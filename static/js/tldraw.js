(function(){
shadow$provide[600]=function(xa,ca,Ya,L){function x(u,A,C){var E,P={},f=null,g=null;void 0!==C&&(f=""+C);void 0!==A.key&&(f=""+A.key);void 0!==A.ref&&(g=A.ref);for(E in A)q.call(A,E)&&!b.hasOwnProperty(E)&&(P[E]=A[E]);if(u&&u.defaultProps)for(E in A=u.defaultProps,A)void 0===P[E]&&(P[E]=A[E]);return{$$typeof:W,type:u,key:f,ref:g,props:P,_owner:B.current}}ca(159);xa=ca(22);var W=60103;L.Fragment=60107;"function"===typeof Symbol&&Symbol.for&&(ca=Symbol.for,W=ca("react.element"),L.Fragment=ca("react.fragment"));
var B=xa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,q=Object.prototype.hasOwnProperty,b={key:!0,ref:!0,__self:!0,__source:!0};L.jsx=x;L.jsxs=x};
shadow$provide[602]=function(xa,ca,Ya,L){Ya.exports=ca(600)};
shadow$provide[603]=function(xa,ca,Ya,L){function x(Ua){for(var xb="https://reactjs.org/docs/error-decoder.html?invariant\x3d"+Ua,qb=1;qb<arguments.length;qb++)xb+="\x26args[]\x3d"+encodeURIComponent(arguments[qb]);return"Minified React error #"+Ua+"; visit "+xb+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function W(Ua){if(null==Ua)return null;if("function"===typeof Ua)return Ua.displayName||Ua.name||null;if("string"===typeof Ua)return Ua;
switch(Ua){case t:return"Fragment";case T:return"Portal";case H:return"Profiler";case I:return"StrictMode";case ha:return"Suspense";case V:return"SuspenseList"}if("object"===typeof Ua)switch(Ua.$$typeof){case O:return(Ua.displayName||"Context")+".Consumer";case Q:return(Ua._context.displayName||"Context")+".Provider";case M:var xb=Ua.render;xb=xb.displayName||xb.name||"";return Ua.displayName||(""!==xb?"ForwardRef("+xb+")":"ForwardRef");case Z:return W(Ua.type);case X:return W(Ua._render);case aa:xb=
Ua._payload;Ua=Ua._init;try{return W(Ua(xb))}catch(qb){}}return null}function B(Ua,xb){for(var qb=Ua._threadCount|0;qb<=xb;qb++)Ua[qb]=Ua._currentValue2,Ua._threadCount=qb+1}function q(Ua,xb,qb,Yb){if(Yb&&(Yb=Ua.contextType,"object"===typeof Yb&&null!==Yb))return B(Yb,qb),Yb[qb];if(Ua=Ua.contextTypes){qb={};for(var cc in Ua)qb[cc]=xb[cc];xb=qb}else xb=ua;return xb}function b(Ua){if(Ha.call(db,Ua))return!0;if(Ha.call(Ja,Ua))return!1;if(va.test(Ua))return db[Ua]=!0;Ja[Ua]=!0;return!1}function u(Ua,
xb,qb,Yb){if(null!==qb&&0===qb.type)return!1;switch(typeof xb){case "function":case "symbol":return!0;case "boolean":if(Yb)return!1;if(null!==qb)return!qb.acceptsBooleans;Ua=Ua.toLowerCase().slice(0,5);return"data-"!==Ua&&"aria-"!==Ua;default:return!1}}function A(Ua,xb,qb,Yb){if(null===xb||"undefined"===typeof xb||u(Ua,xb,qb,Yb))return!0;if(Yb)return!1;if(null!==qb)switch(qb.type){case 3:return!xb;case 4:return!1===xb;case 5:return isNaN(xb);case 6:return isNaN(xb)||1>xb}return!1}function C(Ua,xb,
qb,Yb,cc,yb,Kb){this.acceptsBooleans=2===xb||3===xb||4===xb;this.attributeName=Yb;this.attributeNamespace=cc;this.mustUseProperty=qb;this.propertyName=Ua;this.type=xb;this.sanitizeURL=yb;this.removeEmptyString=Kb}function E(Ua){return Ua[1].toUpperCase()}function P(Ua){if("boolean"===typeof Ua||"number"===typeof Ua)return""+Ua;Ua=""+Ua;var xb=za.exec(Ua);if(xb){var qb="",Yb,cc=0;for(Yb=xb.index;Yb<Ua.length;Yb++){switch(Ua.charCodeAt(Yb)){case 34:xb="\x26quot;";break;case 38:xb="\x26amp;";break;case 39:xb=
"\x26#x27;";break;case 60:xb="\x26lt;";break;case 62:xb="\x26gt;";break;default:continue}cc!==Yb&&(qb+=Ua.substring(cc,Yb));cc=Yb+1;qb+=xb}Ua=cc!==Yb?qb+Ua.substring(cc,Yb):qb}return Ua}function f(Ua,xb){var qb=Ea.hasOwnProperty(Ua)?Ea[Ua]:null,Yb;if(Yb="style"!==Ua)Yb=null!==qb?0===qb.type:!(2<Ua.length)||"o"!==Ua[0]&&"O"!==Ua[0]||"n"!==Ua[1]&&"N"!==Ua[1]?!1:!0;if(Yb||A(Ua,xb,qb,!1))return"";if(null!==qb){Ua=qb.attributeName;Yb=qb.type;if(3===Yb||4===Yb&&!0===xb)return Ua+'\x3d""';qb.sanitizeURL&&
(xb=""+xb);return Ua+'\x3d"'+(P(xb)+'"')}return b(Ua)?Ua+'\x3d"'+(P(xb)+'"'):""}function g(Ua,xb){return Ua===xb&&(0!==Ua||1/Ua===1/xb)||Ua!==Ua&&xb!==xb}function a(){if(null===ja)throw Error(x(321));return ja}function h(){if(0<Sa)throw Error(x(312));return{memoizedState:null,queue:null,next:null}}function l(){null===ma?null===ta?(na=!1,ta=ma=h()):(na=!0,ma=ta):null===ma.next?(na=!1,ma=ma.next=h()):(na=!0,ma=ma.next);return ma}function m(Ua,xb,qb,Yb){for(;Na;)Na=!1,Sa+=1,ma=null,qb=Ua(xb,Yb);D();
return qb}function D(){ja=null;Na=!1;ta=null;Sa=0;ma=Ra=null}function w(Ua,xb){return"function"===typeof xb?xb(Ua):xb}function r(Ua,xb,qb){ja=a();ma=l();if(na){var Yb=ma.queue;xb=Yb.dispatch;if(null!==Ra&&(qb=Ra.get(Yb),void 0!==qb)){Ra.delete(Yb);Yb=ma.memoizedState;do Yb=Ua(Yb,qb.action),qb=qb.next;while(null!==qb);ma.memoizedState=Yb;return[Yb,xb]}return[ma.memoizedState,xb]}Ua=Ua===w?"function"===typeof xb?xb():xb:void 0!==qb?qb(xb):xb;ma.memoizedState=Ua;Ua=ma.queue={last:null,dispatch:null};
Ua=Ua.dispatch=e.bind(null,ja,Ua);return[ma.memoizedState,Ua]}function n(Ua,xb){ja=a();ma=l();xb=void 0===xb?null:xb;if(null!==ma){var qb=ma.memoizedState;if(null!==qb&&null!==xb){var Yb=qb[1];a:if(null===Yb)Yb=!1;else{for(var cc=0;cc<Yb.length&&cc<xb.length;cc++)if(!ka(xb[cc],Yb[cc])){Yb=!1;break a}Yb=!0}if(Yb)return qb[0]}}Ua=Ua();ma.memoizedState=[Ua,xb];return Ua}function e(Ua,xb,qb){if(!(25>Sa))throw Error(x(301));if(Ua===ja)if(Na=!0,Ua={action:qb,next:null},null===Ra&&(Ra=new Map),qb=Ra.get(xb),
void 0===qb)Ra.set(xb,Ua);else{for(xb=qb;null!==xb.next;)xb=xb.next;xb.next=Ua}}function F(){}function y(Ua){switch(Ua){case "svg":return"http://www.w3.org/2000/svg";case "math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function K(Ua){if(void 0===Ua||null===Ua)return Ua;var xb="";N.Children.forEach(Ua,function(qb){null!=qb&&(xb+=qb)});return xb}function U(Ua,xb){if(void 0===Ua)throw Error(x(152,W(xb)||"Component"));}function G(Ua,xb,qb){function Yb(Kb,
Bb){var ib=Bb.prototype&&Bb.prototype.isReactComponent,ub=q(Bb,xb,qb,ib),wb=[],eb=!1,pb={isMounted:function(){return!1},enqueueForceUpdate:function(){if(null===wb)return null},enqueueReplaceState:function(Lc,od){eb=!0;wb=[od]},enqueueSetState:function(Lc,od){if(null===wb)return null;wb.push(od)}};if(ib){if(ib=new Bb(Kb.props,ub,pb),"function"===typeof Bb.getDerivedStateFromProps){var Gb=Bb.getDerivedStateFromProps.call(null,Kb.props,ib.state);null!=Gb&&(ib.state=R({},ib.state,Gb))}}else if(ja={},
ib=Bb(Kb.props,ub,pb),ib=m(Bb,Kb.props,ib,ub),null==ib||null==ib.render){Ua=ib;U(Ua,Bb);return}ib.props=Kb.props;ib.context=ub;ib.updater=pb;pb=ib.state;void 0===pb&&(ib.state=pb=null);if("function"===typeof ib.UNSAFE_componentWillMount||"function"===typeof ib.componentWillMount)if("function"===typeof ib.componentWillMount&&"function"!==typeof Bb.getDerivedStateFromProps&&ib.componentWillMount(),"function"===typeof ib.UNSAFE_componentWillMount&&"function"!==typeof Bb.getDerivedStateFromProps&&ib.UNSAFE_componentWillMount(),
wb.length){pb=wb;var ec=eb;wb=null;eb=!1;if(ec&&1===pb.length)ib.state=pb[0];else{Gb=ec?pb[0]:ib.state;var xc=!0;for(ec=ec?1:0;ec<pb.length;ec++){var Cc=pb[ec];Cc="function"===typeof Cc?Cc.call(ib,Gb,Kb.props,ub):Cc;null!=Cc&&(xc?(xc=!1,Gb=R({},Gb,Cc)):R(Gb,Cc))}ib.state=Gb}}else wb=null;Ua=ib.render();U(Ua,Bb);if("function"===typeof ib.getChildContext&&(Kb=Bb.childContextTypes,"object"===typeof Kb)){var ic=ib.getChildContext(),Nc;for(Nc in ic)if(!(Nc in Kb))throw Error(x(108,W(Bb)||"Unknown",Nc));
}ic&&(xb=R({},xb,ic))}for(;N.isValidElement(Ua);){var cc=Ua,yb=cc.type;if("function"!==typeof yb)break;Yb(cc,yb)}return{child:Ua,context:xb}}var R=ca(159),N=ca(22),T=60106,t=60107,I=60108,H=60114,Q=60109,O=60110,M=60112,ha=60113,V=60120,Z=60115,aa=60116,X=60121,fa=60117,Y=60119,ea=60129,oa=60131;"function"===typeof Symbol&&Symbol.for&&(xa=Symbol.for,T=xa("react.portal"),t=xa("react.fragment"),I=xa("react.strict_mode"),H=xa("react.profiler"),Q=xa("react.provider"),O=xa("react.context"),M=xa("react.forward_ref"),
ha=xa("react.suspense"),V=xa("react.suspense_list"),Z=xa("react.memo"),aa=xa("react.lazy"),X=xa("react.block"),fa=xa("react.fundamental"),Y=xa("react.scope"),ea=xa("react.debug_trace_mode"),oa=xa("react.legacy_hidden"));xa=N.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;var ua={},ra=new Uint16Array(16);for(ca=0;15>ca;ca++)ra[ca]=ca+1;ra[15]=0;var va=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,
Ha=Object.prototype.hasOwnProperty,Ja={},db={},Ea={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(Ua){Ea[Ua]=new C(Ua,0,!1,Ua,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(Ua){var xb=Ua[0];Ea[xb]=new C(xb,1,!1,Ua[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(Ua){Ea[Ua]=
new C(Ua,2,!1,Ua.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(Ua){Ea[Ua]=new C(Ua,2,!1,Ua,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(Ua){Ea[Ua]=new C(Ua,3,!1,Ua.toLowerCase(),null,!1,!1)});["checked",
"multiple","muted","selected"].forEach(function(Ua){Ea[Ua]=new C(Ua,3,!0,Ua,null,!1,!1)});["capture","download"].forEach(function(Ua){Ea[Ua]=new C(Ua,4,!1,Ua,null,!1,!1)});["cols","rows","size","span"].forEach(function(Ua){Ea[Ua]=new C(Ua,6,!1,Ua,null,!1,!1)});["rowSpan","start"].forEach(function(Ua){Ea[Ua]=new C(Ua,5,!1,Ua.toLowerCase(),null,!1,!1)});var Ka=/[\-:]([a-z])/g;"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(Ua){var xb=
Ua.replace(Ka,E);Ea[xb]=new C(xb,1,!1,Ua,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(Ua){var xb=Ua.replace(Ka,E);Ea[xb]=new C(xb,1,!1,Ua,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(Ua){var xb=Ua.replace(Ka,E);Ea[xb]=new C(xb,1,!1,Ua,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(Ua){Ea[Ua]=new C(Ua,1,!1,Ua.toLowerCase(),null,!1,!1)});
Ea.xlinkHref=new C("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(Ua){Ea[Ua]=new C(Ua,1,!1,Ua.toLowerCase(),null,!0,!0)});var za=/["'&<>]/,ka="function"===typeof Object.is?Object.is:g,ja=null,ta=null,ma=null,na=!1,Na=!1,Ra=null,Sa=0,Ma=null,Xa={readContext:function(Ua){var xb=Ma.threadID;B(Ua,xb);return Ua[xb]},useContext:function(Ua){a();var xb=Ma.threadID;B(Ua,xb);return Ua[xb]},useMemo:n,useReducer:r,useRef:function(Ua){ja=
a();ma=l();var xb=ma.memoizedState;return null===xb?(Ua={current:Ua},ma.memoizedState=Ua):xb},useState:function(Ua){return r(w,Ua)},useLayoutEffect:function(){},useCallback:function(Ua,xb){return n(function(){return Ua},xb)},useImperativeHandle:F,useEffect:F,useDebugValue:F,useDeferredValue:function(Ua){a();return Ua},useTransition:function(){a();return[function(Ua){Ua()},!1]},useOpaqueIdentifier:function(){return(Ma.identifierPrefix||"")+"R:"+(Ma.uniqueID++).toString(36)},useMutableSource:function(Ua,
xb){a();return xb(Ua._source)}},jb={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},Jb=R({menuitem:!0},jb),Fb={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,
gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Aa=["Webkit","ms","Moz","O"];Object.keys(Fb).forEach(function(Ua){Aa.forEach(function(xb){xb=xb+Ua.charAt(0).toUpperCase()+Ua.substring(1);Fb[xb]=Fb[Ua]})});var nb=/([A-Z])/g,fb=/^ms-/,Va=N.Children.toArray,
hb=xa.ReactCurrentDispatcher,Wa={listing:!0,pre:!0,textarea:!0},$b=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,Tc={},Qc={},Gc=Object.prototype.hasOwnProperty,Hc={children:null,dangerouslySetInnerHTML:null,suppressContentEditableWarning:null,suppressHydrationWarning:null},Ta=function(){function Ua(qb,Yb,cc){N.isValidElement(qb)?qb.type!==t?qb=[qb]:(qb=qb.props.children,qb=N.isValidElement(qb)?[qb]:Va(qb)):qb=Va(qb);qb={type:null,domNamespace:"http://www.w3.org/1999/xhtml",children:qb,childIndex:0,context:ua,footer:""};
var yb=ra[0];if(0===yb){var Kb=ra;yb=Kb.length;var Bb=2*yb;if(!(65536>=Bb))throw Error(x(304));var ib=new Uint16Array(Bb);ib.set(Kb);ra=ib;ra[0]=yb+1;for(Kb=yb;Kb<Bb-1;Kb++)ra[Kb]=Kb+1;ra[Bb-1]=0}else ra[0]=ra[yb];this.threadID=yb;this.stack=[qb];this.exhausted=!1;this.currentSelectValue=null;this.previousWasTextNode=!1;this.makeStaticMarkup=Yb;this.suspenseDepth=0;this.contextIndex=-1;this.contextStack=[];this.contextValueStack=[];this.uniqueID=0;this.identifierPrefix=cc&&cc.identifierPrefix||""}
var xb=Ua.prototype;xb.destroy=function(){if(!this.exhausted){this.exhausted=!0;this.clearProviders();var qb=this.threadID;ra[qb]=ra[0];ra[0]=qb}};xb.pushProvider=function(qb){var Yb=++this.contextIndex,cc=qb.type._context,yb=this.threadID;B(cc,yb);var Kb=cc[yb];this.contextStack[Yb]=cc;this.contextValueStack[Yb]=Kb;cc[yb]=qb.props.value};xb.popProvider=function(){var qb=this.contextIndex,Yb=this.contextStack[qb],cc=this.contextValueStack[qb];this.contextStack[qb]=null;this.contextValueStack[qb]=
null;this.contextIndex--;Yb[this.threadID]=cc};xb.clearProviders=function(){for(var qb=this.contextIndex;0<=qb;qb--)this.contextStack[qb][this.threadID]=this.contextValueStack[qb]};xb.read=function(qb){if(this.exhausted)return null;var Yb=Ma;Ma=this;var cc=hb.current;hb.current=Xa;try{for(var yb=[""],Kb=!1;yb[0].length<qb;){if(0===this.stack.length){this.exhausted=!0;var Bb=this.threadID;ra[Bb]=ra[0];ra[0]=Bb;break}var ib=this.stack[this.stack.length-1];if(Kb||ib.childIndex>=ib.children.length){var ub=
ib.footer;""!==ub&&(this.previousWasTextNode=!1);this.stack.pop();if("select"===ib.type)this.currentSelectValue=null;else if(null!=ib.type&&null!=ib.type.type&&ib.type.type.$$typeof===Q)this.popProvider(ib.type);else if(ib.type===ha){this.suspenseDepth--;var wb=yb.pop();if(Kb){Kb=!1;var eb=ib.fallbackFrame;if(!eb)throw Error(x(303));this.stack.push(eb);yb[this.suspenseDepth]+="\x3c!--$!--\x3e";continue}else yb[this.suspenseDepth]+=wb}yb[this.suspenseDepth]+=ub}else{var pb=ib.children[ib.childIndex++],
Gb="";try{Gb+=this.render(pb,ib.context,ib.domNamespace)}catch(ec){if(null!=ec&&"function"===typeof ec.then)throw Error(x(294));throw ec;}finally{}yb.length<=this.suspenseDepth&&yb.push("");yb[this.suspenseDepth]+=Gb}}return yb[0]}finally{hb.current=cc,Ma=Yb,D()}};xb.render=function(qb,Yb,cc){if("string"===typeof qb||"number"===typeof qb){cc=""+qb;if(""===cc)return"";if(this.makeStaticMarkup)return P(cc);if(this.previousWasTextNode)return"\x3c!-- --\x3e"+P(cc);this.previousWasTextNode=!0;return P(cc)}Yb=
G(qb,Yb,this.threadID);qb=Yb.child;Yb=Yb.context;if(null===qb||!1===qb)return"";if(!N.isValidElement(qb)){if(null!=qb&&null!=qb.$$typeof){cc=qb.$$typeof;if(cc===T)throw Error(x(257));throw Error(x(258,cc.toString()));}qb=Va(qb);this.stack.push({type:null,domNamespace:cc,children:qb,childIndex:0,context:Yb,footer:""});return""}var yb=qb.type;if("string"===typeof yb)return this.renderDOM(qb,Yb,cc);switch(yb){case oa:case ea:case I:case H:case V:case t:return qb=Va(qb.props.children),this.stack.push({type:null,
domNamespace:cc,children:qb,childIndex:0,context:Yb,footer:""}),"";case ha:throw Error(x(294));case Y:throw Error(x(343));}if("object"===typeof yb&&null!==yb)switch(yb.$$typeof){case M:ja={};var Kb=yb.render(qb.props,qb.ref);Kb=m(yb.render,qb.props,Kb,qb.ref);Kb=Va(Kb);this.stack.push({type:null,domNamespace:cc,children:Kb,childIndex:0,context:Yb,footer:""});return"";case Z:return qb=[N.createElement(yb.type,R({ref:qb.ref},qb.props))],this.stack.push({type:null,domNamespace:cc,children:qb,childIndex:0,
context:Yb,footer:""}),"";case Q:return yb=Va(qb.props.children),cc={type:qb,domNamespace:cc,children:yb,childIndex:0,context:Yb,footer:""},this.pushProvider(qb),this.stack.push(cc),"";case O:yb=qb.type;Kb=qb.props;var Bb=this.threadID;B(yb,Bb);yb=Va(Kb.children(yb[Bb]));this.stack.push({type:qb,domNamespace:cc,children:yb,childIndex:0,context:Yb,footer:""});return"";case fa:throw Error(x(338));case aa:return yb=qb.type,Kb=yb._init,yb=Kb(yb._payload),qb=[N.createElement(yb,R({ref:qb.ref},qb.props))],
this.stack.push({type:null,domNamespace:cc,children:qb,childIndex:0,context:Yb,footer:""}),""}throw Error(x(130,null==yb?yb:typeof yb,""));};xb.renderDOM=function(qb,Yb,cc){var yb=qb.type.toLowerCase();"http://www.w3.org/1999/xhtml"===cc&&y(yb);if(!Tc.hasOwnProperty(yb)){if(!$b.test(yb))throw Error(x(65,yb));Tc[yb]=!0}var Kb=qb.props;if("input"===yb)Kb=R({type:void 0},Kb,{defaultChecked:void 0,defaultValue:void 0,value:null!=Kb.value?Kb.value:Kb.defaultValue,checked:null!=Kb.checked?Kb.checked:Kb.defaultChecked});
else if("textarea"===yb){var Bb=Kb.value;if(null==Bb){Bb=Kb.defaultValue;var ib=Kb.children;if(null!=ib){if(null!=Bb)throw Error(x(92));if(Array.isArray(ib)){if(!(1>=ib.length))throw Error(x(93));ib=ib[0]}Bb=""+ib}null==Bb&&(Bb="")}Kb=R({},Kb,{value:void 0,children:""+Bb})}else if("select"===yb)this.currentSelectValue=null!=Kb.value?Kb.value:Kb.defaultValue,Kb=R({},Kb,{value:void 0});else if("option"===yb){ib=this.currentSelectValue;var ub=K(Kb.children);if(null!=ib){var wb=null!=Kb.value?Kb.value+
"":ub;Bb=!1;if(Array.isArray(ib))for(var eb=0;eb<ib.length;eb++){if(""+ib[eb]===wb){Bb=!0;break}}else Bb=""+ib===wb;Kb=R({selected:void 0,children:void 0},Kb,{selected:Bb,children:ub})}}if(Bb=Kb){if(Jb[yb]&&(null!=Bb.children||null!=Bb.dangerouslySetInnerHTML))throw Error(x(137,yb));if(null!=Bb.dangerouslySetInnerHTML){if(null!=Bb.children)throw Error(x(60));if(!("object"===typeof Bb.dangerouslySetInnerHTML&&"__html"in Bb.dangerouslySetInnerHTML))throw Error(x(61));}if(null!=Bb.style&&"object"!==
typeof Bb.style)throw Error(x(62));}Bb=Kb;ib=this.makeStaticMarkup;ub=1===this.stack.length;wb="\x3c"+qb.type;a:if(-1===yb.indexOf("-"))eb="string"===typeof Bb.is;else switch(yb){case "annotation-xml":case "color-profile":case "font-face":case "font-face-src":case "font-face-uri":case "font-face-format":case "font-face-name":case "missing-glyph":eb=!1;break a;default:eb=!0}for(od in Bb)if(Gc.call(Bb,od)){var pb=Bb[od];if(null!=pb){if("style"===od){var Gb=void 0,ec="",xc="";for(Gb in pb)if(pb.hasOwnProperty(Gb)){var Cc=
0===Gb.indexOf("--"),ic=pb[Gb];if(null!=ic){if(Cc)var Nc=Gb;else if(Nc=Gb,Qc.hasOwnProperty(Nc))Nc=Qc[Nc];else{var Lc=Nc.replace(nb,"-$1").toLowerCase().replace(fb,"-ms-");Nc=Qc[Nc]=Lc}ec+=xc+Nc+":";xc=Gb;Cc=null==ic||"boolean"===typeof ic||""===ic?"":Cc||"number"!==typeof ic||0===ic||Fb.hasOwnProperty(xc)&&Fb[xc]?(""+ic).trim():ic+"px";ec+=Cc;xc=";"}}pb=ec||null}Gb=null;eb?Hc.hasOwnProperty(od)||(Gb=od,Gb=b(Gb)&&null!=pb?Gb+'\x3d"'+(P(pb)+'"'):""):Gb=f(od,pb);Gb&&(wb+=" "+Gb)}}ib||ub&&(wb+=' data-reactroot\x3d""');
var od=wb;Bb="";jb.hasOwnProperty(yb)?od+="/\x3e":(od+="\x3e",Bb="\x3c/"+qb.type+"\x3e");a:{ib=Kb.dangerouslySetInnerHTML;if(null!=ib){if(null!=ib.__html){ib=ib.__html;break a}}else if(ib=Kb.children,"string"===typeof ib||"number"===typeof ib){ib=P(ib);break a}ib=null}null!=ib?(Kb=[],Wa.hasOwnProperty(yb)&&"\n"===ib.charAt(0)&&(od+="\n"),od+=ib):Kb=Va(Kb.children);qb=qb.type;cc=null==cc||"http://www.w3.org/1999/xhtml"===cc?y(qb):"http://www.w3.org/2000/svg"===cc&&"foreignObject"===qb?"http://www.w3.org/1999/xhtml":
cc;this.stack.push({domNamespace:cc,type:yb,children:Kb,childIndex:0,context:Yb,footer:Bb});this.previousWasTextNode=!1;return od};return Ua}();L.renderToNodeStream=function(){throw Error(x(207));};L.renderToStaticMarkup=function(Ua,xb){Ua=new Ta(Ua,!0,xb);try{return Ua.read(Infinity)}finally{Ua.destroy()}};L.renderToStaticNodeStream=function(){throw Error(x(208));};L.renderToString=function(Ua,xb){Ua=new Ta(Ua,!1,xb);try{return Ua.read(Infinity)}finally{Ua.destroy()}};L.version="17.0.2"};
shadow$provide[605]=function(xa,ca,Ya,L){Ya.exports=ca(603)};
shadow$provide[606]=function(xa,ca,Ya,L){function x(){if(!Nb&&(Nb="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Nb))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Nb(oc)}function W(c,k=0){return(kd[c[k+0]]+kd[c[k+1]]+kd[c[k+2]]+kd[c[k+3]]+"-"+kd[c[k+4]]+kd[c[k+5]]+"-"+kd[c[k+6]]+kd[c[k+7]]+"-"+kd[c[k+8]]+kd[c[k+9]]+"-"+kd[c[k+10]]+kd[c[k+11]]+kd[c[k+12]]+kd[c[k+13]]+kd[c[k+14]]+
kd[c[k+15]]).toLowerCase()}function B(c){let k=0;var J=0;for(var da of c)k+=da.w*da.h,J=Math.max(J,da.w);c.sort((Ia,bb)=>bb.h-Ia.h);J=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(k/.95)),J),h:Infinity}];let qa=da=0;for(const Ia of c)for(c=J.length-1;0<=c;c--){var Ca=J[c];if(!(Ia.w>Ca.w||Ia.h>Ca.h)){Ia.x=Ca.x;Ia.y=Ca.y;qa=Math.max(qa,Ia.y+Ia.h);da=Math.max(da,Ia.x+Ia.w);Ia.w===Ca.w&&Ia.h===Ca.h?(Ca=J.pop(),c<J.length&&(J[c]=Ca)):Ia.h===Ca.h?(Ca.x+=Ia.w,Ca.w-=Ia.w):(Ia.w!==Ca.w&&J.push({x:Ca.x+Ia.w,y:Ca.y,
w:Ca.w-Ia.w,h:Ia.h}),Ca.y+=Ia.h,Ca.h-=Ia.h);break}}return{w:da,h:qa,fill:k/(da*qa)||0}}function q(c,...k){return{didIntersect:0<k.length,message:c,points:k}}function b(c,k,J=0){const da=[c[0]+k[0]/2,c[1]+k[1]/2],qa=Ld.rotWith(c,da,J),Ca=Ld.rotWith(Ld.add(c,[k[0],0]),da,J),Ia=Ld.rotWith(Ld.add(c,k),da,J);c=Ld.rotWith(Ld.add(c,[0,k[1]]),da,J);return[["top",[qa,Ca]],["right",[Ca,Ia]],["bottom",[Ia,c]],["left",[c,qa]]]}function u(c,k,J,da){const [qa,Ca]=c,[Ia,bb]=k,[rb,Pb]=J,[jc,yc]=da;return bb/Ia!==
(yc-Pb)/(jc-rb)&&(k=Ia*(yc-Pb)-bb*(jc-rb),0!==k&&(c=((Ca-Pb)*(jc-rb)-(qa-rb)*(yc-Pb))/k,k=((Ca-Pb)*Ia-(qa-rb)*bb)/k,0<=c&&0<=k&&1>=k))?q("intersection",[qa+c*Ia,Ca+c*bb]):q("no intersection")}function A(c,k,J,da,qa=0){return a(J,da,qa,c,k)}function C(c,k,J,da=0){const {minX:qa,minY:Ca,width:Ia,height:bb}=J;return A(c,k,[qa,Ca],[Ia,bb],da)}function E(c,k,J,da){var qa=Ld.sub(c,J);J=Ld.sub(da,J);k=Ld.sub(k,c);da=J[0]*qa[1]-J[1]*qa[0];qa=k[0]*qa[1]-k[1]*qa[0];J=J[1]*k[0]-J[0]*k[1];return 0===da||0===
qa?q("coincident"):0===J?q("parallel"):0!==J&&(da/=J,qa/=J,0<=da&&1>=da&&0<=qa&&1>=qa)?q("intersection",Ld.add(c,Ld.mul(k,da))):q("no intersection")}function P(c,k,J,da){var qa=(k[0]-c[0])*(k[0]-c[0])+(k[1]-c[1])*(k[1]-c[1]),Ca=2*((k[0]-c[0])*(c[0]-J[0])+(k[1]-c[1])*(c[1]-J[1]));J=Ca*Ca-4*qa*(J[0]*J[0]+J[1]*J[1]+c[0]*c[0]+c[1]*c[1]-2*(J[0]*c[0]+J[1]*c[1])-da*da);if(0>J)return q("outside");if(0===J)return q("tangent");da=Math.sqrt(J);J=(-Ca+da)/(2*qa);qa=(-Ca-da)/(2*qa);if((0>J||1<J)&&(0>qa||1<qa))return 0>
J&&0>qa||1<J&&1<qa?q("outside"):q("inside");Ca=[];0<=J&&1>=J&&Ca.push(Ld.lrp(c,k,J));0<=qa&&1>=qa&&Ca.push(Ld.lrp(c,k,qa));return q("intersection",...Ca)}function f(c,k,J,da,qa,Ca=0){if(0===da||0===qa||Ld.isEqual(c,k))return q("no intersection");da=0>da?da:-da;qa=0>qa?qa:-qa;c=Ld.sub(Ld.rotWith(c,J,-Ca),J);k=Ld.sub(Ld.rotWith(k,J,-Ca),J);var Ia=Ld.sub(k,c),bb=Ia[0]*Ia[0]/da/da+Ia[1]*Ia[1]/qa/qa;Ia=2*c[0]*Ia[0]/da/da+2*c[1]*Ia[1]/qa/qa;const rb=[];da=Ia*Ia-4*bb*(c[0]*c[0]/da/da+c[1]*c[1]/qa/qa-1);
0===da?rb.push(-Ia/2/bb):0<da&&(da=Math.sqrt(da),rb.push((-Ia+da)/2/bb),rb.push((-Ia-da)/2/bb));bb=rb.filter(Pb=>0<=Pb&&1>=Pb).map(Pb=>Ld.add(J,Ld.add(c,Ld.mul(Ld.sub(k,c),Pb)))).map(Pb=>Ld.rotWith(Pb,J,Ca));return q("intersection",...bb)}function g(c,k,J){const da=[];for(let qa=1;qa<J.length;qa++){const Ca=E(c,k,J[qa-1],J[qa]);Ca&&da.push(...Ca.points)}return 0===da.length?q("no intersection"):q("intersection",...J)}function a(c,k,J,da,qa){return b(c,k,J).reduce((Ca,[Ia,[bb,rb]])=>{(bb=u(da,qa,bb,
rb))&&Ca.push(q(Ia,...bb.points));return Ca},[]).filter(Ca=>Ca.didIntersect)}function h(c,k,J,da){return b(c,k).reduce((qa,[Ca,[Ia,bb]])=>{(Ia=E(J,da,Ia,bb))&&qa.push(q(Ca,...Ia.points));return qa},[]).filter(qa=>qa.didIntersect)}function l(c,k,J,da){return b(c,k).reduce((qa,[Ca,[Ia,bb]])=>{(Ia=P(Ia,bb,J,da))&&qa.push(gg(tf({},Ia),{message:Ca}));return qa},[]).filter(qa=>qa.didIntersect)}function m(c,k,J,da,qa,Ca=0){return b(c,k).reduce((Ia,[bb,[rb,Pb]])=>{(rb=f(rb,Pb,J,da,qa,Ca))&&Ia.push(gg(tf({},
rb),{message:bb}));return Ia},[]).filter(Ia=>Ia.didIntersect)}function D(c,k,J){return b(c,k).reduce((da,[qa,[Ca,Ia]])=>{Ca=g(Ca,Ia,J);Ca.didIntersect&&da.push(q(qa,...Ca.points));return da},[]).filter(da=>da.didIntersect)}function w(c,k,J){return b(c,k).reduce((da,[qa,[Ca,Ia]])=>{{const bb=[];for(let rb=1;rb<J.length+1;rb++){const Pb=E(Ca,Ia,J[rb-1],J[rb%J.length]);Pb&&bb.push(...Pb.points)}Ca=0===bb.length?q("no intersection"):q("intersection",...J)}Ca.didIntersect&&da.push(q(qa,...Ca.points));
return da},[]).filter(da=>da.didIntersect)}function r(c,k,J,da=0,qa,Ca){return k===J?l(qa,Ca,c,k):m(qa,Ca,c,k,J,da)}function n(c,k,J){const {minX:da,minY:qa,width:Ca,height:Ia}=c;return h([da,qa],[Ca,Ia],k,J)}function e(c){for(var k=arguments.length,J=Array(1<k?k-1:0),da=1;da<k;da++)J[da-1]=arguments[da];throw Error("number"===typeof c?"[MobX] minified error nr: "+c+(J.length?" "+J.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":
"[MobX] "+c);}function F(){return"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof xa?xa:"undefined"!==typeof self?self:Nm}function y(){is||e("Proxy not available")}function K(c){var k=!1;return function(){if(!k)return k=!0,c.apply(this,arguments)}}function U(c){return"function"===typeof c}function G(c){switch(typeof c){case "string":case "symbol":case "number":return!0}return!1}function R(c){return null!==c&&"object"===typeof c}function N(c){if(!R(c))return!1;
c=Object.getPrototypeOf(c);if(null==c)return!0;c=Object.hasOwnProperty.call(c,"constructor")&&c.constructor;return"function"===typeof c&&c.toString()===sr}function T(c){return(c=null==c?void 0:c.constructor)?"GeneratorFunction"===c.name||"GeneratorFunction"===c.displayName?!0:!1:!1}function t(c,k,J){Ah(c,k,{enumerable:!1,writable:!0,configurable:!0,value:J})}function I(c,k,J){Ah(c,k,{enumerable:!1,writable:!1,configurable:!0,value:J})}function H(c,k){var J="isMobX"+c;k.prototype[J]=!0;return function(da){return R(da)&&
!0===da[J]}}function Q(c){return c instanceof Map}function O(c){return c instanceof Set}function M(c){var k=Object.keys(c);if(!Qn)return k;var J=Object.getOwnPropertySymbols(c);return J.length?[].concat(k,J.filter(function(da){return vp.propertyIsEnumerable.call(c,da)})):k}function ha(c){return null===c?null:"object"===typeof c?""+c:c}function V(c,k){return vp.hasOwnProperty.call(c,k)}function Z(c,k){for(var J=0;J<k.length;J++){var da=k[J];da.enumerable=da.enumerable||!1;da.configurable=!0;"value"in
da&&(da.writable=!0);Object.defineProperty(c,da.key,da)}}function aa(c,k,J){k&&Z(c.prototype,k);J&&Z(c,J);Object.defineProperty(c,"prototype",{writable:!1});return c}function X(){X=Object.assign||function(c){for(var k=1;k<arguments.length;k++){var J=arguments[k],da;for(da in J)Object.prototype.hasOwnProperty.call(J,da)&&(c[da]=J[da])}return c};return X.apply(this,arguments)}function fa(c,k){c.prototype=Object.create(k.prototype);c.prototype.constructor=c;Y(c,k)}function Y(c,k){Y=Object.setPrototypeOf||
function(J,da){J.__proto__=da;return J};return Y(c,k)}function ea(c){if(void 0===c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}function oa(c,k){if(c){if("string"===typeof c)return ua(c,k);var J=Object.prototype.toString.call(c).slice(8,-1);"Object"===J&&c.constructor&&(J=c.constructor.name);if("Map"===J||"Set"===J)return Array.from(c);if("Arguments"===J||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(J))return ua(c,k)}}function ua(c,k){if(null==
k||k>c.length)k=c.length;for(var J=0,da=Array(k);J<k;J++)da[J]=c[J];return da}function ra(c,k){var J="undefined"!==typeof Symbol&&c[Symbol.iterator]||c["@@iterator"];if(J)return(J=J.call(c)).next.bind(J);if(Array.isArray(c)||(J=oa(c))||k&&c&&"number"===typeof c.length){J&&(c=J);var da=0;return function(){return da>=c.length?{done:!0}:{done:!1,value:c[da++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}function va(c){return Object.assign(function(k,J){Ha(k,J,c)},c)}function Ha(c,k,J){V(c,Tl)||t(c,Tl,X({},c[Tl]));J.annotationType_!==Et&&(c[Tl][k]=J)}function Ja(c){V(c,Tl)||t(c,Tl,X({},c[Tl]));return c[Tl]}function db(c,k,J){void 0===k&&(k=Pn);void 0===J&&(J=Pn);c=new pn(c);k!==Pn&&Pc(ee,c,k,void 0);J!==Pn&&pd(c,J);return c}function Ea(c,k,J){return vc(c)?c:Array.isArray(c)?Sg.array(c,{name:J}):N(c)?Sg.object(c,void 0,{name:J}):Q(c)?Sg.map(c,{name:J}):O(c)?Sg.set(c,{name:J}):"function"!==typeof c||
Cc(c)||Jc(c)?c:T(c)?qg(c):hd(J,c)}function Ka(c){return c}function za(c,k){return{annotationType_:c,options_:k,make_:ka,extend_:ja}}function ka(c,k,J,da){var qa;if(null!=(qa=this.options_)&&qa.bound)return null===this.extend_(c,k,J,!1)?0:1;if(da===c.target_)return null===this.extend_(c,k,J,!1)?0:2;if(Cc(J.value))return 1;c=ta(c,this,k,J,!1);Ah(da,k,c);return 2}function ja(c,k,J,da){J=ta(c,this,k,J);return c.defineProperty_(k,J,da)}function ta(c,k,J,da,qa){var Ca,Ia,bb,rb,Pb,jc,yc;void 0===qa&&(qa=
Vf.safeDescriptors);da=da.value;if(null!=(Ca=k.options_)&&Ca.bound){var Rc;da=da.bind(null!=(Rc=c.proxy_)?Rc:c.target_)}return{value:Wa(null!=(Ia=null==(bb=k.options_)?void 0:bb.name)?Ia:J.toString(),da,null!=(rb=null==(Pb=k.options_)?void 0:Pb.autoAction)?rb:!1,null!=(jc=k.options_)&&jc.bound?null!=(yc=c.proxy_)?yc:c.target_:void 0),configurable:qa?c.isPlainObject_:!0,enumerable:!1,writable:qa?!1:!0}}function ma(c,k){return{annotationType_:c,options_:k,make_:na,extend_:Na}}function na(c,k,J,da){var qa;
if(da===c.target_)return null===this.extend_(c,k,J,!1)?0:2;if(null!=(qa=this.options_)&&qa.bound&&(!V(c.target_,k)||!Jc(c.target_[k]))&&null===this.extend_(c,k,J,!1))return 0;if(Jc(J.value))return 1;c=Ra(c,this,k,J,!1,!1);Ah(da,k,c);return 2}function Na(c,k,J,da){var qa;J=Ra(c,this,k,J,null==(qa=this.options_)?void 0:qa.bound);return c.defineProperty_(k,J,da)}function Ra(c,k,J,da,qa,Ca){void 0===Ca&&(Ca=Vf.safeDescriptors);k=da.value;Jc(k)||(k=qg(k));if(qa){var Ia;k=k.bind(null!=(Ia=c.proxy_)?Ia:
c.target_);k.isMobXFlow=!0}return{value:k,configurable:Ca?c.isPlainObject_:!0,enumerable:!1,writable:Ca?!1:!0}}function Sa(c,k){return{annotationType_:c,options_:k,make_:Ma,extend_:Xa}}function Ma(c,k,J){return null===this.extend_(c,k,J,!1)?0:1}function Xa(c,k,J,da){return c.defineComputedProperty_(k,X({},this.options_,{get:J.get,set:J.set}),da)}function jb(c,k){return{annotationType_:c,options_:k,make_:Jb,extend_:Fb}}function Jb(c,k,J){return null===this.extend_(c,k,J,!1)?0:1}function Fb(c,k,J,da){var qa,
Ca;return c.defineObservableProperty_(k,J.value,null!=(qa=null==(Ca=this.options_)?void 0:Ca.enhancer)?qa:Ea,da)}function Aa(c){return{annotationType_:"true",options_:c,make_:nb,extend_:fb}}function nb(c,k,J,da){var qa,Ca;if(J.get)return Zg.make_(c,k,J,da);if(J.set){J=Wa(k.toString(),J.set);if(da===c.target_)return null===c.defineProperty_(k,{configurable:Vf.safeDescriptors?c.isPlainObject_:!0,set:J})?0:2;Ah(da,k,{configurable:!0,set:J});return 2}if(da!==c.target_&&"function"===typeof J.value){var Ia;
if(T(J.value)){var bb;return(null!=(bb=this.options_)&&bb.autoBind?qg.bound:qg).make_(c,k,J,da)}return(null!=(Ia=this.options_)&&Ia.autoBind?hd.bound:hd).make_(c,k,J,da)}Ia=!1===(null==(qa=this.options_)?void 0:qa.deep)?Sg.ref:Sg;if("function"===typeof J.value&&null!=(Ca=this.options_)&&Ca.autoBind){var rb;J.value=J.value.bind(null!=(rb=c.proxy_)?rb:c.target_)}return Ia.make_(c,k,J,da)}function fb(c,k,J,da){var qa,Ca;if(J.get)return Zg.extend_(c,k,J,da);if(J.set)return c.defineProperty_(k,{configurable:Vf.safeDescriptors?
c.isPlainObject_:!0,set:Wa(k.toString(),J.set)},da);if("function"===typeof J.value&&null!=(qa=this.options_)&&qa.autoBind){var Ia;J.value=J.value.bind(null!=(Ia=c.proxy_)?Ia:c.target_)}return(!1===(null==(Ca=this.options_)?void 0:Ca.deep)?Sg.ref:Sg).extend_(c,k,J,da)}function Va(c){if(!0===c.deep)var k=Ea;else{if(!1===c.deep)c=Ka;else{c=c.defaultDecorator;var J;c=c?null!=(k=null==(J=c.options_)?void 0:J.enhancer)?k:Ea:Ea}k=c}return k}function hb(c,k,J){if(G(k))Ha(c,k,js);else return vc(c)?c:N(c)?
Sg.object(c,k,J):Array.isArray(c)?Sg.array(c,k):Q(c)?Sg.map(c,k):O(c)?Sg.set(c,k):"object"===typeof c&&null!==c?c:Sg.box(c,k)}function Wa(c,k,J,da){function qa(){a:{var Ca=da||this,Ia=arguments,bb=Vf.trackingDerivation,rb=!J||!bb;Kb();var Pb=Vf.allowStateChanges;rb&&(Ua(),Pb=Tc(!0));var jc=xb(!0),yc=Kt++,Rc=gq;gq=yc;try{var jd=k.apply(Ca,Ia);break a}catch(xd){var fd=xd;throw xd;}finally{gq!==yc&&e(30),gq=Rc,void 0!==fd&&(Vf.suppressReactionErrors=!0),Vf.allowStateChanges=Pb,Vf.allowStateReads=jc,
Bb(),rb&&(Vf.trackingDerivation=bb),Vf.suppressReactionErrors=!1}jd=void 0}return jd}void 0===J&&(J=!1);qa.isMobxAction=!0;Lt&&(hq.value=c,Object.defineProperty(qa,"name",hq));return qa}function $b(c,k){c=Tc(c);try{return k()}finally{Vf.allowStateChanges=c}}function Tc(c){var k=Vf.allowStateChanges;Vf.allowStateChanges=c;return k}function Qc(c){switch(c.dependenciesState_){case Yi.UP_TO_DATE_:return!1;case Yi.NOT_TRACKING_:case Yi.STALE_:return!0;case Yi.POSSIBLY_STALE_:for(var k=xb(!0),J=Ua(),da=
c.observing_,qa=da.length,Ca=0;Ca<qa;Ca++){var Ia=da[Ca];if(yp(Ia)){if(Vf.disableErrorBoundaries)Ia.get();else try{Ia.get()}catch(bb){return Vf.trackingDerivation=J,Vf.allowStateReads=k,!0}if(c.dependenciesState_===Yi.STALE_)return Vf.trackingDerivation=J,Vf.allowStateReads=k,!0}}qb(c);Vf.trackingDerivation=J;Vf.allowStateReads=k;return!1}}function Gc(c,k,J){var da=xb(!0);qb(c);c.newObserving_=Array(c.observing_.length+100);c.unboundDepsCount_=0;c.runId_=++Vf.runId;var qa=Vf.trackingDerivation;Vf.trackingDerivation=
c;Vf.inBatch++;if(!0===Vf.disableErrorBoundaries)var Ca=k.call(J);else try{Ca=k.call(J)}catch(jc){Ca=new Sn(jc)}Vf.inBatch--;Vf.trackingDerivation=qa;var Ia=c.observing_;k=c.observing_=c.newObserving_;J=Yi.UP_TO_DATE_;qa=0;for(var bb=c.unboundDepsCount_,rb=0;rb<bb;rb++){var Pb=k[rb];0===Pb.diffValue_&&(Pb.diffValue_=1,qa!==rb&&(k[qa]=Pb),qa++);Pb.dependenciesState_>J&&(J=Pb.dependenciesState_)}k.length=qa;c.newObserving_=null;for(bb=Ia.length;bb--;)rb=Ia[bb],0===rb.diffValue_&&cc(rb,c),rb.diffValue_=
0;for(;qa--;)Ia=k[qa],1===Ia.diffValue_&&(Ia.diffValue_=0,bb=c,Ia.observers_.add(bb),Ia.lowestObserverState_>bb.dependenciesState_&&(Ia.lowestObserverState_=bb.dependenciesState_));J!==Yi.UP_TO_DATE_&&(c.dependenciesState_=J,c.onBecomeStale_());Vf.allowStateReads=da;return Ca}function Hc(c){var k=c.observing_;c.observing_=[];for(var J=k.length;J--;)cc(k[J],c);c.dependenciesState_=Yi.NOT_TRACKING_}function Ta(c){var k=Ua();try{return c()}finally{Vf.trackingDerivation=k}}function Ua(){var c=Vf.trackingDerivation;
Vf.trackingDerivation=null;return c}function xb(c){var k=Vf.allowStateReads;Vf.allowStateReads=c;return k}function qb(c){if(c.dependenciesState_!==Yi.UP_TO_DATE_){c.dependenciesState_=Yi.UP_TO_DATE_;c=c.observing_;for(var k=c.length;k--;)c[k].lowestObserverState_=Yi.UP_TO_DATE_}}function Yb(){(Vf.pendingReactions.length||Vf.inBatch||Vf.isRunningReactions)&&e(36);ps=!0;if(jq){var c=F();0===--c.__mobxInstanceCount&&(c.__mobxGlobals=void 0);Vf=new iq}}function cc(c,k){c.observers_["delete"](k);0===c.observers_.size&&
yb(c)}function yb(c){!1===c.isPendingUnobservation_&&(c.isPendingUnobservation_=!0,Vf.pendingUnobservations.push(c))}function Kb(){Vf.inBatch++}function Bb(){if(0===--Vf.inBatch){0<Vf.inBatch||Vf.isRunningReactions||kq(pb);for(var c=Vf.pendingUnobservations,k=0;k<c.length;k++){var J=c[k];J.isPendingUnobservation_=!1;0===J.observers_.size&&(J.isBeingObserved_&&(J.isBeingObserved_=!1,J.onBUO()),J instanceof xp&&J.suspend_())}Vf.pendingUnobservations=[]}}function ib(c){var k=Vf.trackingDerivation;if(null!==
k)return k.runId_!==c.lastAccessedBy_&&(c.lastAccessedBy_=k.runId_,k.newObserving_[k.unboundDepsCount_++]=c,!c.isBeingObserved_&&Vf.trackingContext&&(c.isBeingObserved_=!0,c.onBO())),c.isBeingObserved_;0===c.observers_.size&&0<Vf.inBatch&&yb(c);return!1}function ub(c){c.lowestObserverState_!==Yi.STALE_&&(c.lowestObserverState_=Yi.STALE_,c.observers_.forEach(function(k){if(k.dependenciesState_===Yi.UP_TO_DATE_)k.onBecomeStale_();k.dependenciesState_=Yi.STALE_}))}function wb(c){c.lowestObserverState_!==
Yi.STALE_&&(c.lowestObserverState_=Yi.STALE_,c.observers_.forEach(function(k){k.dependenciesState_===Yi.POSSIBLY_STALE_?k.dependenciesState_=Yi.STALE_:k.dependenciesState_===Yi.UP_TO_DATE_&&(c.lowestObserverState_=Yi.UP_TO_DATE_)}))}function eb(c){c.lowestObserverState_===Yi.UP_TO_DATE_&&(c.lowestObserverState_=Yi.POSSIBLY_STALE_,c.observers_.forEach(function(k){k.dependenciesState_===Yi.UP_TO_DATE_&&(k.dependenciesState_=Yi.POSSIBLY_STALE_,k.onBecomeStale_())}))}function pb(){Vf.isRunningReactions=
!0;for(var c=Vf.pendingReactions,k=0;0<c.length;){++k===Ot&&(console.error("[mobx] cycle in reaction: "+c[0]),c.splice(0));for(var J=c.splice(0),da=0,qa=J.length;da<qa;da++)J[da].runReaction_()}Vf.isRunningReactions=!1}function Gb(c){var k=kq;kq=function(J){return c(function(){return k(J)})}}function ec(c){console.warn("[mobx.spy] Is a no-op in production builds");return function(){}}function xc(c){return function(k,J){if(U(k))return Wa(k.name||"\x3cunnamed action\x3e",k,c);if(U(J))return Wa(k,J,
c);if(G(J))return Ha(k,J,c?gb:ia);if(G(k))return va(za(c?"autoAction":qs,{name:k,autoAction:c}))}}function Cc(c){return U(c)&&!0===c.isMobxAction}function ic(c,k){function J(){c(rb)}var da,qa;void 0===k&&(k=rr);var Ca=null!=(da=null==(qa=k)?void 0:qa.name)?da:"Autorun";if(k.scheduler||k.delay){var Ia=Nc(k),bb=!1;var rb=new vo(Ca,function(){bb||(bb=!0,Ia(function(){bb=!1;rb.isDisposed_||rb.track(J)}))},k.onError,k.requiresObservable)}else rb=new vo(Ca,function(){this.track(J)},k.onError,k.requiresObservable);
rb.schedule_();return rb.getDisposer_()}function Nc(c){return c.scheduler?c.scheduler:c.delay?function(k){return setTimeout(k,c.delay)}:Vd}function Lc(c,k,J){function da(){jc=!1;if(!fd.isDisposed_){var xd=!1;fd.track(function(){var Fd=$b(!1,function(){return c(fd)});xd=Pb||!jd(yc,Fd);Rc=yc;yc=Fd});Pb&&J.fireImmediately?Ia(yc,Rc,fd):!Pb&&xd&&Ia(yc,Rc,fd);Pb=!1}}var qa;void 0===J&&(J=rr);var Ca=null!=(qa=J.name)?qa:"Reaction",Ia=Ic(Ca,J.onError?od(J.onError,k):k),bb=!J.scheduler&&!J.delay,rb=Nc(J),
Pb=!0,jc=!1,yc,Rc,jd=J.compareStructural?to.structural:J.equals||to["default"],fd=new vo(Ca,function(){Pb||bb?da():jc||(jc=!0,rb(da))},J.onError,J.requiresObservable);fd.schedule_();return fd.getDisposer_()}function od(c,k){return function(){try{return k.apply(this,arguments)}catch(J){c.call(this,J)}}}function pd(c,k,J){return Pc(re,c,k,J)}function Pc(c,k,J,da){var qa="function"===typeof da?nc(k,J):nc(k),Ca=U(da)?da:J,Ia=c+"L";qa[Ia]?qa[Ia].add(Ca):qa[Ia]=new Set([Ca]);return function(){var bb=qa[Ia];
bb&&(bb["delete"](Ca),0===bb.size&&delete qa[Ia])}}function ob(c){!0===c.isolateGlobalState&&Yb();var k=c.useProxies,J=c.enforceActions;void 0!==k&&(Vf.useProxies="always"===k?!0:"never"===k?!1:"undefined"!==typeof Proxy);"ifavailable"===k&&(Vf.verifyProxies=!0);void 0!==J&&(k="always"===J?"always":"observed"===J,Vf.enforceActions=k,Vf.allowStateChanges=!0===k||"always"===k?!1:!0);["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach(function(da){da in
c&&(Vf[da]=!!c[da])});Vf.allowStateReads=!Vf.observableRequiresReaction;c.reactionScheduler&&Gb(c.reactionScheduler)}function pc(c,k,J,da){var qa=Dt(k),Ca=ld(c,da)[Gh];Kb();try{fq(qa).forEach(function(Ia){Ca.extend_(Ia,qa[Ia],J?Ia in J?J[Ia]:!0:!0)})}finally{Bb()}return c}function Wb(c){var k={name:c.name_};c.observing_&&0<c.observing_.length&&(k.dependencies=Array.from(new Set(c.observing_)).map(Wb));return k}function Bc(){this.message="FLOW_CANCELLED"}function Jc(c){return!0===(null==c?void 0:c.isMobXFlow)}
function vc(c,k){return c?void 0!==k?Ud(c)?c[Gh].values_.has(k):!1:Ud(c)||!!c[Gh]||tr(c)||lq(c)||yp(c):!1}function dc(c){if(Ud(c))return c[Gh].ownKeys_();e(38)}function hc(c,k,J){c.set(k,J);return J}function lc(c,k){if(null==c||"object"!==typeof c||c instanceof Date||!vc(c))return c;if(Mt(c)||yp(c))return lc(c.get(),k);if(k.has(c))return k.get(c);if(Kc(c)){var J=hc(k,c,Array(c.length));c.forEach(function(Ia,bb){J[bb]=lc(Ia,k)});return J}if(zp(c)){var da=hc(k,c,new Set);c.forEach(function(Ia){da.add(lc(Ia,
k))});return da}if(qn(c)){var qa=hc(k,c,new Map);c.forEach(function(Ia,bb){qa.set(bb,lc(Ia,k))});return qa}var Ca=hc(k,c,{});dc(c).forEach(function(Ia){vp.propertyIsEnumerable.call(c,Ia)&&(Ca[Ia]=lc(c[Ia],k))});return Ca}function Db(c,k){return lc(c,new Map)}function rc(){e("trace() is not available in production builds");for(var c=!1,k=arguments.length,J=Array(k),da=0;da<k;da++)J[da]=arguments[da];"boolean"===typeof J[J.length-1]&&(c=J.pop());a:{switch(J.length){case 0:k=Vf.trackingDerivation;break a;
case 1:k=nc(J[0]);break a;case 2:k=nc(J[0],J[1]);break a}k=void 0}if(!k)return e("'trace(break?)' can only be used inside a tracked computed value or a Reaction. Consider passing in the computed value or reaction explicitly");k.isTracing_===uo.NONE&&console.log("[mobx.trace] '"+k.name_+"' tracing enabled");k.isTracing_=c?uo.BREAK:uo.LOG}function Tb(c,k){void 0===k&&(k=void 0);Kb();try{return c.apply(k)}finally{Bb()}}function kb(c){return void 0!==c.interceptors_&&0<c.interceptors_.length}function sb(c,
k){var J=c.interceptors_||(c.interceptors_=[]);J.push(k);return K(function(){var da=J.indexOf(k);-1!==da&&J.splice(da,1)})}function Oa(c,k){var J=Ua();try{var da=[].concat(c.interceptors_||[]);c=0;for(var qa=da.length;c<qa&&((k=da[c](k))&&!k.type&&e(14),k);c++);return k}finally{Vf.trackingDerivation=J}}function Ab(c){return void 0!==c.changeListeners_&&0<c.changeListeners_.length}function Cb(c,k){var J=c.changeListeners_||(c.changeListeners_=[]);J.push(k);return K(function(){var da=J.indexOf(k);-1!==
da&&J.splice(da,1)})}function Ub(c,k){var J=Ua();if(c=c.changeListeners_){c=c.slice();for(var da=0,qa=c.length;da<qa;da++)c[da](k);Vf.trackingDerivation=J}}function zc(c,k,J){var da=ld(c,J)[Gh];Kb();try{var qa;null!=(qa=k)?qa:k=Ja(c);fq(k).forEach(function(Ca){return da.make_(Ca,k[Ca])})}finally{Bb()}return c}function Za(c,k,J,da){void 0===J&&(J="ObservableArray");void 0===da&&(da=!1);y();k=new rm(J,k,da,!1);I(k.values_,Gh,k);J=new Proxy(k.values_,ok);k.proxy_=J;c&&c.length&&(da=Tc(!0),k.spliceWithArray_(0,
0,c),Vf.allowStateChanges=da);return J}function ab(c,k){"function"===typeof Array.prototype[c]&&(Tk[c]=k(c))}function Qa(c){return function(){var k=this[Gh];k.atom_.reportObserved();k=k.dehanceValues_(k.values_);return k[c].apply(k,arguments)}}function mb(c){return function(k,J){var da=this,qa=this[Gh];qa.atom_.reportObserved();return qa.dehanceValues_(qa.values_)[c](function(Ca,Ia){return k.call(J,Ca,Ia,da)})}}function zb(c){return function(){var k=this,J=this[Gh];J.atom_.reportObserved();J=J.dehanceValues_(J.values_);
var da=arguments[0];arguments[0]=function(qa,Ca,Ia){return da(qa,Ca,Ia,k)};return J[c].apply(J,arguments)}}function Kc(c){return R(c)&&vi(c[Gh])}function bd(c){if(Q(c)||qn(c))return c;if(Array.isArray(c))return new Map(c);if(N(c)){var k=new Map,J;for(J in c)k.set(J,c[J]);return k}return e(21,c)}function ld(c,k){var J;if(V(c,Gh))return c;var da=null!=(J=null==k?void 0:k.name)?J:"ObservableObject";J=Xv;var qa=new Map;da=String(da);var Ca;var Ia=k?null!=(Ca=k.defaultDecorator)?Ca:Aa(k):void 0;k=new J(c,
qa,da,Ia);t(c,Gh,k);return c}function Hd(c){return Wv[c]||(Wv[c]={get:function(){return this[Gh].getObservablePropValue_(c)},set:function(k){return this[Gh].setObservablePropValue_(c,k)}})}function Ud(c){return R(c)?Dz(c[Gh]):!1}function Sd(c){return{enumerable:!1,configurable:!0,get:function(){return this[Gh].get_(c)},set:function(k){this[Gh].set_(c,k)}}}function vd(c){if(c>Pt){for(var k=Pt;k<c+100;k++)Ah(Qt.prototype,""+k,Sd(k));Pt=c}}function Ob(c,k,J){return new Qt(c,k,J)}function nc(c,k){if("object"===
typeof c&&null!==c){if(Kc(c))return void 0!==k&&e(23),c[Gh].atom_;if(zp(c))return c[Gh];if(qn(c)){if(void 0===k)return c.keysAtom_;var J=c.data_.get(k)||c.hasMap_.get(k);J||e(25,k,cb(c));return J}if(Ud(c)){if(!k)return e(26);(J=c[Gh].values_.get(k))||e(27,k,cb(c));return J}if(tr(c)||yp(c)||lq(c))return c}else if(U(c)&&lq(c[Gh]))return c[Gh];e(28)}function Mc(c,k){c||e(29);if(void 0!==k)return Mc(nc(c,k));if(tr(c)||yp(c)||lq(c)||qn(c)||zp(c))return c;if(c[Gh])return c[Gh];e(24,c)}function cb(c,k){if(void 0!==
k)c=nc(c,k);else{if(Cc(c))return c.name;c=Ud(c)||qn(c)||zp(c)?Mc(c):nc(c)}return c.name_}function sa(c,k,J){void 0===J&&(J=-1);return pa(c,k,J)}function pa(c,k,J,da,qa){if(c===k)return 0!==c||1/c===1/k;if(null==c||null==k)return!1;if(c!==c)return k!==k;var Ca=typeof c;if("function"!==Ca&&"object"!==Ca&&"object"!=typeof k)return!1;Ca=Zv.call(c);if(Ca!==Zv.call(k))return!1;switch(Ca){case "[object RegExp]":case "[object String]":return""+c===""+k;case "[object Number]":return+c!==+c?+k!==+k:0===+c?
1/+c===1/k:+c===+k;case "[object Date]":case "[object Boolean]":return+c===+k;case "[object Symbol]":return"undefined"!==typeof Symbol&&Symbol.valueOf.call(c)===Symbol.valueOf.call(k);case "[object Map]":case "[object Set]":0<=J&&J++}c=Fa(c);k=Fa(k);Ca="[object Array]"===Ca;if(!Ca){if("object"!=typeof c||"object"!=typeof k)return!1;var Ia=c.constructor,bb=k.constructor;if(Ia!==bb&&!(U(Ia)&&Ia instanceof Ia&&U(bb)&&bb instanceof bb)&&"constructor"in c&&"constructor"in k)return!1}if(0===J)return!1;
0>J&&(J=-1);da=da||[];qa=qa||[];for(Ia=da.length;Ia--;)if(da[Ia]===c)return qa[Ia]===k;da.push(c);qa.push(k);if(Ca){Ia=c.length;if(Ia!==k.length)return!1;for(;Ia--;)if(!pa(c[Ia],k[Ia],J-1,da,qa))return!1}else{Ca=Object.keys(c);Ia=Ca.length;if(Object.keys(k).length!==Ia)return!1;for(;Ia--;)if(bb=Ca[Ia],!V(k,bb)||!pa(c[bb],k[bb],J-1,da,qa))return!1}da.pop();qa.pop();return!0}function Fa(c){return Kc(c)?c.slice():Q(c)||qn(c)||O(c)||zp(c)?Array.from(c.entries()):c}function $a(c){c[Symbol.iterator]=Lb;
return c}function Lb(){return this}function tc(c,k){const J=new Set(k),da=Object.values(c),qa=new Set(da.filter(Ca=>J.has(Ca.toId)||J.has(Ca.fromId)));c=qa.size;for(k=-1;0!==k;)qa.forEach(Ca=>{Ca=Ca.fromId;for(const Ia of da)Ia.fromId===Ca&&qa.add(Ia),Ia.toId===Ca&&qa.add(Ia)}),k=qa.size-c,c=qa.size;return Array.from(qa.values())}function Zc(c,k,J,da,qa,Ca,Ia,bb){if(qa=k.getBindingPoint(qa,Ca,Ia,bb))return{id:da,type:"line",fromId:c.id,toId:k.id,handleId:J,point:Rd.toFixed(qa.point),distance:qa.distance}}
function sd(c,k){const J=c.getCenter(),da=k.getCenter();var qa=Ff();qa=gg(tf({},vr.defaultProps),{id:qa,type:vr.id,parentId:c.props.parentId,point:J});c=Zc(qa,c,"start",Ff(),J,J,Rd.uni(Rd.sub(da,J)),!1);k=Zc(qa,k,"end",Ff(),da,da,Rd.uni(Rd.sub(J,da)),!1);return c&&k?(qa.handles.start.point=[0,0],qa.handles.end.point=Rd.sub(da,J),qa.handles.start.bindingId=c.id,qa.handles.end.bindingId=k.id,[qa,[c,k]]):null}function de(){return new Mz}function le(){return new WeakMap}function se(c){if(!c)return Yt(null);
var k=c.constructor;if(k===Object)return c===Object.prototype?{}:Yt(c);if(~Kz.call(k).indexOf("[native code]"))try{return new k}catch(J){}return Yt(c)}function wf(c){var k="";c.global&&(k+="g");c.ignoreCase&&(k+="i");c.multiline&&(k+="m");c.unicode&&(k+="u");c.sticky&&(k+="y");return k}function df(c){return c.flags}function Bf(c){c=Lz.call(c);return c.substring(8,c.length-1)}function gf(c){return c[Symbol.toStringTag]||Bf(c)}function Wf(c){return Lw(c).concat(Zt(c))}function Pg(c,k,J){for(var da=
Tz(c),qa=0,Ca=da.length,Ia,bb;qa<Ca;++qa)if(Ia=da[qa],"callee"!==Ia&&"caller"!==Ia)if(bb=Rz(c,Ia)){bb.get||bb.set||(bb.value=J.copier(bb.value,J));try{Qz(k,Ia,bb)}catch(rb){k[Ia]=bb.value}}else k[Ia]=J.copier(c[Ia],J);return k}function Jg(c,k){var J=new k.Constructor;k.cache.set(c,J);c.forEach(function(da,qa){J.set(qa,k.copier(da,k))});return J}function Xf(c,k){var J=se(k.prototype);k.cache.set(c,J);for(var da in c)Nw.call(c,da)&&(J[da]=k.copier(c[da],k));return J}function Kg(c,k){var J=se(k.prototype);
k.cache.set(c,J);for(var da in c)Nw.call(c,da)&&(J[da]=k.copier(c[da],k));da=Zt(c);for(var qa=0,Ca=da.length,Ia;qa<Ca;++qa)Ia=da[qa],Sz.call(c,Ia)&&(J[Ia]=k.copier(c[Ia],k));return J}function Kh(c,k){return new k.Constructor(c.valueOf())}function rh(c,k){return c}function hi(c,k){var J=new k.Constructor;k.cache.set(c,J);c.forEach(function(da){J.add(k.copier(da,k))});return J}function Hi(c){function k(Ca,Ia){Ia.prototype=Ia.Constructor=void 0;if(!Ca||"object"!==typeof Ca)return Ca;if(Ia.cache.has(Ca))return Ia.cache.get(Ca);
Ia.prototype=Ca.__proto__||Vz(Ca);Ia.Constructor=Ia.prototype&&Ia.prototype.constructor;if(!Ia.Constructor||Ia.Constructor===Object)return qa(Ca,Ia);if(Uz(Ca))return da(Ca,Ia);var bb=J[Pz(Ca)];return bb?bb(Ca,Ia):"function"===typeof Ca.then?Ca:qa(Ca,Ia)}c=$t({},Pw,c);var J={Arguments:c.object,Array:c.array,ArrayBuffer:c.arrayBuffer,Blob:c.blob,Boolean:Kh,DataView:c.dataView,Date:c.date,Error:c.error,Float32Array:c.arrayBuffer,Float64Array:c.arrayBuffer,Int8Array:c.arrayBuffer,Int16Array:c.arrayBuffer,
Int32Array:c.arrayBuffer,Map:c.map,Number:Kh,Object:c.object,Promise:rh,RegExp:c.regExp,Set:c.set,String:Kh,WeakMap:rh,WeakSet:rh,Uint8Array:c.arrayBuffer,Uint8ClampedArray:c.arrayBuffer,Uint16Array:c.arrayBuffer,Uint32Array:c.arrayBuffer,Uint64Array:c.arrayBuffer},da=J.Array,qa=J.Object;return function(Ca){return k(Ca,{Constructor:void 0,cache:Nz(),copier:k,prototype:void 0})}}function gj(c,k){return(0,Zz.default)(c,k,{arrayMerge:(J,da,qa)=>da})}function Ii(c,k,J,da=!1){const [qa,Ca]=k,[Ia,bb]=J;
c=Ia+(c-qa)/(Ca-qa)*(bb-Ia);return da?Ia<bb?Math.max(Math.min(c,bb),Ia):Math.max(Math.min(c,Ia),bb):c}function Ai(c,k){return new Promise((J,da)=>{if("video"===k){const qa=document.createElement("video");qa.addEventListener("loadedmetadata",function(){J([this.videoWidth,this.videoHeight])},!1);qa.src=c}else if("image"===k){const qa=new Image;qa.onload=()=>J([qa.width,qa.height]);qa.src=c;qa.onerror=Ca=>da(Ca)}else"pdf"===k&&J([595,842])})}function qf(c){return Object.values(lb).includes(c)}function sf(c,
k){return qf(c)||null==c?`var(--ls-wb-${k}-color-${c?c:"default"})`:c}function ig(){var c;null==(c=document.getElementById("__textLabelMeasure"))?void 0:c.remove();c=document.createElement("pre");c.id="__textLabelMeasure";Object.assign(c.style,{whiteSpace:"pre",width:"auto",borderLeft:"2px solid transparent",borderRight:"1px solid transparent",borderBottom:"2px solid transparent",padding:"0px",margin:"0px",opacity:"0",position:"absolute",top:"-500px",left:"0px",zIndex:"9999",userSelect:"none",pointerEvents:"none",
font:"var(--ls-font-family)"});c.tabIndex=-1;document.body.appendChild(c);return c}function xg(c,k,J=0){var da,qa,Ca;if(!c)return[16,32];let Ia;Ia="string"===typeof k?k:`${null!=(da=k.fontStyle)?da:"normal"} ${null!=(qa=k.fontVariant)?qa:"normal"} ${null!=(Ca=k.fontWeight)?Ca:"normal"} ${k.fontSize}px/${k.fontSize*k.lineHeight}px ${k.fontFamily}`;if(!au.has(`${c}-${Ia}-${J}`)){if(!Ao)return[10,10];Ao.parentNode||document.body.appendChild(Ao);Ao.innerHTML=`${c}&#8203;`;Ao.style.font=Ia;Ao.style.padding=
J+"px";k=Ao.getBoundingClientRect();au.set(`${c}-${Ia}-${J}`,[Math.ceil(k.width||1),Math.ceil(k.height||1)])}return au.get(`${c}-${Ia}-${J}`)}function sg(c){try{if("string"!==typeof c||!ad.test(c))throw TypeError("Invalid UUID");let k;const J=new Uint8Array(16);J[0]=(k=parseInt(c.slice(0,8),16))>>>24;J[1]=k>>>16&255;J[2]=k>>>8&255;J[3]=k&255;J[4]=(k=parseInt(c.slice(9,13),16))>>>8;J[5]=k&255;J[6]=(k=parseInt(c.slice(14,18),16))>>>8;J[7]=k&255;J[8]=(k=parseInt(c.slice(19,23),16))>>>8;J[9]=k&255;J[10]=
(k=parseInt(c.slice(24,36),16))/1099511627776&255;J[11]=k/4294967296&255;J[12]=k>>>24&255;J[13]=k>>>16&255;J[14]=k>>>8&255;J[15]=k&255;return!0}catch(k){return!1}}function lg(c,k=0,J){let da;return function(...qa){null==J?void 0:J(...qa);clearTimeout(da);da=setTimeout(()=>c.apply(qa),k)}}function Rb(){return/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)}function ac(){var c,k,J;return(null==(J=null==(k=null==(c=null==window?void 0:window.logseq)?void 0:c.api)?void 0:k.get_state_from_store)?
void 0:J.call(k,"ui/developer-mode?"))||!1}function Fc(c){return!!c}function Ac(c=0){return new Promise(k=>setTimeout(k,c))}function Yc(c="noid"){bu[c]||(bu[c]=Sw.createContext({}));return bu[c]}function md(c="noid"){return Sw.useContext(Yc(c))}function Pd(c){const {callbacks:k}=md(),J=Rw.useRef(-1);return Rw.useMemo(()=>{const da=qa=>{var Ca,Ia;const {order:bb=0}=qa;if(!bb){var rb=qa.target;rb.removeEventListener("pointerup",da);rb.releasePointerCapture(qa.pointerId);null==(Ca=k.onPointerUp)?void 0:
Ca.call(k,{type:"selection",handle:c,order:bb},qa);Ca=Date.now();rb=Ca-J.current;300<rb?J.current=Ca:300>=rb&&(null==(Ia=k.onDoubleClick)?void 0:Ia.call(k,{type:"selection",handle:c,order:bb},qa),J.current=-1);qa.order=bb+1}};return{onPointerDown:qa=>{var Ca;const {order:Ia=0}=qa;if(!Ia){var bb=Zd(qa.currentTarget);bb.setPointerCapture(qa.pointerId);bb.addEventListener("pointerup",da);null==(Ca=k.onPointerDown)?void 0:Ca.call(k,{type:"selection",handle:c,order:Ia},qa);qa.order=Ia+1}},onPointerMove:qa=>
{var Ca;const {order:Ia=0}=qa;Ia||(null==(Ca=k.onPointerMove)?void 0:Ca.call(k,{type:"selection",handle:c,order:Ia},qa),qa.order=Ia+1)},onPointerEnter:qa=>{var Ca;const {order:Ia=0}=qa;Ia||(null==(Ca=k.onPointerEnter)?void 0:Ca.call(k,{type:"selection",handle:c,order:Ia},qa),qa.order=Ia+1)},onPointerLeave:qa=>{var Ca;const {order:Ia=0}=qa;Ia||(null==(Ca=k.onPointerLeave)?void 0:Ca.call(k,{type:"selection",handle:c,order:Ia},qa),qa.order=Ia+1)},onKeyDown:qa=>{var Ca;null==(Ca=k.onKeyDown)?void 0:Ca.call(k,
{type:"selection",handle:c,order:-1},qa)},onKeyUp:qa=>{var Ca;null==(Ca=k.onKeyUp)?void 0:Ca.call(k,{type:"selection",handle:c,order:-1},qa)}}},[k])}function Zd(c){var k;if(null==(k=c.namespaceURI)?0:k.endsWith("svg")){if(c.parentElement)return Zd(c.parentElement);throw Error("Could not find a parent element of an HTML type!");}return c}function fe(c,k,J){const da=xr.useRef(!1),qa=xr.useCallback(()=>{var Ca;if(da.current){const Ia=null==(Ca=c.current)?void 0:Ca.getBoundingClientRect();Ia&&(Ca={minX:Ia.left,
maxX:Ia.left+Ia.width,minY:Ia.top,maxY:Ia.top+Ia.height,width:Ia.width,height:Ia.height},k.updateBounds(Ca),null==J?void 0:J(Ca))}else da.current=!0},[c,J]);xr.useEffect(()=>{const Ca=c.current?bA(c.current):document,Ia=lg(qa,100);Ca.addEventListener("scroll",Ia);window.addEventListener("resize",Ia);return()=>{Ca.removeEventListener("scroll",Ia);window.removeEventListener("resize",Ia)}},[]);xr.useLayoutEffect(()=>{const Ca=new ResizeObserver(Ia=>{Ia[0].contentRect&&qa()});c.current&&Ca.observe(c.current);
return()=>{Ca.disconnect()}},[c]);xr.useEffect(()=>{qa();setTimeout(()=>{var Ca,Ia;null==(Ia=null==(Ca=c.current)?void 0:Ca.querySelector(".tl-canvas"))?void 0:Ia.focus()})},[c])}function Ie(c,k){return Object.keys(k).reduce((J,da)=>{const qa=k[da];return qa?J+`${`--${c}-${da}`}: ${qa};
`:J},"")}function Md(c,k,J=".logseq-tldraw"){cu.useLayoutEffect(()=>{const da=document.createElement("style"),qa=Ie(c,k);da.setAttribute("id",`${c}-theme`);da.setAttribute("data-selector",J);da.innerHTML=`
        ${J} {
          ${qa}
        }
      `;document.head.appendChild(da);return()=>{da&&document.head.contains(da)&&document.head.removeChild(da)}},[c,k,J])}function Pe(c,k){cu.useLayoutEffect(()=>{if(du.get(c))return()=>{};const J=document.createElement("style");J.innerHTML=k;J.setAttribute("id",c);document.head.appendChild(J);du.set(c,J);return()=>{J&&document.head.contains(J)&&(document.head.removeChild(J),du.delete(c))}},[c,k])}function xe(c,k){const J=cu.useMemo(()=>tf(tf({},cA),c),[c]);Md("tl",J,k);Pe("tl-canvas",dA)}function Ae(c=
"noid"){eu[c]||(eu[c]=Uw.createContext({}));return eu[c]}function Le(c="noid"){return Uw.useContext(Ae(c))}function Qe(){const c=Le(),{callbacks:k}=md(),J=Tw.useRef(-1);return Tw.useMemo(()=>({onPointerDown:da=>{var qa,Ca,Ia;if(!c.settings.penMode||"pen"===da.pointerType&&da.isPrimary){var {order:bb=0}=da;bb||(null==(qa=da.currentTarget)?void 0:qa.setPointerCapture(da.pointerId));da.isPrimary&&(null==(Ca=k.onPointerDown)?void 0:Ca.call(k,{type:"canvas",order:bb},da),qa=Date.now(),Ca=qa-J.current,
300<Ca?J.current=qa:300>=Ca&&(null==(Ia=k.onDoubleClick)?void 0:Ia.call(k,{type:"canvas",order:bb},da),J.current=-1))}},onPointerMove:da=>{var qa;if(!c.settings.penMode||"pen"===da.pointerType&&da.isPrimary){var {order:Ca=0}=da;null==(qa=k.onPointerMove)?void 0:qa.call(k,{type:"canvas",order:Ca},da)}},onPointerUp:da=>{var qa,Ca;if(!c.settings.penMode||"pen"===da.pointerType&&da.isPrimary){var {order:Ia=0}=da;Ia||(null==(qa=da.currentTarget)?void 0:qa.releasePointerCapture(da.pointerId));null==(Ca=
k.onPointerUp)?void 0:Ca.call(k,{type:"canvas",order:Ia},da)}},onPointerEnter:da=>{var qa;if(!c.settings.penMode||"pen"===da.pointerType&&da.isPrimary){var {order:Ca=0}=da;null==(qa=k.onPointerEnter)?void 0:qa.call(k,{type:"canvas",order:Ca},da)}},onPointerLeave:da=>{var qa;if(!c.settings.penMode||"pen"===da.pointerType&&da.isPrimary){var {order:Ca=0}=da;null==(qa=k.onPointerLeave)?void 0:qa.call(k,{type:"canvas",order:Ca},da)}},onDrop:da=>z(this,null,function*(){da.preventDefault();"clientX"in da&&
c.drop(da.dataTransfer,[da.clientX,da.clientY])}),onDragOver:da=>{da.preventDefault()},onTouchEnd:da=>{let qa=c.selectedTool.id;"pencil"!==qa&&"highlighter"!==qa||da.preventDefault()}}),[k])}function me(c,k,J){return 0===k||Infinity===Math.abs(k)?Math.pow(c,5*J):c*k*J/(k+J*c)}function Qf(c,k,J,da=.15){return 0===da?Math.max(k,Math.min(c,J)):c<k?-me(k-c,J-k,da)+k:c>J?+me(c-J,J-k,da)+J:c}function Df(c,[k,J],[da,qa]){const [[Ca,Ia],[bb,rb]]=c;return[Qf(k,Ca,Ia,da),Qf(J,bb,rb,qa)]}function Yf(c,k,J){k in
c?Object.defineProperty(c,k,{value:J,enumerable:!0,configurable:!0,writable:!0}):c[k]=J;return c}function Lg(c,k){var J=Object.keys(c);if(Object.getOwnPropertySymbols){var da=Object.getOwnPropertySymbols(c);k&&(da=da.filter(function(qa){return Object.getOwnPropertyDescriptor(c,qa).enumerable}));J.push.apply(J,da)}return J}function vf(c){for(var k=1;k<arguments.length;k++){var J=null!=arguments[k]?arguments[k]:{};k%2?Lg(Object(J),!0).forEach(function(da){Yf(c,da,J[da])}):Object.getOwnPropertyDescriptors?
Object.defineProperties(c,Object.getOwnPropertyDescriptors(J)):Lg(Object(J)).forEach(function(da){Object.defineProperty(c,da,Object.getOwnPropertyDescriptor(J,da))})}return c}function yg(c){return c?c[0].toUpperCase()+c.slice(1):""}function Oh(c=!1,k){return c&&!eA.includes(k)}function Dg(c,k="",J=!1){const da=Vw[c];k=da?da[k]||k:k;return"on"+yg(c)+yg(k)+(Oh(J,k)?"Capture":"")}function Mf(c){c=c.substring(2).toLowerCase();const k=!!~c.indexOf("passive");k&&(c=c.replace("passive",""));var J=fA.includes(c)?
"capturecapture":"capture";(J=!!~c.indexOf(J))&&(c=c.replace("capture",""));return{device:c,capture:J,passive:k}}function Mh(c,k=""){const J=Vw[c];return c+(J?J[k]||k:k)}function Mg(c){return"touches"in c?"touch":"pointerType"in c?c.pointerType:"mouse"}function mi(c){return Array.from(c.touches).filter(k=>{var J,da;return k.target===c.currentTarget||(null===(J=c.currentTarget)||void 0===J?void 0:null===(da=J.contains)||void 0===da?void 0:da.call(J,k.target))})}function lh(c){return"touches"in c?("touchend"===
c.type||"touchcancel"===c.type?c.changedTouches:c.targetTouches)[0]:c}function nf(c,k){const J=k.clientX-c.clientX,da=k.clientY-c.clientY;return{angle:-(180*Math.atan2(J,da))/Math.PI,distance:Math.hypot(J,da),origin:[(k.clientX+c.clientX)/2,(k.clientY+c.clientY)/2]}}function Ye(c){return mi(c).map(k=>k.identifier)}function pf(c,k){const [J,da]=Array.from(c.touches).filter(qa=>k.includes(qa.identifier));return nf(J,da)}function Fg(c){const k=lh(c);return"touches"in c?k.identifier:k.pointerId}function cg(c){c=
lh(c);return[c.clientX,c.clientY]}function ni(c){let {deltaX:k,deltaY:J,deltaMode:da}=c;1===da?(k*=40,J*=40):2===da&&(k*=800,J*=800);return[k,J]}function Gg(c,...k){return"function"===typeof c?c(...k):c}function Dh(){}function Eh(...c){return 0===c.length?Dh:1===c.length?c[0]:function(){let k;for(const J of c)k=J.apply(this,arguments)||k;return k}}function Ji([c,k],J){c=Math.abs(c);k=Math.abs(k);if(c>k&&c>J)return"x";if(k>c&&k>J)return"y"}function Pj(c){const [k,J]=c.overflow,[da,qa]=c._delta,[Ca,
Ia]=c._direction;if(0>k&&0<da&&0>Ca||0<k&&0>da&&0<Ca)c._movement[0]=c._movementBound[0];if(0>J&&0<qa&&0>Ia||0<J&&0>qa&&0<Ia)c._movement[1]=c._movementBound[1]}function di(c){fu.set(c.key,c.engine);gu.set(c.key,c.resolver)}function Uj(c={},k){const J={};for(const [da,qa]of Object.entries(k))switch(typeof qa){case "function":J[da]=qa.call(J,c[da],da,c);break;case "object":J[da]=Uj(c[da],qa);break;case "boolean":qa&&(J[da]=c[da])}return J}function Bi(c,k,J={}){const {target:da,eventOptions:qa,window:Ca,
enabled:Ia,transform:bb}=c;var rb=CA;if(null==c)c={};else{if(null==c)var Pb={};else{Pb={};var jc=Object.keys(c),yc;for(yc=0;yc<jc.length;yc++){var Rc=jc[yc];0<=rb.indexOf(Rc)||(Pb[Rc]=c[Rc])}}if(Object.getOwnPropertySymbols)for(yc=Object.getOwnPropertySymbols(c),Rc=0;Rc<yc.length;Rc++)jc=yc[Rc],0<=rb.indexOf(jc)||Object.prototype.propertyIsEnumerable.call(c,jc)&&(Pb[jc]=c[jc]);c=Pb}J.shared=Uj({target:da,eventOptions:qa,window:Ca,enabled:Ia,transform:bb},BA);if(k){var jd=gu.get(k);J[k]=Uj(vf({shared:J.shared},
c),jd)}else for(jd in c)(k=gu.get(jd))&&(J[jd]=Uj(vf({shared:J.shared},c[jd]),k));return J}function ri(c,k){c.gestures.add(k);c.gestureEventStores[k]=new cx(c,k);c.gestureTimeoutStores[k]=new DA}function vj(c,k,J,da,qa,Ca){if(c.has(J)&&fu.has(da)){var Ia=J+"Start",bb=J+"End";qa[da]=rb=>{let Pb=void 0;if(rb.first&&Ia in k)k[Ia](rb);J in k&&(Pb=k[J](rb));if(rb.last&&bb in k)k[bb](rb);return Pb};Ca[da]=Ca[da]||{}}}function He(c,k={},J,da){const qa=hu.default.useMemo(()=>new EA(c),[]);qa.applyHandlers(c,
da);qa.applyConfig(k,J);hu.default.useEffect(qa.effect.bind(qa));hu.default.useEffect(()=>qa.clean.bind(qa),[]);if(void 0===k.target)return qa.bind.bind(qa)}function ch(c){c.forEach(di);return function(k,J){J=J||{};const da={},qa={},Ca=new Set;for(let Rc in k)FA.test(Rc)?(Ca.add(RegExp.lastMatch),qa[Rc]=k[Rc]):da[Rc]=k[Rc];const [Ia,bb,rb]=[qa,da,Ca];k={};vj(rb,Ia,"onDrag","drag",k,J);vj(rb,Ia,"onWheel","wheel",k,J);vj(rb,Ia,"onScroll","scroll",k,J);vj(rb,Ia,"onPinch","pinch",k,J);vj(rb,Ia,"onMove",
"move",k,J);vj(rb,Ia,"onHover","hover",k,J);const {handlers:Pb,nativeHandlers:jc,config:yc}={handlers:k,config:J,nativeHandlers:bb};return He(Pb,yc,void 0,jc)}}function $h(c,k){return ch([vA,yA,zA,AA,xA,wA])(c,k||{})}function dj(c){const {viewport:k,inputs:J,callbacks:da}=md(),qa=ws.useRef(void 0),Ca=ws.useRef([0,0]),Ia=ws.useRef(0),bb=ws.useMemo(()=>({onWheel:rb=>{var Pb;({event:rb}=rb);rb.preventDefault();const {deltaY:jc,deltaX:yc}=rb;var Rc=0;if(rb.ctrlKey||rb.metaKey){Rc=Math.sign(rb.deltaY);
let Fd=jc;10<Math.abs(rb.deltaY)&&(Fd=10*Rc);Rc=Fd}const [jd,fd,xd]=[yc,jc,Rc];"pinching"===J.state||Ia.current>=rb.timeStamp||(Ia.current=rb.timeStamp,(rb.altKey||rb.ctrlKey||rb.metaKey)&&0===rb.buttons?(Rc=k.bounds,rb=null!=(Pb=J.currentScreenPoint)?Pb:[Rc.width/2,Rc.height/2],Pb=k.camera.zoom,k.onZoom(rb,Pb-xd/100*Pb)):(Pb=Rd.mul(rb.shiftKey&&!Rb()?[fd,0]:[jd,fd],.8),Rd.isEqual(Pb,[0,0])||k.panCamera(Pb)))},onPinchStart:({event:rb,delta:Pb,offset:jc,origin:yc})=>{var Rc;const jd=c.current;rb instanceof
WheelEvent||!(rb.target===jd||null!=jd&&jd.contains(rb.target))||(null==(Rc=da.onPinchStart)?void 0:Rc.call(da,{type:"canvas",order:0,delta:[...Pb,jc[0]],offset:jc,point:Rd.sub(yc,J.containerOffset)},rb),qa.current=yc,Ca.current=[0,0])},onPinchEnd:({event:rb,offset:Pb,origin:jc})=>{var yc;const Rc=c.current;rb instanceof WheelEvent||!(rb.target===Rc||null!=Rc&&Rc.contains(rb.target))||"pinching"!==J.state||(null==(yc=da.onPinchEnd)?void 0:yc.call(da,{type:"canvas",order:0,delta:[0,0,Pb[0]],offset:Pb,
point:Rd.sub(jc,J.containerOffset)},rb),Ca.current=[0,0])},onPinch:({event:rb,offset:Pb,origin:jc})=>{var yc,Rc=c.current;if(!(rb instanceof WheelEvent)&&(rb.target===Rc||null!=Rc&&Rc.contains(rb.target))){qa.current||(qa.current=jc);Rc=Rd.sub(qa.current,jc);var jd=Rd.sub(Rc,Ca.current);null==(yc=da.onPinch)?void 0:yc.call(da,{type:"canvas",order:0,delta:[...jd,Pb[0]],offset:Pb,point:Rd.sub(jc,J.containerOffset)},rb);Ca.current=Rc}}}),[da]);$h(bb,{target:c,eventOptions:{passive:!1},pinch:{from:[k.camera.zoom,
k.camera.zoom],scaleBounds:()=>({from:k.camera.zoom,max:sm.maxZoom,min:sm.minZoom})}})}function Ib(c,k,J,da){iu.useLayoutEffect(()=>{c.current.style.transform=`translate(
        calc(${k.minX}px - var(--tl-padding)),
        calc(${k.minY}px - var(--tl-padding)))
        scale(var(--tl-scale))`},[k.minX,k.minY,J,k.rotation]);iu.useLayoutEffect(()=>{const qa=c.current;qa.style.width=`calc(${Math.floor(k.width)}px + (var(--tl-padding) * 2))`;qa.style.height=`calc(${Math.floor(k.height)}px + (var(--tl-padding) * 2))`},[k.width,k.height]);iu.useLayoutEffect(()=>{const qa=c.current;void 0!==da&&(qa.style.zIndex=da.toString())},[da])}function Sc(c,k){const {onPersist:J,onError:da,onMount:qa,onCreateAssets:Ca,onCreateShapes:Ia,onDeleteAssets:bb,onDeleteShapes:rb,
onDrop:Pb,onPaste:jc,onCopy:yc,onCanvasDBClick:Rc}=k;ex.useLayoutEffect(()=>{const jd=[];if(c)return window.tlapps=window.tlapps||{},window.tlapps[c.uuid]=c,qa&&qa(c,null),()=>{jd.forEach(fd=>fd());window.tlapps&&delete window.tlapps[c.uuid]}},[c]);ex.useLayoutEffect(()=>{const jd=[];J&&jd.push(c.subscribe("persist",J));da&&jd.push(c.subscribe("error",da));Ia&&jd.push(c.subscribe("create-shapes",Ia));Ca&&jd.push(c.subscribe("create-assets",Ca));rb&&jd.push(c.subscribe("delete-shapes",rb));bb&&jd.push(c.subscribe("delete-assets",
bb));Pb&&jd.push(c.subscribe("drop",Pb));jc&&jd.push(c.subscribe("paste",jc));yc&&jd.push(c.subscribe("copy",yc));Rc&&jd.push(c.subscribe("canvas-dbclick",Rc));return()=>jd.forEach(fd=>fd())},[c,J,da])}function $c(c){if("app"in c)return c.app;const [k]=fx.useState(()=>new $z(c.model,c.Shapes,c.Tools,c.readOnly));fx.useLayoutEffect(()=>()=>{k.dispose()},[k]);return k}function qd(c,k){GA.useEffect(()=>{"model"in k&&k.model&&c.loadDocumentModel(k.model)},[k.model])}function yd(c){const k=md(),{viewport:{bounds:J}}=
k;HA.useEffect(()=>{const da=Ia=>{Ia.preventDefault()},qa=Ia=>{if(0!==Ia.touches.length){var bb=Ia.touches[0].pageX,rb=Ia.touches[0].radiusX||0;(10>bb-rb||bb+rb>J.width-10)&&Ia.preventDefault()}},Ca=c.current;if(!Ca)return()=>{};Ca.addEventListener("touchstart",da,{passive:!0});Ca.addEventListener("gestureend",da,{passive:!0});Ca.addEventListener("gesturechange",da,{passive:!0});Ca.addEventListener("gesturestart",da,{passive:!0});Ca.addEventListener("touchstart",qa,{passive:!0});return()=>{Ca&&(Ca.removeEventListener("touchstart",
da),Ca.removeEventListener("gestureend",da),Ca.removeEventListener("gesturechange",da),Ca.removeEventListener("gesturestart",da),Ca.removeEventListener("touchstart",qa))}},[c,J.width])}function Id(c,k){const {inputs:J,callbacks:da}=md();return IA.useMemo(()=>({onPointerDown:qa=>{var Ca,Ia;const {order:bb=0}=qa;bb||(null==(Ca=qa.currentTarget)?void 0:Ca.setPointerCapture(qa.pointerId));Ca=c.props.handles[k];null==(Ia=da.onPointerDown)?void 0:Ia.call(da,{type:"handle",shape:c,handle:Ca,id:k,order:bb},
qa);qa.order=bb+1},onPointerMove:qa=>{var Ca;const {order:Ia=0}=qa,bb=c.props.handles[k];null==(Ca=da.onPointerMove)?void 0:Ca.call(da,{type:"handle",shape:c,handle:bb,id:k,order:Ia},qa);qa.order=Ia+1},onPointerUp:qa=>{var Ca,Ia;const {order:bb=0}=qa;bb||(null==(Ca=qa.currentTarget)?void 0:Ca.releasePointerCapture(qa.pointerId));Ca=c.props.handles[k];null==(Ia=da.onPointerUp)?void 0:Ia.call(da,{type:"handle",shape:c,handle:Ca,id:k,order:bb},qa);qa.order=bb+1},onPointerEnter:qa=>{var Ca;const {order:Ia=
0}=qa,bb=c.props.handles[k];null==(Ca=da.onPointerEnter)?void 0:Ca.call(da,{type:"handle",shape:c,handle:bb,id:k,order:Ia},qa);qa.order=Ia+1},onPointerLeave:qa=>{var Ca;const {order:Ia=0}=qa,bb=c.props.handles[k];null==(Ca=da.onPointerLeave)?void 0:Ca.call(da,{type:"handle",shape:c,handle:bb,id:k,order:Ia},qa);qa.order=Ia+1},onKeyUp:qa=>{var Ca;const Ia=c.props.handles[k];null==(Ca=da.onKeyUp)?void 0:Ca.call(da,{type:"handle",shape:c,handle:Ia,id:k,order:-1},qa)},onKeyDown:qa=>{var Ca;const Ia=c.props.handles[k];
null==(Ca=da.onKeyDown)?void 0:Ca.call(da,{type:"handle",shape:c,handle:Ia,id:k,order:-1},qa)}}),[c.id,J,da])}function Yd(c,k,J=!1){return`url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 35 35' xmlns='http://www.w3.org/2000/svg'><g fill='none' style='transform-origin:center center' transform='rotate(${k})${J?" scale(-1,-1) translate(0, -32)":""}'>`+c.replaceAll('"',"'")+'\x3c/g\x3e\x3c/svg\x3e") 16 16, pointer'}function oe(c,k,J=0){JA.useEffect(()=>{const da=c.current;da&&(da.style.cursor=
KA[k](yi.radiansToDegrees(J)))},[k,J])}function De(c){const {viewport:k}=md(),J=Le();LA.useLayoutEffect(()=>ic(()=>{const da=lg(()=>{var qa;null==(qa=c.current)?void 0:qa.style.setProperty("--tl-zoom",k.camera.zoom.toString())},200);"pinching"!==J.inputs.state&&null!=k.camera.zoom&&da()}),[])}function Me(c,k=0){const [J,da]=(0,gx.useState)(c);(0,gx.useEffect)(()=>{let qa=!1;const Ca=setTimeout(()=>{qa||da(c)},k);return()=>{qa=!0;clearTimeout(Ca)}},[c,k]);return J}function we(){const c=Le();hx.useEffect(()=>
{Lc(()=>tf({},c.viewport.camera),()=>{window.sessionStorage.setItem("logseq.tldraw.camera:"+c.currentPageId,JSON.stringify(c.viewport.camera))})},[c.viewport.camera]);hx.useEffect(()=>{var k;const J=JSON.parse(null!=(k=window.sessionStorage.getItem("logseq.tldraw.camera:"+c.currentPageId))?k:"null");J?c.viewport.update(J):c.selectedIds.size?c.api.zoomToSelection():c.api.zoomToFit()},[c])}function Ee(c){c()}function Ze(c){return Wb(nc(c,void 0))}function kf(c){return{reaction:c,mounted:!1,changedBeforeMount:!1,
cleanAt:Date.now()+NA}}function ge(c){var k=new Map,J=1,da=new c(function(qa){var Ca=k.get(qa);Ca&&(Ca.reaction.dispose(),k.delete(qa))});return{addReactionToTrack:function(qa,Ca,Ia){var bb=J++;da.register(Ia,bb,qa);qa.current=kf(Ca);qa.current.finalizationRegistryCleanupToken=bb;k.set(bb,qa.current);return qa.current},recordReactionAsCommitted:function(qa){da.unregister(qa);qa.current&&qa.current.finalizationRegistryCleanupToken&&k.delete(qa.current.finalizationRegistryCleanupToken)},forceCleanupTimerToRunNowForTests:function(){},
resetCleanupScheduleForTests:function(){}}}function $e(){function c(){void 0===da&&(da=setTimeout(k,1E4))}function k(){da=void 0;var qa=Date.now();J.forEach(function(Ca){var Ia=Ca.current;Ia&&qa>=Ia.cleanAt&&(Ia.reaction.dispose(),Ca.current=null,J.delete(Ca))});0<J.size&&c()}var J=new Set,da;return{addReactionToTrack:function(qa,Ca,Ia){qa.current=kf(Ca);J.add(qa);c();return qa.current},recordReactionAsCommitted:function(qa){J.delete(qa)},forceCleanupTimerToRunNowForTests:function(){da&&(clearTimeout(da),
k())},resetCleanupScheduleForTests:function(){var qa;if(0<J.size){try{for(var Ca=OA(J),Ia=Ca.next();!Ia.done;Ia=Ca.next()){var bb=Ia.value,rb=bb.current;rb&&(rb.reaction.dispose(),bb.current=null)}}catch(jc){var Pb={error:jc}}finally{try{Ia&&!Ia.done&&(qa=Ca.return)&&qa.call(Ca)}finally{if(Pb)throw Pb.error;}}J.clear()}da&&(clearTimeout(da),da=void 0)}}}function Be(){return new RA}function kg(c,k){void 0===k&&(k="observed");var J=kx(Ar.default.useState(Be),1)[0],da=kx(Ar.default.useState(),2)[1],
qa=Ar.default.useRef(null);if(!qa.current)var Ca=new vo("observer".concat(k),function(){Ia.mounted?da([]):Ia.changedBeforeMount=!0}),Ia=PA(qa,Ca,J);J=qa.current.reaction;Ar.default.useDebugValue(J,Ze);Ar.default.useEffect(function(){QA(qa);qa.current?(qa.current.mounted=!0,qa.current.changedBeforeMount&&(qa.current.changedBeforeMount=!1,da([]))):(qa.current={reaction:new vo("observer".concat(k),function(){da([])}),mounted:!0,changedBeforeMount:!1,cleanAt:Infinity},da([]));return function(){qa.current.reaction.dispose();
qa.current=null}},[]);var bb,rb;J.track(function(){try{bb=c()}catch(Pb){rb=Pb}});if(rb)throw rb;return bb}function te(c,k){var J;if(nx&&c.$$typeof===nx)throw Error("[mobx-react-lite] You are trying to use `observer` on a function component wrapped in either another `observer` or `React.memo`. The observer already applies 'React.memo' for you.");k=null!==(J=null===k||void 0===k?void 0:k.forwardRef)&&void 0!==J?J:!1;var da=c,qa=c.displayName||c.name;if(mx&&c.$$typeof===mx&&(k=!0,da=c.render,"function"!==
typeof da))throw Error("[mobx-react-lite] `render` property of ForwardRef was not a function");J=function(Ca,Ia){return kg(function(){return da(Ca,Ia)},qa)};""!==qa&&(J.displayName=qa);c.contextTypes&&(J.contextTypes=c.contextTypes);k&&(J=(0,vq.forwardRef)(J));J=(0,vq.memo)(J);ef(c,J);return J}function ef(c,k){Object.keys(c).forEach(function(J){SA[J]||Object.defineProperty(k,J,Object.getOwnPropertyDescriptor(c,J))})}function Pf(c){var k=c.render;c=c.children||k;return"function"!==typeof c?null:kg(c)}
function Ng(c){const k=Le(),{callbacks:J}=md(),da=ox.useRef(!1);ox.useEffect(()=>{const qa=rb=>{var Pb,jc;if(null==(Pb=c.current)?0:Pb.contains(document.activeElement))null==(jc=J.onKeyDown)?void 0:jc.call(J,{type:"canvas",order:-1},rb),da.current=rb.shiftKey},Ca=rb=>{var Pb,jc;if(null==(Pb=c.current)?0:Pb.contains(document.activeElement))null==(jc=J.onKeyUp)?void 0:jc.call(J,{type:"canvas",order:-1},rb),da.current=rb.shiftKey},Ia=rb=>{var Pb,jc,yc;!k.editingShape&&(null==(Pb=c.current)?0:Pb.contains(document.activeElement))&&
!["INPUT","TEXTAREA"].includes(null!=(yc=null==(jc=document.activeElement)?void 0:jc.tagName)?yc:"")&&(rb.preventDefault(),k.paste(rb,da.current))},bb=rb=>{var Pb,jc,yc;!k.editingShape&&0<k.selectedShapes.size&&(null==(Pb=c.current)?0:Pb.contains(document.activeElement))&&!["INPUT","TEXTAREA"].includes(null!=(yc=null==(jc=document.activeElement)?void 0:jc.tagName)?yc:"")&&(rb.preventDefault(),k.copy())};window.addEventListener("keydown",qa);window.addEventListener("keyup",Ca);document.addEventListener("paste",
Ia);document.addEventListener("copy",bb);return()=>{window.removeEventListener("keydown",qa);window.removeEventListener("keyup",Ca);document.removeEventListener("paste",Ia);document.removeEventListener("copy",bb)}},[])}function fh(c){const k=Le(),{inputs:J,callbacks:da}=md(),qa=tx.useRef(-1);return tx.useMemo(()=>({onPointerDown:Ca=>{var Ia,bb;if(!k.settings.penMode||"pen"===Ca.pointerType&&Ca.isPrimary){var {order:rb=0}=Ca;rb||(null==(Ia=Ca.currentTarget)?void 0:Ia.setPointerCapture(Ca.pointerId));
null==(bb=da.onPointerDown)?void 0:bb.call(da,{type:"shape",shape:c,order:rb},Ca);Ca.order=rb+1}},onPointerMove:Ca=>{var Ia;if(!k.settings.penMode||"pen"===Ca.pointerType&&Ca.isPrimary){var {order:bb=0}=Ca;null==(Ia=da.onPointerMove)?void 0:Ia.call(da,{type:"shape",shape:c,order:bb},Ca);Ca.order=bb+1}},onPointerUp:Ca=>{var Ia,bb,rb;if(!k.settings.penMode||"pen"===Ca.pointerType&&Ca.isPrimary){var {order:Pb=0}=Ca;Pb||(null==(Ia=Ca.currentTarget)?void 0:Ia.releasePointerCapture(Ca.pointerId));null==
(bb=da.onPointerUp)?void 0:bb.call(da,{type:"shape",shape:c,order:Pb},Ca);Ia=Date.now();bb=Ia-qa.current;300<bb?qa.current=Ia:300>=bb&&(null==(rb=da.onDoubleClick)?void 0:rb.call(da,{type:"shape",shape:c,order:Pb},Ca),qa.current=-1);Ca.order=Pb+1}},onPointerEnter:Ca=>{var Ia;if(!k.settings.penMode||"pen"===Ca.pointerType&&Ca.isPrimary){var {order:bb=0}=Ca;null==(Ia=da.onPointerEnter)?void 0:Ia.call(da,{type:"shape",shape:c,order:bb},Ca);Ca.order=bb+1}},onPointerLeave:Ca=>{var Ia;if(!k.settings.penMode||
"pen"===Ca.pointerType&&Ca.isPrimary){var {order:bb=0}=Ca;null==(Ia=da.onPointerLeave)?void 0:Ia.call(da,{type:"shape",shape:c,order:bb},Ca);Ca.order=bb+1}},onKeyUp:Ca=>{var Ia;null==(Ia=da.onKeyUp)?void 0:Ia.call(da,{type:"shape",shape:c,order:-1},Ca)},onKeyDown:Ca=>{var Ia;null==(Ia=da.onKeyDown)?void 0:Ia.call(da,{type:"shape",shape:c,order:-1},Ca)}}),[c.id,J,da])}function jh(c){var {viewport:k,inputs:J,callbacks:da,components:qa}=c;c=hj(c,["viewport","inputs","callbacks","components"]);return(0,Lx.jsx)(lB,
{id:c.id,viewport:k,inputs:J,callbacks:da,components:qa,meta:c.meta,children:(0,Lx.jsx)(hB,tf({},c))})}function Uh(c){var {side:k,content:J,sideOffset:da=10}=c;c=hj(c,["side","content","sideOffset"]);return J?(0,Ep.jsx)(Cr.TooltipProvider,{delayDuration:300,children:(0,Ep.jsxs)(Cr.Tooltip,{children:[(0,Ep.jsx)(Cr.TooltipTrigger,{asChild:!0,children:c.children}),(0,Ep.jsxs)(Cr.TooltipContent,gg(tf({sideOffset:da,side:k},c),{children:[J,(0,Ep.jsx)(Cr.TooltipArrow,{className:"popper-arrow"})]}))]})}):
(0,Ep.jsx)(Ep.Fragment,{children:c.children})}function ei(c){var {className:k,tooltip:J,tooltipSide:da}=c;c=hj(c,["className","tooltip","tooltipSide"]);return(0,Mx.jsx)(Uh,{content:J,side:da,children:(0,Mx.jsx)("button",tf({className:"tl-button "+(null!=k?k:"")},c))})}function Ig(c){var {toggle:k=!0,pressed:J,onPressedChange:da,className:qa,tooltip:Ca}=c;c=hj(c,["toggle","pressed","onPressedChange","className","tooltip"]);return(0,tu.jsx)(Uh,{content:Ca,children:(0,tu.jsx)("div",{className:"inline-flex",
children:(0,tu.jsx)(rB.Toggle,gg(tf({},c),{"data-toggle":k,className:"tl-button"+(qa?" "+qa:""),pressed:J,onPressedChange:da}))})})}function Rk(c){var {side:k,align:J,alignOffset:da,label:qa,children:Ca,border:Ia}=c;c=hj(c,"side align alignOffset label children border".split(" "));return(0,Hs.jsxs)(Is.Popover,{children:[(0,Hs.jsx)(Is.PopoverTrigger,gg(tf({},c),{"data-border":Ia,className:"tl-button tl-popover-trigger-button",children:qa})),(0,Hs.jsxs)(Is.PopoverContent,{className:"w-auto p-1",align:J,
alignOffset:da,side:k,sideOffset:15,collisionBoundary:document.querySelector(".logseq-tldraw"),children:[Ca,(0,Hs.jsx)(Is.PopoverArrow,{className:"popper-arrow"})]})]})}function Wi(c){function k(Pb){return Pb?(0,zk.jsx)("div",{className:"tl-color-bg",style:{backgroundColor:Pb},children:(0,zk.jsx)("div",{className:`w-full h-full bg-${Pb}-500`})}):(0,zk.jsx)("div",{className:"tl-color-bg",children:(0,zk.jsx)(mh,{name:"color-swatch"})})}var {color:J,opacity:da,popoverSide:qa,setColor:Ca,setOpacity:Ia}=
c;c=hj(c,["color","opacity","popoverSide","setColor","setOpacity"]);const {handlers:{t:bb}}=Qx.default.useContext(Si),rb=Qx.default.useMemo(()=>{let Pb="";return lg(jc=>{Ca(Pb)},100,jc=>{Pb=jc.target.value})},[]);return(0,zk.jsx)(Rk,gg(tf({},c),{border:!0,side:qa,label:(0,zk.jsx)(Uh,{content:bb("whiteboard/color"),side:qa,sideOffset:14,children:k(J)}),children:(0,zk.jsxs)("div",{className:"p-1",children:[(0,zk.jsx)("div",{className:"tl-color-palette",children:Object.values(lb).map(Pb=>(0,zk.jsx)("button",
{className:`tl-color-drip m-1${Pb===J?" active":""}`,onClick:()=>Ca(Pb),children:k(Pb)},Pb))}),(0,zk.jsxs)("div",{className:"flex items-center tl-custom-color",children:[(0,zk.jsx)("div",{className:`tl-color-drip m-1 mr-3 ${qf(J)?"":"active"}`,children:(0,zk.jsx)("div",{className:"color-input-wrapper tl-color-bg",children:(0,zk.jsx)("input",tf({className:"color-input cursor-pointer",id:"tl-custom-color-input",type:"color",value:/^#(?:[0-9a-f]{3}){1,2}$/i.test(J)?J:"#000000",onChange:rb,style:{opacity:qf(J)?
0:1}},c))})}),(0,zk.jsx)("label",{htmlFor:"tl-custom-color-input",className:"text-xs cursor-pointer",children:bb("whiteboard/select-custom-color")})]}),Ia&&(0,zk.jsx)("div",{className:"mx-1 my-2",children:(0,zk.jsxs)(Js.Slider,{defaultValue:[null!=da?da:0],onValueCommit:Pb=>Ia(Pb[0]),max:1,step:.1,"aria-label":bb("whiteboard/opacity"),className:"tl-slider-root",children:[(0,zk.jsx)(Js.SliderTrack,{className:"tl-slider-track",children:(0,zk.jsx)(Js.SliderRange,{className:"tl-slider-range"})}),(0,zk.jsx)(Js.SliderThumb,
{className:"tl-slider-thumb"})]})})]})}))}function jk(c){var {options:k,tooltip:J,popoverSide:da,compact:qa=!1,value:Ca,onValueChange:Ia}=c;c=hj(c,"options tooltip popoverSide compact value onValueChange".split(" "));const [bb,rb]=zB.useState(!1);return(0,Un.jsx)("div",gg(tf({},c),{children:(0,Un.jsxs)(yq.Select,{open:bb,onOpenChange:rb,value:Ca,onValueChange:Ia,children:[(0,Un.jsx)(Uh,{content:J,side:da,children:(0,Un.jsxs)(yq.SelectTrigger,{className:`tl-select-trigger ${qa?"compact":""}`,children:[(0,Un.jsx)(yq.SelectValue,
{}),!qa&&(0,Un.jsx)(yq.SelectIcon,{asChild:!0,children:(0,Un.jsx)(BB,{className:"h-4 w-4 opacity-50"})})]})}),(0,Un.jsx)(yq.SelectContent,{className:"min-w-min",side:da,position:"popper",sideOffset:14,align:"center",onKeyDown:Pb=>Pb.stopPropagation(),children:k.map(Pb=>(0,Un.jsx)(yq.SelectItem,{value:Pb.value,children:Pb.label},Pb.value))})]})}))}function Qg(c){var {scaleLevel:k,compact:J,popoverSide:da}=c;hj(c,["scaleLevel","compact","popoverSide"]);const qa=Le();({handlers:{t:c}}=CB.default.useContext(Si));
const Ca=[{label:J?"XS":c("whiteboard/extra-small"),value:"xs"},{label:J?"SM":c("whiteboard/small"),value:"sm"},{label:J?"MD":c("whiteboard/medium"),value:"md"},{label:J?"LG":c("whiteboard/large"),value:"lg"},{label:J?"XL":c("whiteboard/extra-large"),value:"xl"},{label:J?"XXL":c("whiteboard/huge"),value:"xxl"}];return(0,DB.jsx)(jk,{tooltip:c("whiteboard/scale-level"),options:Ca,value:k,popoverSide:da,compact:J,onValueChange:Ia=>{qa.api.setScaleLevel(Ia)}})}function kk(c,k){return function(J){return c(k(J))}}
function Sk(c,k){return k(c)}function Hk(c,k){return function(J){return c(k,J)}}function Ik(c,k){return function(){return c(k)}}function lk(c,k){k(c);return c}function ii(){for(var c=arguments.length,k=Array(c),J=0;J<c;J++)k[J]=arguments[J];return k}function Jm(c){c()}function Mj(c){return function(){return c}}function rj(){for(var c=arguments.length,k=Array(c),J=0;J<c;J++)k[J]=arguments[J];return function(){k.map(Jm)}}function fi(){}function ti(c,k){return c(1,k)}function jl(c,k){c(0,k)}function mk(c){c(2)}
function vl(c){return c(4)}function Xg(c,k){return ti(c,Hk(k,0))}function tk(c,k){var J=c(1,function(da){J();k(da)});return J}function Yg(){var c=[];return function(k,J){switch(k){case 2:c.splice(0,c.length);break;case 1:return c.push(J),function(){var da=c.indexOf(J);-1<da&&c.splice(da,1)};case 0:c.slice().forEach(function(da){da(J)});break;default:throw Error("unrecognized action "+k);}}}function fg(c){var k=c,J=Yg();return function(da,qa){switch(da){case 1:qa(k);break;case 0:k=qa;break;case 4:return k}return J(da,
qa)}}function Xi(c){var k,J;return function(da,qa){switch(da){case 1:if(qa){if(J===qa)break;k&&k();J=qa;return k=c(1,qa)}k&&k();return fi;case 2:k&&k();J=null;break;default:throw Error("unrecognized action "+da);}}}function Ri(c){return lk(Yg(),function(k){return Xg(c,k)})}function Li(c,k){return lk(fg(k),function(J){return Xg(c,J)})}function wl(){for(var c=arguments.length,k=Array(c),J=0;J<c;J++)k[J]=arguments[J];return function(da){return k.reduceRight(Sk,da)}}function Cf(c){for(var k=arguments.length,
J=Array(1<k?k-1:0),da=1;da<k;da++)J[da-1]=arguments[da];var qa=wl.apply(void 0,J);return function(Ca,Ia){switch(Ca){case 1:return ti(c,qa(Ia));case 2:c(2);break;default:throw Error("unrecognized action "+Ca);}}}function sj(c,k){return c===k}function Ch(c){void 0===c&&(c=sj);var k;return function(J){return function(da){c(k,da)||(k=da,J(da))}}}function xh(c){return function(k){return function(J){c(J)&&k(J)}}}function wg(c){return function(k){return kk(k,c)}}function cj(c){return function(k){return function(){return k(c)}}}
function Fi(c,k){return function(J){return function(da){return J(k=c(k,da))}}}function Tj(c){return function(k){return function(J){0<c?c--:k(J)}}}function Lj(c){var k,J;return function(da){return function(qa){k=qa;J||=setTimeout(function(){J=void 0;da(k)},c)}}}function cl(c){var k,J;return function(da){return function(qa){k=qa;J&&clearTimeout(J);J=setTimeout(function(){da(k)},c)}}}function Hh(){for(var c=arguments.length,k=Array(c),J=0;J<c;J++)k[J]=arguments[J];var da=Array(k.length),qa=0,Ca=null,
Ia=Math.pow(2,k.length)-1;k.forEach(function(bb,rb){var Pb=Math.pow(2,rb);ti(bb,function(jc){var yc=qa;qa|=Pb;da[rb]=jc;yc!==Ia&&qa===Ia&&Ca&&(Ca(),Ca=null)})});return function(bb){return function(rb){var Pb=function(){return bb([rb].concat(da))};qa===Ia?Pb():Ca=Pb}}}function xl(){for(var c=arguments.length,k=Array(c),J=0;J<c;J++)k[J]=arguments[J];return function(da,qa){switch(da){case 1:return rj.apply(void 0,k.map(function(Ca){return Ca(1,qa)}));case 2:break;default:throw Error("unrecognized action "+
da);}}}function Qh(c,k){void 0===k&&(k=sj);return Cf(c,Ch(k))}function Gi(){for(var c=Yg(),k=arguments.length,J=Array(k),da=0;da<k;da++)J[da]=arguments[da];var qa=Array(J.length),Ca=0,Ia=Math.pow(2,J.length)-1;J.forEach(function(bb,rb){var Pb=Math.pow(2,rb);ti(bb,function(jc){qa[rb]=jc;Ca|=Pb;Ca===Ia&&c(0,qa)})});return function(bb,rb){switch(bb){case 1:return Ca===Ia&&rb(qa),c(1,rb);case 2:c(2);break;default:throw Error("unrecognized action "+bb);}}}function oh(c,k,J){void 0===k&&(k=[]);J=(void 0===
J?{singleton:!0}:J).singleton;return{id:Symbol(),constructor:c,dependencies:k,singleton:J}}function tj(c){var k=new Map;return function qa(da){var Ca=da.id,Ia=da.constructor,bb=da.dependencies;if((da=da.singleton)&&k.has(Ca))return k.get(Ca);Ia=Ia(bb.map(function(rb){return qa(rb)}));da&&k.set(Ca,Ia);return Ia}(c)}function dl(c,k){if(null==c)return{};var J={},da=Object.keys(c),qa;for(qa=0;qa<da.length;qa++){var Ca=da[qa];0<=k.indexOf(Ca)||(J[Ca]=c[Ca])}return J}function yl(c,k){if(c){if("string"===
typeof c)return om(c,k);var J=Object.prototype.toString.call(c).slice(8,-1);"Object"===J&&c.constructor&&(J=c.constructor.name);if("Map"===J||"Set"===J)return Array.from(c);if("Arguments"===J||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(J))return om(c,k)}}function om(c,k){if(null==k||k>c.length)k=c.length;for(var J=0,da=Array(k);J<k;J++)da[J]=c[J];return da}function nm(c,k){var J="undefined"!==typeof Symbol&&c[Symbol.iterator]||c["@@iterator"];if(J)return(J=J.call(c)).next.bind(J);if(Array.isArray(c)||
(J=yl(c))||k&&c&&"number"===typeof c.length){J&&(c=J);var da=0;return function(){return da>=c.length?{done:!0}:{done:!1,value:c[da++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function Ln(c,k){for(var J={},da={},qa=0,Ca=c.length;qa<Ca;)da[c[qa]]=1,qa+=1;for(var Ia in k)da.hasOwnProperty(Ia)||(J[Ia]=k[Ia]);return J}function mc(c,k,J){function da(yc,Rc){yc.propsReady&&(0,yc.propsReady)(0,
!1);for(var jd=nm(Ia),fd;!(fd=jd()).done;)fd=fd.value,(0,yc[k.required[fd]])(0,Rc[fd]);for(jd=nm(bb);!(fd=jd()).done;)if(fd=fd.value,fd in Rc)(0,yc[k.optional[fd]])(0,Rc[fd]);yc.propsReady&&(0,yc.propsReady)(0,!0)}function qa(yc){return rb.reduce(function(Rc,jd){Rc[jd]=function(fd){(0,yc[k.methods[jd]])(0,fd)};return Rc},{})}function Ca(yc){return Pb.reduce(function(Rc,jd){Rc[jd]=Xi(yc[k.events[jd]]);return Rc},{})}var Ia=Object.keys(k.required||{}),bb=Object.keys(k.optional||{}),rb=Object.keys(k.methods||
{}),Pb=Object.keys(k.events||{}),jc=(0,Bl.createContext)({});return{Component:(0,Bl.forwardRef)(function(yc,Rc){var jd=yc.children,fd=dl(yc,IB),xd=(0,Bl.useState)(function(){return lk(tj(c),function(Xc){return da(Xc,fd)})})[0],Fd=(0,Bl.useState)(Ik(Ca,xd))[0];Ks(function(){for(var Xc=nm(Pb),id;!(id=Xc()).done;)if(id=id.value,id in fd)(0,Fd[id])(1,fd[id]);return function(){Object.values(Fd).map(mk)}},[fd,Fd,xd]);Ks(function(){da(xd,fd)});(0,Bl.useImperativeHandle)(Rc,Mj(qa(xd)));return(0,Bl.createElement)(jc.Provider,
{value:xd},J?(0,Bl.createElement)(J,Ln([].concat(Ia,bb,Pb),fd),jd):jd)}),usePublisher:function(yc){return(0,Bl.useCallback)(Hk(jl,(0,Bl.useContext)(jc)[yc]),[yc])},useEmitterValue:function(yc){var Rc=(0,Bl.useContext)(jc)[yc];yc=(0,Bl.useState)(Ik(vl,Rc));var jd=yc[0],fd=yc[1];Ks(function(){return ti(Rc,function(xd){xd!==jd&&fd(Mj(xd))})},[Rc,jd]);return jd},useEmitter:function(yc,Rc){var jd=(0,Bl.useContext)(jc)[yc];Ks(function(){return jd(1,Rc)},[Rc,jd])}}}function Ga(){return Ga=Object.assign||
function(c){for(var k=1;k<arguments.length;k++){var J=arguments[k],da;for(da in J)Object.prototype.hasOwnProperty.call(J,da)&&(c[da]=J[da])}return c},Ga.apply(this,arguments)}function sc(c,k){if(null==c)return{};var J,da,qa={},Ca=Object.keys(c);for(da=0;da<Ca.length;da++)0<=k.indexOf(J=Ca[da])||(qa[J]=c[J]);return qa}function qc(c,k){(null==k||k>c.length)&&(k=c.length);for(var J=0,da=Array(k);J<k;J++)da[J]=c[J];return da}function Mb(c,k){var J="undefined"!=typeof Symbol&&c[Symbol.iterator]||c["@@iterator"];
if(J)return(J=J.call(c)).next.bind(J);if(Array.isArray(c)||(J=function(qa,Ca){if(qa){if("string"==typeof qa)return qc(qa,Ca);var Ia=Object.prototype.toString.call(qa).slice(8,-1);return"Object"===Ia&&qa.constructor&&(Ia=qa.constructor.name),"Map"===Ia||"Set"===Ia?Array.from(qa):"Arguments"===Ia||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ia)?qc(qa,Ca):void 0}}(c))||k&&c&&"number"==typeof c.length){J&&(c=J);var da=0;return function(){return da>=c.length?{done:!0}:{done:!1,value:c[da++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}function Ec(c,k){void 0===k&&(k=!0);var J=(0,gi.useRef)(null),da=function(Ca){};if("undefined"!=typeof ResizeObserver){var qa=new ResizeObserver(function(Ca){Ca=Ca[0].target;null!==Ca.offsetParent&&c(Ca)});da=function(Ca){Ca&&k?(qa.observe(Ca),J.current=Ca):(J.current&&qa.unobserve(J.current),J.current=null)}}return{ref:J,callbackRef:da}}function fc(c,k){return void 0===k&&(k=!0),Ec(c,k).callbackRef}function Sb(c,k,J,da,qa,Ca,Ia){return Ec(function(bb){for(var rb=function(yc,Rc,jd,fd){jd=yc.length;
if(0===jd)return null;for(var xd=[],Fd=0;Fd<jd;Fd++){var Xc=yc.item(Fd);if(Xc&&void 0!==Xc.dataset.index){var id=parseInt(Xc.dataset.index),nd=parseFloat(Xc.dataset.knownSize),Gd=Rc(Xc,"offsetHeight");if(0===Gd&&fd("Zero-sized element, this should not happen",{child:Xc},Bk.ERROR),Gd!==nd)Xc=xd[xd.length-1],0===xd.length||Xc.size!==Gd||Xc.endIndex!==id-1?xd.push({startIndex:id,endIndex:id,size:Gd}):xd[xd.length-1].endIndex++}}return xd}(bb.children,k,0,qa),Pb=bb.parentElement;!Pb.dataset.virtuosoScroller;)Pb=
Pb.parentElement;var jc="window"===Pb.firstElementChild.dataset.viewportType;da({scrollTop:Math.max(Ia?Ia.scrollTop:jc?window.pageYOffset||document.documentElement.scrollTop:Pb.scrollTop,0),scrollHeight:Ia?Ia.scrollHeight:jc?document.documentElement.scrollHeight:Pb.scrollHeight,viewportHeight:Ia?Ia.offsetHeight:jc?window.innerHeight:Pb.offsetHeight});null==Ca||Ca(function(yc,Rc,jd){return"normal"===Rc||null!=Rc&&Rc.endsWith("px")||jd("row-gap was not resolved to pixel value correctly",Rc,Bk.WARN),
"normal"===Rc?0:parseInt(null!=Rc?Rc:"0",10)}(0,getComputedStyle(bb).rowGap,qa));null!==rb&&c(rb)},J)}function Qb(c,k){return Math.round(c.getBoundingClientRect()[k])}function uc(c,k,J,da,qa){void 0===da&&(da=fi);var Ca=(0,gi.useRef)(null),Ia=(0,gi.useRef)(null),bb=(0,gi.useRef)(null),rb=(0,gi.useRef)(!1),Pb=(0,gi.useCallback)(function(jc){jc=jc.target;var yc=jc===window||jc===document,Rc=yc?window.pageYOffset||document.documentElement.scrollTop:jc.scrollTop,jd=yc?document.documentElement.scrollHeight:
jc.scrollHeight,fd=yc?window.innerHeight:jc.offsetHeight;jc=function(){c({scrollTop:Math.max(Rc,0),scrollHeight:jd,viewportHeight:fd})};rb.current?(0,JB.flushSync)(jc):jc();rb.current=!1;null!==Ia.current&&(Rc===Ia.current||0>=Rc||Rc===jd-fd)&&(Ia.current=null,k(!0),bb.current&&(clearTimeout(bb.current),bb.current=null))},[c,k]);return(0,gi.useEffect)(function(){var jc=qa||Ca.current;return da(qa||Ca.current),Pb({target:jc}),jc.addEventListener("scroll",Pb,{passive:!0}),function(){da(null);jc.removeEventListener("scroll",
Pb)}},[Ca,Pb,J,da,qa]),{scrollerRef:Ca,scrollByCallback:function(jc){rb.current=!0;Ca.current.scrollBy(jc)},scrollToCallback:function(jc){var yc=Ca.current;if(yc&&!("offsetHeight"in yc&&0===yc.offsetHeight)){var Rc,jd,fd,xd="smooth"===jc.behavior;if(yc===window?(jd=Math.max(Qb(document.documentElement,"height"),document.documentElement.scrollHeight),Rc=window.innerHeight,fd=document.documentElement.scrollTop):(jd=yc.scrollHeight,Rc=Qb(yc,"height"),fd=yc.scrollTop),jc.top=Math.ceil(Math.max(Math.min(jd-
Rc,jc.top),0)),1.01>Math.abs(Rc-jd)||jc.top===fd)return c({scrollTop:fd,scrollHeight:jd,viewportHeight:Rc}),void(xd&&k(!0));xd?(Ia.current=jc.top,bb.current&&clearTimeout(bb.current),bb.current=setTimeout(function(){bb.current=null;Ia.current=null;k(!0)},1E3)):Ia.current=null;yc.scrollTo(jc)}}}}function Vc(c,k,J,da,qa){return void 0===da&&(da=Ni),void 0===qa&&(qa=Ni),{k:c,v:k,lvl:J,l:da,r:qa}}function ed(c,k){if(c===Ni)return Ni;var J=c.k,da=c.l,qa=c.r;if(k===J){if(da===Ni)return qa;if(qa===Ni)return da;
k=ue(da);return Og(Re(c,{k:k[0],v:k[1],l:Ce(da)}))}return Og(Re(c,k<J?{l:ed(da,k)}:{r:ed(qa,k)}))}function ud(c,k,J){return(void 0===J&&(J="k"),c===Ni)?[-Infinity,void 0]:c[J]===k?[c.k,c.v]:c[J]<k?(k=ud(c.r,k,J),-Infinity===k[0]?[c.k,c.v]:k):ud(c.l,k,J)}function Bd(c,k,J){return c===Ni?Vc(k,J,1):k===c.k?Re(c,{k,v:J}):Jf(yf(Re(c,k<c.k?{l:Bd(c.l,k,J)}:{r:Bd(c.r,k,J)})))}function Jd(c,k,J){if(c===Ni)return[];var da=c.k,qa=c.v,Ca=c.r,Ia=[];return da>k&&(Ia=Ia.concat(Jd(c.l,k,J))),da>=k&&da<=J&&Ia.push({k:da,
v:qa}),da<=J&&(Ia=Ia.concat(Jd(Ca,k,J))),Ia}function ke(c){return c===Ni?[]:[].concat(ke(c.l),[{k:c.k,v:c.v}],ke(c.r))}function ue(c){return c.r===Ni?[c.k,c.v]:ue(c.r)}function Ce(c){return c.r===Ni?c.l:Og(Re(c,{r:Ce(c.r)}))}function Re(c,k){return Vc(void 0!==k.k?k.k:c.k,void 0!==k.v?k.v:c.v,void 0!==k.lvl?k.lvl:c.lvl,void 0!==k.l?k.l:c.l,void 0!==k.r?k.r:c.r)}function vg(c){return c===Ni||c.lvl>c.r.lvl}function Og(c){var k=c.l,J=c.r,da=c.lvl;if(J.lvl>=da-1&&k.lvl>=da-1)return c;if(da>J.lvl+1){if(vg(k))return yf(Re(c,
{lvl:da-1}));if(k===Ni||k.r===Ni)throw Error("Unexpected empty nodes");return Re(k.r,{l:Re(k,{r:k.r.l}),r:Re(c,{l:k.r.r,lvl:da-1}),lvl:da})}if(vg(c))return Jf(Re(c,{lvl:da-1}));if(J===Ni||J.l===Ni)throw Error("Unexpected empty nodes");k=J.l;var qa=vg(k)?J.lvl-1:J.lvl;return Re(k,{l:Re(c,{r:k.l,lvl:da-1}),r:Jf(Re(J,{l:k.r,lvl:qa})),lvl:k.lvl+1})}function bg(c,k,J){return c===Ni?[]:og(Jd(c,ud(c,k)[0],J),function(da){return{index:da.k,value:da.v}})}function og(c,k){var J=c.length;if(0===J)return[];var da=
k(c[0]),qa=da.index;da=da.value;for(var Ca=[],Ia=1;Ia<J;Ia++){var bb=k(c[Ia]),rb=bb.index;bb=bb.value;Ca.push({start:qa,end:rb-1,value:da});qa=rb;da=bb}return Ca.push({start:qa,end:Infinity,value:da}),Ca}function Jf(c){var k=c.r,J=c.lvl;return k===Ni||k.r===Ni||k.lvl!==J||k.r.lvl!==J?c:Re(k,{l:Re(c,{r:k.l}),lvl:J+1})}function yf(c){var k=c.l;return k===Ni||k.lvl!==c.lvl?c:Re(k,{r:Re(c,{l:k.r})})}function Rg(c,k,J,da){void 0===da&&(da=0);for(var qa=c.length-1;da<=qa;){var Ca=Math.floor((da+qa)/2),
Ia=J(c[Ca],k);if(0===Ia)return Ca;if(-1===Ia){if(2>qa-da)return Ca-1;qa=Ca-1}else{if(qa===da)return Ca;da=Ca+1}}throw Error("Failed binary finding record in array - "+c.join(",")+", searched for "+k);}function Eg(c){var k=c.size,J=c.startIndex,da=c.endIndex;return function(qa){return qa.start===J&&(qa.end===da||Infinity===qa.end)&&qa.value===k}}function Lf(c,k){c=c.index;return k===c?0:k<c?-1:1}function Rh(c,k){c=c.offset;return k===c?0:k<c?-1:1}function Sh(c){return{index:c.index,value:c}}function oi(c,
k,J,da){var qa=0,Ca=0,Ia=0,bb;0!==k?(Ia=c[bb=Rg(c,k-1,Lf)].offset,Ca=ud(J,k-1),qa=Ca[0],Ca=Ca[1],c.length&&c[bb].size===ud(J,k)[1]&&--bb,c=c.slice(0,bb+1)):c=[];for(k=Mb(bg(J,k,Infinity));!(J=k()).done;)bb=J.value,J=bb.start,bb=bb.value,qa=J-qa,Ia=qa*Ca+Ia+qa*da,c.push({offset:Ia,size:bb,index:J}),qa=J,Ca=bb;return{offsetTree:c,lastIndex:qa,lastOffset:Ia,lastSize:Ca}}function eh(c,k){var J=k[0],da=k[1],qa=k[3];0<J.length&&(0,k[2])("received item sizes",J,Bk.DEBUG);var Ca=c.sizeTree;k=Ca;var Ia=0;
if(0<da.length&&Ca===Ni&&2===J.length){var bb=J[0].size,rb=J[1].size;k=da.reduce(function(jc,yc){return Bd(Bd(jc,yc,bb),yc+1,rb)},k)}else J=function(jc,yc){var Rc,jd=jc===Ni?0:Infinity;for(yc=Mb(yc);!(Rc=yc()).done;){var fd=Rc.value;Rc=fd.size;var xd=fd.startIndex,Fd=fd.endIndex;if(jd=Math.min(jd,xd),jc===Ni)jc=Bd(jc,0,Rc);else{var Xc=bg(jc,xd-1,Fd+1);if(!Xc.some(Eg(fd))){var id,nd=fd=!1;for(Xc=Mb(Xc);!(id=Xc()).done;){var Gd=id.value;id=Gd.start;var wd=Gd.end;Gd=Gd.value;fd?(Fd>=id||Rc===Gd)&&(jc=
ed(jc,id)):(nd=Gd!==Rc,fd=!0);wd>Fd&&Fd>=id&&Gd!==Rc&&(jc=Bd(jc,Fd+1,Gd))}nd&&(jc=Bd(jc,xd,Rc))}}}return[jc,jd]}(k,J),k=J[0],Ia=J[1];if(k===Ca)return c;c=oi(c.offsetTree,Ia,k,qa);var Pb=c.offsetTree;return{sizeTree:k,offsetTree:Pb,lastIndex:c.lastIndex,lastOffset:c.lastOffset,lastSize:c.lastSize,groupOffsetTree:da.reduce(function(jc,yc){return Bd(jc,yc,Hg(yc,Pb,qa))},Ni),groupIndices:da}}function Hg(c,k,J){if(0===k.length)return 0;k=k[Rg(k,c,Lf)];c-=k.index;c=k.size*c+(c-1)*J+k.offset;return 0<c?
c+J:c}function Zh(c,k,J){if(void 0!==c.groupIndex)return k.groupIndices[c.groupIndex]+1;c=uj("LAST"===c.index?J:c.index,k);return Math.max(0,c,Math.min(J,c))}function uj(c,k){if(k.groupOffsetTree===Ni)return c;for(var J=0;k.groupIndices[J]<=c+J;)J++;return c+J}function Kl(c){c="number"==typeof c?{index:c}:c;return c.align||(c.align="start"),c.behavior&&NB||(c.behavior="auto"),c.offset||(c.offset=0),c}function Ok(c){return!!c&&("smooth"===c?"smooth":"auto")}function Zm(c){return c.reduce(function(k,
J){return k.groupIndices.push(k.totalCount),k.totalCount+=J+1,k},{totalCount:0,groupIndices:[]})}function ak(c,k){return!(!c||c[0]!==k[0]||c[1]!==k[1])}function pj(c,k){return!(!c||c.startIndex!==k.startIndex||c.endIndex!==k.endIndex)}function Bn(c,k,J){return"number"==typeof c?"up"===J&&"top"===k||"down"===J&&"bottom"===k?c:0:"up"===J?"top"===k?c.main:c.reverse:"bottom"===k?c.main:c.reverse}function fo(c,k,J){if(0===c.length)return[];if(k.groupOffsetTree===Ni)return c.map(function(rb){return Ga({},
rb,{index:rb.index+J,originalIndex:rb.index})});var da,qa=[],Ca=bg(k.groupOffsetTree,c[0].index,c[c.length-1].index),Ia=void 0,bb=0;for(c=Mb(c);!(da=c()).done;)da=da.value,(!Ia||Ia.end<da.index)&&(Ia=Ca.shift(),bb=k.groupIndices.indexOf(Ia.start)),qa.push(Ga({},da.index===Ia.start?{type:"group",index:bb}:{index:da.index-(bb+1)+J,groupIndex:bb},{size:da.size,offset:da.offset,originalIndex:da.index,data:da.data}));return qa}function Ll(c,k,J,da,qa,Ca){var Ia=0,bb=0;0<c.length&&(Ia=c[0].offset,bb=c[c.length-
1],bb=bb.offset+bb.size);var rb=J-qa.lastIndex,Pb=Ia;da=qa.lastOffset+rb*qa.lastSize+(rb-1)*da-bb;return{items:fo(c,qa,Ca),topItems:fo(k,qa,Ca),topListHeight:k.reduce(function(jc,yc){return yc.size+jc},0),offsetTop:Ia,offsetBottom:da,top:Pb,bottom:bb,totalCount:J,firstItemIndex:Ca}}function ol(c){var k,J=!1;return function(){return J||(J=!0,k=c()),k}}function Pi(c,k){var J=(0,gi.useRef)(null),da=(0,gi.useCallback)(function(rb){if(null!==rb&&rb.offsetParent){var Pb=rb.getBoundingClientRect();rb=Pb.width;
if(k){var jc=k.getBoundingClientRect();Pb=Pb.top-jc.top;jc=jc.height-Math.max(0,Pb);Pb+=k.scrollTop}else jc=window.innerHeight-Math.max(0,Pb.top),Pb=Pb.top+window.pageYOffset;J.current={offsetTop:Pb,visibleHeight:jc,visibleWidth:rb};c(J.current)}},[c,k]),qa=Ec(da),Ca=qa.callbackRef,Ia=qa.ref,bb=(0,gi.useCallback)(function(){da(Ia.current)},[da,Ia]);return(0,gi.useEffect)(function(){if(k){k.addEventListener("scroll",bb);var rb=new ResizeObserver(bb);return rb.observe(k),function(){k.removeEventListener("scroll",
bb);rb.unobserve(k)}}return window.addEventListener("scroll",bb),window.addEventListener("resize",bb),function(){window.removeEventListener("scroll",bb);window.removeEventListener("resize",bb)}},[bb,k]),Ca}function gk(c){return c}function $m(c,k){var J=Yg();return ti(J,function(){return console.warn("react-virtuoso: You are using a deprecated property. "+k,"color: red;","color: inherit;","color: blue;")}),Xg(J,c),J}function Ki(c,k){if("string"!=typeof c)return{context:k}}function kl(c){var k=c.usePublisher,
J=c.useEmitter,da=c.useEmitterValue;return yh.memo(function(qa){var Ca=qa.style,Ia=qa.children;qa=sc(qa,aC);var bb=k("scrollContainerState"),rb=da("ScrollerComponent"),Pb=k("smoothScrollTargetReached"),jc=da("scrollerRef"),yc=da("context");bb=uc(bb,Pb,rb,jc);Pb=bb.scrollerRef;jc=bb.scrollByCallback;return J("scrollTo",bb.scrollToCallback),J("scrollBy",jc),(0,gi.createElement)(rb,Ga({ref:Pb,style:Ga({},hC,Ca),"data-test-id":"virtuoso-scroller","data-virtuoso-scroller":!0,tabIndex:0},qa,Ki(rb,yc)),
Ia)})}function Ol(c){var k=c.usePublisher,J=c.useEmitter,da=c.useEmitterValue;return yh.memo(function(qa){var Ca=qa.style,Ia=qa.children;qa=sc(qa,bC);var bb=k("windowScrollContainerState"),rb=da("ScrollerComponent"),Pb=k("smoothScrollTargetReached"),jc=da("totalListHeight"),yc=da("deviation"),Rc=da("customScrollParent"),jd=da("context");Pb=uc(bb,Pb,rb,fi,Rc);var fd=Pb.scrollerRef;bb=Pb.scrollByCallback;Pb=Pb.scrollToCallback;return KB(function(){return fd.current=Rc||window,function(){fd.current=
null}},[fd,Rc]),J("windowScrollTo",Pb),J("scrollBy",bb),(0,gi.createElement)(rb,Ga({style:Ga({position:"relative"},Ca,0!==jc?{height:jc+yc}:{}),"data-virtuoso-scroller":!0},qa,Ki(rb,jd)),Ia)})}function mm(c,k,J){return Array.from({length:k-c+1}).map(function(da,qa){return{index:qa+c,data:null==J?void 0:J[qa+c]}})}function tl(c,k){return c&&c.column===k.column&&c.row===k.row}function wi(c,k,J,da){var qa=J.height;return void 0===qa||0===da.length?{top:0,bottom:0}:{top:Fm(c,k,J,da[0].index),bottom:Fm(c,
k,J,da[da.length-1].index)+qa}}function Fm(c,k,J,da){var qa=k.column;c=Cq(1,Ns((c.width+qa)/(J.width+qa)));da=Ns(da/c);J=da*J.height+Cq(0,da-1)*k.row;return 0<J?J+k.row:J}function rl(c,k,J){return"normal"===k||null!=k&&k.endsWith("px")||J(c+" was not resolved to pixel value correctly",k,Bk.WARN),"normal"===k?0:parseInt(null!=k?k:"0",10)}function Ml(){Ml=Object.assign?Object.assign.bind():function(c){for(var k=1;k<arguments.length;k++){var J=arguments[k],da;for(da in J)Object.prototype.hasOwnProperty.call(J,
da)&&(c[da]=J[da])}return c};return Ml.apply(this,arguments)}function Gk(c,k){Gk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(J,da){J.__proto__=da;return J};return Gk(c,k)}function op(c,k){c.prototype=Object.create(k.prototype);c.prototype.constructor=c;Gk(c,k)}function Dm(c){Dm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(k){return k.__proto__||Object.getPrototypeOf(k)};return Dm(c)}function Em(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;
if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(c){return!1}}function ql(c,k,J){ql=Em()?Reflect.construct.bind():function(da,qa,Ca){var Ia=[null];Ia.push.apply(Ia,qa);da=new (Function.bind.apply(da,Ia));Ca&&Gk(da,Ca.prototype);return da};return ql.apply(null,arguments)}function bn(c){var k="function"===typeof Map?new Map:void 0;bn=function(J){function da(){return ql(J,arguments,Dm(this).constructor)}if(null===J||
-1===Function.toString.call(J).indexOf("[native code]"))return J;if("function"!==typeof J)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof k){if(k.has(J))return k.get(J);k.set(J,da)}da.prototype=Object.create(J.prototype,{constructor:{value:da,enumerable:!1,writable:!0,configurable:!0}});return Gk(da,J)};return bn(c)}function cn(c,k,J){return Math.round(255*c)+","+Math.round(255*k)+","+Math.round(255*J)}function gm(c,k,J,da){void 0===da&&(da=cn);if(0===
k)return da(J,J,J);c=(c%360+360)%360/60;var qa=(1-Math.abs(2*J-1))*k,Ca=qa*(1-Math.abs(c%2-1)),Ia=k=0,bb=0;0<=c&&1>c?(k=qa,Ia=Ca):1<=c&&2>c?(k=Ca,Ia=qa):2<=c&&3>c?(Ia=qa,bb=Ca):3<=c&&4>c?(Ia=Ca,bb=qa):4<=c&&5>c?(k=Ca,bb=qa):5<=c&&6>c&&(k=qa,bb=Ca);J-=qa/2;return da(k+J,Ia+J,bb+J)}function Cn(c){if("string"!==typeof c)throw new sn(3);if("string"===typeof c){var k=c.toLowerCase();c=gy[k]?"#"+gy[k]:c}if(c.match(MC))return{red:parseInt(""+c[1]+c[2],16),green:parseInt(""+c[3]+c[4],16),blue:parseInt(""+
c[5]+c[6],16)};if(c.match(NC))return k=parseFloat((parseInt(""+c[7]+c[8],16)/255).toFixed(2)),{red:parseInt(""+c[1]+c[2],16),green:parseInt(""+c[3]+c[4],16),blue:parseInt(""+c[5]+c[6],16),alpha:k};if(c.match(OC))return{red:parseInt(""+c[1]+c[1],16),green:parseInt(""+c[2]+c[2],16),blue:parseInt(""+c[3]+c[3],16)};if(c.match(PC))return k=parseFloat((parseInt(""+c[4]+c[4],16)/255).toFixed(2)),{red:parseInt(""+c[1]+c[1],16),green:parseInt(""+c[2]+c[2],16),blue:parseInt(""+c[3]+c[3],16),alpha:k};if(k=Hu.exec(c))return{red:parseInt(""+
k[1],10),green:parseInt(""+k[2],10),blue:parseInt(""+k[3],10)};if(k=QC.exec(c.substring(0,50)))return{red:parseInt(""+k[1],10),green:parseInt(""+k[2],10),blue:parseInt(""+k[3],10),alpha:1<parseFloat(""+k[4])?parseFloat(""+k[4])/100:parseFloat(""+k[4])};var J=RC.exec(c);if(J){k=parseInt(""+J[1],10);var da=parseInt(""+J[2],10)/100;J=parseInt(""+J[3],10)/100;k="rgb("+gm(k,da,J)+")";da=Hu.exec(k);if(!da)throw new sn(4,c,k);return{red:parseInt(""+da[1],10),green:parseInt(""+da[2],10),blue:parseInt(""+
da[3],10)}}if(k=SC.exec(c.substring(0,50))){da=parseInt(""+k[1],10);J=parseInt(""+k[2],10)/100;var qa=parseInt(""+k[3],10)/100;da="rgb("+gm(da,J,qa)+")";J=Hu.exec(da);if(!J)throw new sn(4,c,da);return{red:parseInt(""+J[1],10),green:parseInt(""+J[2],10),blue:parseInt(""+J[3],10),alpha:1<parseFloat(""+k[4])?parseFloat(""+k[4])/100:parseFloat(""+k[4])}}throw new sn(5);}function Ug(c){c=c.toString(16);return 1===c.length?"0"+c:c}function Fn(c,k,J){return Iu("#"+Ug(Math.round(255*c))+Ug(Math.round(255*
k))+Ug(Math.round(255*J)))}function Gn(c,k,J){if("number"===typeof c&&"number"===typeof k&&"number"===typeof J)return Iu("#"+Ug(c)+Ug(k)+Ug(J));if("object"===typeof c&&void 0===k&&void 0===J)return Iu("#"+Ug(c.red)+Ug(c.green)+Ug(c.blue));throw new sn(6);}function Gm(c){if("object"!==typeof c)throw new sn(8);if("number"===typeof c.red&&"number"===typeof c.green&&"number"===typeof c.blue&&"number"===typeof c.alpha){if("object"===typeof c)c=1<=c.alpha?Gn(c.red,c.green,c.blue):"rgba("+c.red+","+c.green+
","+c.blue+","+c.alpha+")";else throw new sn(7);return c}if("number"===typeof c.red&&"number"===typeof c.green&&"number"===typeof c.blue&&("number"!==typeof c.alpha||"undefined"===typeof c.alpha))return Gn(c);if("number"===typeof c.hue&&"number"===typeof c.saturation&&"number"===typeof c.lightness&&"number"===typeof c.alpha){if("object"===typeof c)c=1<=c.alpha?gm(c.hue,c.saturation,c.lightness,Fn):"rgba("+gm(c.hue,c.saturation,c.lightness)+","+c.alpha+")";else throw new sn(2);return c}if("number"===
typeof c.hue&&"number"===typeof c.saturation&&"number"===typeof c.lightness&&("number"!==typeof c.alpha||"undefined"===typeof c.alpha)){if("object"===typeof c)c=gm(c.hue,c.saturation,c.lightness,Fn);else throw new sn(1);return c}throw new sn(8);}function sl(c,k,J){return function(){var da=J.concat(Array.prototype.slice.call(arguments));return da.length>=k?c.apply(this,da):sl(c,k,da)}}function In(c,k){if("transparent"===k)return k;k=Cn(k);var J=k.red/255,da=k.green/255,qa=k.blue/255,Ca=Math.max(J,
da,qa),Ia=Math.min(J,da,qa),bb=(Ca+Ia)/2;if(Ca===Ia)k=void 0!==k.alpha?{hue:0,saturation:0,lightness:bb,alpha:k.alpha}:{hue:0,saturation:0,lightness:bb};else{var rb=Ca-Ia;Ia=.5<bb?rb/(2-Ca-Ia):rb/(Ca+Ia);switch(Ca){case J:J=(da-qa)/rb+(da<qa?6:0);break;case da:J=(qa-J)/rb+2;break;default:J=(J-da)/rb+4}J*=60;k=void 0!==k.alpha?{hue:J,saturation:Ia,lightness:bb,alpha:k.alpha}:{hue:J,saturation:Ia,lightness:bb}}bb=Ml;c=k.lightness-parseFloat(c);return Gm(bb({},k,{lightness:Math.max(0,Math.min(1,c))}))}
function fl(c,k){var J;void 0!==k.strokeWidth&&(k.strokeWidth=Math.max(k.strokeWidth,1));void 0!==k.opacity&&(k.opacity=Math.min(1,Math.max(k.opacity,0)));let da=null!=(J=k.fill)?J:c.props.fill;void 0===da||qf(da)||"var(--ls-secondary-background-color)"===da||k.noFill||!Zl.includes(c.props.type)||(c=TC(.3,da),k.stroke=c);return k}function Hn({strokeWidth:c,size:k,mode:J}){return"svg"===J?(0,hy.jsx)("rect",{className:"tl-binding-indicator",x:c,y:c,rx:2,ry:2,width:Math.max(0,k[0]-2*c),height:Math.max(0,
k[1]-2*c),strokeWidth:4*c}):(0,hy.jsx)("div",{className:"tl-binding-indicator",style:{position:"absolute",left:0,top:0,right:0,bottom:0,boxShadow:"0 0 0 4px var(--tl-binding)",borderRadius:4}})}function an(){const c=Le();return"panning"===c.inputs.state||"pinching"===c.inputs.state}function pl({left:c,middle:k,right:J,stroke:da,strokeWidth:qa}){return(0,Ou.jsxs)("g",{children:[(0,Ou.jsx)("path",{className:"tl-stroke-hitarea",d:`M ${c} L ${k} ${J}`}),(0,Ou.jsx)("path",{d:`M ${c} L ${k} ${J}`,fill:"none",
stroke:da,strokeWidth:qa,strokeLinecap:"round",strokeLinejoin:"round",pointerEvents:"none"})]})}function el(c,k,J){k=P(c,k,c,J).points;if(!k)return console.warn("Could not find an intersection for the arrow head."),{left:c,right:c};k=(J=k[0])?Rd.rotWith(J,c,Math.PI/6):c;c=J?Rd.rotWith(J,c,-Math.PI/6):c;return{left:k,right:c}}function mj(c,k,J){const {left:da,right:qa}=el(c,k,J);return`M ${da} L ${c} ${qa}`}function po(c,k,J,da,qa){c=c.strokeWidth;var Ca=Rd.dist(k,J);c=Math.min(Ca/3,16*c);Ca=[];Ca.push(`M ${k} L ${J}`);
da&&Ca.push(mj(k,J,c));qa&&Ca.push(mj(J,k,c));return Ca.join(" ")}function hl({id:c,bounds:k,labelSize:J,offset:da,scale:qa=1}){return(0,Ts.jsx)("defs",{children:(0,Ts.jsxs)("mask",{id:c+"_clip",children:[(0,Ts.jsx)("rect",{x:-100,y:-100,width:k.width+200,height:k.height+200,fill:"white"}),(0,Ts.jsx)("rect",{x:k.width/2-J[0]/2*qa+((null==da?void 0:da[0])||0),y:k.height/2-J[1]/2*qa+((null==da?void 0:da[1])||0),width:J[0]*qa,height:J[1]*qa,rx:4*qa,ry:4*qa,fill:"black"})]})})}function tp(c,k,J,da=qa=>
qa){return c*da(.5-k*(.5-J))}function eq(c){return[-c[0],-c[1]]}function ji(c,k){return[c[0]+k[0],c[1]+k[1]]}function Ei(c,k){return[c[0]-k[0],c[1]-k[1]]}function il(c,k){return[c[0]*k,c[1]*k]}function Kn(c){return[c[1],-c[0]]}function Hm(c,k){return c[0]===k[0]&&c[1]===k[1]}function ln(c){return c[0]*c[0]+c[1]*c[1]}function Jn(c){var k=Math.hypot(c[0],c[1]);return[c[0]/k,c[1]/k]}function gl(c,k){return Math.hypot(c[1]-k[1],c[0]-k[0])}function uk(c,k,J){let da=Math.sin(J);J=Math.cos(J);let qa=c[0]-
k[0];c=c[1]-k[1];return[qa*J-c*da+k[0],qa*da+c*J+k[1]]}function Vk(c,k,J){return ji(c,il(Ei(k,c),J))}function Km(c,k,J){return ji(c,il(k,J))}function mn(c,k={}){let {size:J=16,smoothing:da=.5,thinning:qa=.5,simulatePressure:Ca=!0,easing:Ia=Af=>Af,start:bb={},end:rb={},last:Pb=!1}=k,{cap:jc=!0,easing:yc=Af=>Af*(2-Af)}=bb,{cap:Rc=!0,easing:jd=Af=>--Af*Af*Af+1}=rb;if(0===c.length||0>=J)return[];var fd=c[c.length-1].runningLength;let xd=!1===bb.taper?0:!0===bb.taper?Math.max(J,fd):bb.taper,Fd=!1===rb.taper?
0:!0===rb.taper?Math.max(J,fd):rb.taper;var Xc=Math.pow(J*da,2);k=[];let id=[];var nd=c.slice(0,10).reduce((Af,rf)=>{var Zf=rf.pressure;Ca&&(rf=Iq(1,rf.distance/J),Zf=Iq(1,1-rf),Zf=Iq(1,Af+.275*(Zf-Af)*rf));return(Af+Zf)/2},c[0].pressure),Gd=tp(J,qa,c[c.length-1].pressure,Ia),wd;let Ge=c[0].vector;var Je=c[0].point;let ag=Je;var af=Je;let Sf=ag;var Bh=!1;for(var Tg=0;Tg<c.length;Tg++){var {pressure:zg}=c[Tg];let {point:Af,vector:rf,distance:Zf,runningLength:hh}=c[Tg];if(Tg<c.length-1&&3>fd-hh)continue;
qa?(Ca&&(Gd=Iq(1,Zf/J),zg=Iq(1,1-Gd),zg=Iq(1,nd+.275*(zg-nd)*Gd)),Gd=tp(J,qa,zg,Ia)):Gd=J/2;void 0===wd&&(wd=Gd);var dh=hh<xd?yc(hh/xd):1,uf=fd-hh<Fd?jd((fd-hh)/Fd):1;Gd=Math.max(.01,Gd*Math.min(dh,uf));uf=(Tg<c.length-1?c[Tg+1]:c[Tg]).vector;let Lh=Tg<c.length-1?rf[0]*uf[0]+rf[1]*uf[1]:1;dh=null!==Lh&&0>Lh;if(0>rf[0]*Ge[0]+rf[1]*Ge[1]&&!Bh||dh){Je=il(Kn(Ge),Gd);for(let Oi=1/13,Vh=0;1>=Vh;Vh+=Oi)af=uk(Ei(Af,Je),Af,Lr*Vh),k.push(af),Sf=uk(ji(Af,Je),Af,Lr*-Vh),id.push(Sf);Je=af;ag=Sf;dh&&(Bh=!0)}else(Bh=
!1,Tg===c.length-1)?(zg=il(Kn(rf),Gd),k.push(Ei(Af,zg)),id.push(ji(Af,zg))):(nd=il(Kn(Vk(uf,rf,Lh)),Gd),af=Ei(Af,nd),(1>=Tg||ln(Ei(Je,af))>Xc)&&(k.push(af),Je=af),Sf=ji(Af,nd),(1>=Tg||ln(Ei(ag,Sf))>Xc)&&(id.push(Sf),ag=Sf),nd=zg,Ge=rf)}fd=c[0].point.slice(0,2);Xc=1<c.length?c[c.length-1].point.slice(0,2):ji(c[0].point,[1,1]);af=[];Bh=[];if(1===c.length){if(!xd&&!Fd||Pb){c=Km(fd,Jn(Kn(Ei(fd,Xc))),-(wd||Gd));k=[];for(let Af=1/13,rf=Af;1>=rf;rf+=Af)k.push(uk(c,fd,2*Lr*rf));return k}}else{if(!(xd||Fd&&
1===c.length))if(jc)for(let Af=1/13,rf=Af;1>=rf;rf+=Af)wd=uk(id[0],fd,Lr*rf),af.push(wd);else Tg=Ei(k[0],id[0]),wd=il(Tg,.5),Tg=il(Tg,.51),af.push(Ei(fd,wd),Ei(fd,Tg),ji(fd,Tg),ji(fd,wd));wd=Kn(eq(c[c.length-1].vector));if(Fd||xd&&1===c.length)Bh.push(Xc);else if(Rc){c=Km(Xc,wd,Gd);for(let Af=1/29,rf=Af;1>rf;rf+=Af)Bh.push(uk(c,Xc,3*Lr*rf))}else Bh.push(ji(Xc,il(wd,Gd)),ji(Xc,il(wd,.99*Gd)),Ei(Xc,il(wd,.99*Gd)),Ei(Xc,il(wd,Gd)))}return k.concat(Bh,id.reverse(),af)}function Lm(c,k={}){var J;let {streamline:da=
.5,size:qa=16,last:Ca=!1}=k;if(0===c.length)return[];k=.15+.85*(1-da);c=Array.isArray(c[0])?c:c.map(({x:yc,y:Rc,pressure:jd=.5})=>[yc,Rc,jd]);if(2===c.length){var Ia=c[1];c=c.slice(0,-1);for(var bb=1;5>bb;bb++)c.push(Vk(c[0],Ia,bb/4))}1===c.length&&(c=[...c,[...ji(c[0],[1,1]),...c[0].slice(2)]]);Ia=[{point:[c[0][0],c[0][1]],pressure:0<=c[0][2]?c[0][2]:.25,vector:[1,1],distance:0,runningLength:0}];bb=!1;let rb=0,Pb=Ia[0],jc=c.length-1;for(let yc=1;yc<c.length;yc++){let Rc=Ca&&yc===jc?c[yc].slice(0,
2):Vk(Pb.point,c[yc],k);if(Hm(Pb.point,Rc))continue;let jd=gl(Rc,Pb.point);if(rb+=jd,yc<jc&&!bb){if(rb<qa)continue;bb=!0}Pb={point:Rc,pressure:0<=c[yc][2]?c[yc][2]:.5,vector:Jn(Ei(Pb.point,Rc)),distance:jd,runningLength:rb};Ia.push(Pb)}return Ia[0].vector=(null==(J=Ia[1])?void 0:J.vector)||[0,0],Ia}function Pl(c,k=4/3){return(new Ws(c)).exportAsSVG(k)}function Ql(c,k=4/3){return(new Ws(c)).generatePreviewJsx(void 0,k)}function Jk({id:c,type:k,onRemove:J,showContent:da}){const qa=Le(),{handlers:Ca}=
Sx.default.useContext(Si),Ia=Ca.t;return(0,yj.jsxs)("div",{className:"tl-shape-links-panel-item color-level relative",children:[(0,yj.jsx)("div",{className:"whitespace-pre break-all overflow-hidden text-ellipsis inline-flex",children:(0,yj.jsx)(Tx,{id:c,showReferenceContent:da})}),(0,yj.jsx)("div",{className:"flex-1"}),Ca.getBlockPageName(c)!==qa.currentPage.name&&(0,yj.jsx)(ei,{tooltip:Ia("whiteboard/open-page"),type:"button",onClick:()=>null==Ca?void 0:Ca.redirectToPage(c),children:(0,yj.jsx)(mh,
{name:"open-as-page"})}),(0,yj.jsx)(ei,{tooltip:Ia("whiteboard/open-page-in-sidebar"),type:"button",onClick:()=>null==Ca?void 0:Ca.sidebarAddBlock(c,"B"===k?"block":"page"),children:(0,yj.jsx)(mh,{name:"move-to-sidebar-right"})}),J&&(0,yj.jsx)(ei,{className:"tl-shape-links-panel-item-remove-button",tooltip:Ia("whiteboard/remove-link"),type:"button",onClick:J,children:(0,yj.jsx)(mh,{name:"x",className:"!translate-y-0"})})]})}function Mi({options:c,value:k,onValueChange:J}){return(0,Xn.jsx)(Nq.ToggleGroup,
{type:"single",value:k,onValueChange:J,children:c.map(da=>(0,Xn.jsx)(Uh,{content:da.tooltip,children:(0,Xn.jsx)("div",{className:"inline-flex",children:(0,Xn.jsx)(Nq.ToggleGroupItem,{className:"tl-button",value:da.value,disabled:da.value===k,children:(0,Xn.jsx)(mh,{name:da.icon})})})},da.value))})}function Mn({options:c,value:k,onValueChange:J}){return(0,Xn.jsx)(Nq.ToggleGroup,{className:"inline-flex",type:"multiple",value:k,onValueChange:J,children:c.map(da=>(0,Xn.jsx)(Nq.ToggleGroupItem,{className:"tl-button",
value:da.value,children:(0,Xn.jsx)(mh,{name:da.icon})},da.value))})}function Wk(c){return Le().selectedShapesArray.filter(k=>!k.props.isLocked).filter(k=>{var J;return null==(J=pk[k.props.type])?void 0:J.includes(c)})}function Xk(c){var k;c=c.match(/\.[0-9a-z]+$/i);if(!c)return"unknown";const J=c[0].toLowerCase();[c]=null!=(k=Object.entries(Dy).find(([,da])=>da.includes(J)))?k:["unknown",null];return c}function Yk(...c){return(...k)=>z(this,null,function*(){for(const J of c){const da=yield J(...k);
if(da&&0<da.length)return da}return null})}function qo(c,k){return z(this,null,function*(){return c.types.includes(k)?c instanceof DataTransfer?c.getData(k):yield(yield c.getType(k)).text():null})}function Ej(){const {handlers:c}=Sr.useContext(Si);return Sr.useCallback((k,J)=>z(this,null,function*(){if(J.shiftKey&&1===k.selectedShapesArray.length){var da=yield navigator.clipboard.read();let qa;0<da.length&&(da=(yield(yield da[0].getType("text/plain")).text()).trim())&&(/^\(\(.*\)\)$/.test(da)&&40===
da.length?(da=da.slice(2,-2),sg(da)&&(qa=da)):/^\[\[.*\]\]$/.test(da)&&(qa=da.slice(2,-2)));if(qa){k.selectedShapesArray[0].update({refs:[qa]});k.persist();return}}at(k,J,c)}),[])}function Rl(){const c=Ej();return $s.useCallback((k,J)=>z(this,[k,J],function*(da,{dataTransfer:qa,point:Ca}){c(da,{point:Ca,shiftKey:!1,dataTransfer:qa,fromDrop:!0})}),[])}function up(){const {handlers:c}=Ey.useContext(Si);return Ey.useCallback((k,{text:J,html:da})=>{c.copyToClipboard(J,da)},[])}function zl(){return dv.default.useCallback(c=>
z(this,null,function*(){setTimeout(()=>{c.transition("logseq-portal").selectedTool.transition("creating")},100)}),[])}var nn=Object.create,Al=Object.defineProperty,Nn=Object.defineProperties,Mm=Object.getOwnPropertyDescriptor,On=Object.getOwnPropertyDescriptors,ro=Object.getOwnPropertyNames,pm=Object.getOwnPropertySymbols,so=Object.getPrototypeOf,xj=Object.prototype.hasOwnProperty,on=Object.prototype.propertyIsEnumerable,Sl=(c,k,J)=>k in c?Al(c,k,{enumerable:!0,configurable:!0,writable:!0,value:J}):
c[k]=J,tf=(c,k)=>{for(var J in k||={})xj.call(k,J)&&Sl(c,J,k[J]);if(pm)for(J of pm(k))on.call(k,J)&&Sl(c,J,k[J]);return c},gg=(c,k)=>Nn(c,On(k)),hj=(c,k)=>{var J={},da;for(da in c)xj.call(c,da)&&0>k.indexOf(da)&&(J[da]=c[da]);if(null!=c&&pm)for(da of pm(c))0>k.indexOf(da)&&on.call(c,da)&&(J[da]=c[da]);return J},nk=(c,k)=>function(){return k||(0,c[ro(c)[0]])((k={exports:{}}).exports,k),k.exports},Qi=(c,k,J,da)=>{if(k&&"object"===typeof k||"function"===typeof k)for(let qa of ro(k))xj.call(c,qa)||qa===
J||Al(c,qa,{get:()=>k[qa],enumerable:!(da=Mm(k,qa))||da.enumerable});return c},Uf=(c,k,J)=>(J=null!=c?nn(so(c)):{},Qi(!k&&c&&c.__esModule?J:Al(J,"default",{value:c,enumerable:!0}),c)),pe=(c,k,J,da)=>{for(var qa=1<da?void 0:da?Mm(k,J):k,Ca=c.length-1,Ia;0<=Ca;Ca--)if(Ia=c[Ca])qa=(da?Ia(k,J,qa):Ia(qa))||qa;da&&qa&&Al(k,J,qa);return qa},vb=(c,k,J)=>{Sl(c,"symbol"!==typeof k?k+"":k,J);return J},z=(c,k,J)=>new Promise((da,qa)=>{var Ca=rb=>{try{bb(J.next(rb))}catch(Pb){qa(Pb)}},Ia=rb=>{try{bb(J.throw(rb))}catch(Pb){qa(Pb)}},
bb=rb=>rb.done?da(rb.value):Promise.resolve(rb.value).then(Ca,Ia);bb((J=J.apply(c,k)).next())}),ba=nk({["../../node_modules/rbush/rbush.min.js"](c,k){!function(J,da){"object"==typeof c&&"undefined"!=typeof k?k.exports=da():"function"==typeof define&&define.amd?define(da):(J=J||self).RBush=da()}(c,function(){function J(Xc,id,nd,Gd,wd){!function Tg(Je,ag,af,Sf,Bh){for(;Sf>af;){if(600<Sf-af){var zg=Sf-af+1,dh=ag-af+1,uf=Math.log(zg),Af=.5*Math.exp(2*uf/3);uf=.5*Math.sqrt(uf*Af*(zg-Af)/zg)*(0>dh-zg/2?
-1:1);Tg(Je,ag,Math.max(af,Math.floor(ag-dh*Af/zg+uf)),Math.min(Sf,Math.floor(ag+(zg-dh)*Af/zg+uf)),Bh)}zg=Je[ag];dh=af;Af=Sf;da(Je,af,ag);for(0<Bh(Je[Sf],zg)&&da(Je,af,Sf);dh<Af;){da(Je,dh,Af);dh++;for(Af--;0>Bh(Je[dh],zg);)dh++;for(;0<Bh(Je[Af],zg);)Af--}0===Bh(Je[af],zg)?da(Je,af,Af):da(Je,++Af,Sf);Af<=ag&&(af=Af+1);ag<=Af&&(Sf=Af-1)}}(Xc,id,nd||0,Gd||Xc.length-1,wd||qa)}function da(Xc,id,nd){var Gd=Xc[id];Xc[id]=Xc[nd];Xc[nd]=Gd}function qa(Xc,id){return Xc<id?-1:Xc>id?1:0}function Ca(Xc,id){Ia(Xc,
0,Xc.children.length,id,Xc)}function Ia(Xc,id,nd,Gd,wd){wd||=fd(null);wd.minX=1/0;wd.minY=1/0;wd.maxX=-1/0;for(wd.maxY=-1/0;id<nd;id++){var Ge=Xc.children[id];bb(wd,Xc.leaf?Gd(Ge):Ge)}return wd}function bb(Xc,id){return Xc.minX=Math.min(Xc.minX,id.minX),Xc.minY=Math.min(Xc.minY,id.minY),Xc.maxX=Math.max(Xc.maxX,id.maxX),Xc.maxY=Math.max(Xc.maxY,id.maxY),Xc}function rb(Xc,id){return Xc.minX-id.minX}function Pb(Xc,id){return Xc.minY-id.minY}function jc(Xc){return(Xc.maxX-Xc.minX)*(Xc.maxY-Xc.minY)}
function yc(Xc){return Xc.maxX-Xc.minX+(Xc.maxY-Xc.minY)}function Rc(Xc,id){return Xc.minX<=id.minX&&Xc.minY<=id.minY&&id.maxX<=Xc.maxX&&id.maxY<=Xc.maxY}function jd(Xc,id){return id.minX<=Xc.maxX&&id.minY<=Xc.maxY&&id.maxX>=Xc.minX&&id.maxY>=Xc.minY}function fd(Xc){return{children:Xc,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function xd(Xc,id,nd,Gd,wd){for(var Ge=[id,nd];Ge.length;)if(!((nd=Ge.pop())-(id=Ge.pop())<=Gd)){var Je=id+Math.ceil((nd-id)/Gd/2)*Gd;J(Xc,Je,id,nd,wd);Ge.push(id,
Je,Je,nd)}}var Fd=function(Xc){void 0===Xc&&(Xc=9);this._maxEntries=Math.max(4,Xc);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));this.clear()};return Fd.prototype.all=function(){return this._all(this.data,[])},Fd.prototype.search=function(Xc){var id=this.data,nd=[];if(!jd(Xc,id))return nd;for(var Gd=this.toBBox,wd=[];id;){for(var Ge=0;Ge<id.children.length;Ge++){var Je=id.children[Ge],ag=id.leaf?Gd(Je):Je;jd(Xc,ag)&&(id.leaf?nd.push(Je):Rc(Xc,ag)?this._all(Je,nd):wd.push(Je))}id=wd.pop()}return nd},
Fd.prototype.collides=function(Xc){var id=this.data;if(!jd(Xc,id))return!1;for(var nd=[];id;){for(var Gd=0;Gd<id.children.length;Gd++){var wd=id.children[Gd],Ge=id.leaf?this.toBBox(wd):wd;if(jd(Xc,Ge)){if(id.leaf||Rc(Xc,Ge))return!0;nd.push(wd)}}id=nd.pop()}return!1},Fd.prototype.load=function(Xc){if(!Xc||!Xc.length)return this;if(Xc.length<this._minEntries){for(var id=0;id<Xc.length;id++)this.insert(Xc[id]);return this}Xc=this._build(Xc.slice(),0,Xc.length-1,0);this.data.children.length?this.data.height===
Xc.height?this._splitRoot(this.data,Xc):(this.data.height<Xc.height&&(id=this.data,this.data=Xc,Xc=id),this._insert(Xc,this.data.height-Xc.height-1,!0)):this.data=Xc;return this},Fd.prototype.insert=function(Xc){return Xc&&this._insert(Xc,this.data.height-1),this},Fd.prototype.clear=function(){return this.data=fd([]),this},Fd.prototype.remove=function(Xc,id){if(!Xc)return this;for(var nd,Gd,wd,Ge=this.data,Je=this.toBBox(Xc),ag=[],af=[];Ge||ag.length;){if(Ge||(Ge=ag.pop(),Gd=ag[ag.length-1],nd=af.pop(),
wd=!0),Ge.leaf){a:{var Sf=Xc;var Bh=Ge.children,Tg=id;if(Tg){for(var zg=0;zg<Bh.length;zg++)if(Tg(Sf,Bh[zg])){Sf=zg;break a}Sf=-1}else Sf=Bh.indexOf(Sf)}if(-1!==Sf)return Ge.children.splice(Sf,1),ag.push(Ge),this._condense(ag),this}wd||Ge.leaf||!Rc(Ge,Je)?Gd?(nd++,Ge=Gd.children[nd],wd=!1):Ge=null:(ag.push(Ge),af.push(nd),nd=0,Gd=Ge,Ge=Ge.children[0])}return this},Fd.prototype.toBBox=function(Xc){return Xc},Fd.prototype.compareMinX=function(Xc,id){return Xc.minX-id.minX},Fd.prototype.compareMinY=
function(Xc,id){return Xc.minY-id.minY},Fd.prototype.toJSON=function(){return this.data},Fd.prototype.fromJSON=function(Xc){return this.data=Xc,this},Fd.prototype._all=function(Xc,id){for(var nd=[];Xc;)Xc.leaf?id.push.apply(id,Xc.children):nd.push.apply(nd,Xc.children),Xc=nd.pop();return id},Fd.prototype._build=function(Xc,id,nd,Gd){var wd,Ge=nd-id+1,Je=this._maxEntries;if(Ge<=Je)return Ca(wd=fd(Xc.slice(id,nd+1)),this.toBBox),wd;Gd||(Gd=Math.ceil(Math.log(Ge)/Math.log(Je)),Je=Math.ceil(Ge/Math.pow(Je,
Gd-1)));(wd=fd([])).leaf=!1;wd.height=Gd;Ge=Math.ceil(Ge/Je);Je=Ge*Math.ceil(Math.sqrt(Je));for(xd(Xc,id,nd,Je,this.compareMinX);id<=nd;id+=Je){var ag=Math.min(id+Je-1,nd);xd(Xc,id,ag,Ge,this.compareMinY);for(var af=id;af<=ag;af+=Ge)wd.children.push(this._build(Xc,af,Math.min(af+Ge-1,ag),Gd-1))}return Ca(wd,this.toBBox),wd},Fd.prototype._chooseSubtree=function(Xc,id,nd,Gd){for(;Gd.push(id),!id.leaf&&Gd.length-1!==nd;){for(var wd=1/0,Ge=1/0,Je=void 0,ag=0;ag<id.children.length;ag++){var af=id.children[ag],
Sf=jc(af),Bh=(Tg=Xc,zg=af,(Math.max(zg.maxX,Tg.maxX)-Math.min(zg.minX,Tg.minX))*(Math.max(zg.maxY,Tg.maxY)-Math.min(zg.minY,Tg.minY))-Sf);Bh<Ge?(Ge=Bh,wd=Sf<wd?Sf:wd,Je=af):Bh===Ge&&Sf<wd&&(wd=Sf,Je=af)}id=Je||id.children[0]}var Tg,zg;return id},Fd.prototype._insert=function(Xc,id,nd){nd=nd?Xc:this.toBBox(Xc);var Gd=[],wd=this._chooseSubtree(nd,this.data,id,Gd);wd.children.push(Xc);for(bb(wd,nd);0<=id&&Gd[id].children.length>this._maxEntries;)this._split(Gd,id),id--;this._adjustParentBBoxes(nd,Gd,
id)},Fd.prototype._split=function(Xc,id){var nd=Xc[id],Gd=nd.children.length,wd=this._minEntries;this._chooseSplitAxis(nd,wd,Gd);Gd=this._chooseSplitIndex(nd,wd,Gd);Gd=fd(nd.children.splice(Gd,nd.children.length-Gd));Gd.height=nd.height;Gd.leaf=nd.leaf;Ca(nd,this.toBBox);Ca(Gd,this.toBBox);id?Xc[id-1].children.push(Gd):this._splitRoot(nd,Gd)},Fd.prototype._splitRoot=function(Xc,id){this.data=fd([Xc,id]);this.data.height=Xc.height+1;this.data.leaf=!1;Ca(this.data,this.toBBox)},Fd.prototype._chooseSplitIndex=
function(Xc,id,nd){for(var Gd,wd,Ge,Je,ag,af,Sf,Bh=1/0,Tg=1/0,zg=id;zg<=nd-id;zg++){var dh=Ia(Xc,0,zg,this.toBBox),uf=Ia(Xc,zg,nd,this.toBBox),Af=(wd=dh,Ge=uf,Je=void 0,ag=void 0,af=void 0,Sf=void 0,Je=Math.max(wd.minX,Ge.minX),ag=Math.max(wd.minY,Ge.minY),af=Math.min(wd.maxX,Ge.maxX),Sf=Math.min(wd.maxY,Ge.maxY),Math.max(0,af-Je)*Math.max(0,Sf-ag));dh=jc(dh)+jc(uf);Af<Bh?(Bh=Af,Gd=zg,Tg=dh<Tg?dh:Tg):Af===Bh&&dh<Tg&&(Tg=dh,Gd=zg)}return Gd||nd-id},Fd.prototype._chooseSplitAxis=function(Xc,id,nd){var Gd=
Xc.leaf?this.compareMinX:rb,wd=Xc.leaf?this.compareMinY:Pb;this._allDistMargin(Xc,id,nd,Gd)<this._allDistMargin(Xc,id,nd,wd)&&Xc.children.sort(Gd)},Fd.prototype._allDistMargin=function(Xc,id,nd,Gd){Xc.children.sort(Gd);Gd=this.toBBox;for(var wd=Ia(Xc,0,id,Gd),Ge=Ia(Xc,nd-id,nd,Gd),Je=yc(wd)+yc(Ge),ag=id;ag<nd-id;ag++){var af=Xc.children[ag];bb(wd,Xc.leaf?Gd(af):af);Je+=yc(wd)}for(nd=nd-id-1;nd>=id;nd--)wd=Xc.children[nd],bb(Ge,Xc.leaf?Gd(wd):wd),Je+=yc(Ge);return Je},Fd.prototype._adjustParentBBoxes=
function(Xc,id,nd){for(;0<=nd;nd--)bb(id[nd],Xc)},Fd.prototype._condense=function(Xc){for(var id=Xc.length-1,nd=void 0;0<=id;id--)0===Xc[id].children.length?0<id?(nd=Xc[id-1].children).splice(nd.indexOf(Xc[id]),1):this.clear():Ca(Xc[id],this.toBBox)},Fd})}}),ya=nk({["../../node_modules/fast-deep-equal/index.js"](c,k){k.exports=function Ca(da,qa){if(da===qa)return!0;if(da&&qa&&"object"==typeof da&&"object"==typeof qa){if(da.constructor!==qa.constructor)return!1;var Ia;if(Array.isArray(da)){var bb=
da.length;if(bb!=qa.length)return!1;for(Ia=bb;0!==Ia--;)if(!Ca(da[Ia],qa[Ia]))return!1;return!0}if(da.constructor===RegExp)return da.source===qa.source&&da.flags===qa.flags;if(da.valueOf!==Object.prototype.valueOf)return da.valueOf()===qa.valueOf();if(da.toString!==Object.prototype.toString)return da.toString()===qa.toString();var rb=Object.keys(da);bb=rb.length;if(bb!==Object.keys(qa).length)return!1;for(Ia=bb;0!==Ia--;)if(!Object.prototype.hasOwnProperty.call(qa,rb[Ia]))return!1;for(Ia=bb;0!==Ia--;)if(bb=
rb[Ia],!Ca(da[bb],qa[bb]))return!1;return!0}return da!==da&&qa!==qa}}}),wa=nk({["../../../../node_modules/deepmerge/dist/cjs.js"](c,k){function J(yc,Rc){return!1!==Rc.clone&&Rc.isMergeableObject(yc)?rb(Array.isArray(yc)?[]:{},yc,Rc):yc}function da(yc,Rc,jd){return yc.concat(Rc).map(function(fd){return J(fd,jd)})}function qa(yc){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(yc).filter(function(Rc){return Object.propertyIsEnumerable.call(yc,Rc)}):[]}function Ca(yc){return Object.keys(yc).concat(qa(yc))}
function Ia(yc,Rc){try{return Rc in yc}catch(jd){return!1}}function bb(yc,Rc,jd){var fd={};jd.isMergeableObject(yc)&&Ca(yc).forEach(function(xd){fd[xd]=J(yc[xd],jd)});Ca(Rc).forEach(function(xd){if(!Ia(yc,xd)||Object.hasOwnProperty.call(yc,xd)&&Object.propertyIsEnumerable.call(yc,xd))if(Ia(yc,xd)&&jd.isMergeableObject(Rc[xd])){if(jd.customMerge){var Fd=jd.customMerge(xd);Fd="function"===typeof Fd?Fd:rb}else Fd=rb;fd[xd]=Fd(yc[xd],Rc[xd],jd)}else fd[xd]=J(Rc[xd],jd)});return fd}function rb(yc,Rc,jd){jd=
jd||{};jd.arrayMerge=jd.arrayMerge||da;jd.isMergeableObject=jd.isMergeableObject||Pb;jd.cloneUnlessOtherwiseSpecified=J;var fd=Array.isArray(Rc),xd=Array.isArray(yc);return fd!==xd?J(Rc,jd):fd?jd.arrayMerge(yc,Rc,jd):bb(yc,Rc,jd)}var Pb=function(yc){var Rc;if(Rc=!!yc&&"object"===typeof yc)Rc=Object.prototype.toString.call(yc),Rc=!("[object RegExp]"===Rc||"[object Date]"===Rc||yc.$$typeof===jc);return Rc},jc="function"===typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;rb.all=function(yc,
Rc){if(!Array.isArray(yc))throw Error("first argument should be an array");return yc.reduce(function(jd,fd){return rb(jd,fd,Rc)},{})};k.exports=rb}}),La={};((c,k)=>{for(var J in k)Al(c,J,{get:k[J],enumerable:!0})})(La,{App:()=>Gy,PreviewManager:()=>Ws,generateJSXFromModel:()=>Ql,generateSVGFromModel:()=>Pl});Ya.exports=(c=>Qi(Al({},"__esModule",{value:!0}),c))(La);var lb=(c=>{c.Yellow="yellow";c.Red="red";c.Pink="pink";c.Green="green";c.Blue="blue";c.Purple="purple";c.Gray="gray";c.Default="";return c})(lb||
{}),Eb=(c=>{c.Box="box";c.Ellipse="ellipse";c.Polygon="polygon";return c})(Eb||{}),Nb,oc=new Uint8Array(16),ad=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,kd=[];for(let c=0;256>c;++c)kd.push((c+256).toString(16).slice(1));var Td,Xd,ae=0,Se=0,Ff=function(c,k,J){J=k&&J||0;const da=k||Array(16);c=c||{};let qa=c.node||Td;var Ca=void 0!==c.clockseq?c.clockseq:Xd;if(null==qa||null==Ca){var Ia=c.random||(c.rng||x)();null==qa&&(qa=
Td=[Ia[0]|1,Ia[1],Ia[2],Ia[3],Ia[4],Ia[5]]);null==Ca&&(Ca=Xd=(Ia[6]<<8|Ia[7])&16383)}Ia=void 0!==c.msecs?c.msecs:Date.now();let bb=void 0!==c.nsecs?c.nsecs:Se+1;const rb=Ia-ae+(bb-Se)/1E4;0>rb&&void 0===c.clockseq&&(Ca=Ca+1&16383);(0>rb||Ia>ae)&&void 0===c.nsecs&&(bb=0);if(1E4<=bb)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");ae=Ia;Se=bb;Xd=Ca;Ia+=122192928E5;c=(1E4*(Ia&268435455)+bb)%4294967296;da[J++]=c>>>24&255;da[J++]=c>>>16&255;da[J++]=c>>>8&255;da[J++]=c&255;c=Ia/4294967296*
1E4&268435455;da[J++]=c>>>8&255;da[J++]=c&255;da[J++]=c>>>24&15|16;da[J++]=c>>>16&255;da[J++]=Ca>>>8|128;da[J++]=Ca&255;for(Ca=0;6>Ca;++Ca)da[J+Ca]=qa[Ca];return k||W(da)},Nf=class{static clamp(c,k,J){return Math.max(k,"undefined"!==typeof J?Math.min(c,J):c)}static clampV(c,k,J){return c.map(da=>J?Nf.clamp(da,k,J):Nf.clamp(da,k))}static cross(c,k,J){return(k[0]-c[0])*(J[1]-c[1])-(J[0]-c[0])*(k[1]-c[1])}static snap(c,k=1){return[Math.round(c[0]/k)*k,Math.round(c[1]/k)*k]}},Ld=Nf;Ld.neg=c=>[-c[0],-c[1]];
Ld.add=(c,k)=>[c[0]+k[0],c[1]+k[1]];Ld.addScalar=(c,k)=>[c[0]+k,c[1]+k];Ld.sub=(c,k)=>[c[0]-k[0],c[1]-k[1]];Ld.subScalar=(c,k)=>[c[0]-k,c[1]-k];Ld.vec=(c,k)=>[k[0]-c[0],k[1]-c[1]];Ld.mul=(c,k)=>[c[0]*k,c[1]*k];Ld.mulV=(c,k)=>[c[0]*k[0],c[1]*k[1]];Ld.div=(c,k)=>[c[0]/k,c[1]/k];Ld.divV=(c,k)=>[c[0]/k[0],c[1]/k[1]];Ld.per=c=>[c[1],-c[0]];Ld.dpr=(c,k)=>c[0]*k[0]+c[1]*k[1];Ld.cpr=(c,k)=>c[0]*k[1]-k[0]*c[1];Ld.len2=c=>c[0]*c[0]+c[1]*c[1];Ld.len=c=>Math.hypot(c[0],c[1]);Ld.pry=(c,k)=>Nf.dpr(c,k)/Nf.len(k);
Ld.uni=c=>Nf.div(c,Nf.len(c));Ld.normalize=c=>Nf.uni(c);Ld.tangent=(c,k)=>Nf.uni(Nf.sub(c,k));Ld.dist2=(c,k)=>Nf.len2(Nf.sub(c,k));Ld.dist=(c,k)=>Math.hypot(c[1]-k[1],c[0]-k[0]);Ld.fastDist=(c,k)=>{c=[k[0]-c[0],k[1]-c[1]];k=[Math.abs(c[0]),Math.abs(c[1])];let J=1/Math.max(k[0],k[1]);J*=1.29289-(k[0]+k[1])*J*.29289;return[c[0]*J,c[1]*J]};Ld.ang=(c,k)=>Math.atan2(Nf.cpr(c,k),Nf.dpr(c,k));Ld.angle=(c,k)=>Math.atan2(k[1]-c[1],k[0]-c[0]);Ld.med=(c,k)=>Nf.mul(Nf.add(c,k),.5);Ld.rot=(c,k=0)=>[c[0]*Math.cos(k)-
c[1]*Math.sin(k),c[0]*Math.sin(k)+c[1]*Math.cos(k)];Ld.rotWith=(c,k,J=0)=>{if(0===J)return c;const da=Math.sin(J);J=Math.cos(J);const qa=c[0]-k[0];c=c[1]-k[1];return[qa*J-c*da+k[0],qa*da+c*J+k[1]]};Ld.isEqual=(c,k)=>c[0]===k[0]&&c[1]===k[1];Ld.lrp=(c,k,J)=>Nf.add(c,Nf.mul(Nf.sub(k,c),J));Ld.int=(c,k,J,da,qa=1)=>{J=(Nf.clamp(J,da)-J)/(da-J);return Nf.add(Nf.mul(c,1-J),Nf.mul(k,qa))};Ld.ang3=(c,k,J)=>{c=Nf.vec(k,c);k=Nf.vec(k,J);return Nf.ang(c,k)};Ld.abs=c=>[Math.abs(c[0]),Math.abs(c[1])];Ld.rescale=
(c,k)=>{const J=Nf.len(c);return[k*c[0]/J,k*c[1]/J]};Ld.isLeft=(c,k,J)=>(k[0]-c[0])*(J[1]-c[1])-(J[0]-c[0])*(k[1]-c[1]);Ld.clockwise=(c,k,J)=>0<Nf.isLeft(c,k,J);Ld.toFixed=c=>c.map(k=>Math.round(100*k)/100);Ld.nearestPointOnLineThroughPoint=(c,k,J)=>Nf.add(c,Nf.mul(k,Nf.pry(Nf.sub(J,c),k)));Ld.distanceToLineThroughPoint=(c,k,J)=>Nf.dist(J,Nf.nearestPointOnLineThroughPoint(c,k,J));Ld.nearestPointOnLineSegment=(c,k,J,da=!0)=>{const qa=Nf.uni(Nf.sub(k,c));J=Nf.add(c,Nf.mul(qa,Nf.pry(Nf.sub(J,c),qa)));
if(da){if(J[0]<Math.min(c[0],k[0]))return c[0]<k[0]?c:k;if(J[0]>Math.max(c[0],k[0]))return c[0]>k[0]?c:k;if(J[1]<Math.min(c[1],k[1]))return c[1]<k[1]?c:k;if(J[1]>Math.max(c[1],k[1]))return c[1]>k[1]?c:k}return J};Ld.distanceToLineSegment=(c,k,J,da=!0)=>Nf.dist(J,Nf.nearestPointOnLineSegment(c,k,J,da));Ld.nudge=(c,k,J)=>Nf.isEqual(c,k)?c:Nf.add(c,Nf.mul(Nf.uni(Nf.sub(k,c)),J));Ld.nudgeAtAngle=(c,k,J)=>[Math.cos(k)*J+c[0],Math.sin(k)*J+c[1]];Ld.toPrecision=(c,k=4)=>[+c[0].toPrecision(k),+c[1].toPrecision(k)];
Ld.pointsBetween=(c,k,J=6)=>Array.from(Array(J)).map((da,qa)=>{da=qa/(J-1);qa=Math.min(1,.5+Math.abs(.5-da));return[...Nf.lrp(c,k,da),qa]});Ld.slope=(c,k)=>c[0]===k[0]?NaN:(c[1]-k[1])/(c[0]-k[0]);Ld.toAngle=c=>{c=Math.atan2(c[1],c[0]);return 0>c?c+2*Math.PI:c};Ld.max=(...c)=>[Math.max(...c.map(k=>k[0])),Math.max(...c.map(k=>k[1]))];Ld.min=(...c)=>[Math.min(...c.map(k=>k[0])),Math.min(...c.map(k=>k[1]))];var Rd=Ld,Xe=class{static getRectangleSides(c,k,J=0){const da=[c[0]+k[0]/2,c[1]+k[1]/2],qa=Ld.rotWith(c,
da,J),Ca=Ld.rotWith(Ld.add(c,[k[0],0]),da,J),Ia=Ld.rotWith(Ld.add(c,k),da,J);c=Ld.rotWith(Ld.add(c,[0,k[1]]),da,J);return[["top",[qa,Ca]],["right",[Ca,Ia]],["bottom",[Ia,c]],["left",[c,qa]]]}static getBoundsSides(c){return Xe.getRectangleSides([c.minX,c.minY],[c.width,c.height])}static expandBounds(c,k){return{minX:c.minX-k,minY:c.minY-k,maxX:c.maxX+k,maxY:c.maxY+k,width:c.width+2*k,height:c.height+2*k}}static boundsCollide(c,k){return!(c.maxX<k.minX||c.minX>k.maxX||c.maxY<k.minY||c.minY>k.maxY)}static boundsContain(c,
k){return Array.isArray(k)?c.minX<k[0]&&c.minY<k[1]&&c.maxY>k[1]&&c.maxX>k[0]:c.minX<k.minX&&c.minY<k.minY&&c.maxY>k.maxY&&c.maxX>k.maxX}static boundsContained(c,k){return Xe.boundsContain(k,c)}static boundsAreEqual(c,k){return!(k.maxX!==c.maxX||k.minX!==c.minX||k.maxY!==c.maxY||k.minY!==c.minY)}static getBoundsFromPoints(c,k=0){let J=Infinity,da=Infinity,qa=-Infinity,Ca=-Infinity;if(2>c.length)da=J=0,Ca=qa=1;else for(const Ia of c)J=Math.min(Ia[0],J),da=Math.min(Ia[1],da),qa=Math.max(Ia[0],qa),Ca=
Math.max(Ia[1],Ca);return 0!==k?Xe.getBoundsFromPoints(c.map(Ia=>Ld.rotWith(Ia,[(J+qa)/2,(da+Ca)/2],k))):{minX:J,minY:da,maxX:qa,maxY:Ca,width:Math.max(1,qa-J),height:Math.max(1,Ca-da)}}static centerBounds(c,k){const J=Xe.getBoundsCenter(c);return Xe.translateBounds(c,[k[0]-J[0],k[1]-J[1]])}static snapBoundsToGrid(c,k){const J=Math.round(c.minX/k)*k,da=Math.round(c.minY/k)*k,qa=Math.round(c.maxX/k)*k;c=Math.round(c.maxY/k)*k;return{minX:J,minY:da,maxX:qa,maxY:c,width:Math.max(1,qa-J),height:Math.max(1,
c-da)}}static translateBounds(c,k){return{minX:c.minX+k[0],minY:c.minY+k[1],maxX:c.maxX+k[0],maxY:c.maxY+k[1],width:c.width,height:c.height}}static multiplyBounds(c,k){const J=Xe.getBoundsCenter(c);return Xe.centerBounds({minX:c.minX*k,minY:c.minY*k,maxX:c.maxX*k,maxY:c.maxY*k,width:c.width*k,height:c.height*k},[J[0]*k,J[1]*k])}static divideBounds(c,k){const J=Xe.getBoundsCenter(c);return Xe.centerBounds({minX:c.minX/k,minY:c.minY/k,maxX:c.maxX/k,maxY:c.maxY/k,width:c.width/k,height:c.height/k},[J[0]/
k,J[1]/k])}static getRotatedBounds(c,k=0){c=Xe.getRotatedCorners(c,k);let J=k=Infinity,da=-Infinity,qa=-Infinity;for(const Ca of c)k=Math.min(Ca[0],k),J=Math.min(Ca[1],J),da=Math.max(Ca[0],da),qa=Math.max(Ca[1],qa);return{minX:k,minY:J,maxX:da,maxY:qa,width:Math.max(1,da-k),height:Math.max(1,qa-J),rotation:0}}static getRotatedEllipseBounds(c,k,J,da,qa=0){var Ca=Math.cos(qa);const Ia=Math.sin(qa);qa=Math.hypot(J*Ca,da*Ia);Ca=Math.hypot(J*Ia,da*Ca);return{minX:c+J-qa,minY:k+da-Ca,maxX:c+J+qa,maxY:k+
da+Ca,width:2*qa,height:2*Ca}}static getExpandedBounds(c,k){const J=Math.min(c.minX,k.minX),da=Math.min(c.minY,k.minY),qa=Math.max(c.maxX,k.maxX);c=Math.max(c.maxY,k.maxY);return{minX:J,minY:da,maxX:qa,maxY:c,width:Math.abs(qa-J),height:Math.abs(c-da)}}static getCommonBounds(c){if(2>c.length)return c[0];let k=c[0];for(let J=1;J<c.length;J++)k=Xe.getExpandedBounds(k,c[J]);return k}static getRotatedCorners(c,k=0){const J=[c.minX+c.width/2,c.minY+c.height/2];c=[[c.minX,c.minY],[c.maxX,c.minY],[c.maxX,
c.maxY],[c.minX,c.maxY]];return k?c.map(da=>Ld.rotWith(da,J,k)):c}static getTransformedBoundingBox(c,k,J,da=0,qa=!1){const [Ca,Ia]=[c.minX,c.minY],[bb,rb]=[c.maxX,c.maxY];let [Pb,jc]=[c.minX,c.minY],[yc,Rc]=[c.maxX,c.maxY];if("center"===k)return{minX:Pb+J[0],minY:jc+J[1],maxX:yc+J[0],maxY:Rc+J[1],width:yc-Pb,height:Rc-jc,scaleX:1,scaleY:1};const [jd,fd]=Ld.rot(J,-da);switch(k){case "top_edge":case "top_left_corner":case "top_right_corner":jc+=fd;break;case "bottom_edge":case "bottom_left_corner":case "bottom_right_corner":Rc+=
fd}switch(k){case "left_edge":case "top_left_corner":case "bottom_left_corner":Pb+=jd;break;case "right_edge":case "top_right_corner":case "bottom_right_corner":yc+=jd}var xd=bb-Ca;const Fd=rb-Ia;var Xc=(yc-Pb)/xd,id=(Rc-jc)/Fd;c=0>Xc;J=0>id;var nd=Math.abs(yc-Pb),Gd=Math.abs(Rc-jc);if(qa)switch(qa=xd/Fd,xd=qa<nd/Gd,id=1/qa*(0>id?1:-1)*nd,Xc=Gd*(0>Xc?1:-1)*qa,k){case "top_left_corner":xd?jc=Rc+id:Pb=yc+Xc;break;case "top_right_corner":xd?jc=Rc+id:yc=Pb-Xc;break;case "bottom_right_corner":xd?Rc=jc-
id:yc=Pb-Xc;break;case "bottom_left_corner":xd?Rc=jc-id:Pb=yc+Xc;break;case "bottom_edge":case "top_edge":nd=(Pb+yc)/2;Gd*=qa;Pb=nd-Gd/2;yc=nd+Gd/2;break;case "left_edge":case "right_edge":Gd=(jc+Rc)/2,nd/=qa,jc=Gd-nd/2,Rc=Gd+nd/2}if(0!==da%(2*Math.PI)){nd=[0,0];Gd=Ld.med([Ca,Ia],[bb,rb]);Xc=Ld.med([Pb,jc],[yc,Rc]);switch(k){case "top_left_corner":nd=Ld.sub(Ld.rotWith([yc,Rc],Xc,da),Ld.rotWith([bb,rb],Gd,da));break;case "top_right_corner":nd=Ld.sub(Ld.rotWith([Pb,Rc],Xc,da),Ld.rotWith([Ca,rb],Gd,
da));break;case "bottom_right_corner":nd=Ld.sub(Ld.rotWith([Pb,jc],Xc,da),Ld.rotWith([Ca,Ia],Gd,da));break;case "bottom_left_corner":nd=Ld.sub(Ld.rotWith([yc,jc],Xc,da),Ld.rotWith([bb,Ia],Gd,da));break;case "top_edge":nd=Ld.sub(Ld.rotWith(Ld.med([Pb,Rc],[yc,Rc]),Xc,da),Ld.rotWith(Ld.med([Ca,rb],[bb,rb]),Gd,da));break;case "left_edge":nd=Ld.sub(Ld.rotWith(Ld.med([yc,jc],[yc,Rc]),Xc,da),Ld.rotWith(Ld.med([bb,Ia],[bb,rb]),Gd,da));break;case "bottom_edge":nd=Ld.sub(Ld.rotWith(Ld.med([Pb,jc],[yc,jc]),
Xc,da),Ld.rotWith(Ld.med([Ca,Ia],[bb,Ia]),Gd,da));break;case "right_edge":nd=Ld.sub(Ld.rotWith(Ld.med([Pb,jc],[Pb,Rc]),Xc,da),Ld.rotWith(Ld.med([Ca,Ia],[Ca,rb]),Gd,da))}[Pb,jc]=Ld.sub([Pb,jc],nd);[yc,Rc]=Ld.sub([yc,Rc],nd)}yc<Pb&&([yc,Pb]=[Pb,yc]);Rc<jc&&([Rc,jc]=[jc,Rc]);return{minX:Pb,minY:jc,maxX:yc,maxY:Rc,width:yc-Pb,height:Rc-jc,scaleX:(yc-Pb)/(bb-Ca||1)*(c?-1:1),scaleY:(Rc-jc)/(rb-Ia||1)*(J?-1:1)}}static getTransformAnchor(c,k,J){let da=c;switch(c){case "top_left_corner":da=k&&J?"bottom_right_corner":
k?"top_right_corner":J?"bottom_left_corner":"bottom_right_corner";break;case "top_right_corner":da=k&&J?"bottom_left_corner":k?"top_left_corner":J?"bottom_right_corner":"bottom_left_corner";break;case "bottom_right_corner":da=k&&J?"top_left_corner":k?"bottom_left_corner":J?"top_right_corner":"top_left_corner";break;case "bottom_left_corner":da=k&&J?"top_right_corner":k?"bottom_right_corner":J?"top_left_corner":"top_right_corner"}return da}static getRelativeTransformedBoundingBox(c,k,J,da,qa){da=c.minX+
(da?k.maxX-J.maxX:J.minX-k.minX)/k.width*c.width;qa=c.minY+(qa?k.maxY-J.maxY:J.minY-k.minY)/k.height*c.height;const Ca=J.width/k.width*c.width;c=J.height/k.height*c.height;return{minX:da,minY:qa,maxX:da+Ca,maxY:qa+c,width:Ca,height:c}}static getRotatedSize(c,k){const J=Ld.div(c,2);c=[[0,0],[c[0],0],c,[0,c[1]]].map(da=>Ld.rotWith(da,J,k));c=Xe.getBoundsFromPoints(c);return[c.width,c.height]}static getBoundsCenter(c){return[c.minX+c.width/2,c.minY+c.height/2]}static getBoundsWithCenter(c){const k=Xe.getBoundsCenter(c);
return gg(tf({},c),{midX:k[0],midY:k[1]})}static getCommonTopLeft(c){const k=[Infinity,Infinity];c.forEach(J=>{k[0]=Math.min(k[0],J[0]);k[1]=Math.min(k[1],J[1])});return k}static getTLSnapPoints(c,k,J){const da=tf({},c);c=[0,0];const qa=[],Ca={minX:{id:"minX",isSnapped:!1},midX:{id:"midX",isSnapped:!1},maxX:{id:"maxX",isSnapped:!1},minY:{id:"minY",isSnapped:!1},midY:{id:"midY",isSnapped:!1},maxY:{id:"maxY",isSnapped:!1}},Ia=["midX","minX","maxX"],bb=["midY","minY","maxY"];k=k.map(Rc=>{const jd=Ia.flatMap((xd,
Fd)=>Ia.map((Xc,id)=>{const nd=da[xd]-Rc[Xc];return{f:xd,t:Xc,gap:nd,distance:Math.abs(nd),isCareful:0===Fd||3===Fd+id}})),fd=bb.flatMap((xd,Fd)=>bb.map((Xc,id)=>{const nd=da[xd]-Rc[Xc];return{f:xd,t:Xc,gap:nd,distance:Math.abs(nd),isCareful:0===Fd||3===Fd+id}}));return[Rc,jd,fd]});let rb=Infinity,Pb=Infinity,jc=Infinity,yc=Infinity;k.forEach(([,Rc,jd])=>{Rc.forEach(fd=>{fd.distance<J&&fd.distance<jc&&(jc=fd.distance,rb=fd.gap)});jd.forEach(fd=>{fd.distance<J&&fd.distance<yc&&(yc=fd.distance,Pb=fd.gap)})});
k.forEach(([Rc,jd,fd])=>{Infinity!==rb&&jd.forEach(xd=>{2>Math.abs(xd.gap-rb)&&(Ca[xd.f]=gg(tf({},Ca[xd.f]),{isSnapped:!0,to:Rc[xd.t],B:Rc,distance:xd.distance}))});Infinity!==Pb&&fd.forEach(xd=>{2>Math.abs(xd.gap-Pb)&&(Ca[xd.f]=gg(tf({},Ca[xd.f]),{isSnapped:!0,to:Rc[xd.t],B:Rc,distance:xd.distance}))})});c[0]=Infinity===rb?0:rb;c[1]=Infinity===Pb?0:Pb;da.minX-=c[0];da.midX-=c[0];da.maxX-=c[0];da.minY-=c[1];da.midY-=c[1];da.maxY-=c[1];Ia.forEach(Rc=>{Rc=Ca[Rc];if(Rc.isSnapped){var {id:jd,B:fd}=Rc;
Rc=da[jd];qa.push("minX"===jd?[[Rc,da.midY],[Rc,fd.minY],[Rc,fd.maxY]]:[[Rc,da.minY],[Rc,da.maxY],[Rc,fd.minY],[Rc,fd.maxY]])}});bb.forEach(Rc=>{Rc=Ca[Rc];if(Rc.isSnapped){var {id:jd,B:fd}=Rc;Rc=da[jd];qa.push("midY"===jd?[[da.midX,Rc],[fd.minX,Rc],[fd.maxX,Rc]]:[[da.minX,Rc],[da.maxX,Rc],[fd.minX,Rc],[fd.maxX,Rc]])}});return{offset:c,snapLines:qa}}static ensureRatio(c,k){const {width:J,height:da}=c,qa=tf({},c);J/da<k?(qa.width=da*k,qa.maxX+=J-c.width):(qa.height=J/k,qa.maxY+=da-c.height);return qa}static getDistributions(c,
k){var J=c.map(Ca=>{const Ia=Ca.getBounds();return{id:Ca.id,point:[Ia.minX,Ia.minY],bounds:Ia,center:Ca.getCenter()}});c=J.length;var da=Xe.getCommonBounds(J.map(({bounds:Ca})=>Ca));const qa=[];switch(k){case "horizontal":k=J.reduce((Ca,Ia)=>Ca+Ia.bounds.width,0);if(k>da.width){const Ca=J.sort((Pb,jc)=>Pb.bounds.minX-jc.bounds.minX)[0],Ia=J.sort((Pb,jc)=>jc.bounds.maxX-Pb.bounds.maxX)[0];da=J.filter(Pb=>Pb!==Ca&&Pb!==Ia).sort((Pb,jc)=>Pb.center[0]-jc.center[0]);const bb=(Ia.center[0]-Ca.center[0])/
(c-1),rb=Ca.center[0]+bb;da.forEach(({id:Pb,point:jc,bounds:yc},Rc)=>{qa.push({id:Pb,prev:jc,next:[rb+bb*Rc-yc.width/2,yc.minY]})})}else{J=J.sort((bb,rb)=>bb.center[0]-rb.center[0]);let Ca=da.minX;const Ia=(da.width-k)/(c-1);J.forEach(({id:bb,point:rb,bounds:Pb})=>{qa.push({id:bb,prev:rb,next:[Ca,Pb.minY]});Ca+=Pb.width+Ia})}break;case "vertical":if(k=J.reduce((Ca,Ia)=>Ca+Ia.bounds.height,0),k>da.height){const Ca=J.sort((Pb,jc)=>Pb.bounds.minY-jc.bounds.minY)[0],Ia=J.sort((Pb,jc)=>jc.bounds.maxY-
Pb.bounds.maxY)[0];da=J.filter(Pb=>Pb!==Ca&&Pb!==Ia).sort((Pb,jc)=>Pb.center[1]-jc.center[1]);const bb=(Ia.center[1]-Ca.center[1])/(c-1),rb=Ca.center[1]+bb;da.forEach(({id:Pb,point:jc,bounds:yc},Rc)=>{qa.push({id:Pb,prev:jc,next:[yc.minX,rb+bb*Rc-yc.height/2]})})}else{J=J.sort((bb,rb)=>bb.center[1]-rb.center[1]);let Ca=da.minY;const Ia=(da.height-k)/(c-1);J.forEach(({id:bb,point:rb,bounds:Pb})=>{qa.push({id:bb,prev:rb,next:[Pb.minX,Ca]});Ca+=Pb.height+Ia})}}return qa}static getPackedDistributions(c){const k=
Xe.getCommonBounds(c.map(({bounds:qa})=>qa)),J=[k.minX,k.minY],da=Object.fromEntries(c.map(qa=>[qa.id,[qa.bounds.minX,qa.bounds.minY]]));c=c.filter(qa=>{var Ca,Ia,bb,rb;return!((null==(Ia=null==(Ca=qa.props.handles)?void 0:Ca.start)?0:Ia.bindingId)||(null==(rb=null==(bb=qa.props.handles)?void 0:bb.end)?0:rb.bindingId))}).map(qa=>{const Ca=qa.getBounds();return{id:qa.id,w:Ca.width+16,h:Ca.height+16,x:Ca.minX,y:Ca.minY}});B(c);return c.map(({id:qa,x:Ca,y:Ia})=>({id:qa,prev:da[qa],next:[Ca+J[0],Ia+J[1]]}))}},
ki=class{static pointInCircle(c,k,J){return Ld.dist(c,k)<=J}static pointInEllipse(c,k,J,da,qa=0){qa=qa||0;var Ca=Math.cos(qa);qa=Math.sin(qa);k=Ld.sub(c,k);c=Ca*k[0]+qa*k[1];Ca=qa*k[0]-Ca*k[1];return 1>=c*c/(J*J)+Ca*Ca/(da*da)}static pointInRect(c,k){return!(c[0]<k[0]||c[0]>c[0]+k[0]||c[1]<k[1]||c[1]>c[1]+k[1])}static pointInPolygon(c,k){let J=0;k.forEach((da,qa)=>{qa=k[(qa+1)%k.length];da[1]<=c[1]?qa[1]>c[1]&&0<Ld.cross(da,qa,c)&&(J+=1):qa[1]<=c[1]&&0>Ld.cross(da,qa,c)&&--J});return 0!==J}static pointInBounds(c,
k){return!(c[0]<k.minX||c[0]>k.maxX||c[1]<k.minY||c[1]>k.maxY)}static pointInPolyline(c,k,J=3){for(let da=1;da<k.length;da++)if(Ld.distanceToLineSegment(k[da-1],k[da],c)<J)return!0;return!1}static _getSqSegDist(c,k,J){let da=k[0];k=k[1];let qa=J[0]-da,Ca=J[1]-k;if(0!==qa||0!==Ca){const Ia=((c[0]-da)*qa+(c[1]-k)*Ca)/(qa*qa+Ca*Ca);1<Ia?(da=J[0],k=J[1]):0<Ia&&(da+=qa*Ia,k+=Ca*Ia)}qa=c[0]-da;Ca=c[1]-k;return qa*qa+Ca*Ca}static _simplifyStep(c,k,J,da,qa){let Ca=da,Ia=-1;for(let bb=k+1;bb<J;bb++){const rb=
ki._getSqSegDist(c[bb],c[k],c[J]);rb>Ca&&(Ia=bb,Ca=rb)}-1<Ia&&Ca>da&&(1<Ia-k&&ki._simplifyStep(c,k,Ia,da,qa),qa.push(c[Ia]),1<J-Ia&&ki._simplifyStep(c,Ia,J,da,qa))}static simplify2(c,k=1){if(2>=c.length)return c;k*=k;var J=c[0],da=c[1];const qa=[J];for(let Ca=1,Ia=c.length;Ca<Ia;Ca++)da=c[Ca],(da[0]-J[0])*(da[0]-J[0])+(da[1]-J[1])*(da[1]-J[1])>k&&(qa.push(da),J=da);J!==da&&qa.push(da);J=qa.length-1;da=[qa[0]];ki._simplifyStep(qa,0,J,k,da);da.push(qa[J],c[c.length-1]);return da}static pointNearToPolyline(c,
k,J=8){const da=k.length;for(let qa=1;qa<da;qa++)if(Ld.distanceToLineSegment(k[qa-1],k[qa],c)<J)return!0;return!1}},th=ki;vb(th,"simplify",(c,k=1)=>{var J=c.length;const da=c[0],qa=c[J-1],[Ca,Ia]=da,[bb,rb]=qa;if(2<J){let Pb=0,jc=0;const yc=Ld.len2([rb-Ia,bb-Ca]);for(let Rc=1;Rc<J-1;Rc++){const [jd,fd]=c[Rc],xd=Math.pow(jd*(rb-Ia)+Ca*(fd-rb)+bb*(Ia-fd),2)/yc;Pb>xd||(Pb=xd,jc=Rc)}if(Pb>k)return J=ki.simplify(c.slice(0,jc+1),k),c=ki.simplify(c.slice(jc+1),k),J.concat(c.slice(1))}return[da,qa]});var Wh=
Math.PI,zh=Wh/2,ph=2*Wh,qi={},xi={bottom_edge:"ns-resize",top_edge:"ns-resize",left_edge:"ew-resize",right_edge:"ew-resize",bottom_left_corner:"nesw-resize",bottom_right_corner:"nwse-resize",top_left_corner:"nwse-resize",top_right_corner:"nesw-resize",bottom_left_resize_corner:"swne-rotate",bottom_right_resize_corner:"senw-rotate",top_left_resize_corner:"nwse-rotate",top_right_resize_corner:"nesw-rotate",rotate:"rotate",center:"grab",background:"grab"},yi=class{static circleFromThreePoints(c,k,J){const [da,
qa]=c,[Ca,Ia]=k,[bb,rb]=J;k=da*(Ia-rb)-qa*(Ca-bb)+Ca*rb-bb*Ia;c=-((da*da+qa*qa)*(rb-Ia)+(Ca*Ca+Ia*Ia)*(qa-rb)+(bb*bb+rb*rb)*(Ia-qa))/(2*k);k=-((da*da+qa*qa)*(Ca-bb)+(Ca*Ca+Ia*Ia)*(bb-da)+(bb*bb+rb*rb)*(da-Ca))/(2*k);return[c,k,Math.hypot(c-da,k-qa)]}static perimeterOfEllipse(c,k){const J=Math.pow(c-k,2)/Math.pow(c+k,2);return Wh*(c+k)*(1+3*J/(10+Math.sqrt(4-3*J)))}static shortAngleDist(c,k){c=(k-c)%ph;return 2*c%ph-c}static longAngleDist(c,k){return ph-yi.shortAngleDist(c,k)}static lerpAngles(c,k,
J){return c+yi.shortAngleDist(c,k)*J}static angleDelta(c,k){return yi.shortAngleDist(c,k)}static getSweep(c,k,J){return yi.angleDelta(Rd.angle(c,k),Rd.angle(c,J))}static clampRadians(c){return(ph+c)%ph}static snapAngleToSegments(c,k){k=ph/k;c=Math.floor((yi.clampRadians(c)+k/2)/k)*k%ph;c<Wh&&(c+=ph);c>Wh&&(c-=ph);return c}static isAngleBetween(c,k,J){if(J===c||J===k)return!0;k=(k-c+zh)%zh;return k<=Wh!==(J-c+zh)%zh>k}static degreesToRadians(c){return c*Wh/180}static radiansToDegrees(c){return 180*
c/Wh}static getArcLength(c,k,J,da){c=yi.getSweep(c,J,da);return c/ph*ph*k}static getSweepFlag(c,k,J){J=Rd.angle(c,J);return 0<(Rd.angle(c,k)-J+3*Wh)%ph-Wh?0:1}static getLargeArcFlag(c,k,J){c=Rd.angle(J,c);k=(Rd.angle(J,k)-c+3*Wh)%ph-Wh;return Math.abs(k)>zh?0:1}static getArcDashOffset(c,k,J,da,qa){const Ca=yi.getSweepFlag(c,J,da);k=yi.getArcLength(c,k,J,da);return-(0>Ca?k:ph*c[2]-k)/2+qa}static getEllipseDashOffset(c,k){return-(ph*c[2])/2+-k}static radiansToCardinalDirection(c){return c<.25*Math.PI?
"north":c<.75*Math.PI?"east":c<1.25*Math.PI?"south":c<1.75*Math.PI?"west":"north"}},ui=class{static getPolygonCentroid(c){var k=c.map(J=>J[0]);c=c.map(J=>J[1]);k=Math.min(...k)+Math.max(...k);c=Math.min(...c)+Math.max(...c);return[k?k/2:0,c?c/2:0]}};vb(ui,"getEdges",c=>{const k=c.length;return c.map((J,da)=>[J,c[(da+1)%k]])});vb(ui,"getEdgeOutwardNormal",(c,k)=>Rd.per(Rd.uni(Rd.sub(k,c))));vb(ui,"getEdgeInwardNormal",(c,k)=>Rd.neg(ui.getEdgeOutwardNormal(c,k)));vb(ui,"getOffsetEdge",(c,k,J)=>{J=Rd.mul(Rd.per(Rd.uni(Rd.sub(k,
c))),J);return[Rd.add(c,J),Rd.add(k,J)]});vb(ui,"getOffsetEdges",(c,k)=>c.map(([J,da])=>ui.getOffsetEdge(J,da,k)));vb(ui,"getOffsetPolygon",(c,k)=>{if(1>c.length)throw Error("Expected at least one point.");if(1===c.length)return c=c[0],[Rd.add(c,[-k,-k]),Rd.add(c,[k,-k]),Rd.add(c,[k,k]),Rd.add(c,[-k,k])];if(2===c.length){const [J,da]=c;return[...ui.getOffsetEdge(J,da,k),...ui.getOffsetEdge(da,J,k)]}return ui.getOffsetEdges(ui.getEdges(c),k).flatMap((J,da,qa)=>{{da=qa[(da+1)%qa.length];const Ca=Ld.slope(J[0],
J[1]);qa=Ld.slope(da[0],da[1]);Ca!==qa?Number.isNaN(Ca)&&!Number.isNaN(qa)?J=[J[0][0],(J[0][0]-da[0][0])*qa+da[0][1]]:Number.isNaN(qa)&&!Number.isNaN(Ca)?J=[da[0][0],(da[0][0]-J[0][0])*Ca+J[0][1]]:(J=(Ca*J[0][0]-qa*da[0][0]+da[0][1]-J[0][1])/(Ca-qa),J=[J,qa*(J-da[0][0])+da[0][1]]):J=void 0}if(void 0===J)throw Error("Expected an intersection");return J})});vb(ui,"getPolygonVertices",(c,k,J=0,da=1)=>{c=Rd.div(c,2);const [qa,Ca]=[Math.max(1,c[0]-J),Math.max(1,c[1]-J)];J=[];for(let Pb=0,jc=ph/k;Pb<k;Pb++){var Ia=
(-zh+Pb*jc)%ph,bb=(-zh+(Pb+1)*jc)%ph;Ia=Rd.add(c,[qa*Math.cos(Ia),Ca*Math.sin(Ia)]);bb=Rd.add(c,[qa*Math.cos(bb),Ca*Math.sin(bb)]);var rb=Rd.med(Ia,bb);rb=Rd.nudge(rb,c,Rd.dist(c,rb)*(1-da));J.push(Ia,rb,bb)}return J});vb(ui,"getTriangleVertices",(c,k=0,J=1)=>{const [da,qa]=c;var Ca=1-J;c=[da/2,k/2];J=[da-k,qa-k];k=[k/2,qa-k];const Ia=ui.getPolygonCentroid([c,J,k]),bb=Rd.med(c,J),rb=Rd.med(J,k),Pb=Rd.med(k,c),jc=Rd.dist(bb,Ia)*Ca,yc=Rd.dist(rb,Ia)*Ca;Ca*=Rd.dist(Pb,Ia);return[c,jc?Rd.nudge(bb,Ia,
jc):bb,J,yc?Rd.nudge(rb,Ia,yc):rb,k,Ca?Rd.nudge(Pb,Ia,Ca):Pb]});vb(ui,"getStarVertices",(c,k,J,da=1)=>{const qa=Rd.div(k,2),Ca=Rd.mul(qa,da/2),Ia=ph/J/2;return Array.from(Array(2*J)).map((bb,rb)=>{bb=-zh+rb*Ia;const [Pb,jc]=rb%2?Ca:qa;return Rd.add(c,[Pb*Math.cos(bb),jc*Math.sin(bb)])})});var vk=class{static getCurvedPathForPolygon(c){if(3>c.length)return"M -4, 0\n      a 4,4 0 1,0 8,0\n      a 4,4 0 1,0 -8,0";const k=["M",...c[0].slice(0,2),"Q"],J=c.length;for(let da=1;da<J;da++){const [qa,Ca]=c[da],
[Ia,bb]=c[(da+1)%J];k.push(qa,Ca,(qa+Ia)/2,(Ca+bb)/2)}k.push("Z");return k.join(" ")}static getCurvedPathForPoints(c){if(3>c.length)return"M -4, 0\n      a 4,4 0 1,0 8,0\n      a 4,4 0 1,0 -8,0";const k=["M",...c[0].slice(0,2),"Q"],J=c.length;for(let da=1;da<J-1;da++){const [qa,Ca]=c[da],[Ia,bb]=c[da+1];k.push(qa,Ca,(qa+Ia)/2,(Ca+bb)/2)}return k.join(" ")}static getSvgPathFromStroke(c,k=!0){const J=c.length;if(4>J)return"";let da=c[0],qa=c[1];var Ca=c[2];Ca=`M${da[0].toFixed(2)},${da[1].toFixed(2)} Q${qa[0].toFixed(2)},${qa[1].toFixed(2)} ${((qa[0]+
Ca[0])/2).toFixed(2)},${((qa[1]+Ca[1])/2).toFixed(2)} T`;for(let Ia=2,bb=J-1;Ia<bb;Ia++)da=c[Ia],qa=c[Ia+1],Ca+=`${((da[0]+qa[0])/2).toFixed(2)},${((da[1]+qa[1])/2).toFixed(2)} `;k&&(Ca+="Z");return Ca}static getSvgPathFromStrokePoints(c,k=!1){const J=c.length;if(4>J)return"";let da=c[0].point,qa=c[1].point;var Ca=c[2].point;Ca=`M${da[0].toFixed(2)},${da[1].toFixed(2)} Q${qa[0].toFixed(2)},${qa[1].toFixed(2)} ${((qa[0]+Ca[0])/2).toFixed(2)},${((qa[1]+Ca[1])/2).toFixed(2)} T`;for(let Ia=2,bb=J-1;Ia<
bb;Ia++)da=c[Ia].point,qa=c[Ia+1].point,Ca+=`${((da[0]+qa[0])/2).toFixed(2)},${((da[1]+qa[1])/2).toFixed(2)} `;k&&(Ca+="Z");return Ca}};vb(vk,"TRIM_NUMBERS",/(\s?[A-Z]?,?-?[0-9]*\.[0-9]{0,2})(([0-9]|e|-)*)/g);var Nm={},Om=Object.assign,Zk=Object.getOwnPropertyDescriptor,Ah=Object.defineProperty,vp=Object.prototype,qm=[];Object.freeze(qm);var rr={};Object.freeze(rr);var is="undefined"!==typeof Proxy,sr=Object.toString(),Pn=function(){},Qn="undefined"!==typeof Object.getOwnPropertySymbols,fq="undefined"!==
typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:Qn?function(c){return Object.getOwnPropertyNames(c).concat(Object.getOwnPropertySymbols(c))}:Object.getOwnPropertyNames,Dt=Object.getOwnPropertyDescriptors||function(c){var k={};fq(c).forEach(function(J){k[J]=Zk(c,J)});return k},Tl=Symbol("mobx-stored-annotations"),Gh=Symbol("mobx administration"),pn=function(){function c(J){void 0===J&&(J="Atom");this.name_=void 0;this.isBeingObserved_=this.isPendingUnobservation_=!1;this.observers_=new Set;this.lastAccessedBy_=
this.diffValue_=0;this.lowestObserverState_=Yi.NOT_TRACKING_;this.onBUOL=this.onBOL=void 0;this.name_=J}var k=c.prototype;k.onBO=function(){this.onBOL&&this.onBOL.forEach(function(J){return J()})};k.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(J){return J()})};k.reportObserved=function(){return ib(this)};k.reportChanged=function(){Kb();ub(this);Bb()};k.toString=function(){return this.name_};return c}(),tr=H("Atom",pn),to={identity:function(c,k){return c===k},structural:function(c,k){return sa(c,
k)},"default":function(c,k){return Object.is?Object.is(c,k):c===k?0!==c||1/c===1/k:c!==c&&k!==k},shallow:function(c,k){return sa(c,k,1)}},Et="override",Ft=Aa(),wp={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(wp);var js=jb("observable"),Gt=jb("observable.ref",{enhancer:Ka}),Ht=jb("observable.shallow",{enhancer:function(c,k,J){if(void 0===c||null===c||Ud(c)||Kc(c)||qn(c)||zp(c))return c;if(Array.isArray(c))return Sg.array(c,{name:J,deep:!1});if(N(c))return Sg.object(c,void 0,
{name:J,deep:!1});if(Q(c))return Sg.map(c,{name:J,deep:!1});if(O(c))return Sg.set(c,{name:J,deep:!1})}}),ks=jb("observable.struct",{enhancer:function(c,k){return sa(c,k)?k:c}}),ls=va(js);Object.assign(hb,ls);var It={box:function(c,k){k=k||wp;return new Rn(c,Va(k),k.name,!0,k.equals)},array:function(c,k){k=k||wp;return(!1===Vf.useProxies||!1===k.proxy?Ob:Za)(c,Va(k),k.name)},map:function(c,k){k=k||wp;return new mq(c,Va(k),k.name)},set:function(c,k){k=k||wp;return new Vv(c,Va(k),k.name)},object:function(c,
k,J){if(!1===Vf.useProxies||!1===(null==J?void 0:J.proxy))J=ld({},J);else{var da={},qa,Ca;y();da=ld(da,J);J=null!=(Ca=(qa=da[Gh]).proxy_)?Ca:qa.proxy_=new Proxy(da,Nh)}return pc(J,c,k)},ref:va(Gt),shallow:va(Ht),deep:ls,struct:va(ks)},Sg=Om(hb,It),ur=Sa("computed"),Jt=Sa("computed.struct",{equals:to.structural}),Zg=function(c,k){if(G(k))return Ha(c,k,ur);if(N(c))return va(Sa("computed",c));k=N(k)?k:{};k.get=c;k.name||(k.name=c.name||"");return new xp(k)};Object.assign(Zg,ur);Zg.struct=va(Jt);var ms,
ns,gq=0,Kt=1,Lt=null!=(ms=null==(ns=Zk(function(){},"name"))?void 0:ns.configurable)?ms:!1,hq={value:"action",configurable:!0,writable:!1,enumerable:!1};var os=Symbol.toPrimitive;var Rn=function(c){function k(da,qa,Ca,Ia,bb){void 0===Ca&&(Ca="ObservableValue");void 0===bb&&(bb=to["default"]);Ia=c.call(this,Ca)||this;Ia.enhancer=void 0;Ia.hasUnreportedChange_=!1;Ia.interceptors_=void 0;Ia.changeListeners_=void 0;Ia.value_=void 0;Ia.dehancer=void 0;Ia.enhancer=qa;Ia.name_=Ca;Ia.equals=bb;Ia.value_=
qa(da,void 0,Ca);return Ia}fa(k,c);var J=k.prototype;J.dehanceValue=function(da){return void 0!==this.dehancer?this.dehancer(da):da};J.set=function(da){da=this.prepareNewValue_(da);da!==Vf.UNCHANGED&&this.setNewValue_(da)};J.prepareNewValue_=function(da){if(kb(this)){da=Oa(this,{object:this,type:Jh,newValue:da});if(!da)return Vf.UNCHANGED;da=da.newValue}da=this.enhancer(da,this.value_,this.name_);return this.equals(this.value_,da)?Vf.UNCHANGED:da};J.setNewValue_=function(da){var qa=this.value_;this.value_=
da;this.reportChanged();Ab(this)&&Ub(this,{type:Jh,object:this,newValue:da,oldValue:qa})};J.get=function(){this.reportObserved();return this.dehanceValue(this.value_)};J.intercept_=function(da){return sb(this,da)};J.observe_=function(da,qa){qa&&da({observableKind:"value",debugObjectName:this.name_,object:this,type:Jh,newValue:this.value_,oldValue:void 0});return Cb(this,da)};J.raw=function(){return this.value_};J.toJSON=function(){return this.get()};J.toString=function(){return this.name_+"["+this.value_+
"]"};J.valueOf=function(){return ha(this.get())};J[os]=function(){return this.valueOf()};return k}(pn),Mt=H("ObservableValue",Rn);var Nt=Symbol.toPrimitive;var xp=function(){function c(J){this.dependenciesState_=Yi.NOT_TRACKING_;this.observing_=[];this.newObserving_=null;this.isPendingUnobservation_=this.isBeingObserved_=!1;this.observers_=new Set;this.lastAccessedBy_=this.runId_=this.diffValue_=0;this.lowestObserverState_=Yi.UP_TO_DATE_;this.unboundDepsCount_=0;this.value_=new Sn(null);this.triggeredBy_=
this.name_=void 0;this.isRunningSetter_=this.isComputing_=!1;this.setter_=this.derivation=void 0;this.isTracing_=uo.NONE;this.onBUOL=this.onBOL=this.keepAlive_=this.requiresReaction_=this.equals_=this.scope_=void 0;J.get||e(31);this.derivation=J.get;this.name_=J.name||"ComputedValue";J.set&&(this.setter_=Wa("ComputedValue-setter",J.set));this.equals_=J.equals||(J.compareStructural||J.struct?to.structural:to["default"]);this.scope_=J.context;this.requiresReaction_=J.requiresReaction;this.keepAlive_=
!!J.keepAlive}var k=c.prototype;k.onBecomeStale_=function(){eb(this)};k.onBO=function(){this.onBOL&&this.onBOL.forEach(function(J){return J()})};k.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(J){return J()})};k.get=function(){this.isComputing_&&e(32,this.name_,this.derivation);if(0!==Vf.inBatch||0!==this.observers_.size||this.keepAlive_){if(ib(this),Qc(this)){var J=Vf.trackingContext;this.keepAlive_&&!J&&(Vf.trackingContext=this);this.trackAndCompute()&&wb(this);Vf.trackingContext=J}}else Qc(this)&&
(this.warnAboutUntrackedRead_(),Kb(),this.value_=this.computeValue_(!1),Bb());J=this.value_;if(J instanceof Sn)throw J.cause;return J};k.set=function(J){if(this.setter_){this.isRunningSetter_&&e(33,this.name_);this.isRunningSetter_=!0;try{this.setter_.call(this.scope_,J)}finally{this.isRunningSetter_=!1}}else e(34,this.name_)};k.trackAndCompute=function(){var J=this.value_,da=this.dependenciesState_===Yi.NOT_TRACKING_,qa=this.computeValue_(!0);if(J=da||J instanceof Sn||qa instanceof Sn||!this.equals_(J,
qa))this.value_=qa;return J};k.computeValue_=function(J){this.isComputing_=!0;var da=Tc(!1);if(J)var qa=Gc(this,this.derivation,this.scope_);else if(!0===Vf.disableErrorBoundaries)qa=this.derivation.call(this.scope_);else try{qa=this.derivation.call(this.scope_)}catch(Ca){qa=new Sn(Ca)}Vf.allowStateChanges=da;this.isComputing_=!1;return qa};k.suspend_=function(){this.keepAlive_||(Hc(this),this.value_=void 0)};k.observe_=function(J,da){var qa=this,Ca=!0,Ia=void 0;return ic(function(){var bb=qa.get();
if(!Ca||da){var rb=Ua();J({observableKind:"computed",debugObjectName:qa.name_,type:Jh,object:qa,newValue:bb,oldValue:Ia});Vf.trackingDerivation=rb}Ca=!1;Ia=bb})};k.warnAboutUntrackedRead_=function(){};k.toString=function(){return this.name_+"["+this.derivation.toString()+"]"};k.valueOf=function(){return ha(this.get())};k[Nt]=function(){return this.valueOf()};return c}(),yp=H("ComputedValue",xp),Yi;(function(c){c[c.NOT_TRACKING_=-1]="NOT_TRACKING_";c[c.UP_TO_DATE_=0]="UP_TO_DATE_";c[c.POSSIBLY_STALE_=
1]="POSSIBLY_STALE_";c[c.STALE_=2]="STALE_"})(Yi||={});var uo;(function(c){c[c.NONE=0]="NONE";c[c.LOG=1]="LOG";c[c.BREAK=2]="BREAK"})(uo||={});var Sn=function(c){this.cause=void 0;this.cause=c},iq=function(){this.version=6;this.UNCHANGED={};this.trackingContext=this.trackingDerivation=null;this.inBatch=this.mobxGuid=this.runId=0;this.pendingUnobservations=[];this.pendingReactions=[];this.allowStateChanges=this.isRunningReactions=!1;this.enforceActions=this.allowStateReads=!0;this.spyListeners=[];
this.globalReactionErrorHandlers=[];this.suppressReactionErrors=this.disableErrorBoundaries=this.observableRequiresReaction=this.reactionRequiresObservable=this.computedRequiresReaction=!1;this.useProxies=!0;this.verifyProxies=!1;this.safeDescriptors=!0},jq=!0,ps=!1,Vf=function(){var c=F();0<c.__mobxInstanceCount&&!c.__mobxGlobals&&(jq=!1);c.__mobxGlobals&&c.__mobxGlobals.version!==(new iq).version&&(jq=!1);if(jq){if(c.__mobxGlobals)return c.__mobxInstanceCount+=1,c.__mobxGlobals.UNCHANGED||(c.__mobxGlobals.UNCHANGED=
{}),c.__mobxGlobals;c.__mobxInstanceCount=1;return c.__mobxGlobals=new iq}setTimeout(function(){ps||e(35)},1);return new iq}(),vo=function(){function c(J,da,qa,Ca){void 0===J&&(J="Reaction");this.requiresObservable_=this.errorHandler_=this.onInvalidate_=this.name_=void 0;this.observing_=[];this.newObserving_=[];this.dependenciesState_=Yi.NOT_TRACKING_;this.unboundDepsCount_=this.runId_=this.diffValue_=0;this.isRunning_=this.isTrackPending_=this.isScheduled_=this.isDisposed_=!1;this.isTracing_=uo.NONE;
this.name_=J;this.onInvalidate_=da;this.errorHandler_=qa;this.requiresObservable_=Ca}var k=c.prototype;k.onBecomeStale_=function(){this.schedule_()};k.schedule_=function(){this.isScheduled_||(this.isScheduled_=!0,Vf.pendingReactions.push(this),0<Vf.inBatch||Vf.isRunningReactions||kq(pb))};k.isScheduled=function(){return this.isScheduled_};k.runReaction_=function(){if(!this.isDisposed_){Kb();this.isScheduled_=!1;var J=Vf.trackingContext;Vf.trackingContext=this;if(Qc(this)){this.isTrackPending_=!0;
try{this.onInvalidate_()}catch(da){this.reportExceptionInDerivation_(da)}}Vf.trackingContext=J;Bb()}};k.track=function(J){if(!this.isDisposed_){Kb();this.isRunning_=!0;var da=Vf.trackingContext;Vf.trackingContext=this;J=Gc(this,J,void 0);Vf.trackingContext=da;this.isTrackPending_=this.isRunning_=!1;this.isDisposed_&&Hc(this);J instanceof Sn&&this.reportExceptionInDerivation_(J.cause);Bb()}};k.reportExceptionInDerivation_=function(J){var da=this;if(this.errorHandler_)this.errorHandler_(J,this);else{if(Vf.disableErrorBoundaries)throw J;
Vf.suppressReactionErrors||console.error("[mobx] uncaught error in '"+this+"'",J);Vf.globalReactionErrorHandlers.forEach(function(qa){return qa(J,da)})}};k.dispose=function(){this.isDisposed_||(this.isDisposed_=!0,this.isRunning_||(Kb(),Hc(this),Bb()))};k.getDisposer_=function(){var J=this.dispose.bind(this);J[Gh]=this;return J};k.toString=function(){return"Reaction["+this.name_+"]"};k.trace=function(J){void 0===J&&(J=!1);rc(this,J)};return c}(),Ot=100,kq=function(c){return c()},lq=H("Reaction",vo),
qs="action",ia=za(qs),Ba=za("action.bound",{bound:!0}),gb=za("autoAction",{autoAction:!0}),kc=za("autoAction.bound",{autoAction:!0,bound:!0}),Ic=xc(!1);Object.assign(Ic,ia);var hd=xc(!0);Object.assign(hd,gb);Ic.bound=va(Ba);hd.bound=va(kc);var Vd=function(c){return c()},ee="onBO",re="onBUO",Oe=0;Bc.prototype=Object.create(Error.prototype);var of=ma("flow"),hg=ma("flow.bound",{bound:!0}),qg=Object.assign(function(c,k){if(G(k))return Ha(c,k,of);var J=c.name||"\x3cunnamed flow\x3e";k=function(){var da=
arguments,qa=++Oe,Ca=Ic(J+" - runid: "+qa+" - init",c).apply(this,da),Ia,bb=void 0;da=new Promise(function(rb,Pb){function jc(fd){bb=void 0;try{var xd=Ic(J+" - runid: "+qa+" - yield "+jd++,Ca.next).call(Ca,fd)}catch(Fd){return Pb(Fd)}Rc(xd)}function yc(fd){bb=void 0;try{var xd=Ic(J+" - runid: "+qa+" - yield "+jd++,Ca["throw"]).call(Ca,fd)}catch(Fd){return Pb(Fd)}Rc(xd)}function Rc(fd){if(U(null==fd?void 0:fd.then))fd.then(Rc,Pb);else{if(fd.done)return rb(fd.value);bb=Promise.resolve(fd.value);return bb.then(jc,
yc)}}var jd=0;Ia=Pb;jc(void 0)});da.cancel=Ic(J+" - runid: "+qa+" - cancel",function(){try{if(bb){var rb=bb;U(rb.cancel)&&rb.cancel()}var Pb=Ca["return"](void 0),jc=Promise.resolve(Pb.value);jc.then(Pn,Pn);U(jc.cancel)&&jc.cancel();Ia(new Bc)}catch(yc){Ia(yc)}});return da};k.isMobXFlow=!0;return k},of);qg.bound=va(hg);var Nh={has:function(c,k){return c[Gh].has_(k)},get:function(c,k){return c[Gh].get_(k)},set:function(c,k,J){var da;return G(k)?null!=(da=c[Gh].set_(k,J,!0))?da:!0:!1},deleteProperty:function(c,
k){var J;return G(k)?null!=(J=c[Gh].delete_(k,!0))?J:!0:!1},defineProperty:function(c,k,J){var da;return null!=(da=c[Gh].defineProperty_(k,J))?da:!0},ownKeys:function(c){return c[Gh].ownKeys_()},preventExtensions:function(c){e(13)}},Jh="update",ok={get:function(c,k){var J=c[Gh];return k===Gh?J:"length"===k?J.getArrayLength_():"string"!==typeof k||isNaN(k)?V(Tk,k)?Tk[k]:c[k]:J.get_(parseInt(k))},set:function(c,k,J){var da=c[Gh];"length"===k&&da.setArrayLength_(J);"symbol"===typeof k||isNaN(k)?c[k]=
J:da.set_(parseInt(k),J);return!0},preventExtensions:function(){e(15)}},rm=function(){function c(J,da,qa,Ca){void 0===J&&(J="ObservableArray");this.atom_=this.legacyMode_=this.owned_=void 0;this.values_=[];this.proxy_=this.dehancer=this.enhancer_=this.changeListeners_=this.interceptors_=void 0;this.lastKnownLength_=0;this.owned_=qa;this.legacyMode_=Ca;this.atom_=new pn(J);this.enhancer_=function(Ia,bb){return da(Ia,bb,"ObservableArray[..]")}}var k=c.prototype;k.dehanceValue_=function(J){return void 0!==
this.dehancer?this.dehancer(J):J};k.dehanceValues_=function(J){return void 0!==this.dehancer&&0<J.length?J.map(this.dehancer):J};k.intercept_=function(J){return sb(this,J)};k.observe_=function(J,da){void 0===da&&(da=!1);da&&J({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0});return Cb(this,J)};k.getArrayLength_=function(){this.atom_.reportObserved();return this.values_.length};
k.setArrayLength_=function(J){("number"!==typeof J||isNaN(J)||0>J)&&e("Out of range: "+J);var da=this.values_.length;if(J!==da)if(J>da){for(var qa=Array(J-da),Ca=0;Ca<J-da;Ca++)qa[Ca]=void 0;this.spliceWithArray_(da,0,qa)}else this.spliceWithArray_(J,da-J)};k.updateArrayLength_=function(J,da){J!==this.lastKnownLength_&&e(16);this.lastKnownLength_+=da;this.legacyMode_&&0<da&&vd(J+da+1)};k.spliceWithArray_=function(J,da,qa){var Ca=this,Ia=this.values_.length;void 0===J?J=0:J>Ia?J=Ia:0>J&&(J=Math.max(0,
Ia+J));da=1===arguments.length?Ia-J:void 0===da||null===da?0:Math.max(0,Math.min(da,Ia-J));void 0===qa&&(qa=qm);if(kb(this)){var bb=Oa(this,{object:this.proxy_,type:"splice",index:J,removedCount:da,added:qa});if(!bb)return qm;da=bb.removedCount;qa=bb.added}qa=0===qa.length?qa:qa.map(function(rb){return Ca.enhancer_(rb,void 0)});this.legacyMode_&&this.updateArrayLength_(Ia,qa.length-da);Ia=this.spliceItemsIntoValues_(J,da,qa);0===da&&0===qa.length||this.notifyArraySplice_(J,qa,Ia);return this.dehanceValues_(Ia)};
k.spliceItemsIntoValues_=function(J,da,qa){if(1E4>qa.length){var Ca;return(Ca=this.values_).splice.apply(Ca,[J,da].concat(qa))}Ca=this.values_.slice(J,J+da);var Ia=this.values_.slice(J+da);this.values_.length+=qa.length-da;for(da=0;da<qa.length;da++)this.values_[J+da]=qa[da];for(da=0;da<Ia.length;da++)this.values_[J+qa.length+da]=Ia[da];return Ca};k.notifyArrayChildUpdate_=function(J,da,qa){var Ca=!this.owned_&&!1,Ia=Ab(this);J=Ia||Ca?{observableKind:"array",object:this.proxy_,type:Jh,debugObjectName:this.atom_.name_,
index:J,newValue:da,oldValue:qa}:null;this.atom_.reportChanged();Ia&&Ub(this,J)};k.notifyArraySplice_=function(J,da,qa){var Ca=!this.owned_&&!1,Ia=Ab(this);J=Ia||Ca?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:J,removed:qa,added:da,removedCount:qa.length,addedCount:da.length}:null;this.atom_.reportChanged();Ia&&Ub(this,J)};k.get_=function(J){if(this.legacyMode_&&J>=this.values_.length)console.warn("[mobx] Out of bounds read: "+J);else return this.atom_.reportObserved(),
this.dehanceValue_(this.values_[J])};k.set_=function(J,da){var qa=this.values_;this.legacyMode_&&J>qa.length&&e(17,J,qa.length);if(J<qa.length){var Ca=qa[J];if(kb(this)){da=Oa(this,{type:Jh,object:this.proxy_,index:J,newValue:da});if(!da)return;da=da.newValue}da=this.enhancer_(da,Ca);da!==Ca&&(qa[J]=da,this.notifyArrayChildUpdate_(J,da,Ca))}else{J=Array(J+1-qa.length);for(Ca=0;Ca<J.length-1;Ca++)J[Ca]=void 0;J[J.length-1]=da;this.spliceWithArray_(qa.length,0,J)}};return c}(),Tk={clear:function(){return this.splice(0)},
replace:function(c){var k=this[Gh];return k.spliceWithArray_(0,k.values_.length,c)},toJSON:function(){return this.slice()},splice:function(c,k){for(var J=arguments.length,da=Array(2<J?J-2:0),qa=2;qa<J;qa++)da[qa-2]=arguments[qa];J=this[Gh];switch(arguments.length){case 0:return[];case 1:return J.spliceWithArray_(c);case 2:return J.spliceWithArray_(c,k)}return J.spliceWithArray_(c,k,da)},spliceWithArray:function(c,k,J){return this[Gh].spliceWithArray_(c,k,J)},push:function(){for(var c=this[Gh],k=arguments.length,
J=Array(k),da=0;da<k;da++)J[da]=arguments[da];c.spliceWithArray_(c.values_.length,0,J);return c.values_.length},pop:function(){return this.splice(Math.max(this[Gh].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var c=this[Gh],k=arguments.length,J=Array(k),da=0;da<k;da++)J[da]=arguments[da];c.spliceWithArray_(0,0,J);return c.values_.length},reverse:function(){Vf.trackingDerivation&&e(37,"reverse");this.replace(this.slice().reverse());return this},sort:function(){Vf.trackingDerivation&&
e(37,"sort");var c=this.slice();c.sort.apply(c,arguments);this.replace(c);return this},remove:function(c){var k=this[Gh];c=k.dehanceValues_(k.values_).indexOf(c);return-1<c?(this.splice(c,1),!0):!1}};ab("concat",Qa);ab("flat",Qa);ab("includes",Qa);ab("indexOf",Qa);ab("join",Qa);ab("lastIndexOf",Qa);ab("slice",Qa);ab("toString",Qa);ab("toLocaleString",Qa);ab("every",mb);ab("filter",mb);ab("find",mb);ab("findIndex",mb);ab("flatMap",mb);ab("forEach",mb);ab("map",mb);ab("some",mb);ab("reduce",zb);ab("reduceRight",
zb);var vi=H("ObservableArrayAdministration",rm),ck={};var ll=Symbol.iterator;var wo=Symbol.toStringTag;var mq=function(){function c(J,da,qa){var Ca=this;void 0===da&&(da=Ea);void 0===qa&&(qa="ObservableMap");this.name_=this.enhancer_=void 0;this[Gh]=ck;this.dehancer=this.changeListeners_=this.interceptors_=this.keysAtom_=this.hasMap_=this.data_=void 0;this.enhancer_=da;this.name_=qa;U(Map)||e(18);this.keysAtom_=db("ObservableMap.keys()");this.data_=new Map;this.hasMap_=new Map;$b(!0,function(){Ca.merge(J)})}
var k=c.prototype;k.has_=function(J){return this.data_.has(J)};k.has=function(J){var da=this;if(!Vf.trackingDerivation)return this.has_(J);var qa=this.hasMap_.get(J);if(!qa){var Ca=qa=new Rn(this.has_(J),Ka,"ObservableMap.key?",!1);this.hasMap_.set(J,Ca);pd(Ca,function(){return da.hasMap_["delete"](J)})}return qa.get()};k.set=function(J,da){var qa=this.has_(J);if(kb(this)){da=Oa(this,{type:qa?Jh:"add",object:this,newValue:da,name:J});if(!da)return this;da=da.newValue}qa?this.updateValue_(J,da):this.addValue_(J,
da);return this};k["delete"]=function(J){var da=this;if(kb(this)&&!Oa(this,{type:"delete",object:this,name:J}))return!1;if(this.has_(J)){var qa=Ab(this),Ca=qa?{observableKind:"map",debugObjectName:this.name_,type:"delete",object:this,oldValue:this.data_.get(J).value_,name:J}:null;Tb(function(){var Ia;da.keysAtom_.reportChanged();null==(Ia=da.hasMap_.get(J))?void 0:Ia.setNewValue_(!1);da.data_.get(J).setNewValue_(void 0);da.data_["delete"](J)});qa&&Ub(this,Ca);return!0}return!1};k.updateValue_=function(J,
da){var qa=this.data_.get(J);da=qa.prepareNewValue_(da);if(da!==Vf.UNCHANGED){var Ca=Ab(this);J=Ca?{observableKind:"map",debugObjectName:this.name_,type:Jh,object:this,oldValue:qa.value_,name:J,newValue:da}:null;qa.setNewValue_(da);Ca&&Ub(this,J)}};k.addValue_=function(J,da){var qa=this;Tb(function(){var bb,rb=new Rn(da,qa.enhancer_,"ObservableMap.key",!1);qa.data_.set(J,rb);da=rb.value_;null==(bb=qa.hasMap_.get(J))?void 0:bb.setNewValue_(!0);qa.keysAtom_.reportChanged()});var Ca=Ab(this),Ia=Ca?{observableKind:"map",
debugObjectName:this.name_,type:"add",object:this,name:J,newValue:da}:null;Ca&&Ub(this,Ia)};k.get=function(J){return this.has(J)?this.dehanceValue_(this.data_.get(J).get()):this.dehanceValue_(void 0)};k.dehanceValue_=function(J){return void 0!==this.dehancer?this.dehancer(J):J};k.keys=function(){this.keysAtom_.reportObserved();return this.data_.keys()};k.values=function(){var J=this,da=this.keys();return $a({next:function(){var qa=da.next(),Ca=qa.done;qa=qa.value;return{done:Ca,value:Ca?void 0:J.get(qa)}}})};
k.entries=function(){var J=this,da=this.keys();return $a({next:function(){var qa=da.next(),Ca=qa.done;qa=qa.value;return{done:Ca,value:Ca?void 0:[qa,J.get(qa)]}}})};k[ll]=function(){return this.entries()};k.forEach=function(J,da){for(var qa=ra(this),Ca;!(Ca=qa()).done;)Ca=Ca.value,J.call(da,Ca[1],Ca[0],this)};k.merge=function(J){var da=this;qn(J)&&(J=new Map(J));Tb(function(){N(J)?M(J).forEach(function(qa){return da.set(qa,J[qa])}):Array.isArray(J)?J.forEach(function(qa){return da.set(qa[0],qa[1])}):
Q(J)?(J.constructor!==Map&&e(19,J),J.forEach(function(qa,Ca){return da.set(Ca,qa)})):null!==J&&void 0!==J&&e(20,J)});return this};k.clear=function(){var J=this;Tb(function(){Ta(function(){for(var da=ra(J.keys()),qa;!(qa=da()).done;)J["delete"](qa.value)})})};k.replace=function(J){var da=this;Tb(function(){for(var qa=bd(J),Ca=new Map,Ia=!1,bb=ra(da.data_.keys()),rb;!(rb=bb()).done;)if(rb=rb.value,!qa.has(rb))if(da["delete"](rb))Ia=!0;else{var Pb=da.data_.get(rb);Ca.set(rb,Pb)}for(qa=ra(qa.entries());!(bb=
qa()).done;)rb=bb.value,bb=rb[0],Pb=rb[1],rb=da.data_.has(bb),da.set(bb,Pb),da.data_.has(bb)&&(Pb=da.data_.get(bb),Ca.set(bb,Pb),rb||(Ia=!0));if(!Ia)if(da.data_.size!==Ca.size)da.keysAtom_.reportChanged();else for(Ia=da.data_.keys(),qa=Ca.keys(),bb=Ia.next(),rb=qa.next();!bb.done;){if(bb.value!==rb.value){da.keysAtom_.reportChanged();break}bb=Ia.next();rb=qa.next()}da.data_=Ca});return this};k.toString=function(){return"[object ObservableMap]"};k.toJSON=function(){return Array.from(this)};k.observe_=
function(J,da){return Cb(this,J)};k.intercept_=function(J){return sb(this,J)};aa(c,[{key:"size",get:function(){this.keysAtom_.reportObserved();return this.data_.size}},{key:wo,get:function(){return"Map"}}]);return c}(),qn=H("ObservableMap",mq),rs={};var Bz=Symbol.iterator;var Cz=Symbol.toStringTag;var Vv=function(){function c(J,da,qa){void 0===da&&(da=Ea);void 0===qa&&(qa="ObservableSet");this.name_=void 0;this[Gh]=rs;this.data_=new Set;this.enhancer_=this.dehancer=this.interceptors_=this.changeListeners_=
this.atom_=void 0;this.name_=qa;U(Set)||e(22);this.atom_=db(this.name_);this.enhancer_=function(Ca,Ia){return da(Ca,Ia,qa)};J&&this.replace(J)}var k=c.prototype;k.dehanceValue_=function(J){return void 0!==this.dehancer?this.dehancer(J):J};k.clear=function(){var J=this;Tb(function(){Ta(function(){for(var da=ra(J.data_.values()),qa;!(qa=da()).done;)J["delete"](qa.value)})})};k.forEach=function(J,da){for(var qa=ra(this),Ca;!(Ca=qa()).done;)Ca=Ca.value,J.call(da,Ca,Ca,this)};k.add=function(J){var da=
this;if(kb(this)&&!Oa(this,{type:"add",object:this,newValue:J}))return this;if(!this.has(J)){Tb(function(){da.data_.add(da.enhancer_(J,void 0));da.atom_.reportChanged()});var qa=Ab(this),Ca=qa?{observableKind:"set",debugObjectName:this.name_,type:"add",object:this,newValue:J}:null;qa&&Ub(this,Ca)}return this};k["delete"]=function(J){var da=this;if(kb(this)&&!Oa(this,{type:"delete",object:this,oldValue:J}))return!1;if(this.has(J)){var qa=Ab(this),Ca=qa?{observableKind:"set",debugObjectName:this.name_,
type:"delete",object:this,oldValue:J}:null;Tb(function(){da.atom_.reportChanged();da.data_["delete"](J)});qa&&Ub(this,Ca);return!0}return!1};k.has=function(J){this.atom_.reportObserved();return this.data_.has(this.dehanceValue_(J))};k.entries=function(){var J=0,da=Array.from(this.keys()),qa=Array.from(this.values());return $a({next:function(){var Ca=J;J+=1;return Ca<qa.length?{value:[da[Ca],qa[Ca]],done:!1}:{done:!0}}})};k.keys=function(){return this.values()};k.values=function(){this.atom_.reportObserved();
var J=this,da=0,qa=Array.from(this.data_.values());return $a({next:function(){return da<qa.length?{value:J.dehanceValue_(qa[da++]),done:!1}:{done:!0}}})};k.replace=function(J){var da=this;zp(J)&&(J=new Set(J));Tb(function(){Array.isArray(J)?(da.clear(),J.forEach(function(qa){return da.add(qa)})):O(J)?(da.clear(),J.forEach(function(qa){return da.add(qa)})):null!==J&&void 0!==J&&e("Cannot initialize set from "+J)});return this};k.observe_=function(J,da){return Cb(this,J)};k.intercept_=function(J){return sb(this,
J)};k.toJSON=function(){return Array.from(this)};k.toString=function(){return"[object ObservableSet]"};k[Bz]=function(){return this.values()};aa(c,[{key:"size",get:function(){this.atom_.reportObserved();return this.data_.size}},{key:Cz,get:function(){return"Set"}}]);return c}(),zp=H("ObservableSet",Vv),Wv=Object.create(null),Xv=function(){function c(J,da,qa,Ca){void 0===da&&(da=new Map);void 0===Ca&&(Ca=Ft);this.pendingKeys_=this.appliedAnnotations_=this.isPlainObject_=this.proxy_=this.interceptors_=
this.changeListeners_=this.keysAtom_=this.defaultAnnotation_=this.values_=this.target_=void 0;this.target_=J;this.values_=da;this.name_=qa;this.defaultAnnotation_=Ca;this.keysAtom_=new pn("ObservableObject.keys");this.isPlainObject_=N(this.target_)}var k=c.prototype;k.getObservablePropValue_=function(J){return this.values_.get(J).get()};k.setObservablePropValue_=function(J,da){var qa=this.values_.get(J);if(qa instanceof xp)return qa.set(da),!0;if(kb(this)){da=Oa(this,{type:Jh,object:this.proxy_||
this.target_,name:J,newValue:da});if(!da)return null;da=da.newValue}da=qa.prepareNewValue_(da);if(da!==Vf.UNCHANGED){var Ca=Ab(this);J=Ca?{type:Jh,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:qa.value_,name:J,newValue:da}:null;qa.setNewValue_(da);Ca&&Ub(this,J)}return!0};k.get_=function(J){Vf.trackingDerivation&&!V(this.target_,J)&&this.has_(J);return this.target_[J]};k.set_=function(J,da,qa){void 0===qa&&(qa=!1);if(V(this.target_,J)){if(this.values_.has(J))return this.setObservablePropValue_(J,
da);if(qa)return Reflect.set(this.target_,J,da);this.target_[J]=da;return!0}return this.extend_(J,{value:da,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,qa)};k.has_=function(J){if(!Vf.trackingDerivation)return J in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var da=this.pendingKeys_.get(J);da||(da=new Rn(J in this.target_,Ka,"ObservableObject.key?",!1),this.pendingKeys_.set(J,da));return da.get()};k.make_=function(J,da){!0===da&&(da=this.defaultAnnotation_);if(!1!==
da){if(!(J in this.target_)){var qa;if(null!=(qa=this.target_[Tl])&&qa[J])return;e(1,da.annotationType_,this.name_+"."+J.toString())}for(qa=this.target_;qa&&qa!==vp;){var Ca=Zk(qa,J);if(Ca){Ca=da.make_(this,J,Ca,qa);if(0===Ca)return;if(1===Ca)break}qa=Object.getPrototypeOf(qa)}var Ia;null==(Ia=this.target_[Tl])?!0:delete Ia[J]}};k.extend_=function(J,da,qa,Ca){void 0===Ca&&(Ca=!1);!0===qa&&(qa=this.defaultAnnotation_);if(!1===qa)return this.defineProperty_(J,da,Ca);if(da=qa.extend_(this,J,da,Ca)){var Ia;
null==(Ia=this.target_[Tl])?!0:delete Ia[J]}return da};k.defineProperty_=function(J,da,qa){void 0===qa&&(qa=!1);try{Kb();var Ca=this.delete_(J);if(!Ca)return Ca;if(kb(this)){var Ia=Oa(this,{object:this.proxy_||this.target_,name:J,type:"add",newValue:da.value});if(!Ia)return null;var bb=Ia.newValue;da.value!==bb&&(da=X({},da,{value:bb}))}if(qa){if(!Reflect.defineProperty(this.target_,J,da))return!1}else Ah(this.target_,J,da);this.notifyPropertyAddition_(J,da.value)}finally{Bb()}return!0};k.defineObservableProperty_=
function(J,da,qa,Ca){void 0===Ca&&(Ca=!1);try{Kb();var Ia=this.delete_(J);if(!Ia)return Ia;if(kb(this)){var bb=Oa(this,{object:this.proxy_||this.target_,name:J,type:"add",newValue:da});if(!bb)return null;da=bb.newValue}var rb=Hd(J),Pb={configurable:Vf.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:rb.get,set:rb.set};if(Ca){if(!Reflect.defineProperty(this.target_,J,Pb))return!1}else Ah(this.target_,J,Pb);var jc=new Rn(da,qa,"ObservableObject.key",!1);this.values_.set(J,jc);this.notifyPropertyAddition_(J,
jc.value_)}finally{Bb()}return!0};k.defineComputedProperty_=function(J,da,qa){void 0===qa&&(qa=!1);try{Kb();var Ca=this.delete_(J);if(!Ca)return Ca;if(kb(this)&&!Oa(this,{object:this.proxy_||this.target_,name:J,type:"add",newValue:void 0}))return null;da.name||(da.name="ObservableObject.key");da.context=this.proxy_||this.target_;var Ia=Hd(J),bb={configurable:Vf.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:Ia.get,set:Ia.set};if(qa){if(!Reflect.defineProperty(this.target_,J,bb))return!1}else Ah(this.target_,
J,bb);this.values_.set(J,new xp(da));this.notifyPropertyAddition_(J,void 0)}finally{Bb()}return!0};k.delete_=function(J,da){void 0===da&&(da=!1);if(!V(this.target_,J))return!0;if(kb(this)&&!Oa(this,{object:this.proxy_||this.target_,name:J,type:"remove"}))return null;try{var qa,Ca;Kb();var Ia=Ab(this),bb=this.values_.get(J),rb=void 0;if(!bb&&Ia){var Pb;rb=null==(Pb=Zk(this.target_,J))?void 0:Pb.value}if(da){if(!Reflect.deleteProperty(this.target_,J))return!1}else delete this.target_[J];bb&&(this.values_["delete"](J),
bb instanceof Rn&&(rb=bb.value_),ub(bb));this.keysAtom_.reportChanged();null==(qa=this.pendingKeys_)?void 0:null==(Ca=qa.get(J))?void 0:Ca.set(J in this.target_);if(Ia){var jc={type:"remove",observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:rb,name:J};Ia&&Ub(this,jc)}}finally{Bb()}return!0};k.observe_=function(J,da){return Cb(this,J)};k.intercept_=function(J){return sb(this,J)};k.notifyPropertyAddition_=function(J,da){var qa,Ca,Ia=Ab(this);Ia&&(da=Ia?{type:"add",
observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:J,newValue:da}:null,Ia&&Ub(this,da));null==(qa=this.pendingKeys_)?void 0:null==(Ca=qa.get(J))?void 0:Ca.set(!0);this.keysAtom_.reportChanged()};k.ownKeys_=function(){this.keysAtom_.reportObserved();return fq(this.target_)};k.keys_=function(){this.keysAtom_.reportObserved();return Object.keys(this.target_)};return c}(),Dz=H("ObservableObjectAdministration",Xv),Ez=Sd(0),Pt=0,Yv=function(){};(function(c,k){Object.setPrototypeOf?
Object.setPrototypeOf(c.prototype,k):void 0!==c.prototype.__proto__?c.prototype.__proto__=k:c.prototype=k})(Yv,Array.prototype);var Qt=function(c,k,J){function da(Ca,Ia,bb,rb){void 0===bb&&(bb="ObservableArray");void 0===rb&&(rb=!1);var Pb=c.call(this)||this;Ia=new rm(bb,Ia,rb,!0);Ia.proxy_=ea(Pb);I(ea(Pb),Gh,Ia);Ca&&Ca.length&&(Ia=Tc(!0),Pb.spliceWithArray(0,0,Ca),Vf.allowStateChanges=Ia);Object.defineProperty(ea(Pb),"0",Ez);return Pb}fa(da,c);var qa=da.prototype;qa.concat=function(){this[Gh].atom_.reportObserved();
for(var Ca=arguments.length,Ia=Array(Ca),bb=0;bb<Ca;bb++)Ia[bb]=arguments[bb];return Array.prototype.concat.apply(this.slice(),Ia.map(function(rb){return Kc(rb)?rb.slice():rb}))};qa[J]=function(){var Ca=this,Ia=0;return $a({next:function(){return Ia<Ca.length?{value:Ca[Ia++],done:!1}:{done:!0,value:void 0}}})};aa(da,[{key:"length",get:function(){return this[Gh].getArrayLength_()},set:function(Ca){this[Gh].setArrayLength_(Ca)}},{key:k,get:function(){return"Array"}}]);return da}(Yv,Symbol.toStringTag,
Symbol.iterator);Object.entries(Tk).forEach(function(c){var k=c[0];c=c[1];"concat"!==k&&t(Qt.prototype,k,c)});vd(1E3);var Zv=vp.toString;["Symbol","Map","Set"].forEach(function(c){"undefined"===typeof F()[c]&&e("MobX requires global '"+c+"' to be available or polyfilled")});"object"===typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:ec,extras:{getDebugName:cb},$mobx:Gh});var Fz=ca(602),wk=class{constructor(c){vb(this,"props");vb(this,"aspectRatio");vb(this,"type");
vb(this,"hideCloneHandles",!1);vb(this,"hideResizeHandles",!1);vb(this,"hideRotateHandle",!1);vb(this,"hideContextBar",!1);vb(this,"hideSelectionDetail",!1);vb(this,"hideSelection",!1);vb(this,"canChangeAspectRatio",!0);vb(this,"canUnmount",!0);vb(this,"canResize",[!0,!0]);vb(this,"canScale",!0);vb(this,"canFlip",!0);vb(this,"canEdit",!1);vb(this,"canBind",!1);vb(this,"nonce");vb(this,"bindingDistance",4);vb(this,"isDirty",!1);vb(this,"lastSerialized");vb(this,"getCenter",()=>Xe.getBoundsCenter(this.bounds));
vb(this,"getRotatedBounds",()=>{const {bounds:Ca,props:{rotation:Ia}}=this;return Ia?Xe.getBoundsFromPoints(Xe.getRotatedCorners(Ca,Ia)):Ca});vb(this,"hitTestPoint",Ca=>{var Ia=this.rotatedBounds;if(!this.props.rotation)return th.pointInBounds(Ca,Ia);Ia=Xe.getRotatedCorners(Ia,this.props.rotation);return th.pointInPolygon(Ca,Ia)});vb(this,"hitTestLineSegment",(Ca,Ia)=>{const bb=Xe.getBoundsFromPoints([Ca,Ia]),{rotatedBounds:rb,props:{rotation:Pb=0}}=this;return Xe.boundsContain(rb,bb)||Pb?g(Ca,Ia,
Xe.getRotatedCorners(this.bounds)).didIntersect:0<n(rb,Ca,Ia).length});vb(this,"hitTestBounds",Ca=>{const {rotatedBounds:Ia,props:{rotation:bb=0}}=this,rb=Xe.getRotatedCorners(this.bounds,bb);return Xe.boundsContain(Ca,Ia)||0<w([Ca.minX,Ca.minY],[Ca.width,Ca.height],rb).length});vb(this,"getExpandedBounds",()=>Xe.expandBounds(this.getBounds(),this.bindingDistance));vb(this,"getBindingPoint",(Ca,Ia,bb,rb)=>{var Pb=this.getBounds(),jc=this.getExpandedBounds();if(th.pointInBounds(Ca,jc)){var yc=C(Ia,
bb,jc).filter(Rc=>Rc.didIntersect).map(Rc=>Rc.points[0]);if(yc.length)return bb=this.getCenter(),yc=yc.sort((Rc,jd)=>Rd.dist(jd,Ia)-Rd.dist(Rc,Ia))[0],yc=Rd.med(Ca,yc),rb?(rb=2>Rd.dist(Ca,bb)?bb:Ca,Pb=0):(rb=2>Rd.distanceToLineSegment(Ca,yc,bb)?bb:yc,Pb=th.pointInBounds(Ca,Pb)?this.bindingDistance:Math.max(this.bindingDistance,Xe.getBoundsSides(Pb).map(Rc=>Rd.distanceToLineSegment(Rc[1][0],Rc[1][1],Ca)).sort((Rc,jd)=>Rc-jd)[0])),jc=Rd.divV(Rd.sub(rb,[jc.minX,jc.minY]),[jc.width,jc.height]),{point:Rd.clampV(jc,
0,1),distance:Pb}}});vb(this,"getSerialized",()=>Db(gg(tf({},this.props),{type:this.type,nonce:this.nonce})));vb(this,"getCachedSerialized",()=>{!this.isDirty&&this.lastSerialized||Tb(()=>{this.setIsDirty(!1);this.setLastSerialized(this.getSerialized())});if(this.lastSerialized)return this.lastSerialized;throw Error("Should not get here for getCachedSerialized");});vb(this,"validateProps",Ca=>Ca);vb(this,"update",(Ca,Ia=!1,bb=!1)=>{Ia||this.isDirty||this.setIsDirty(!0);Ia||bb||this.incNonce();Object.assign(this.props,
this.validateProps(Ca));return this});vb(this,"clone",()=>new this.constructor(this.serialized));vb(this,"onResetBounds",Ca=>this);vb(this,"scale",[1,1]);vb(this,"onResizeStart",Ca=>{var Ia;this.scale=[...(null!=(Ia=this.props.scale)?Ia:[1,1])];return this});vb(this,"onResize",(Ca,Ia)=>{const {bounds:bb,rotation:rb,scale:[Pb,jc]}=Ia;Ca=[...this.scale];0>Pb&&(Ca[0]*=-1);0>jc&&(Ca[1]*=-1);this.update({point:[bb.minX,bb.minY],scale:Ca,rotation:rb});return this});vb(this,"onHandleChange",(Ca,{id:Ia,delta:bb})=>
{if(void 0!==Ca.handles){var rb=Bp(Ca.handles);rb[Ia]=gg(tf({},rb[Ia]),{point:Rd.add(bb,Ca.handles[Ia].point)});var Pb=Xe.getCommonTopLeft(Object.values(rb).map(jc=>jc.point));Object.values(rb).forEach(jc=>{jc.point=Rd.sub(jc.point,Pb)});this.update({point:Rd.add(Ca.point,Pb),handles:rb})}});var k,J;const da=this.constructor.id,qa=null!=(k=this.constructor.defaultProps)?k:{};this.type=da;this.props=tf(tf({scale:[1,1]},qa),c);this.nonce=null!=(J=c.nonce)?J:Date.now();zc(this)}get id(){return this.props.id}setNonce(c){this.nonce=
c}incNonce(){this.nonce++}setIsDirty(c){this.isDirty=c}setLastSerialized(c){this.lastSerialized=c}get center(){return this.getCenter()}get bounds(){return this.getBounds()}get rotatedBounds(){return this.getRotatedBounds()}get serialized(){return this.getCachedSerialized()}getShapeSVGJsx(c){c=this.getBounds();const {stroke:k,strokeWidth:J,strokeType:da,opacity:qa,fill:Ca,noFill:Ia,borderRadius:bb}=this.props;return(0,Fz.jsx)("rect",{fill:Ia?"none":sf(Ca,"background"),stroke:sf(k,"stroke"),strokeWidth:null!=
J?J:2,strokeDasharray:"dashed"===da?"8 2":void 0,fillOpacity:null!=qa?qa:.2,width:c.width,height:c.height,rx:bb,ry:bb})}};vb(wk,"type");pe([Sg],wk.prototype,"props",2);pe([Sg],wk.prototype,"canResize",2);pe([Sg],wk.prototype,"nonce",2);pe([Sg],wk.prototype,"isDirty",2);pe([Sg],wk.prototype,"lastSerialized",2);pe([Zg],wk.prototype,"id",1);pe([Ic],wk.prototype,"setNonce",1);pe([Ic],wk.prototype,"incNonce",1);pe([Ic],wk.prototype,"setIsDirty",1);pe([Ic],wk.prototype,"setLastSerialized",1);pe([Zg],wk.prototype,
"center",1);pe([Zg],wk.prototype,"bounds",1);pe([Zg],wk.prototype,"rotatedBounds",1);pe([Zg],wk.prototype,"serialized",1);pe([Ic],wk.prototype,"update",2);var $k=class extends wk{constructor(c={}){super(c);vb(this,"canBind",!0);vb(this,"getBounds",()=>{const [k,J]=this.props.point,[da,qa]=this.props.size;return{minX:k,minY:J,maxX:k+da,maxY:J+qa,width:da,height:qa}});vb(this,"getRotatedBounds",()=>Xe.getBoundsFromPoints(Xe.getRotatedCorners(this.bounds,this.props.rotation)));vb(this,"onResize",(k,
J)=>{const {bounds:da,rotation:qa,scale:[Ca,Ia]}=J;k=[...this.scale];0>Ca&&(k[0]*=-1);0>Ia&&(k[1]*=-1);this.update({point:[da.minX,da.minY],scale:k,rotation:qa});return this.update({rotation:qa,point:[da.minX,da.minY],size:[Math.max(1,da.width),Math.max(1,da.height)],scale:k})});vb(this,"validateProps",k=>{void 0!==k.size&&(k.size[0]=Math.max(k.size[0],1),k.size[1]=Math.max(k.size[1],1));return k});zc(this)}};vb($k,"id","box");vb($k,"defaultProps",{id:"box",type:"box",parentId:"page",point:[0,0],
size:[100,100]});var nq=class extends wk{constructor(c={}){super(c);vb(this,"getBounds",()=>{const {pointBounds:k,props:{point:J}}=this;return Xe.translateBounds(k,J)});vb(this,"getRotatedBounds",()=>{const {props:{rotation:k,point:J},bounds:da,rotatedPoints:qa}=this;return k?Xe.translateBounds(Xe.getBoundsFromPoints(qa),J):da});vb(this,"normalizedPoints",[]);vb(this,"isResizeFlippedX",!1);vb(this,"isResizeFlippedY",!1);vb(this,"onResizeStart",()=>{var k;const {bounds:J,props:{points:da}}=this;this.scale=
[...(null!=(k=this.props.scale)?k:[1,1])];const qa=[J.width,J.height];this.normalizedPoints=da.map(Ca=>Ld.divV(Ca,qa));return this});vb(this,"onResize",(k,J)=>{const {bounds:da,scale:[qa,Ca]}=J,Ia=[da.width,da.height];k=[...this.scale];0>qa&&(k[0]*=-1);0>Ca&&(k[1]*=-1);return this.update(qa||Ca?{point:[da.minX,da.minY],points:this.normalizedPoints.map(bb=>Ld.mulV(bb,Ia).concat(bb[2])),scale:k}:{point:[da.minX,da.minY],points:this.normalizedPoints.map(bb=>Ld.mulV(bb,Ia).concat(bb[2]))})});vb(this,
"hitTestPoint",k=>{const {props:{points:J,point:da}}=this;return th.pointNearToPolyline(Ld.sub(k,da),J)});vb(this,"hitTestLineSegment",(k,J)=>{const {bounds:da,props:{points:qa,point:Ca}}=this;if(th.pointInBounds(k,da)||th.pointInBounds(J,da)||0<n(da,k,J).length){const Ia=Ld.sub(k,Ca),bb=Ld.sub(J,Ca);return g(Ia,bb,qa).didIntersect||!!qa.find(rb=>5>Ld.dist(Ia,rb)||5>Ld.dist(bb,rb))}return!1});vb(this,"hitTestBounds",k=>{const {rotatedBounds:J,props:{points:da,point:qa}}=this,Ca=Xe.translateBounds(k,
Ld.neg(qa));return Xe.boundsContain(k,J)||da.every(Ia=>th.pointInBounds(Ia,Ca))||Xe.boundsCollide(k,J)&&0<D([Ca.minX,Ca.minY],[Ca.width,Ca.height],da).length});zc(this)}get pointBounds(){const {props:{points:c}}=this;return Xe.getBoundsFromPoints(c)}get rotatedPoints(){const {props:{point:c,points:k,rotation:J},center:da}=this;if(!J)return k;const qa=Ld.sub(da,c);return k.map(Ca=>Ld.rotWith(Ca,qa,J))}};vb(nq,"id","draw");vb(nq,"defaultProps",{id:"draw",type:"draw",parentId:"page",point:[0,0],points:[],
isComplete:!1});pe([Zg],nq.prototype,"pointBounds",1);pe([Zg],nq.prototype,"rotatedPoints",1);var Rt=class extends $k{constructor(c={}){super(c);vb(this,"getBounds",()=>{const {props:{point:[k,J],size:[da,qa]}}=this;return Xe.getRotatedEllipseBounds(k,J,da/2,qa/2,0)});vb(this,"getRotatedBounds",()=>{const {props:{point:[k,J],size:[da,qa],rotation:Ca}}=this;return Xe.getRotatedEllipseBounds(k,J,da/2,qa/2,Ca)});vb(this,"hitTestPoint",k=>{const {props:{size:J,rotation:da},center:qa}=this;return th.pointInEllipse(k,
qa,J[0],J[1],da||0)});vb(this,"hitTestLineSegment",(k,J)=>{const {props:{size:[da,qa],rotation:Ca=0},center:Ia}=this;return f(k,J,Ia,da,qa,Ca).didIntersect});vb(this,"hitTestBounds",k=>{const {props:{size:[J,da],rotation:qa=0},rotatedBounds:Ca}=this;var Ia;if(!(Ia=Xe.boundsContain(k,Ca))){const {minX:bb,minY:rb,width:Pb,height:jc}=k;Ia=0<r(this.center,J/2,da/2,qa,[bb,rb],[Pb,jc]).length}return Ia});zc(this)}};vb(Rt,"id","ellipse");vb(Rt,"defaultProps",{id:"ellipse",type:"ellipse",parentId:"page",
point:[0,0],size:[100,100]});var St=class extends $k{constructor(c={}){super(c);vb(this,"onResetBounds",k=>{const {clipping:J,size:da,point:qa}=this.props;if(J){const [Ca,Ia,bb,rb]=Array.isArray(J)?J:[J,J,J,J];return this.update({clipping:0,point:[qa[0]-rb,qa[1]-Ca],size:[da[0]+(rb-Ia),da[1]+(Ca-bb)]})}if(k.asset){const {size:[Ca,Ia]}=k.asset;this.update({clipping:0,point:[qa[0]+da[0]/2-Ca/2,qa[1]+da[1]/2-Ia/2],size:[Ca,Ia]})}return this});vb(this,"onResize",(k,J)=>{const {bounds:da,clip:qa,scale:Ca}=
J;({clipping:J}=this.props);const {clipping:Ia}=k;if(qa){const {point:[bb,rb],size:[Pb,jc]}=k,[yc,Rc,jd,fd]=Ia?Array.isArray(Ia)?Ia:[Ia,Ia,Ia,Ia]:[0,0,0,0];J=[yc+(da.minY-rb),Rc+(da.maxX-(bb+Pb)),jd+(da.maxY-(rb+jc)),fd+(da.minX-bb)]}else void 0!==Ia&&(J=Array.isArray(Ia)?Ia:[Ia,Ia,Ia,Ia],J=[J[0]*Ca[1],J[1]*Ca[0],J[2]*Ca[1],J[3]*Ca[0]]);if(J&&Array.isArray(J)){const bb=J;bb.every((rb,Pb)=>0===Pb||rb===bb[Pb-1])&&(J=bb[0])}return this.update({point:[da.minX,da.minY],size:[Math.max(1,da.width),Math.max(1,
da.height)],clipping:J})});zc(this)}};vb(St,"id","ellipse");vb(St,"defaultProps",{id:"ellipse",type:"ellipse",parentId:"page",point:[0,0],size:[100,100],clipping:0,objectFit:"none",assetId:""});var $v=class extends wk{constructor(c={}){super(c);vb(this,"getBounds",()=>{const {points:k,props:{point:J}}=this;return Xe.translateBounds(Xe.getBoundsFromPoints(k),J)});vb(this,"getRotatedBounds",()=>{const {rotatedPoints:k,props:{point:J}}=this;return Xe.translateBounds(Xe.getBoundsFromPoints(k),J)});vb(this,
"normalizedHandles",[]);vb(this,"onResizeStart",()=>{var k;const {props:{handles:J},bounds:da}=this;this.scale=[...(null!=(k=this.props.scale)?k:[1,1])];const qa=[da.width,da.height];this.normalizedHandles=Object.values(J).map(Ca=>Ld.divV(Ca.point,qa));return this});vb(this,"onResize",(k,J)=>{const {bounds:da,scale:[qa,Ca]}=J,{props:{handles:Ia},normalizedHandles:bb}=this,rb=[da.width,da.height];k=[...this.scale];0>qa&&(k[0]*=-1);0>Ca&&(k[1]*=-1);return this.update({point:[da.minX,da.minY],handles:Object.values(Ia).map((Pb,
jc)=>gg(tf({},Pb),{point:Ld.mulV(bb[jc],rb)})),scale:k})});vb(this,"hitTestPoint",k=>{const {points:J}=this;return th.pointNearToPolyline(Ld.sub(k,this.props.point),J)});vb(this,"hitTestLineSegment",(k,J)=>{const {bounds:da,points:qa,props:{point:Ca}}=this;if(th.pointInBounds(k,da)||th.pointInBounds(J,da)||0<n(da,k,J).length){const Ia=Ld.sub(k,Ca),bb=Ld.sub(J,Ca);return g(Ia,bb,qa).didIntersect||!!qa.find(rb=>5>Ld.dist(Ia,rb)||5>Ld.dist(bb,rb))}return!1});vb(this,"hitTestBounds",k=>{const {rotatedBounds:J,
points:da,props:{point:qa}}=this,Ca=Xe.translateBounds(k,Ld.neg(qa));return Xe.boundsContain(k,J)||da.every(Ia=>th.pointInBounds(Ia,Ca))||Xe.boundsCollide(k,J)&&0<D([Ca.minX,Ca.minY],[Ca.width,Ca.height],da).length});vb(this,"validateProps",k=>{k.point&&(k.point=[0,0]);void 0!==k.handles&&1>Object.values(k.handles).length&&(k.handles=$v.defaultProps.handles);return k});zc(this)}get points(){return Object.values(this.props.handles).map(c=>c.point)}get centroid(){const {points:c}=this;return ui.getPolygonCentroid(c)}get rotatedPoints(){const {centroid:c,
props:{handles:k,rotation:J}}=this;return J?Object.values(k).map(da=>Ld.rotWith(da.point,c,J)):this.points}},oq=$v;vb(oq,"id","polyline");vb(oq,"defaultProps",{id:"polyline",type:"polyline",parentId:"page",point:[0,0],handles:{}});pe([Zg],oq.prototype,"points",1);pe([Zg],oq.prototype,"centroid",1);pe([Zg],oq.prototype,"rotatedPoints",1);var aw=class extends oq{constructor(c={}){super(c);vb(this,"hideResizeHandles",!0);vb(this,"hideRotateHandle",!0);vb(this,"validateProps",k=>{k.point&&(k.point=[0,
0]);void 0!==k.handles&&1>Object.values(k.handles).length&&(k.handles=aw.defaultProps.handles);return k});vb(this,"getHandlesChange",(k,J)=>{var da=gj(k.handles,J);da=gj(da,{start:{point:Rd.toFixed(da.start.point)},end:{point:Rd.toFixed(da.end.point)}});if(!Rd.isEqual(da.start.point,da.end.point)){J={point:k.point,handles:Bp(da)};k=k.point;da=Xe.translateBounds(Xe.getBoundsFromPoints(Object.values(da).map(Ca=>Ca.point)),J.point);var qa=Rd.sub([da.minX,da.minY],k);Rd.isEqual(qa,[0,0])||(Object.values(J.handles).forEach(Ca=>
{Ca.point=Rd.toFixed(Rd.sub(Ca.point,qa))}),J.point=Rd.toFixed(Rd.add(J.point,qa)));return J}});zc(this)}},vr=aw;vb(vr,"id","line");vb(vr,"defaultProps",{id:"line",type:"line",parentId:"page",point:[0,0],handles:{start:{id:"start",canBind:!0,point:[0,0]},end:{id:"end",canBind:!0,point:[1,1]}}});var xo=class extends $k{constructor(c={}){super(c);vb(this,"getRotatedBounds",()=>{const {rotatedVertices:k,props:{point:J},offset:da}=this;return Xe.translateBounds(Xe.getBoundsFromPoints(k),Ld.add(J,da))});
vb(this,"hitTestPoint",k=>{const {vertices:J}=this;return th.pointInPolygon(Ld.add(k,this.props.point),J)});vb(this,"hitTestLineSegment",(k,J)=>{const {vertices:da,props:{point:qa}}=this;return g(Ld.sub(k,qa),Ld.sub(J,qa),da).didIntersect});vb(this,"hitTestBounds",k=>{const {rotatedBounds:J,offset:da,rotatedVertices:qa,props:{point:Ca}}=this,Ia=Xe.translateBounds(k,Ld.neg(Ld.add(Ca,da)));return Xe.boundsContain(k,J)||qa.every(bb=>th.pointInBounds(bb,Ia))||0<w([Ia.minX,Ia.minY],[Ia.width,Ia.height],
qa).length});vb(this,"validateProps",k=>{k.point&&(k.point=[0,0]);void 0!==k.sides&&3>k.sides&&(k.sides=3);return k});zc(this)}get vertices(){return this.getVertices()}get pageVertices(){const {props:{point:c},vertices:k}=this;return k.map(J=>Ld.add(J,c))}get centroid(){const {vertices:c}=this;return ui.getPolygonCentroid(c)}get rotatedVertices(){const {vertices:c,centroid:k,props:{rotation:J}}=this;return J?c.map(da=>Ld.rotWith(da,k,J)):c}get offset(){const {props:{size:[c,k]}}=this,J=Xe.getBoundsCenter(Xe.getBoundsFromPoints(this.vertices));
return Ld.sub(Ld.div([c,k],2),J)}getVertices(c=0){const {ratio:k,sides:J,size:da}=this.props;return 3===J?ui.getTriangleVertices(da,c,k):ui.getPolygonVertices(da,J,c,k)}};vb(xo,"id","polygon");vb(xo,"defaultProps",{id:"polygon",type:"polygon",parentId:"page",point:[0,0],size:[100,100],sides:5,ratio:1,isFlippedY:!1});pe([Zg],xo.prototype,"vertices",1);pe([Zg],xo.prototype,"pageVertices",1);pe([Zg],xo.prototype,"centroid",1);pe([Zg],xo.prototype,"rotatedVertices",1);pe([Zg],xo.prototype,"offset",1);
var Tt=class extends $k{constructor(c={}){super(c);vb(this,"canEdit",!0);vb(this,"canFlip",!1);zc(this)}};vb(Tt,"id","text");vb(Tt,"defaultProps",{id:"text",type:"text",parentId:"page",isSizeLocked:!0,point:[0,0],size:[16,32],text:""});var ss=class extends $k{constructor(c={}){super(c);vb(this,"canEdit",!1);vb(this,"canFlip",!1);vb(this,"getBounds",()=>0===this.shapes.length?(Le().deleteShapes([this.id]),{minX:0,minY:0,maxX:0,maxY:0,width:0,height:0}):Xe.getCommonBounds(this.shapes.map(k=>k.getBounds())));
zc(this);this.canResize=[!1,!1]}getShapes(){throw Error("will be implemented other places");}get shapes(){return this.getShapes()}};vb(ss,"id","group");vb(ss,"defaultProps",{id:"group",type:"group",parentId:"page",point:[0,0],size:[0,0],children:[]});pe([Zg],ss.prototype,"shapes",1);var pq=class{constructor(){vb(this,"_id");vb(this,"_initial");vb(this,"_states");vb(this,"_isActive",!1);vb(this,"cursor");vb(this,"_disposables",[]);vb(this,"children",new Map([]));vb(this,"registerStates",J=>{J.forEach(da=>
this.children.set(da.id,new da(this,this)));return this});vb(this,"deregisterStates",J=>{J.forEach(da=>{var qa;null==(qa=this.children.get(da.id))?void 0:qa.dispose();this.children.delete(da.id)});return this});vb(this,"currentState",{});vb(this,"transition",(J,da={})=>{if(0===this.children.size)throw Error(`Tool ${this.id} has no states, cannot transition to ${J}.`);const qa=this.children.get(J),Ca=this.currentState;if(!qa)throw Error(`Could not find a state named ${J}.`);Tb(()=>{this.currentState?
(Ca._events.onExit(gg(tf({},da),{toId:J})),Ca.dispose(),this.setCurrentState(qa),this._events.onTransition(gg(tf({},da),{fromId:Ca.id,toId:J})),qa._events.onEnter(gg(tf({},da),{fromId:Ca.id}))):(this.currentState=qa,qa._events.onEnter(gg(tf({},da),{fromId:""})))});return this});vb(this,"isIn",J=>{J=J.split(".").reverse();let da=this;for(;0<J.length;){const qa=J.pop();if(!qa)return!0;if(da.currentState.id===qa){if(0===J.length)return!0;da=da.currentState}else break}return!1});vb(this,"isInAny",(...J)=>
J.some(this.isIn));vb(this,"forwardEvent",(J,...da)=>{var qa,Ca;(null==(Ca=null==(qa=this.currentState)?void 0:qa._events)?0:Ca[J])&&Tb(()=>{var Ia;return null==(Ia=this.currentState._events)?void 0:Ia[J](...da)})});vb(this,"_events",{onTransition:J=>{var da;null==(da=this.onTransition)?void 0:da.call(this,J)},onEnter:J=>{var da;this._isActive=!0;this.initial&&this.transition(this.initial,J);null==(da=this.onEnter)?void 0:da.call(this,J)},onExit:J=>{var da,qa,Ca;this._isActive=!1;null==(qa=null==
(da=this.currentState)?void 0:da.onExit)?void 0:qa.call(da,{toId:"parent"});null==(Ca=this.onExit)?void 0:Ca.call(this,J)},onPointerDown:(J,da)=>{var qa;null==(qa=this.onPointerDown)?void 0:qa.call(this,J,da);this.forwardEvent("onPointerDown",J,da)},onPointerUp:(J,da)=>{var qa;null==(qa=this.onPointerUp)?void 0:qa.call(this,J,da);this.forwardEvent("onPointerUp",J,da)},onPointerMove:(J,da)=>{var qa;null==(qa=this.onPointerMove)?void 0:qa.call(this,J,da);this.forwardEvent("onPointerMove",J,da)},onPointerEnter:(J,
da)=>{var qa;null==(qa=this.onPointerEnter)?void 0:qa.call(this,J,da);this.forwardEvent("onPointerEnter",J,da)},onPointerLeave:(J,da)=>{var qa;null==(qa=this.onPointerLeave)?void 0:qa.call(this,J,da);this.forwardEvent("onPointerLeave",J,da)},onDoubleClick:(J,da)=>{var qa;null==(qa=this.onDoubleClick)?void 0:qa.call(this,J,da);this.forwardEvent("onDoubleClick",J,da)},onKeyDown:(J,da)=>{var qa;this._events.onModifierKey(J,da);null==(qa=this.onKeyDown)?void 0:qa.call(this,J,da);this.forwardEvent("onKeyDown",
J,da)},onKeyUp:(J,da)=>{var qa;this._events.onModifierKey(J,da);null==(qa=this.onKeyUp)?void 0:qa.call(this,J,da);this.forwardEvent("onKeyUp",J,da)},onPinchStart:(J,da)=>{var qa;null==(qa=this.onPinchStart)?void 0:qa.call(this,J,da);this.forwardEvent("onPinchStart",J,da)},onPinch:(J,da)=>{var qa;null==(qa=this.onPinch)?void 0:qa.call(this,J,da);this.forwardEvent("onPinch",J,da)},onPinchEnd:(J,da)=>{var qa;null==(qa=this.onPinchEnd)?void 0:qa.call(this,J,da);this.forwardEvent("onPinchEnd",J,da)},onModifierKey:(J,
da)=>{switch(da.key){case "Shift":case "Alt":case "Ctrl":case "Meta":this._events.onPointerMove(J,da)}}});vb(this,"onEnter");vb(this,"onExit");vb(this,"onTransition");vb(this,"onPointerDown");vb(this,"onPointerUp");vb(this,"onPointerMove");vb(this,"onPointerEnter");vb(this,"onPointerLeave");vb(this,"onDoubleClick");vb(this,"onKeyDown");vb(this,"onKeyUp");vb(this,"onPinchStart");vb(this,"onPinch");vb(this,"onPinchEnd");const c=this.constructor.initial,k=this.constructor.states;this._id=this.constructor.id;
this._initial=c;this._states=k}dispose(){this._disposables.forEach(c=>c());this._disposables=[];return this}get initial(){return this._initial}get states(){return this._states}get id(){return this._id}get isActive(){return this._isActive}get ascendants(){return[this]}get descendants(){return Array.from(this.children.values()).flatMap(c=>[c,...c.descendants])}setCurrentState(c){this.currentState=c}};vb(pq,"id");vb(pq,"shortcuts");pe([Sg],pq.prototype,"currentState",2);pe([Ic],pq.prototype,"setCurrentState",
1);var Ut=class extends pq{constructor(c,k){var J,da;super();vb(this,"_root");vb(this,"_parent");vb(this,"children",new Map([]));vb(this,"registerStates",qa=>{qa.forEach(Ca=>this.children.set(Ca.id,new Ca(this,this._root)));return this});vb(this,"deregisterStates",qa=>{qa.forEach(Ca=>{var Ia;null==(Ia=this.children.get(Ca.id))?void 0:Ia.dispose();this.children.delete(Ca.id)});return this});this._parent=c;this._root=k;this.states&&0<this.states.length&&(this.registerStates(this.states),c=null!=(J=
this.initial)?J:this.states[0].id,J=this.children.get(c))&&(this.setCurrentState(J),null==(da=this.currentState)?void 0:da._events.onEnter({fromId:"initial"}));zc(this)}get root(){return this._root}get parent(){return this._parent}get ascendants(){return this.parent?"ascendants"in this.parent?[...this.parent.ascendants,this]:[this.parent,this]:[this]}};vb(Ut,"cursor");var yo=class extends Ut{constructor(){super(...arguments);vb(this,"isLocked",!1);vb(this,"previous");vb(this,"onEnter",({fromId:c})=>
{this.previous=c;this.cursor&&this.app.cursors.setCursor(this.cursor)});vb(this,"onTransition",c=>{({toId:c}=c);c=this.children.get(c);this.app.cursors.reset();c.cursor?this.app.cursors.setCursor(c.cursor):this.cursor&&this.app.cursors.setCursor(this.cursor)})}get app(){return this.root}},zi=class extends Ut{get app(){return this.root}get tool(){return this.parent}},bw=class extends zi{constructor(){super(...arguments);vb(this,"cursor","crosshair");vb(this,"creatingShape");vb(this,"aspectRatio");
vb(this,"initialBounds",{});vb(this,"onEnter",()=>{const {currentPage:c,inputs:{originPoint:k,currentPoint:J}}=this.app;var {Shape:da}=this.tool;da=new da({id:Ff(),type:da.id,parentId:c.id,point:[...k],fill:this.app.settings.color,stroke:this.app.settings.color,size:Rd.abs(Rd.sub(J,k))});this.initialBounds={minX:k[0],minY:k[1],maxX:k[0]+1,maxY:k[1]+1,width:1,height:1};da.canChangeAspectRatio||(da.aspectRatio?(this.aspectRatio=da.aspectRatio,this.initialBounds.height=this.aspectRatio):(this.aspectRatio=
1,this.initialBounds.height=1),this.initialBounds.width=1,this.initialBounds.maxY=this.initialBounds.minY+this.initialBounds.height);this.creatingShape=da;this.creatingShape.setScaleLevel(this.app.settings.scaleLevel);this.app.currentPage.addShapes(da);this.app.setSelectedShapes([da])});vb(this,"onPointerMove",c=>{if(!c.order){if(!this.creatingShape)throw Error("Expected a creating shape.");var {initialBounds:k}=this,{currentPoint:J,originPoint:da,shiftKey:qa}=this.app.inputs;c=qa||this.creatingShape.props.isAspectRatioLocked||
!this.creatingShape.canChangeAspectRatio;k=Xe.getTransformedBoundingBox(k,"bottom_right_corner",Rd.sub(J,da),0,c);this.app.settings.snapToGrid&&!c&&(k=Xe.snapBoundsToGrid(k,8));this.creatingShape.update({point:[k.minX,k.minY],size:[k.width,k.height]})}});vb(this,"onPointerUp",()=>{this.tool.transition("idle");this.creatingShape?(this.app.setSelectedShapes([this.creatingShape]),this.app.api.editShape(this.creatingShape)):this.app.transition("select");this.app.persist()});vb(this,"onKeyDown",(c,k)=>
{switch(k.key){case "Escape":if(!this.creatingShape)throw Error("Expected a creating shape.");this.app.deleteShapes([this.creatingShape]);this.tool.transition("idle")}})}};vb(bw,"id","creating");var cw=class extends zi{constructor(){super(...arguments);vb(this,"onPointerDown",(c,k)=>{c.order||this.tool.transition("pointing")});vb(this,"onPinchStart",(...c)=>{var k,J;this.app.transition("select",{returnTo:this.app.currentState.id});null==(J=(k=this.app._events).onPinchStart)?void 0:J.call(k,...c)});
vb(this,"onKeyDown",(c,k)=>{switch(k.key){case "Escape":this.app.transition("select")}})}};vb(cw,"id","idle");var dw=class extends zi{constructor(){super(...arguments);vb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:k}=this.app.inputs;5<Ld.dist(c,k)&&!this.app.readOnly&&(this.tool.transition("creating"),this.app.setSelectedShapes(this.app.currentPage.shapes))});vb(this,"onPointerUp",()=>{this.tool.transition("idle")})}};vb(dw,"id","pointing");var Tn=class extends yo{constructor(){super(...arguments);
vb(this,"cursor","crosshair")}};vb(Tn,"id","box");vb(Tn,"states",[cw,dw,bw]);vb(Tn,"initial","idle");var ew=class extends zi{constructor(){super(...arguments);vb(this,"shape",{});vb(this,"points",[[0,0,.5]]);vb(this,"persistDebounced",lg(this.app.persist,200));vb(this,"onPinchStart",(c,k)=>{this.tool.transition("pinching",{info:c,event:k})});vb(this,"onEnter",()=>{var c;const {Shape:k,previousShape:J}=this.tool;var {originPoint:da}=this.app.inputs;this.app.history.pause();if(this.app.inputs.shiftKey&&
J){this.shape=J;var {shape:qa}=this;var Ca=qa.props.points[qa.props.points.length-1];const bb=Ld.sub(da,qa.props.point).concat(null!=(c=da[2])?c:.5);this.points=[...qa.props.points,Ca,Ca];const rb=Math.ceil(Ld.dist(Ca,da)/16);for(let Pb=0,jc=Pb/(rb-1);Pb<rb;Pb++){c=this.points;da=c.push;qa=Ld.lrp(Ca,bb,jc);var Ia=Ca[2];da.call(c,qa.concat.call(qa,Ia+(bb[2]-Ia)*jc))}this.addNextPoint(bb)}else this.tool.previousShape=void 0,this.points=[[0,0,null!=(Ca=da[2])?Ca:.5]],this.shape=new k({id:Ff(),type:k.id,
parentId:this.app.currentPage.id,point:da.slice(0,2),points:this.points,isComplete:!1,fill:this.app.settings.color,stroke:this.app.settings.color}),this.shape.setScaleLevel(this.app.settings.scaleLevel),this.app.currentPage.addShapes(this.shape)});vb(this,"onPointerMove",()=>{const {shape:c}=this,{currentPoint:k,previousPoint:J}=this.app.inputs;Ld.isEqual(J,k)||this.addNextPoint(Ld.sub(k,c.props.point).concat(k[2]))});vb(this,"onPointerUp",()=>{if(!this.shape)throw Error("Expected a creating shape.");
this.app.history.resume();this.shape.update({isComplete:!0,points:this.tool.simplify?th.simplify2(this.points,this.tool.simplifyTolerance):this.shape.props.points});this.tool.previousShape=this.shape;this.tool.transition("idle");let c=this.app.selectedTool.id;"pencil"===c||"highlighter"===c?this.persistDebounced():this.app.persist()});vb(this,"onKeyDown",(c,k)=>{switch(k.key){case "Escape":if(!this.shape)throw Error("Expected a creating shape.");this.app.deleteShapes([this.shape]);this.tool.transition("idle")}})}addNextPoint(c){const {shape:k}=
this,J=Ld.min(c,[0,0]);this.points.push(c);0>J[0]||0>J[1]?(this.points=this.points.map(da=>Ld.sub(da,J).concat(da[2])),k.update({point:Ld.add(k.props.point,J),points:this.points})):k.update({points:this.points})}};vb(ew,"id","creating");var fw=class extends zi{constructor(){super(...arguments);vb(this,"onPointerDown",(c,k)=>{c.order||this.app.readOnly||this.tool.transition("creating")});vb(this,"onPinchStart",(c,k)=>{this.tool.transition("pinching",{info:c,event:k})});vb(this,"onKeyDown",(c,k)=>{switch(k.key){case "Escape":this.app.transition("select")}})}};
vb(fw,"id","idle");var gw=class extends zi{constructor(){super(...arguments);vb(this,"origin",[0,0]);vb(this,"prevDelta",[0,0]);vb(this,"onEnter",c=>{this.prevDelta=c.info.delta;this.origin=c.info.point});vb(this,"onPinch",c=>{this.app.viewport.pinchZoom(c.point,c.delta,c.delta[2])});vb(this,"onPinchEnd",()=>{this.tool.transition("idle")})}};vb(gw,"id","pinching");var wr=class extends yo{constructor(){super(...arguments);vb(this,"cursor","crosshair");vb(this,"simplify",!0);vb(this,"simplifyTolerance",
1);vb(this,"previousShape");vb(this,"onPinchStart",(c,k)=>{this.transition("pinching",{info:c,event:k})})}};vb(wr,"id","draw");vb(wr,"states",[fw,ew,gw]);vb(wr,"initial","idle");var hw=class extends zi{constructor(){super(...arguments);vb(this,"points",[[0,0,.5]]);vb(this,"hitShapes",new Set);vb(this,"onEnter",()=>{const {originPoint:c}=this.app.inputs;this.points=[c];this.hitShapes.clear()});vb(this,"onPointerMove",()=>{const {currentPoint:c,previousPoint:k}=this.app.inputs;Ld.isEqual(k,c)||(this.points.push(c),
this.app.shapesInViewport.filter(J=>J.hitTestLineSegment(k,c)).forEach(J=>this.hitShapes.add(J)),this.app.setErasingShapes(Array.from(this.hitShapes.values())))});vb(this,"onPointerUp",()=>{this.app.deleteShapes(Array.from(this.hitShapes.values()));this.tool.transition("idle")});vb(this,"onKeyDown",(c,k)=>{switch(k.key){case "Escape":this.app.setErasingShapes([]),this.tool.transition("idle")}})}};vb(hw,"id","erasing");var iw=class extends zi{constructor(){super(...arguments);vb(this,"onPointerDown",
(c,k)=>{c.order||this.tool.transition("pointing")});vb(this,"onPinchStart",(...c)=>{var k,J;this.app.transition("select",{returnTo:this.app.currentState.id});null==(J=(k=this.app._events).onPinchStart)?void 0:J.call(k,...c)});vb(this,"onKeyDown",(c,k)=>{switch(k.key){case "Escape":this.app.transition("select")}})}};vb(iw,"id","idle");var jw=class extends zi{constructor(){super(...arguments);vb(this,"onEnter",()=>{const {currentPoint:c}=this.app.inputs;this.app.setErasingShapes(this.app.shapesInViewport.filter(k=>
k.hitTestPoint(c)))});vb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:k}=this.app.inputs;5<Ld.dist(c,k)&&(this.tool.transition("erasing"),this.app.setSelectedShapes([]))});vb(this,"onPointerUp",()=>{const c=[...this.app.erasingShapes];this.app.setErasingShapes([]);this.app.deleteShapes(c);this.tool.transition("idle")})}};vb(jw,"id","pointing");var ts=class extends yo{constructor(){super(...arguments);vb(this,"cursor","crosshair")}};vb(ts,"id","erase");vb(ts,"states",[iw,jw,hw]);vb(ts,
"initial","idle");var Vt=class extends zi{constructor(){super(...arguments);vb(this,"handle",{});vb(this,"handleId","end");vb(this,"currentShape",{});vb(this,"initialShape",{});vb(this,"bindableShapeIds",[]);vb(this,"startBindingShapeId");vb(this,"newStartBindingId","");vb(this,"draggedBindingId","");vb(this,"onPointerMove",()=>{const {inputs:{shiftKey:c,previousPoint:k,originPoint:J,currentPoint:da,modKey:qa,altKey:Ca},settings:{snapToGrid:Ia}}=this.app;var bb=this.app.getShapeById(this.initialShape.id),
{handles:rb}=this.initialShape,Pb=this.handleId,jc="start"===this.handleId?"end":"start";if(!Rd.isEqual(k,da)){var yc=Rd.sub(da,J);if(c){var Rc=rb[jc].point,jd=Rd.add(rb[Pb].point,yc),fd=Rd.angle(Rc,jd);Rc=Rd.rotWith(jd,Rc,yi.snapAngleToSegments(fd,24)-fd);yc=Rd.add(yc,Rd.sub(Rc,jd))}yc=Rd.add(rb[Pb].point,yc);rb={[Pb]:gg(tf({},rb[Pb]),{point:Ia?Rd.snap(yc,8):Rd.toFixed(yc),bindingId:void 0})};var xd=this.currentShape.getHandlesChange(this.initialShape,rb);if(xd){rb=gj(bb.props,xd);var Fd={},Xc;Pb=
rb.handles[Pb];jc=rb.handles[jc];if(this.startBindingShapeId){var id;if(yc=this.app.getShapeById(this.startBindingShapeId)){jd=yc.getCenter();Rc=rb.handles.end;var nd=Rd.add(rb.handles.start.point,rb.point);Rd.isEqual(nd,jd)&&nd[1]++;fd=yc.hitTestPoint(da);nd=Rd.uni(Rd.sub(nd,jd));const Gd=void 0!==this.app.currentPage.bindings[this.newStartBindingId];qa||yc.hitTestPoint(Rd.add(rb.point,Rc.point))||(id=Zc(bb.props,yc,"start",this.newStartBindingId,jd,jd,nd,fd));id&&!Gd?(Fd[this.newStartBindingId]=
id,rb.handles.start.bindingId=id.id):!id&&Gd&&(console.log("removing start binding"),delete Fd[this.newStartBindingId],rb.handles.start.bindingId=void 0)}}if(!qa){id=Rd.add(jc.point,rb.point);jc=Rd.add(Pb.point,rb.point);Pb=Rd.uni(Rd.sub(jc,id));const Gd=Rd.add(rb.point,rb.handles.start.point),wd=Rd.add(rb.point,rb.handles.end.point);yc=this.bindableShapeIds.map(Ge=>this.app.getShapeById(Ge)).sort((Ge,Je)=>Je.nonce-Ge.nonce).filter(Ge=>![Gd,wd].every(Je=>Ge.hitTestPoint(Je)));for(const Ge of yc)if(Xc=
Zc(bb.props,Ge,this.handleId,this.draggedBindingId,jc,id,Pb,Ca))break}Xc?(Fd[this.draggedBindingId]=Xc,rb=gj(rb,{handles:{[this.handleId]:{bindingId:this.draggedBindingId}}})):(bb=bb.props.handles[this.handleId].bindingId,void 0!==bb&&(delete Fd[bb],rb=gj(rb,{handles:{[this.handleId]:{bindingId:void 0}}})));xd=this.currentShape.getHandlesChange(rb,rb.handles);Tb(()=>{var Gd;if(xd){this.currentShape.update(xd);this.app.currentPage.updateBindings(Fd);const wd=Object.values(null!=(Gd=xd.handles)?Gd:
{}).map(Ge=>Ge.bindingId).map(Ge=>this.app.currentPage.bindings[Ge]).filter(Boolean).flatMap(Ge=>[Ge.toId,Ge.fromId].filter(Boolean));this.app.setBindingShapes(wd)}})}}});vb(this,"onPointerUp",()=>{this.tool.transition("idle");this.currentShape&&this.app.setSelectedShapes([this.currentShape]);this.app.transition("select");this.app.persist()});vb(this,"onExit",()=>{this.app.clearBindingShape();this.app.history.resume();this.app.persist()});vb(this,"onKeyDown",(c,k)=>{switch(k.key){case "Escape":this.app.deleteShapes([this.currentShape]),
this.tool.transition("idle")}})}};vb(Vt,"id","creating");var kw=class extends Vt{constructor(){super(...arguments);vb(this,"onEnter",()=>{var c;this.app.history.pause();this.newStartBindingId=Ff();this.draggedBindingId=Ff();this.bindableShapeIds=this.app.currentPage.getBindableShapes();var {Shape:k}=this.tool;const {originPoint:J}=this.app.inputs;k=new k(gg(tf({},k.defaultProps),{id:Ff(),type:k.id,parentId:this.app.currentPage.id,point:this.app.settings.snapToGrid?Rd.snap(J,8):J,fill:this.app.settings.color,
stroke:this.app.settings.color,scaleLevel:this.app.settings.scaleLevel}));this.initialShape=Db(k.props);this.currentShape=k;this.app.currentPage.addShapes(k);this.app.setSelectedShapes([k]);if(this.startBindingShapeId=null==(c=this.bindableShapeIds.map(da=>this.app.getShapeById(da)).filter(da=>th.pointInBounds(J,da.bounds))[0])?void 0:c.id)this.bindableShapeIds.splice(this.bindableShapeIds.indexOf(this.startBindingShapeId),1),this.app.setBindingShapes([this.startBindingShapeId])})}};vb(kw,"id","creating");
var lw=class extends zi{constructor(){super(...arguments);vb(this,"onPointerDown",(c,k)=>{c.order||this.tool.transition("pointing")});vb(this,"onPinchStart",(...c)=>{var k,J;this.app.transition("select",{returnTo:this.app.currentState.id});null==(J=(k=this.app._events).onPinchStart)?void 0:J.call(k,...c)});vb(this,"onKeyDown",(c,k)=>{switch(k.key){case "Escape":this.app.transition("select")}});vb(this,"onPointerEnter",c=>{if(!c.order)switch(c.type){case "shape":this.app.setHoveredShape(c.shape.id);
break;case "selection":"background"!==c.handle&&"center"!==c.handle&&this.tool.transition("hoveringSelectionHandle",c)}});vb(this,"onPointerLeave",c=>{c.order||"shape"===c.type&&this.app.hoveredId&&this.app.setHoveredShape(void 0)})}};vb(lw,"id","idle");var mw=class extends zi{constructor(){super(...arguments);vb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:k}=this.app.inputs;5<Ld.dist(c,k)&&!this.app.readOnly&&(this.tool.transition("creating"),this.app.setSelectedShapes(this.app.currentPage.shapes))})}};
vb(mw,"id","pointing");var us=class extends yo{constructor(){super(...arguments);vb(this,"cursor","crosshair")}};vb(us,"id","line");vb(us,"states",[lw,mw,kw]);vb(us,"initial","idle");var nw=class extends zi{constructor(){super(...arguments);vb(this,"cursor","crosshair");vb(this,"creatingShape");vb(this,"aspectRatio");vb(this,"initialBounds",{});vb(this,"onEnter",()=>{const {currentPage:c,inputs:{originPoint:k}}=this.app,{Shape:J}=this.tool,da=new J({id:Ff(),type:J.id,parentId:c.id,point:[...k],text:"",
size:[16,32],isSizeLocked:!0,fill:this.app.settings.color,stroke:this.app.settings.color});this.creatingShape=da;this.creatingShape.setScaleLevel(this.app.settings.scaleLevel);Tb(()=>{this.app.currentPage.addShapes(da);const qa=this.app.settings.snapToGrid?Rd.snap([...k],8):k,{bounds:Ca}=da;da.update({point:Rd.sub(qa,[Ca.width/2,Ca.height/2])});this.app.transition("select");this.app.setSelectedShapes([da]);this.app.currentState.transition("editingShape",{type:"shape",shape:this.creatingShape,order:0})})})}};
vb(nw,"id","creating");var ow=class extends zi{constructor(){super(...arguments);vb(this,"onPointerDown",(c,k)=>{c.order||this.app.readOnly||this.tool.transition("creating")});vb(this,"onPinchStart",(...c)=>{var k,J;this.app.transition("select",{returnTo:this.app.currentState.id});null==(J=(k=this.app._events).onPinchStart)?void 0:J.call(k,...c)});vb(this,"onKeyDown",(c,k)=>{switch(k.key){case "Escape":this.app.transition("select")}})}};vb(ow,"id","idle");var vs=class extends yo{constructor(){super(...arguments);
vb(this,"cursor","crosshair")}};vb(vs,"id","box");vb(vs,"states",[ow,nw]);vb(vs,"initial","idle");var Gz=Uf(ba()),Hz=class extends Gz.default{constructor(){super(...arguments);vb(this,"toBBox",c=>c.rotatedBounds)}},pw=class extends zi{constructor(){super(...arguments);vb(this,"initialSelectedIds",[]);vb(this,"initialSelectedShapes",[]);vb(this,"tree",new Hz);vb(this,"onEnter",()=>{const {selectedShapes:c,currentPage:k,selectedIds:J}=this.app;this.initialSelectedIds=Array.from(J.values());this.initialSelectedShapes=
Array.from(c.values());this.tree.load(k.shapes)});vb(this,"onExit",()=>{this.initialSelectedIds=[];this.tree.clear();this.app.setBrush(void 0)});vb(this,"onPointerMove",()=>{const {inputs:{shiftKey:c,ctrlKey:k,originPoint:J,currentPoint:da}}=this.app,qa=Xe.getBoundsFromPoints([da,J],0);this.app.setBrush(qa);const Ca=[...(new Set(this.tree.search(qa).filter(Ia=>k?Xe.boundsContain(qa,Ia.rotatedBounds):Ia.hitTestBounds(qa)).filter(Ia=>"group"!==Ia.type).map(Ia=>{var bb;return null!=(bb=this.app.getParentGroup(Ia))?
bb:Ia})))];c?Ca.every(Ia=>this.initialSelectedShapes.includes(Ia))?this.app.setSelectedShapes(this.initialSelectedShapes.filter(Ia=>!Ca.includes(Ia))):this.app.setSelectedShapes([...(new Set([...this.initialSelectedShapes,...Ca]))]):this.app.setSelectedShapes(Ca);this.app.viewport.panToPointWhenNearBounds(da)});vb(this,"onPointerUp",()=>{this.app.setBrush(void 0);this.tool.transition("idle")});vb(this,"handleModifierKey",(c,k)=>{switch(k.key){case "Escape":this.app.setBrush(void 0),this.app.setSelectedShapes(this.initialSelectedIds),
this.tool.transition("idle")}})}};vb(pw,"id","brushing");var qw=class extends zi{constructor(){super(...arguments);vb(this,"onEnter",c=>{var k;const {selectedIds:J,inputs:{shiftKey:da}}=this.app;if("shape"===c.type&&!J.has(c.shape.id)){const qa=null!=(k=this.app.getParentGroup(c.shape))?k:c.shape;da?this.app.setSelectedShapes([...Array.from(J.values()),qa.id]):this.app.setSelectedShapes([qa])}});vb(this,"onPointerDown",()=>{this.tool.transition("idle")})}};vb(qw,"id","contextMenu");var rw=class extends zi{constructor(){super(...arguments);
vb(this,"onEnter",c=>{"pinching"===c.fromId&&this.parent.returnTo&&this.app.transition(this.parent.returnTo)});vb(this,"onExit",()=>{});vb(this,"onPointerEnter",c=>{if(!c.order)switch(c.type){case "shape":this.app.setHoveredShape(c.shape.id);break;case "selection":"background"!==c.handle&&"center"!==c.handle&&this.tool.transition("hoveringSelectionHandle",c);break;case "canvas":this.app.setHoveredShape(void 0)}});vb(this,"onPointerDown",(c,k)=>{const {selectedShapes:J,inputs:{ctrlKey:da}}=this.app;
if(2===k.button)this.tool.transition("contextMenu",c);else if(da)this.tool.transition("pointingCanvas");else switch(c.type){case "selection":switch(c.handle){case "center":break;case "background":this.tool.transition("pointingBoundsBackground");break;case "rotate":this.tool.transition("pointingRotateHandle");break;default:this.tool.transition("pointingResizeHandle",c)}break;case "shape":if(J.has(c.shape))this.tool.transition("pointingSelectedShape",c);else{const {selectionBounds:qa,inputs:Ca}=this.app;
qa&&th.pointInBounds(Ca.currentPoint,qa)?this.tool.transition("pointingShapeBehindBounds",c):this.tool.transition("pointingShape",c)}break;case "handle":this.tool.transition("pointingHandle",c);break;case "canvas":this.tool.transition("pointingCanvas");break;case "minimap":this.tool.transition("pointingMinimap",tf(tf({},k),c))}});vb(this,"onPointerLeave",c=>{c.order||"shape"===c.type&&this.app.hoveredId&&this.app.setHoveredShape(void 0)});vb(this,"onPinchStart",(c,k)=>{this.tool.transition("pinching",
{info:c,event:k})});vb(this,"onDoubleClick",c=>{if(!c.order&&1===this.app.selectedShapesArray.length&&!this.app.readOnly){var k=this.app.selectedShapesArray[0];if(k.canEdit&&!k.props.isLocked)switch(c.type){case "shape":this.tool.transition("editingShape",c);break;case "selection":1===this.app.selectedShapesArray.length&&this.tool.transition("editingShape",{type:"shape",target:k})}}});vb(this,"onKeyDown",(c,k)=>{({selectedShapesArray:c}=this.app);switch(k.key){case "Enter":1===c.length&&c[0].canEdit&&
!this.app.readOnly&&this.tool.transition("editingShape",{type:"shape",shape:c[0],order:0});break;case "Escape":c.length&&this.app.setSelectedShapes([])}})}};vb(rw,"id","idle");var sw=class extends zi{constructor(){super(...arguments);vb(this,"onEnter",c=>{var k;const {selectedIds:J,inputs:{shiftKey:da}}=this.app,qa=null!=(k=this.app.getParentGroup(c.shape))?k:c.shape;da?this.app.setSelectedShapes([...Array.from(J.values()),qa.id]):this.app.setSelectedShapes([qa])});vb(this,"onPointerMove",()=>{const {currentPoint:c,
originPoint:k}=this.app.inputs;5<Ld.dist(c,k)&&!this.app.readOnly&&this.tool.transition("translating")});vb(this,"onPointerUp",()=>{this.tool.transition("idle")});vb(this,"onPinchStart",(c,k)=>{this.tool.transition("pinching",{info:c,event:k})})}};vb(sw,"id","pointingShape");var tw=class extends zi{constructor(){super(...arguments);vb(this,"cursor","move");vb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:k}=this.app.inputs;5<Ld.dist(c,k)&&!this.app.readOnly&&this.tool.transition("translating")});
vb(this,"onPointerUp",()=>{this.app.setSelectedShapes([]);this.tool.transition("idle")});vb(this,"onPinchStart",(c,k)=>{this.tool.transition("pinching",{info:c,event:k})})}};vb(tw,"id","pointingBoundsBackground");var uw=class extends zi{constructor(){super(...arguments);vb(this,"onEnter",()=>{var c;const {shiftKey:k}=this.app.inputs;k||(this.app.setSelectedShapes([]),this.app.setEditingShape(),null==(c=window.getSelection())?void 0:c.removeAllRanges())});vb(this,"onPointerMove",()=>{const {currentPoint:c,
originPoint:k}=this.app.inputs;5<Ld.dist(c,k)&&this.tool.transition("brushing")});vb(this,"onPointerUp",()=>{this.app.inputs.shiftKey||this.app.setSelectedShapes([]);this.tool.transition("idle")});vb(this,"onPinchStart",(c,k)=>{this.tool.transition("pinching",{info:c,event:k})});vb(this,"onDoubleClick",()=>{this.app.notify("canvas-dbclick",{point:this.app.inputs.originPoint})})}};vb(uw,"id","pointingCanvas");var vw=class extends zi{constructor(){super(...arguments);vb(this,"cursor","move");vb(this,
"isCloning",!1);vb(this,"didClone",!1);vb(this,"initialPoints",{});vb(this,"initialShapePoints",{});vb(this,"initialClonePoints",{});vb(this,"clones",[]);vb(this,"onEnter",()=>{var c;this.app.history.pause();const {allSelectedShapesArray:k,inputs:J}=this.app;this.initialPoints=this.initialShapePoints=Object.fromEntries(k.map(({id:da,props:{point:qa}})=>[da,qa.slice()]));document.querySelectorAll("input,textarea").forEach(da=>da.blur());null==(c=document.getSelection())?void 0:c.empty();J.altKey?this.startCloning():
this.moveSelectedShapesToPointer()});vb(this,"onExit",()=>{this.app.history.resume();this.isCloning=this.didClone=!1;this.clones=[];this.initialPoints={};this.initialShapePoints={};this.initialClonePoints={}});vb(this,"onPointerMove",()=>{const {inputs:{currentPoint:c}}=this.app;this.moveSelectedShapesToPointer();this.app.viewport.panToPointWhenNearBounds(c)});vb(this,"onPointerDown",()=>{this.app.history.resume();this.app.persist();this.tool.transition("idle")});vb(this,"onPointerUp",()=>{this.app.history.resume();
this.app.persist();this.tool.transition("idle")});vb(this,"onKeyDown",(c,k)=>{switch(k.key){case "Alt":this.startCloning();break;case "Escape":this.app.allSelectedShapes.forEach(J=>{J.update({point:this.initialPoints[J.id]})}),this.tool.transition("idle")}});vb(this,"onKeyUp",(c,k)=>{switch(k.key){case "Alt":if(!this.isCloning)throw Error("Expected to be cloning.");const {currentPage:J,allSelectedShapes:da}=this.app;J.removeShapes(...da);this.initialPoints=this.initialShapePoints;this.app.setSelectedShapes(Object.keys(this.initialPoints));
this.moveSelectedShapesToPointer();this.isCloning=!1}})}moveSelectedShapesToPointer(){const {inputs:{shiftKey:c,originPoint:k,currentPoint:J}}=this.app,{initialPoints:da}=this,qa=Ld.sub(J,k);c&&(Math.abs(qa[0])<Math.abs(qa[1])?qa[0]=0:qa[1]=0);Tb(()=>{this.app.allSelectedShapesArray.filter(Ca=>!Ca.props.isLocked).forEach(Ca=>{let Ia=Ld.add(da[Ca.id],qa);this.app.settings.snapToGrid&&(Ia=Ld.snap(Ia,8));Ca.update({point:Ia})})})}startCloning(){this.didClone||(this.clones=this.app.allSelectedShapesArray.map(c=>
{const k=this.app.getShapeClass(c.type);if(!k)throw Error("Could not find that shape class.");return new k(gg(tf({},c.serialized),{id:Ff(),type:c.type,point:this.initialPoints[c.id],rotation:c.props.rotation,isLocked:!1}))}),this.initialClonePoints=Object.fromEntries(this.clones.map(({id:c,props:{point:k}})=>[c,k.slice()])),this.didClone=!0);this.app.allSelectedShapes.forEach(c=>{c.update({point:this.initialPoints[c.id]})});this.initialPoints=this.initialClonePoints;this.app.currentPage.addShapes(...this.clones);
this.app.setSelectedShapes(Object.keys(this.initialClonePoints));this.moveSelectedShapesToPointer();this.isCloning=!0}};vb(vw,"id","translating");var ww=class extends zi{constructor(){super(...arguments);vb(this,"pointedSelectedShape");vb(this,"onEnter",c=>{this.pointedSelectedShape=c.shape});vb(this,"onExit",()=>{this.pointedSelectedShape=void 0});vb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:k}=this.app.inputs;5<Ld.dist(c,k)&&!this.app.readOnly&&this.tool.transition("translating")});
vb(this,"onPointerUp",()=>{const {shiftKey:c,currentPoint:k}=this.app.inputs;var {selectedShapesArray:J}=this.app;if(!this.pointedSelectedShape)throw Error("Expected a pointed selected shape");if(c)({selectedIds:J}=this.app),J=Array.from(J.values()),J.splice(J.indexOf(this.pointedSelectedShape.id),1),this.app.setSelectedShapes(J);else{if(1===J.length&&this.pointedSelectedShape.canEdit&&!this.app.readOnly&&!this.pointedSelectedShape.props.isLocked&&this.pointedSelectedShape instanceof $k&&th.pointInBounds(k,
this.pointedSelectedShape.bounds)){this.tool.transition("editingShape",{shape:this.pointedSelectedShape,order:0,type:"shape"});return}this.app.setSelectedShapes([this.pointedSelectedShape.id])}this.tool.transition("idle")});vb(this,"onPinchStart",(c,k)=>{this.tool.transition("pinching",{info:c,event:k})})}};vb(ww,"id","pointingSelectedShape");var xw=class extends zi{constructor(){super(...arguments);vb(this,"info",{});vb(this,"onEnter",c=>{this.info=c;this.updateCursor()});vb(this,"onExit",()=>{this.app.cursors.reset()});
vb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:k}=this.app.inputs;5<Ld.dist(c,k)&&this.tool.transition("resizing",this.info)});vb(this,"onPointerUp",()=>{this.tool.transition("hoveringSelectionHandle",this.info)});vb(this,"onPinchStart",(c,k)=>{this.tool.transition("pinching",{info:c,event:k})})}updateCursor(){this.app.cursors.setCursor(xi[this.info.handle],this.app.selectionBounds.rotation)}};vb(xw,"id","pointingResizeHandle");var yw=class extends zi{constructor(){super(...arguments);
vb(this,"isSingle",!1);vb(this,"handle","bottom_right_corner");vb(this,"snapshots",{});vb(this,"initialCommonBounds",{});vb(this,"selectionRotation",0);vb(this,"resizeType","corner");vb(this,"onEnter",c=>{var k,J;const {history:da,selectedShapesArray:qa,selectionBounds:Ca}=this.app;if(!Ca)throw Error("Expected a selected bounds.");this.handle=c.handle;this.resizeType="left_edge"===c.handle||"right_edge"===c.handle?"horizontal-edge":"top_edge"===c.handle||"bottom_edge"===c.handle?"vertical-edge":"corner";
this.app.cursors.setCursor(yw.CURSORS[c.handle],null==(k=this.app.selectionBounds)?void 0:k.rotation);da.pause();const Ia=Xe.getBoundsFromPoints(qa.map(bb=>Xe.getBoundsCenter(bb.bounds)));this.selectionRotation=(this.isSingle=1===qa.length)?null!=(J=qa[0].props.rotation)?J:0:0;this.initialCommonBounds=tf({},Ca);this.snapshots=Object.fromEntries(qa.map(bb=>{const rb=tf({},bb.bounds),[Pb,jc]=Xe.getBoundsCenter(rb);return[bb.id,{props:bb.serialized,bounds:rb,transformOrigin:[(Pb-this.initialCommonBounds.minX)/
this.initialCommonBounds.width,(jc-this.initialCommonBounds.minY)/this.initialCommonBounds.height],innerTransformOrigin:[(Pb-Ia.minX)/Ia.width,(jc-Ia.minY)/Ia.height],isAspectRatioLocked:bb.props.isAspectRatioLocked||!(bb.canChangeAspectRatio&&!bb.props.rotation)}]}));qa.forEach(bb=>{var rb;null==(rb=bb.onResizeStart)?void 0:rb.call(bb,{isSingle:this.isSingle})})});vb(this,"onExit",()=>{this.app.cursors.reset();this.snapshots={};this.initialCommonBounds={};this.selectionRotation=0;this.app.history.resume()});
vb(this,"onPointerMove",()=>{const {inputs:{altKey:c,shiftKey:k,ctrlKey:J,originPoint:da,currentPoint:qa}}=this.app,{handle:Ca,snapshots:Ia,initialCommonBounds:bb}=this;let rb=Ld.sub(qa,da);c&&(rb=Ld.mul(rb,2));const Pb=this.app.selectedShapes.values().next().value;let jc=Xe.getTransformedBoundingBox(bb,Ca,rb,this.selectionRotation,k||this.isSingle&&(J?!("clipping"in Pb.props):!Pb.canChangeAspectRatio||Pb.props.isAspectRatioLocked));c&&(jc=tf(tf({},jc),Xe.centerBounds(jc,Xe.getBoundsCenter(bb))));
const {scaleX:yc,scaleY:Rc}=jc;this.app.selectedShapes.forEach(jd=>{var fd,xd;const {isAspectRatioLocked:Fd,props:Xc,bounds:id,transformOrigin:nd}=Ia[jd.id];let Gd=Xe.getRelativeTransformedBoundingBox(jc,bb,id,0>yc,0>Rc);if(jd.canResize.some(Je=>Je)||jd.props.isSizeLocked||!this.isSingle){var wd=[yc,Rc],Ge=null!=(fd=Xc.rotation)?fd:0;fd=Xe.getBoundsCenter(Gd);jd.canFlip||(wd=Ld.abs(wd));jd.canScale||(wd=null!=(xd=Xc.scale)?xd:[1,1]);if(Ge&&0>yc&&0<=Rc||0>Rc&&0<=yc)Ge*=-1;this.app.settings.snapToGrid&&
!Fd&&(Gd=Xe.snapBoundsToGrid(Gd,8));jd.onResize(Xc,{center:fd,rotation:Ge,scale:wd,bounds:Gd,type:Ca,clip:J,transformOrigin:nd})}});this.updateCursor(yc,Rc);this.app.viewport.panToPointWhenNearBounds(qa)});vb(this,"onPointerUp",()=>{this.app.history.resume();this.app.persist();this.tool.transition("idle")});vb(this,"onKeyDown",(c,k)=>{switch(k.key){case "Escape":this.app.selectedShapes.forEach(J=>{J.update(tf({},this.snapshots[J.id].props))}),this.tool.transition("idle")}})}updateCursor(c,k){var J,
da,qa,Ca;const Ia=0>c&&0<=k;c=0>k&&0<=c;switch(this.handle){case "top_left_corner":case "bottom_right_corner":Ia||c?"nwse-resize"===this.app.cursors.cursor&&this.app.cursors.setCursor("nesw-resize",null==(J=this.app.selectionBounds)?void 0:J.rotation):"nesw-resize"===this.app.cursors.cursor&&this.app.cursors.setCursor("nwse-resize",null==(da=this.app.selectionBounds)?void 0:da.rotation);break;case "top_right_corner":case "bottom_left_corner":Ia||c?"nesw-resize"===this.app.cursors.cursor&&this.app.cursors.setCursor("nwse-resize",
null==(qa=this.app.selectionBounds)?void 0:qa.rotation):"nwse-resize"===this.app.cursors.cursor&&this.app.cursors.setCursor("nesw-resize",null==(Ca=this.app.selectionBounds)?void 0:Ca.rotation)}}},Wt=yw;vb(Wt,"id","resizing");vb(Wt,"CURSORS",{bottom_edge:"ns-resize",top_edge:"ns-resize",left_edge:"ew-resize",right_edge:"ew-resize",bottom_left_corner:"nesw-resize",bottom_right_corner:"nwse-resize",top_left_corner:"nwse-resize",top_right_corner:"nesw-resize"});var zw=class extends zi{constructor(){super(...arguments);
vb(this,"cursor","rotate");vb(this,"handle","");vb(this,"onEnter",c=>{this.app.history.pause();this.handle=c.handle;this.updateCursor()});vb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:k}=this.app.inputs;5<Ld.dist(c,k)&&this.tool.transition("rotating",{handle:this.handle})});vb(this,"onPointerUp",()=>{this.app.history.resume();this.app.persist();this.tool.transition("idle")});vb(this,"onPinchStart",(c,k)=>{this.tool.transition("pinching",{info:c,event:k})})}updateCursor(){this.app.cursors.setCursor(xi[this.handle],
this.app.selectionRotation)}};vb(zw,"id","pointingRotateHandle");var Aw=class extends zi{constructor(){super(...arguments);vb(this,"info",{});vb(this,"onEnter",c=>{this.info=c});vb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:k}=this.app.inputs;5<Ld.dist(c,k)&&!this.app.readOnly&&this.tool.transition("translating")});vb(this,"onPointerUp",()=>{const {selectedIds:c,inputs:{shiftKey:k}}=this.app;k?this.app.setSelectedShapes([...Array.from(c.values()),this.info.shape.id]):this.app.setSelectedShapes([this.info.shape.id]);
this.tool.transition("idle")});vb(this,"onPinchStart",(c,k)=>{this.tool.transition("pinching",{info:c,event:k})})}};vb(Aw,"id","pointingShapeBehindBounds");var Xt=class extends zi{constructor(){super(...arguments);vb(this,"cursor","rotate");vb(this,"snapshot",{});vb(this,"initialCommonCenter",[0,0]);vb(this,"initialCommonBounds",{});vb(this,"initialAngle",0);vb(this,"initialSelectionRotation",0);vb(this,"handle","");vb(this,"onEnter",c=>{const {history:k,selectedShapesArray:J,selectionBounds:da}=
this.app;if(!da)throw Error("Expected selected bounds.");k.pause();this.handle=c.handle;this.initialSelectionRotation=this.app.selectionRotation;this.initialCommonBounds=tf({},da);this.initialCommonCenter=Xe.getBoundsCenter(da);this.initialAngle=Ld.angle(this.initialCommonCenter,this.app.inputs.currentPoint);this.snapshot=Object.fromEntries(J.map(qa=>[qa.id,{point:[...qa.props.point],center:[...qa.center],rotation:qa.props.rotation,handles:"handles"in qa?Bp(qa.handles):void 0}]));this.updateCursor()});
vb(this,"onExit",()=>{this.app.history.resume();this.snapshot={}});vb(this,"onPointerMove",()=>{const {selectedShapes:c,inputs:{shiftKey:k,currentPoint:J}}=this.app,{snapshot:da,initialCommonCenter:qa,initialAngle:Ca,initialSelectionRotation:Ia}=this;let bb=Ld.angle(qa,J)-Ca;k&&(bb=yi.snapAngleToSegments(bb,24));c.forEach(Pb=>{var jc=da[Pb.id];let yc=0;if(k){var {rotation:Rc=0}=jc;yc=yi.snapAngleToSegments(Rc,24)-Rc}const jd=Ld.sub(jc.center,jc.point);Rc=Ld.rotWith(jc.center,qa,bb);if("handles"in
Pb){jc=jc.handles;const fd=jc.map(Fd=>Ld.rotWith(Fd.point,jd,bb)),xd=Xe.getCommonTopLeft(fd);Pb.update({point:Ld.add(xd,Ld.sub(Rc,jd)),handles:jc.map((Fd,Xc)=>gg(tf({},Fd),{point:Ld.sub(fd[Xc],xd)}))})}else Pb.update({point:Ld.sub(Rc,jd),rotation:yi.clampRadians((jc.rotation||0)+bb+yc)})});const rb=yi.clampRadians(Ia+bb);this.app.setSelectionRotation(k?yi.snapAngleToSegments(rb,24):rb);this.updateCursor()});vb(this,"onPointerUp",()=>{this.app.history.resume();this.app.persist();this.tool.transition("idle")});
vb(this,"onKeyDown",(c,k)=>{switch(k.key){case "Escape":this.app.selectedShapes.forEach(J=>{J.update(this.snapshot[J.id])}),this.tool.transition("idle")}})}updateCursor(){this.app.cursors.setCursor(xi[this.handle],this.app.selectionRotation)}};vb(Xt,"id","rotating");var Bw=class extends zi{constructor(){super(...arguments);vb(this,"onPinch",(c,k)=>{this.app.viewport.pinchZoom(c.point,c.delta,c.delta[2])});vb(this,"onPinchEnd",()=>{this.tool.transition("idle")});vb(this,"onPointerDown",()=>{this.tool.transition("idle")})}};
vb(Bw,"id","pinching");var Cw=class extends Vt{constructor(){super(...arguments);vb(this,"cursor","grabbing");vb(this,"onEnter",c=>{this.app.history.pause();this.newStartBindingId=Ff();this.draggedBindingId=Ff();this.bindableShapeIds=this.app.currentPage.getBindableShapes();this.handleId=c.id;this.currentShape=c.shape;this.initialShape=Db(this.currentShape.props);this.app.setSelectedShapes([this.currentShape])})}};vb(Cw,"id","translatingHandle");var Dw=class extends zi{constructor(){super(...arguments);
vb(this,"cursor","grabbing");vb(this,"info",{});vb(this,"onEnter",c=>{this.info=c});vb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:k}=this.app.inputs;5<Ld.dist(c,k)&&this.tool.transition("translatingHandle",this.info)});vb(this,"onPointerUp",()=>{this.tool.transition("idle")});vb(this,"onPinchStart",(c,k)=>{this.tool.transition("pinching",{info:c,event:k})})}};vb(Dw,"id","pointingHandle");var Ew=class extends zi{constructor(){super(...arguments);vb(this,"handle");vb(this,"onEnter",
c=>{var k;this.app.cursors.setCursor(xi[c.handle],null!=(k=this.app.selectionBounds.rotation)?k:0);this.handle=c.handle});vb(this,"onExit",()=>{this.app.cursors.reset()});vb(this,"onPinchStart",(c,k)=>{this.tool.transition("pinching",{info:c,event:k})});vb(this,"onPointerDown",c=>{switch(c.type){case "selection":switch(c.handle){case "center":break;case "background":break;case "top_left_resize_corner":case "top_right_resize_corner":case "bottom_right_resize_corner":case "bottom_left_resize_corner":this.tool.transition("pointingRotateHandle",
c);break;default:this.tool.transition("pointingResizeHandle",c)}}});vb(this,"onPointerLeave",()=>{this.tool.transition("idle")});vb(this,"onDoubleClick",c=>{var k;if(!c.order&&1===this.app.selectedShapes.size){var J=this.app.selectedShapes.values().next().value;if(!J.canEdit||this.app.readOnly||J.props.isLocked)J.onResetBounds({asset:J.props.assetId?this.app.assets[J.props.assetId]:void 0,zoom:this.app.viewport.camera.zoom}),this.tool.transition("idle");else switch(c.type){case "shape":this.tool.transition("editingShape",
c);break;case "selection":null==(k=J.onResetBounds)?void 0:k.call(J,{zoom:this.app.viewport.camera.zoom}),1===this.app.selectedShapesArray.length&&this.tool.transition("editingShape",{type:"shape",target:J})}}})}};vb(Ew,"id","hoveringSelectionHandle");var Fw=class extends zi{constructor(){super(...arguments);vb(this,"editingShape",{});vb(this,"onEnter",c=>{this.editingShape=c.shape;this.app.setEditingShape(c.shape)});vb(this,"onExit",()=>{var c;if(this.editingShape&&"text"in this.editingShape.props){const k=
this.editingShape.props.text.trim();""===k&&"text"===this.editingShape.props.type?this.app.deleteShapes([this.editingShape]):(this.editingShape.onResetBounds(),this.editingShape.update({text:k}))}this.app.persist();this.app.setEditingShape();null==(c=document.querySelector(".tl-canvas"))?void 0:c.focus()});vb(this,"onPinchStart",(c,k)=>{this.tool.transition("pinching",{info:c,event:k})});vb(this,"onPointerDown",c=>{switch(c.type){case "shape":if(c.shape===this.editingShape)break;this.tool.transition("idle",
c);break;case "canvas":c.order||this.tool.transition("idle",c)}});vb(this,"onKeyDown",(c,k)=>{switch(k.key){case "Escape":Tb(()=>{k.stopPropagation();this.app.setSelectedShapes([this.editingShape]);this.tool.transition("idle")})}})}};vb(Fw,"id","editingShape");var Gw=class extends zi{constructor(){super(...arguments);vb(this,"minimapZoom",1);vb(this,"minimapRect",{minX:0,minY:0,maxX:0,maxY:0,width:0,height:0});vb(this,"getCameraPoint",c=>{const k=document.querySelector(".tl-preview-minimap svg");
var J=document.querySelector(".tl-preview-minimap #minimap-camera-rect");if(k&&J){const da=k.getBoundingClientRect();this.minimapRect.height=da.height;this.minimapRect.width=da.width;this.minimapRect.minX=da.left;this.minimapRect.minY=da.top;this.minimapRect.maxX=da.right;this.minimapRect.maxY=da.bottom;this.minimapZoom=+k.dataset.commonBoundWidth/this.minimapRect.width;c=Ld.sub(c,[this.minimapRect.minX,this.minimapRect.minY]);J=J.getBoundingClientRect();J=Ld.mul(Ld.sub(c,[J.left+J.width/2,J.top+
J.height/2]),this.minimapZoom);return Ld.sub(this.app.viewport.camera.point,J)}});vb(this,"onEnter",c=>{(c=this.getCameraPoint([c.clientX,c.clientY]))?this.app.viewport.update({point:c}):this.tool.transition("idle")});vb(this,"onPointerMove",(c,k)=>{"clientX"in k&&(c=this.getCameraPoint([k.clientX,k.clientY]))&&this.app.viewport.update({point:c})});vb(this,"onPointerUp",()=>{this.tool.transition("idle")})}};vb(Gw,"id","pointingMinimap");var qq=class extends yo{constructor(){super(...arguments);vb(this,
"returnTo","");vb(this,"onEnter",c=>{this.returnTo=null==c?void 0:c.returnTo})}};vb(qq,"id","select");vb(qq,"initial","idle");vb(qq,"shortcut","whiteboard/select");vb(qq,"states",[rw,pw,qw,uw,sw,Aw,ww,tw,Ew,xw,zw,Gw,Dw,Cw,vw,Wt,Xt,Xt,Bw,Fw]);var Hw=class extends zi{constructor(){super(...arguments);vb(this,"cursor","grabbing");vb(this,"originalScreenPoint",[]);vb(this,"originalCameraPoint",[]);vb(this,"prevState","idle");vb(this,"onEnter",c=>{this.prevState=null==c?void 0:c.prevState;this.originalScreenPoint=
this.app.inputs.currentScreenPoint;this.originalCameraPoint=this.app.viewport.camera.point});vb(this,"onPointerMove",(c,k)=>{c=Rd.sub(this.originalScreenPoint,this.app.inputs.currentScreenPoint);this.app.viewport.update({point:Rd.sub(this.originalCameraPoint,Rd.div(c,this.app.viewport.camera.zoom))})});vb(this,"onPointerUp",()=>{var c;this.tool.transition(null!=(c=this.prevState)?c:"idle")})}};vb(Hw,"id","panning");var Iw=class extends zi{constructor(){super(...arguments);vb(this,"onEnter",c=>{this.parent.prevTool&&
c.exit&&(this.app.setCurrentState(this.parent.prevTool),setTimeout(()=>{this.app.cursors.reset();this.app.cursors.setCursor(this.parent.prevTool.cursor)}))});vb(this,"onPointerDown",(c,k)=>{c.order||this.tool.transition("panning")})}};vb(Iw,"id","idle");var Jw=class extends zi{constructor(){super(...arguments);vb(this,"onPointerDown",(c,k)=>{c.order||this.tool.transition("panning",{prevState:"idleHold"})});vb(this,"onPinchStart",(c,k)=>{this.tool.transition("pinching",{info:c,event:k})})}};vb(Jw,
"id","idleHold");var Kw=class extends zi{constructor(){super(...arguments);vb(this,"origin",[0,0]);vb(this,"prevDelta",[0,0]);vb(this,"onEnter",c=>{this.prevDelta=c.info.delta;this.origin=c.info.point});vb(this,"onPinch",c=>{this.app.viewport.pinchZoom(c.point,c.delta,c.delta[2])});vb(this,"onPinchEnd",()=>{this.tool.transition("idle")})}};vb(Kw,"id","pinching");var rq=class extends yo{constructor(){super(...arguments);vb(this,"cursor","grab");vb(this,"prevTool",null);vb(this,"onEnter",c=>{this.prevTool=
null==c?void 0:c.prevTool});vb(this,"onKeyDown",(c,k)=>{switch(k.key){case "Escape":this.app.transition("select")}});vb(this,"onPinchStart",(c,k)=>{this.transition("pinching",{info:c,event:k})})}};vb(rq,"id","move");vb(rq,"shortcut","whiteboard/pan");vb(rq,"states",[Iw,Jw,Hw,Kw]);vb(rq,"initial","idle");var xk=class{constructor(c,k={}){vb(this,"lastShapesNounces",null);vb(this,"app");vb(this,"id");vb(this,"name");vb(this,"shapes",[]);vb(this,"bindings",{});vb(this,"nonce",0);vb(this,"bringForward",
bb=>{const rb=this.parseShapesArg(bb);rb.sort((Pb,jc)=>this.shapes.indexOf(jc)-this.shapes.indexOf(Pb)).map(Pb=>this.shapes.indexOf(Pb)).forEach(Pb=>{if(Pb!==this.shapes.length-1&&!rb.includes(this.shapes[Pb+1])){var jc=this.shapes[Pb];this.shapes[Pb]=this.shapes[Pb+1];this.shapes[Pb+1]=jc}});this.app.persist();return this});vb(this,"sendBackward",bb=>{const rb=this.parseShapesArg(bb);rb.sort((Pb,jc)=>this.shapes.indexOf(Pb)-this.shapes.indexOf(jc)).map(Pb=>this.shapes.indexOf(Pb)).forEach(Pb=>{if(0!==
Pb&&!rb.includes(this.shapes[Pb-1])){var jc=this.shapes[Pb];this.shapes[Pb]=this.shapes[Pb-1];this.shapes[Pb-1]=jc}});this.app.persist();return this});vb(this,"bringToFront",bb=>{const rb=this.parseShapesArg(bb);this.shapes=this.shapes.filter(Pb=>!rb.includes(Pb)).concat(rb);this.app.persist();return this});vb(this,"sendToBack",bb=>{const rb=this.parseShapesArg(bb);this.shapes=rb.concat(this.shapes.filter(Pb=>!rb.includes(Pb)));this.app.persist();return this});vb(this,"flip",(bb,rb)=>{bb=this.parseShapesArg(bb);
const Pb=Xe.getCommonBounds(bb.map(jc=>jc.bounds));bb.forEach(jc=>{var yc;const Rc=Xe.getRelativeTransformedBoundingBox(Pb,Pb,jc.bounds,"horizontal"===rb,"vertical"===rb);if(jc.serialized)jc.onResize(jc.serialized,{bounds:Rc,center:Xe.getBoundsCenter(Rc),rotation:null!=(yc=jc.props.rotation)?yc:-0,type:"top_left_corner",scale:jc.canFlip&&jc.props.scale?"horizontal"===rb?[-jc.props.scale[0],1]:[1,-jc.props.scale[1]]:[1,1],clip:!1,transformOrigin:[.5,.5]})});this.app.persist();return this});vb(this,
"getShapeById",bb=>this.shapes.find(rb=>rb.id===bb));vb(this,"cleanup",bb=>{bb=tc(this.bindings,bb);const rb=new Set;let Pb=!1;const jc=Bp(this.bindings);bb.forEach(yc=>{var Rc;if(this.bindings[yc.id]){var jd=this.getShapeById(yc.toId),fd=this.getShapeById(yc.fromId);jd&&fd?rb.has(fd.id)||(yc=this.updateArrowBindings(fd),rb.add(fd.id),yc&&(jd=tf(tf({},fd.props),yc),null==(Rc=this.getShapeById(jd.id))?void 0:Rc.update(jd,!1,(0,Yz.default)(null==yc?void 0:yc.handles,null==fd?void 0:fd.props.handles)))):
(delete jc[yc.id],Pb=!0)}});Object.keys(jc).forEach(yc=>{const Rc=this.bindings[yc];0===this.shapes.filter(jd=>jd.id===Rc.fromId||jd.id===Rc.toId).length&&(delete jc[yc],Pb=!0)});Pb&&this.update({bindings:jc})});vb(this,"updateArrowBindings",bb=>{var rb,Pb,jc,yc={start:Bp(bb.props.handles.start),end:Bp(bb.props.handles.end)},Rc={isBound:!1,handle:bb.props.handles.start,point:Rd.add(bb.props.handles.start.point,bb.props.point)},jd={isBound:!1,handle:bb.props.handles.end,point:Rd.add(bb.props.handles.end.point,
bb.props.point)};if(bb.props.handles.start.bindingId){var fd=void 0!==(null==(rb=bb.props.decorations)?void 0:rb.start);rb=bb.props.handles.start;var xd=this.bindings[bb.props.handles.start.bindingId],Fd=this.getShapeById(null==xd?void 0:xd.toId);if(Fd){Rc=Fd.getBounds();var Xc=Fd.getExpandedBounds(),id=Xe.expandBounds(Rc,fd?xd.distance:1);const {minX:nd,minY:Gd,width:wd,height:Ge}=Xc,Je=Rd.add([nd,Gd],Rd.mulV([wd,Ge],Rd.rotWith(xd.point,[.5,.5],Fd.props.rotation||0)));Rc={isBound:!0,hasDecoration:fd,
binding:xd,handle:rb,point:Je,target:Fd,bounds:Rc,expandedBounds:Xc,intersectBounds:id,center:Fd.getCenter()}}}if(bb.props.handles.end.bindingId&&(fd=void 0!==(null==(Pb=bb.props.decorations)?void 0:Pb.end),Pb=bb.props.handles.end,rb=this.bindings[bb.props.handles.end.bindingId],xd=this.getShapeById(null==rb?void 0:rb.toId))){jd=xd.getBounds();Fd=xd.getExpandedBounds();Xc=fd?Xe.expandBounds(jd,rb.distance):jd;const {minX:nd,minY:Gd,width:wd,height:Ge}=Fd;id=Rd.add([nd,Gd],Rd.mulV([wd,Ge],Rd.rotWith(rb.point,
[.5,.5],xd.props.rotation||0)));jd={isBound:!0,hasDecoration:fd,binding:rb,handle:Pb,point:id,target:xd,bounds:jd,expandedBounds:Fd,intersectBounds:Xc,center:xd.getCenter()}}for(const nd of["end","start"]){Pb="start"===nd?Rc:jd;const Gd="start"===nd?jd:Rc;if(Pb.isBound)if(Pb.binding.distance){if(fd=Rd.uni(Rd.sub(Pb.point,Gd.point)),rb=C(Gd.point,fd,Pb.intersectBounds,Pb.target.props.rotation).filter(wd=>wd.didIntersect).map(wd=>wd.points[0]).sort((wd,Ge)=>Rd.dist(wd,Gd.point)-Rd.dist(Ge,Gd.point)),
rb[0])if(xd=void 0,Gd.isBound&&(xd=C(Gd.point,fd,Gd.intersectBounds,Gd.target.props.rotation).filter(wd=>wd.didIntersect).map(wd=>wd.points[0]).sort((wd,Ge)=>Rd.dist(wd,Gd.point)-Rd.dist(Ge,Gd.point))[0]),Gd.isBound&&(2>rb.length||xd&&rb[0]&&10>Math.ceil(Rd.dist(rb[0],xd))||Xe.boundsContain(Pb.expandedBounds,Gd.expandedBounds)||Xe.boundsCollide(Pb.expandedBounds,Gd.expandedBounds)))fd=Rd.uni(Rd.sub(Gd.point,Pb.point)),rb=C(Pb.point,fd,Pb.bounds,Pb.target.props.rotation).filter(wd=>wd.didIntersect).map(wd=>
wd.points[0]),rb[0]&&(yc[nd].point=Rd.toFixed(Rd.sub(rb[0],bb.props.point)),yc["start"===nd?"end":"start"].point=Rd.toFixed(Rd.add(Rd.sub(rb[0],bb.props.point),Rd.mul(fd,Math.min(Rd.dist(rb[0],Gd.point),10*(Xe.boundsContain(Gd.bounds,Pb.intersectBounds)?-1:1))))));else{if(!Gd.isBound&&(rb[0]&&10>Rd.dist(rb[0],Gd.point)||th.pointInBounds(Gd.point,Pb.intersectBounds)))return yc=Rd.uni(Rd.sub(Pb.center,Gd.point)),null==(jc=bb.getHandlesChange)?void 0:jc.call(bb,bb.props,{[nd]:gg(tf({},bb.props.handles[nd]),
{point:Rd.toFixed(Rd.add(Rd.sub(Gd.point,bb.props.point),Rd.mul(yc,10)))})});rb[0]&&(yc[nd].point=Rd.toFixed(Rd.sub(rb[0],bb.props.point)))}}else yc[nd].point=Rd.sub(Pb.point,bb.props.point)}return bb.getHandlesChange(bb.props,yc)});const {id:J,name:da,shapes:qa=[],bindings:Ca={},nonce:Ia}=k;this.id=J;this.name=da;this.bindings=Object.assign({},Ca);this.app=c;this.nonce=Ia||0;this.addShapes(...qa);zc(this);ic(()=>{const bb=0<this.shapes.length?Object.fromEntries(this.shapes.map(rb=>[rb.id,rb.nonce])):
null;if(this.lastShapesNounces&&bb){const rb=this.lastShapesNounces,Pb=[...(new Set([...Object.keys(bb),...Object.keys(rb)]))].filter(jc=>rb[jc]!==bb[jc]);requestAnimationFrame(()=>{this.cleanup(Pb)})}bb&&(this.lastShapesNounces=bb)})}get serialized(){return{id:this.id,name:this.name,shapes:this.shapes.map(c=>c.serialized).filter(c=>!!c).map(c=>Db(c)),bindings:Bp(this.bindings),nonce:this.nonce}}get shapesById(){return Object.fromEntries(this.shapes.map(c=>[c.id,c]))}update(c){Object.assign(this,
c);return this}updateBindings(c){Object.assign(this.bindings,c);return this}updateShapesIndex(c){this.shapes.sort((k,J)=>c.indexOf(k.id)-c.indexOf(J.id));return this}addShapes(...c){if(0!==c.length)return c="getBounds"in c[0]?c:c.map(k=>new (this.app.getShapeClass(k.type))(k)),this.shapes.push(...c),c}parseShapesArg(c){return"string"===typeof c[0]?this.shapes.filter(k=>c.includes(k.id)):c}removeShapes(...c){const k=this.parseShapesArg(c);this.shapes=this.shapes.filter(J=>!k.includes(J));return k}getBindableShapes(){return this.shapes.filter(c=>
c.canBind).sort((c,k)=>k.nonce-c.nonce).map(c=>c.id)}};pe([Sg],xk.prototype,"id",2);pe([Sg],xk.prototype,"name",2);pe([Sg],xk.prototype,"shapes",2);pe([Sg],xk.prototype,"bindings",2);pe([Zg],xk.prototype,"serialized",1);pe([Zg],xk.prototype,"shapesById",1);pe([Sg],xk.prototype,"nonce",2);pe([Ic],xk.prototype,"update",1);pe([Ic],xk.prototype,"updateBindings",1);pe([Ic],xk.prototype,"updateShapesIndex",1);pe([Ic],xk.prototype,"addShapes",1);pe([Ic],xk.prototype,"removeShapes",1);pe([Ic],xk.prototype,
"bringForward",2);pe([Ic],xk.prototype,"sendBackward",2);pe([Ic],xk.prototype,"bringToFront",2);pe([Ic],xk.prototype,"sendToBack",2);pe([Ic],xk.prototype,"cleanup",2);var Fj=class{constructor(){vb(this,"shiftKey",!1);vb(this,"ctrlKey",!1);vb(this,"modKey",!1);vb(this,"altKey",!1);vb(this,"spaceKey",!1);vb(this,"isPinching",!1);vb(this,"currentScreenPoint",[0,0]);vb(this,"currentPoint",[0,0]);vb(this,"previousScreenPoint",[0,0]);vb(this,"previousPoint",[0,0]);vb(this,"originScreenPoint",[0,0]);vb(this,
"originPoint",[0,0]);vb(this,"pointerIds",new Set);vb(this,"state","idle");vb(this,"containerOffset",[0,0]);vb(this,"onPointerDown",(c,k)=>{this.pointerIds.add(k.pointerId);this.updateModifiers(k);this.originScreenPoint=this.currentScreenPoint;this.originPoint=c;this.state="pointing"});vb(this,"onPointerMove",(c,k)=>{"pinching"!==this.state&&("panning"===this.state&&(this.state="idle"),this.updateModifiers(k),this.previousPoint=this.currentPoint,this.currentPoint=c)});vb(this,"onPointerUp",(c,k)=>
{this.pointerIds.clear();this.updateModifiers(k);this.state="idle"});vb(this,"onKeyDown",c=>{this.updateModifiers(c);switch(c.key){case " ":this.spaceKey=!0}});vb(this,"onKeyUp",c=>{this.updateModifiers(c);switch(c.key){case " ":this.spaceKey=!1}});vb(this,"onPinchStart",(c,k)=>{this.updateModifiers(k);this.state="pinching"});vb(this,"onPinch",(c,k)=>{"pinching"===this.state&&this.updateModifiers(k)});vb(this,"onPinchEnd",(c,k)=>{"pinching"===this.state&&(this.updateModifiers(k),this.state="idle")});
zc(this)}updateContainerOffset(c){Object.assign(this.containerOffset,c)}updateModifiers(c){c.isPrimary&&("clientX"in c&&(this.previousScreenPoint=this.currentScreenPoint,this.currentScreenPoint=Rd.sub([c.clientX,c.clientY],this.containerOffset)),"shiftKey"in c&&(this.shiftKey=c.shiftKey,this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.modKey=Rb()?c.metaKey:c.ctrlKey))}};pe([Sg],Fj.prototype,"shiftKey",2);pe([Sg],Fj.prototype,"ctrlKey",2);pe([Sg],Fj.prototype,"modKey",2);pe([Sg],Fj.prototype,"altKey",
2);pe([Sg],Fj.prototype,"spaceKey",2);pe([Sg],Fj.prototype,"isPinching",2);pe([Sg],Fj.prototype,"currentScreenPoint",2);pe([Sg],Fj.prototype,"currentPoint",2);pe([Sg],Fj.prototype,"previousScreenPoint",2);pe([Sg],Fj.prototype,"previousPoint",2);pe([Sg],Fj.prototype,"originScreenPoint",2);pe([Sg],Fj.prototype,"originPoint",2);pe([Sg],Fj.prototype,"state",2);pe([Sg],Fj.prototype,"containerOffset",2);pe([Ic],Fj.prototype,"updateContainerOffset",1);pe([Ic],Fj.prototype,"updateModifiers",1);pe([Ic],Fj.prototype,
"onPointerDown",2);pe([Ic],Fj.prototype,"onPointerMove",2);pe([Ic],Fj.prototype,"onPointerUp",2);pe([Ic],Fj.prototype,"onKeyDown",2);pe([Ic],Fj.prototype,"onKeyUp",2);pe([Ic],Fj.prototype,"onPinchStart",2);pe([Ic],Fj.prototype,"onPinch",2);pe([Ic],Fj.prototype,"onPinchEnd",2);var Iz=(c,k=100)=>-(Math.cos(Math.PI*Ld.clamp(c/k,0,1))-1)/2,Ap=class{constructor(){vb(this,"bounds",{minX:0,minY:0,maxX:1080,maxY:720,width:1080,height:720});vb(this,"camera",{point:[0,0],zoom:1});vb(this,"updateBounds",c=>
{this.bounds=c;return this});vb(this,"panCamera",c=>this.update({point:Ld.sub(this.camera.point,Ld.div(c,this.camera.zoom))}));vb(this,"panToPointWhenNearBounds",c=>{const k=Ld.div([Ap.panThreshold,Ap.panThreshold],this.camera.zoom),J=Ld.sub([this.currentView.maxX,this.currentView.maxY],Ld.add(c,k));c=Ld.sub([this.currentView.minX,this.currentView.minY],Ld.sub(c,k));this.panCamera(Ld.mul([0>J[0]?J[0]:0<c[0]?c[0]:0,0>J[1]?J[1]:0<c[1]?c[1]:0],-Ap.panMultiplier*this.camera.zoom))});vb(this,"update",
({point:c,zoom:k})=>{void 0===c||isNaN(c[0])||isNaN(c[1])||(this.camera.point=c);void 0===k||isNaN(k)||(this.camera.zoom=Math.min(4,Math.max(.1,k)));return this});vb(this,"getPagePoint",c=>{const {camera:k,bounds:J}=this;return Ld.sub(Ld.div(Ld.sub(c,[J.minX,J.minY]),k.zoom),k.point)});vb(this,"getScreenPoint",c=>{const {camera:k}=this;return Ld.mul(Ld.add(c,k.point),k.zoom)});vb(this,"onZoom",(c,k,J=!1)=>this.pinchZoom(c,[0,0],k,J));vb(this,"pinchZoom",(c,k,J,da=!1)=>{var {camera:qa}=this;k=Ld.sub(qa.point,
Ld.div(k,qa.zoom));J=Ld.clamp(J,Ap.minZoom,Ap.maxZoom);qa=Ld.div(c,qa.zoom);c=Ld.div(c,J);c=Ld.toFixed(Ld.add(k,Ld.sub(c,qa)));da?this.animateCamera({point:c,zoom:J}):this.update({point:c,zoom:J});return this});vb(this,"setZoom",(c,k=!1)=>{const {bounds:J}=this;this.onZoom([J.width/2,J.height/2],c,k)});vb(this,"zoomIn",()=>{const {camera:c}=this;this.setZoom(c.zoom/.8,!0)});vb(this,"zoomOut",()=>{const {camera:c}=this;this.setZoom(.8*c.zoom,!0)});vb(this,"resetZoom",()=>{this.setZoom(1,!0);return this});
vb(this,"animateCamera",({point:c,zoom:k})=>this.animateToViewport({minX:-c[0],minY:-c[1],maxX:this.bounds.width/k-c[0],maxY:this.bounds.height/k-c[1],width:this.bounds.width/k,height:this.bounds.height/k}));vb(this,"animateToViewport",c=>{const k=performance.now(),J=tf({},this.currentView),da=()=>{var qa=performance.now()-k;qa=Iz(qa);var Ca=J.minX+(c.minX-J.minX)*qa;this.update({point:[-Ca,-(J.minY+(c.minY-J.minY)*qa)],zoom:this.bounds.width/(J.maxX+(c.maxX-J.maxX)*qa-Ca)});1>qa&&requestAnimationFrame(da)};
da()});vb(this,"zoomToBounds",({width:c,height:k,minX:J,minY:da})=>{const {bounds:qa,camera:Ca}=this;let Ia=Math.min((qa.width-100)/c,(qa.height-100)/k);Ia=Math.min(1,Math.max(Ap.minZoom,Ca.zoom===Ia||1>Ca.zoom?Math.min(1,Ia):Ia));c=Ld.add([-J,-da],[(qa.width-c*Ia)/2/Ia,(qa.height-k*Ia)/2/Ia]);this.animateCamera({point:c,zoom:Ia})});zc(this)}get currentView(){const {bounds:c,camera:{point:k,zoom:J}}=this,da=c.width/J,qa=c.height/J;return{minX:-k[0],minY:-k[1],maxX:da-k[0],maxY:qa-k[1],width:da,height:qa}}},
sm=Ap;vb(sm,"minZoom",.1);vb(sm,"maxZoom",4);vb(sm,"panMultiplier",.05);vb(sm,"panThreshold",100);pe([Sg],sm.prototype,"bounds",2);pe([Sg],sm.prototype,"camera",2);pe([Ic],sm.prototype,"updateBounds",2);pe([Ic],sm.prototype,"update",2);pe([Zg],sm.prototype,"currentView",1);var Jz=class{constructor(c){vb(this,"app");vb(this,"editShape",k=>{(null==k?0:k.props.isLocked)||this.app.transition("select").selectedTool.transition("editingShape",{shape:k});return this});vb(this,"hoverShape",k=>{this.app.setHoveredShape(k);
return this});vb(this,"createShapes",(...k)=>{this.app.createShapes(k);return this});vb(this,"updateShapes",(...k)=>{this.app.updateShapes(k);return this});vb(this,"deleteShapes",(...k)=>{this.app.deleteShapes(k.length?k:this.app.selectedShapesArray);return this});vb(this,"selectShapes",(...k)=>{this.app.setSelectedShapes(k);return this});vb(this,"deselectShapes",(...k)=>{const J="string"===typeof k[0]?k:k.map(da=>da.id);this.app.setSelectedShapes(this.app.selectedShapesArray.filter(da=>!J.includes(da.id)));
return this});vb(this,"flipHorizontal",(...k)=>{this.app.flipHorizontal(k);return this});vb(this,"flipVertical",(...k)=>{this.app.flipVertical(k);return this});vb(this,"selectAll",()=>{this.app.setSelectedShapes(this.app.currentPage.shapes.filter(k=>!this.app.shapesInGroups().includes(k)));return this});vb(this,"deselectAll",()=>{this.app.setSelectedShapes([]);return this});vb(this,"zoomIn",()=>{this.app.viewport.zoomIn();return this});vb(this,"zoomOut",()=>{this.app.viewport.zoomOut();return this});
vb(this,"resetZoom",()=>{this.app.viewport.resetZoom();return this});vb(this,"zoomToFit",()=>{var {shapes:k}=this.app.currentPage;if(0===k.length)return this;k=Xe.getCommonBounds(k.map(J=>J.bounds));this.app.viewport.zoomToBounds(k);return this});vb(this,"cameraToCenter",()=>{var {shapes:k}=this.app.currentPage;if(0===k.length)return this;k=Xe.getCommonBounds(k.map(J=>J.bounds));this.app.viewport.update({point:Rd.add(Rd.neg(Xe.getBoundsCenter(k)),[this.app.viewport.currentView.width/2,this.app.viewport.currentView.height/
2])});return this});vb(this,"zoomToSelection",()=>{const {selectionBounds:k}=this.app;if(!k)return this;this.app.viewport.zoomToBounds(k);return this});vb(this,"resetZoomToCursor",()=>{this.app.viewport.animateCamera({zoom:1,point:Rd.sub(this.app.inputs.originScreenPoint,this.app.inputs.originPoint)});return this});vb(this,"toggleGrid",()=>{const {settings:k}=this.app;k.update({showGrid:!k.showGrid});return this});vb(this,"toggleSnapToGrid",()=>{const {settings:k}=this.app;k.update({snapToGrid:!k.snapToGrid});
return this});vb(this,"togglePenMode",()=>{const {settings:k}=this.app;k.update({penMode:!k.penMode});return this});vb(this,"setColor",k=>{const {settings:J}=this.app;J.update({color:k});this.app.selectedShapesArray.forEach(da=>{da.props.isLocked||da.update({fill:k,stroke:k})});this.app.persist();return this});vb(this,"setScaleLevel",k=>{const {settings:J}=this.app;J.update({scaleLevel:k});this.app.selectedShapes.forEach(da=>{da.props.isLocked||da.setScaleLevel(k)});this.app.persist();return this});
vb(this,"undo",()=>{this.app.undo();return this});vb(this,"redo",()=>{this.app.redo();return this});vb(this,"persist",()=>{this.app.persist();return this});vb(this,"createNewLineBinding",(k,J)=>this.app.createNewLineBinding(k,J));vb(this,"clone",k=>{if(!this.app.readOnly&&1===this.app.selectedShapesArray.length&&Object.values(Eb).some(Rc=>Rc===this.app.selectedShapesArray[0].type)){var J=this.app.allSelectedShapesArray[0],da=this.app.getShapeClass(J.type),{minX:qa,minY:Ca,maxX:Ia,maxY:bb,width:rb,
height:Pb}=J.bounds,jc=[0,0];switch(k){case "down":jc=[qa,bb+100];break;case "up":jc=[qa,Ca-100-Pb];break;case "left":jc=[qa-100-rb,Ca];break;case "right":jc=[Ia+100,Ca]}var yc=new da(gg(tf({},J.serialized),{id:Ff(),nonce:Date.now(),refs:[],label:"",point:jc}));this.app.history.pause();this.app.currentPage.addShapes(yc);this.app.createNewLineBinding(J,yc);this.app.history.resume();this.app.persist();setTimeout(()=>this.editShape(yc))}});vb(this,"cloneShapes",({shapes:k,assets:J,bindings:da,point:qa=
[0,0]})=>{const Ca=Xe.getCommonBounds(k.filter(rb=>"group"!==rb.type).map(rb=>{var Pb,jc,yc,Rc,jd,fd,xd,Fd,Xc,id,nd,Gd,wd,Ge,Je,ag;return{minX:null!=(jc=null==(Pb=rb.point)?void 0:Pb[0])?jc:qa[0],minY:null!=(Rc=null==(yc=rb.point)?void 0:yc[1])?Rc:qa[1],width:null!=(fd=null==(jd=rb.size)?void 0:jd[0])?fd:4,height:null!=(Fd=null==(xd=rb.size)?void 0:xd[1])?Fd:4,maxX:(null!=(id=null==(Xc=rb.point)?void 0:Xc[0])?id:qa[0])+(null!=(Gd=null==(nd=rb.size)?void 0:nd[0])?Gd:4),maxY:(null!=(Ge=null==(wd=rb.point)?
void 0:wd[1])?Ge:qa[1])+(null!=(ag=null==(Je=rb.size)?void 0:Je[1])?ag:4)}})),Ia=k.map(rb=>gg(tf({},rb),{id:Ff(),point:[qa[0]+rb.point[0]-Ca.minX,qa[1]+rb.point[1]-Ca.minY]}));Ia.forEach(rb=>{var Pb;rb.children&&0<(null==(Pb=rb.children)?void 0:Pb.length)&&(rb.children=rb.children.map(jc=>{var yc;return null==(yc=Ia[k.findIndex(Rc=>Rc.id===jc)])?void 0:yc.id}).filter(Fc))});const bb=[];Ia.flatMap(rb=>{var Pb;return Object.values(null!=(Pb=rb.handles)?Pb:{})}).forEach(rb=>{if(rb.bindingId){var Pb=
da[rb.bindingId];if(Pb){var jc=k.findIndex(Rc=>Rc.id===Pb.fromId);const yc=k.findIndex(Rc=>Rc.id===Pb.toId);Pb&&-1!==jc&&-1!==yc?(jc=gg(tf({},Pb),{id:Ff(),fromId:Ia[jc].id,toId:Ia[yc].id}),bb.push(jc),rb.bindingId=jc.id):rb.bindingId=void 0}else console.warn("binding not found",rb.bindingId)}});J=J.filter(rb=>Ia.some(Pb=>Pb.assetId===rb.id));return{shapes:Ia,assets:J,bindings:bb}});vb(this,"getClonedShapesFromTldrString",(k,J)=>{try{{var da;const Pb=null==(da=k.match(/<whiteboard-tldr>(.*)<\/whiteboard-tldr>/))?
void 0:da[1];if(Pb){try{var qa=JSON.parse(Pb)}catch(jc){qa=null}var Ca=qa}else Ca=void 0}k=Ca;if(!k)return null;const {shapes:Ia,bindings:bb,assets:rb}=k;return this.cloneShapes({shapes:Ia,bindings:bb,assets:rb,point:J})}catch(Ia){console.log(Ia)}return null});vb(this,"cloneShapesIntoCurrentPage",k=>{(k=this.cloneShapes(k))&&this.addClonedShapes(k);return this});vb(this,"addClonedShapes",k=>{const {shapes:J,assets:da,bindings:qa}=k;0<da.length&&this.app.createAssets(da);0<J.length&&this.app.createShapes(J);
this.app.currentPage.updateBindings(Object.fromEntries(qa.map(Ca=>[Ca.id,Ca])));this.app.selectedTool.transition("idle");return this});vb(this,"addClonedShapesFromTldrString",(k,J)=>{(k=this.getClonedShapesFromTldrString(k,J))&&this.addClonedShapes(k);return this});vb(this,"doGroup",(k=this.app.allSelectedShapesArray)=>{if(!this.app.readOnly){this.app.history.pause();var J=[...k.filter(da=>"group"===da.type),...k.map(da=>this.app.getParentGroup(da))].filter(Fc);this.app.currentPage.removeShapes(...J);
k=k.filter(da=>"group"!==da.type);1<k.length&&(J=this.app.getShapeClass("group"),J=new J({id:Ff(),type:J.id,parentId:this.app.currentPage.id,children:k.map(da=>da.id)}),this.app.currentPage.addShapes(J),this.app.setSelectedShapes([J]),this.app.bringForward(k));this.app.history.resume();this.app.persist()}});vb(this,"unGroup",(k=this.app.allSelectedShapesArray)=>{if(!this.app.readOnly){k=[...k.filter(da=>"group"===da.type),...k.map(da=>this.app.getParentGroup(da))].filter(Fc);var J=this.app.shapesInGroups(k);
0<k.length&&(this.app.currentPage.removeShapes(...k),this.app.persist(),this.app.setSelectedShapes(J))}});vb(this,"convertShapes",(k,J=this.app.allSelectedShapesArray)=>{const da=this.app.getShapeClass(k);this.app.currentPage.removeShapes(...J);J=J.map(qa=>new da(gg(tf({},qa.serialized),{type:k,nonce:Date.now()})));this.app.currentPage.addShapes(...J);this.app.persist();this.app.setSelectedShapes(J)});vb(this,"setCollapsed",(k,J=this.app.allSelectedShapesArray)=>{J.forEach(da=>{"logseq-portal"===
da.props.type&&da.setCollapsed(k)});this.app.persist()});this.app=c}},sq=class{constructor(){vb(this,"cursor","default");vb(this,"rotation",0);vb(this,"reset",()=>{this.cursor="default"});vb(this,"setCursor",(c,k=0)=>{if(c!==this.cursor||k!==this.rotation)this.cursor=c,this.rotation=k});vb(this,"setRotation",c=>{c!==this.rotation&&(this.rotation=c)});zc(this)}};pe([Sg],sq.prototype,"cursor",2);pe([Sg],sq.prototype,"rotation",2);pe([Ic],sq.prototype,"reset",2);pe([Ic],sq.prototype,"setCursor",2);pe([Ic],
sq.prototype,"setRotation",2);var tq=class{constructor(c){vb(this,"app");vb(this,"stack",[]);vb(this,"isPaused",!0);vb(this,"pause",()=>{this.isPaused||(this.isPaused=!0)});vb(this,"resume",()=>{this.isPaused&&(this.isPaused=!1)});vb(this,"persist",(k=!1)=>{this.isPaused||this.creating||this.app.notify("persist",{replace:k})});vb(this,"undo",()=>{this.isPaused||"idle"===this.app.selectedTool.currentState.id&&this.app.appUndo&&this.app.appUndo()});vb(this,"redo",()=>{this.isPaused||"idle"===this.app.selectedTool.currentState.id&&
this.app.appRedo&&this.app.appRedo()});vb(this,"instantiateShape",k=>new (this.app.getShapeClass(k.type))(k));vb(this,"deserialize",k=>{Tb(()=>{var J,{pages:da}=k;const qa=this.isPaused;this.pause();const Ca=[...this.app.selectedIds];try{const Ia=new Map(this.app.pages),bb=[];for(const rb of da){const Pb=Ia.get(rb.id);if(void 0!==Pb){const jc=new Map(Pb.shapes.map(yc=>[yc.props.id,yc]));da=[];for(const yc of rb.shapes){const Rc=jc.get(yc.id);void 0!==Rc?(Rc.nonce!==yc.nonce&&(Rc.update(yc,!0),Rc.nonce=
yc.nonce,Rc.setLastSerialized(yc)),jc.delete(yc.id)):da.push(this.instantiateShape(yc))}0<jc.size&&!this.app.selectedTool.isInAny("creating","editingShape")&&Pb.removeShapes(...jc.values());0<da.length&&Pb.addShapes(...da);Ia.delete(rb.id);Pb.updateBindings(rb.bindings);Pb.nonce=null!=(J=rb.nonce)?J:0}else{const {id:jc,name:yc,shapes:Rc,bindings:jd,nonce:fd}=rb;bb.push(new xk(this.app,{id:jc,name:yc,nonce:fd,bindings:jd,shapes:Rc.map(xd=>this.instantiateShape(xd))}))}}0<bb.length&&this.app.addPages(bb);
0<Ia.size&&this.app.removePages(Array.from(Ia.values()));this.app.setSelectedShapes(Ca).setErasingShapes([])}catch(Ia){console.warn(Ia)}qa||this.resume()})});this.app=c;zc(this)}get creating(){return"creating"===this.app.selectedTool.currentState.id}};pe([Sg],tq.prototype,"stack",2);pe([Ic],tq.prototype,"persist",2);pe([Ic],tq.prototype,"undo",2);pe([Ic],tq.prototype,"redo",2);pe([Ic],tq.prototype,"deserialize",2);var zo=class{constructor(){vb(this,"mode","light");vb(this,"showGrid",!0);vb(this,"snapToGrid",
!0);vb(this,"penMode",!1);vb(this,"scaleLevel","md");vb(this,"color","");zc(this)}update(c){Object.assign(this,c)}};pe([Sg],zo.prototype,"mode",2);pe([Sg],zo.prototype,"showGrid",2);pe([Sg],zo.prototype,"snapToGrid",2);pe([Sg],zo.prototype,"penMode",2);pe([Sg],zo.prototype,"scaleLevel",2);pe([Sg],zo.prototype,"color",2);pe([Ic],zo.prototype,"update",1);var uh=class extends pq{constructor(c,k,J,da){var qa,Ca;super();vb(this,"uuid",Ff());vb(this,"readOnly");vb(this,"api");vb(this,"inputs",new Fj);vb(this,
"cursors",new sq);vb(this,"viewport",new sm);vb(this,"settings",new zo);vb(this,"Tools",[]);vb(this,"history",new tq(this));vb(this,"persist",this.history.persist);vb(this,"undo",this.history.undo);vb(this,"redo",this.history.redo);vb(this,"saving",!1);vb(this,"saveState",()=>{this.history.isPaused||(this.saving=!0,requestAnimationFrame(()=>{this.saving&&(this.persist(),this.saving=!1)}))});vb(this,"load",()=>{this.notify("load",null);return this});vb(this,"save",()=>{this.notify("save",null);return this});
vb(this,"pages",new Map([["page",new xk(this,{id:"page",name:"page",shapes:[],bindings:{}})]]));vb(this,"getPageById",Ia=>{const bb=this.pages.get(Ia);if(!bb)throw Error(`Could not find a page named ${Ia}.`);return bb});vb(this,"getShapeById",(Ia,bb=this.currentPage.id)=>{var rb;return null==(rb=this.getPageById(bb))?void 0:rb.shapesById[Ia]});vb(this,"createShapes",Ia=>{if(this.readOnly)return this;(Ia=this.currentPage.addShapes(...Ia))&&this.notify("create-shapes",Ia);this.persist();return this});
vb(this,"updateShapes",Ia=>{if(this.readOnly)return this;Ia.forEach(bb=>{const rb=this.getShapeById(bb.id);null==rb?void 0:rb.update(bb);bb.type!==(null==rb?void 0:rb.type)&&this.api.convertShapes(bb.type,[rb])});this.persist();return this});vb(this,"deleteShapes",Ia=>{if(0===Ia.length||this.readOnly)return this;Ia=Ia.map(jc=>"string"===typeof jc?this.getShapeById(jc):jc).filter(Fc).filter(jc=>!jc.props.isLocked);const bb=this.shapesInGroups(Ia);Ia.forEach(jc=>{this.getParentGroup(jc)&&bb.push(jc)});
let rb=new Set([...Ia,...bb].map(jc=>jc.id));bb.forEach(jc=>{var yc;const Rc=this.getParentGroup(jc);if(Rc){const jd=null==(yc=Rc.props.children)?void 0:yc.filter(fd=>fd!==jc.id);!jd||1>=(null==jd?void 0:jd.length)?rb.add(Rc.id):Rc.update({children:jd})}});const Pb=(jc,yc)=>{var Rc;[...rb].includes(jc)&&"line"===(null==(Rc=this.getShapeById(yc))?void 0:Rc.type)&&rb.add(yc)};this.currentPage.shapes.filter(jc=>!jc.props.isLocked).flatMap(jc=>{var yc;return Object.values(null!=(yc=jc.props.handles)?
yc:{})}).flatMap(jc=>jc.bindingId).filter(Fc).map(jc=>{var yc,Rc;const jd=null==(yc=this.currentPage.bindings[jc])?void 0:yc.toId;jc=null==(Rc=this.currentPage.bindings[jc])?void 0:Rc.fromId;jd&&jc&&(Pb(jd,jc),Pb(jc,jd))});Ia=[...rb].map(jc=>this.getShapeById(jc));this.setSelectedShapes(this.selectedShapesArray.filter(jc=>!rb.has(jc.id)));(Ia=this.currentPage.removeShapes(...Ia))&&this.notify("delete-shapes",Ia);this.persist();return this});vb(this,"bringForward",(Ia=this.selectedShapesArray)=>{0<
Ia.length&&!this.readOnly&&this.currentPage.bringForward(Ia);return this});vb(this,"sendBackward",(Ia=this.selectedShapesArray)=>{0<Ia.length&&!this.readOnly&&this.currentPage.sendBackward(Ia);return this});vb(this,"sendToBack",(Ia=this.selectedShapesArray)=>{0<Ia.length&&!this.readOnly&&this.currentPage.sendToBack(Ia);return this});vb(this,"bringToFront",(Ia=this.selectedShapesArray)=>{0<Ia.length&&!this.readOnly&&this.currentPage.bringToFront(Ia);return this});vb(this,"flipHorizontal",(Ia=this.selectedShapesArray)=>
{this.currentPage.flip(Ia,"horizontal");return this});vb(this,"flipVertical",(Ia=this.selectedShapesArray)=>{this.currentPage.flip(Ia,"vertical");return this});vb(this,"align",(Ia,bb=this.selectedShapesArray)=>{if(2>bb.length||this.readOnly)return this;const rb=bb.map(jd=>{const fd=jd.getBounds();return{id:jd.id,point:[fd.minX,fd.minY],bounds:fd}}),Pb=Xe.getCommonBounds(rb.map(({bounds:jd})=>jd)),jc=Pb.minX+Pb.width/2,yc=Pb.minY+Pb.height/2,Rc=Object.fromEntries(rb.map(({id:jd,point:fd,bounds:xd})=>
[jd,{prev:fd,next:{top:[fd[0],Pb.minY],centerVertical:[fd[0],yc-xd.height/2],bottom:[fd[0],Pb.maxY-xd.height],left:[Pb.minX,fd[1]],centerHorizontal:[jc-xd.width/2,fd[1]],right:[Pb.maxX-xd.width,fd[1]]}[Ia]}]));bb.forEach(jd=>{Rc[jd.id]&&jd.update({point:Rc[jd.id].next})});this.persist();return this});vb(this,"distribute",(Ia,bb=this.selectedShapesArray)=>{if(2>bb.length||this.readOnly)return this;const rb=Object.fromEntries(Xe.getDistributions(bb,Ia).map(Pb=>[Pb.id,Pb]));bb.forEach(Pb=>{rb[Pb.id]&&
Pb.update({point:rb[Pb.id].next})});this.persist();return this});vb(this,"packIntoRectangle",(Ia=this.selectedShapesArray)=>{if(2>Ia.length||this.readOnly)return this;const bb=Object.fromEntries(Xe.getPackedDistributions(Ia).map(rb=>[rb.id,rb]));Ia.forEach(rb=>{bb[rb.id]&&rb.update({point:bb[rb.id].next})});this.persist();return this});vb(this,"setLocked",Ia=>{if(0===this.selectedShapesArray.length||this.readOnly)return this;this.selectedShapesArray.forEach(bb=>{bb.update({isLocked:Ia})});this.persist();
return this});vb(this,"assets",{});vb(this,"removeUnusedAssets",()=>{const Ia=this.getCleanUpAssets();Object.keys(this.assets).forEach(bb=>{Ia.some(rb=>rb.id===bb)||delete this.assets[bb]});this.persist();return this});vb(this,"copy",()=>{if(0<this.selectedShapesArray.length&&!this.editingShape){const bb=this.allSelectedShapesArray;var Ia=JSON.stringify({shapes:bb.map(Pb=>Pb.serialized),assets:this.getCleanUpAssets().filter(Pb=>bb.some(jc=>jc.props.assetId===Pb.id)),bindings:Db(this.currentPage.bindings)});
Ia=encodeURIComponent(`<whiteboard-tldr>${Ia}</whiteboard-tldr>`);const rb=this.selectedShapesArray.map(Pb=>`((${Pb.props.id}))`).join(" ");this.notify("copy",{text:rb,html:Ia})}});vb(this,"paste",(Ia,bb)=>{var rb;this.editingShape||this.readOnly||this.notify("paste",{point:this.inputs.currentPoint,shiftKey:!!bb,dataTransfer:null!=(rb=null==Ia?void 0:Ia.clipboardData)?rb:void 0})});vb(this,"cut",()=>{this.copy();this.api.deleteShapes()});vb(this,"drop",(Ia,bb)=>{this.notify("drop",{dataTransfer:Ia,
point:bb?this.viewport.getPagePoint(bb):Xe.getBoundsCenter(this.viewport.currentView)})});vb(this,"selectTool",(Ia,bb={})=>{this.readOnly&&!["select","move"].includes(Ia)||this.transition(Ia,bb)});vb(this,"editingId");vb(this,"setEditingShape",Ia=>{this.editingId="string"===typeof Ia?Ia:null==Ia?void 0:Ia.id;return this});vb(this,"clearEditingState",()=>{this.selectedTool.transition("idle");return this.setEditingShape()});vb(this,"hoveredId");vb(this,"setHoveredShape",Ia=>{this.hoveredId="string"===
typeof Ia?Ia:null==Ia?void 0:Ia.id;return this});vb(this,"selectedIds",new Set);vb(this,"selectedShapes",new Set);vb(this,"selectionRotation",0);vb(this,"setSelectedShapes",Ia=>{var bb;const {selectedIds:rb,selectedShapes:Pb}=this;rb.clear();Pb.clear();Ia[0]&&"string"===typeof Ia[0]?Ia.forEach(yc=>rb.add(yc)):Ia.forEach(yc=>rb.add(yc.id));const jc=this.currentPage.shapes.filter(yc=>rb.has(yc.id));jc.forEach(yc=>Pb.add(yc));this.selectionRotation=1===jc.length?null!=(bb=jc[0].props.rotation)?bb:0:
0;0===Ia.length&&this.setEditingShape();return this});vb(this,"erasingIds",new Set);vb(this,"erasingShapes",new Set);vb(this,"setErasingShapes",Ia=>{const {erasingIds:bb,erasingShapes:rb}=this;bb.clear();rb.clear();Ia[0]&&"string"===typeof Ia[0]?Ia.forEach(Pb=>bb.add(Pb)):Ia.forEach(Pb=>bb.add(Pb.id));this.currentPage.shapes.filter(Pb=>bb.has(Pb.id)).forEach(Pb=>rb.add(Pb));return this});vb(this,"bindingIds");vb(this,"setBindingShapes",Ia=>{this.bindingIds=Ia;return this});vb(this,"clearBindingShape",
()=>this.setBindingShapes());vb(this,"createNewLineBinding",(Ia,bb)=>{Ia="string"===typeof Ia?this.getShapeById(Ia):Ia;bb="string"===typeof bb?this.getShapeById(bb):bb;if((null==Ia?0:Ia.canBind)&&(null==bb?0:bb.canBind)&&(bb=sd(Ia,bb))){const [rb,Pb]=bb;this.createShapes([rb]);this.currentPage.updateBindings(Object.fromEntries(Pb.map(jc=>[jc.id,jc])));this.persist();return!0}return!1});vb(this,"brush");vb(this,"setBrush",Ia=>{this.brush=Ia;return this});vb(this,"setCamera",(Ia,bb)=>{this.viewport.update({point:Ia,
zoom:bb});return this});vb(this,"getPagePoint",Ia=>{const {camera:bb}=this.viewport;return Ld.sub(Ld.div(Ia,bb.zoom),bb.point)});vb(this,"getScreenPoint",Ia=>{const {camera:bb}=this.viewport;return Ld.mul(Ld.add(Ia,bb.point),bb.zoom)});vb(this,"Shapes",new Map);vb(this,"registerShapes",Ia=>{Ia.forEach(bb=>{if("group"===bb.id){const rb=this;bb.prototype.getShapes=function(){var Pb,jc;return null!=(jc=null==(Pb=this.props.children)?void 0:Pb.map(yc=>rb.getShapeById(yc)).filter(Boolean))?jc:[]}}return this.Shapes.set(bb.id,
bb)})});vb(this,"deregisterShapes",Ia=>{Ia.forEach(bb=>this.Shapes.delete(bb.id))});vb(this,"getShapeClass",Ia=>{if(!Ia)throw Error("No shape type provided.");const bb=this.Shapes.get(Ia);if(!bb)throw Error(`Could not find shape class for ${Ia}`);return bb});vb(this,"wrapUpdate",Ia=>{Tb(()=>{const bb=!this.history.isPaused;bb&&this.history.pause();Ia();bb&&(this.history.resume(),this.persist())})});vb(this,"subscriptions",new Set([]));vb(this,"subscribe",(Ia,bb)=>{if(void 0===bb)throw Error("Callback is required.");
const rb={event:Ia,callback:bb};this.subscriptions.add(rb);return()=>this.unsubscribe(rb)});vb(this,"unsubscribe",Ia=>{this.subscriptions.delete(Ia);return this});vb(this,"notify",(Ia,bb)=>{this.subscriptions.forEach(rb=>{rb.event===Ia&&rb.callback(this,bb)});return this});vb(this,"onTransition",()=>{});vb(this,"onPointerDown",(Ia,bb)=>{if(!this.editingShape&&1===bb.button&&!this.isIn("move"))this.temporaryTransitionToMove(bb);else if(2===bb.button&&!this.editingShape)bb.preventDefault(),this.transition("select");
else if("clientX"in bb)this.inputs.onPointerDown([...this.viewport.getPagePoint([bb.clientX,bb.clientY]),bb.pressure],bb)});vb(this,"onPointerUp",(Ia,bb)=>{if(!this.editingShape&&1===bb.button&&this.isIn("move"))this.selectedTool.transition("idle",{exit:!0}),bb.stopPropagation(),bb.preventDefault();else if("clientX"in bb)this.inputs.onPointerUp([...this.viewport.getPagePoint([bb.clientX,bb.clientY]),bb.pressure],bb)});vb(this,"onPointerMove",(Ia,bb)=>{if("clientX"in bb)this.inputs.onPointerMove([...this.viewport.getPagePoint([bb.clientX,
bb.clientY]),bb.pressure],bb)});vb(this,"onKeyDown",(Ia,bb)=>{if(this.editingShape||" "!==bb.key||this.isIn("move"))this.inputs.onKeyDown(bb);else this.temporaryTransitionToMove(bb)});vb(this,"onKeyUp",(Ia,bb)=>{if(!this.editingShape&&" "===bb.key&&this.isIn("move"))this.selectedTool.transition("idle",{exit:!0}),bb.stopPropagation(),bb.preventDefault();else this.inputs.onKeyUp(bb)});vb(this,"onPinchStart",(Ia,bb)=>{this.inputs.onPinchStart([...this.viewport.getPagePoint(Ia.point),.5],bb)});vb(this,
"onPinch",(Ia,bb)=>{this.inputs.onPinch([...this.viewport.getPagePoint(Ia.point),.5],bb)});vb(this,"onPinchEnd",(Ia,bb)=>{this.inputs.onPinchEnd([...this.viewport.getPagePoint(Ia.point),.5],bb)});this._states=[qq,rq];this.readOnly=da;this.history.pause();this.states&&0<this.states.length&&(this.registerStates(this.states),da=null!=(qa=this.initial)?qa:this.states[0].id,qa=this.children.get(da))&&(this.currentState=qa,null==(Ca=this.currentState)?void 0:Ca._events.onEnter({fromId:"initial"}));k&&this.registerShapes(k);
J&&this.registerTools(J);this.history.resume();c&&this.history.deserialize(c);this.api=new Jz(this);zc(this);this.notify("mount",null)}loadDocumentModel(c){this.history.deserialize(c);c.assets&&0<c.assets.length&&this.addAssets(c.assets);return this}get serialized(){return{}}get currentPageId(){return this.pages.keys().next().value}get currentPage(){return this.getPageById(this.currentPageId)}addPages(c){c.forEach(k=>this.pages.set(k.id,k));this.persist();return this}removePages(c){c.forEach(k=>this.pages.delete(k.id));
this.persist();return this}shapesInGroups(c=this.shapes){return c.flatMap(k=>k.props.children).filter(Fc).map(k=>this.getShapeById(k)).filter(Fc)}getParentGroup(c){return this.shapes.find(k=>{var J;return null==(J=k.props.children)?void 0:J.includes(c.id)})}addAssets(c){c.forEach(k=>this.assets[k.id]=k);return this}removeAssets(c){"string"===typeof c[0]?c.forEach(k=>delete this.assets[k]):c.forEach(k=>delete this.assets[k.id]);this.persist();return this}getCleanUpAssets(){const c=new Set;this.pages.forEach(k=>
k.shapes.forEach(J=>{J.props.assetId&&this.assets[J.props.assetId]&&c.add(this.assets[J.props.assetId])}));return Array.from(c)}createAssets(c){this.addAssets(c);this.notify("create-assets",{assets:c});this.persist();return this}get selectedTool(){return this.currentState}registerTools(c){this.Tools=c;return this.registerStates(c)}get editingShape(){const {editingId:c,currentPage:k}=this;return c?k.shapes.find(J=>J.id===c):void 0}get hoveredShape(){const {hoveredId:c,currentPage:k}=this;return c?
k.shapes.find(J=>J.id===c):void 0}get hoveredGroup(){const {hoveredShape:c}=this;return c?this.shapes.find(k=>{var J;return"group"===k.type&&(null==(J=k.props.children)?void 0:J.includes(c.id))}):void 0}get selectedShapesArray(){const {selectedShapes:c,selectedTool:k}=this;return"select"!==k.id?[]:Array.from(c.values())}get allSelectedShapes(){return new Set(this.allSelectedShapesArray)}get allSelectedShapesArray(){const {selectedShapesArray:c}=this;return[...(new Set([...c,...this.shapesInGroups(c)]))]}setSelectionRotation(c){this.selectionRotation=
c}get erasingShapesArray(){return Array.from(this.erasingShapes.values())}get bindingShapes(){var c;const k=1===this.selectedShapesArray.length?this.selectedShapesArray.flatMap(da=>{var qa;return Object.values(null!=(qa=da.props.handles)?qa:{})}).flatMap(da=>da.bindingId).filter(Fc).flatMap(da=>{var qa,Ca;return[null==(qa=this.currentPage.bindings[da])?void 0:qa.fromId,null==(Ca=this.currentPage.bindings[da])?void 0:Ca.toId]}).filter(Fc):[],J=[...(null!=(c=this.bindingIds)?c:[]),...k];return J?this.currentPage.shapes.filter(da=>
null==J?void 0:J.includes(da.id)):void 0}get currentGrid(){const {zoom:c}=this.viewport.camera;return.15>c?128:1>c?32:8}get shapes(){const {currentPage:{shapes:c}}=this;return Array.from(c.values())}get shapesInViewport(){const {selectedShapes:c,currentPage:k,viewport:{currentView:J}}=this;return k.shapes.filter(da=>!da.canUnmount||c.has(da)||Xe.boundsContain(J,da.rotatedBounds)||Xe.boundsCollide(J,da.rotatedBounds))}get selectionDirectionHint(){const {selectionBounds:c,viewport:{currentView:k}}=
this;if(c&&!Xe.boundsContain(k,c)&&!Xe.boundsCollide(k,c)){var J=Xe.getBoundsCenter(c);return Ld.clampV([(J[0]-k.minX-k.width/2)/k.width,(J[1]-k.minY-k.height/2)/k.height],-1,1)}}get selectionBounds(){const {selectedShapesArray:c}=this;if(0!==c.length)return 1===c.length?gg(tf({},c[0].bounds),{rotation:c[0].props.rotation}):Xe.getCommonBounds(this.selectedShapesArray.map(k=>k.rotatedBounds))}get showSelection(){var c;const {selectedShapesArray:k}=this;return this.isIn("select")&&!this.isInAny("select.translating",
"select.pinching","select.rotating")&&(1===k.length&&!(null==(c=k[0])?0:c.hideSelection)||1<k.length)}get showSelectionDetail(){return this.isIn("select")&&!this.isInAny("select.translating","select.pinching")&&0<this.selectedShapes.size&&!this.selectedShapesArray.every(c=>c.hideSelectionDetail)&&!1}get showSelectionRotation(){return this.showSelectionDetail&&this.isInAny("select.rotating","select.pointingRotateHandle")}get showContextBar(){const {selectedShapesArray:c}=this;return this.isInAny("select.idle",
"select.hoveringSelectionHandle")&&!this.isIn("select.contextMenu")&&0<c.length&&!this.readOnly&&!c.every(k=>k.hideContextBar)}get showRotateHandles(){const {selectedShapesArray:c}=this;return this.isInAny("select.idle","select.hoveringSelectionHandle","select.pointingRotateHandle","select.pointingResizeHandle")&&0<c.length&&!this.readOnly&&!c.some(k=>k.hideRotateHandle)}get showResizeHandles(){const {selectedShapesArray:c}=this;return this.isInAny("select.idle","select.hoveringSelectionHandle","select.pointingShape",
"select.pointingSelectedShape","select.pointingRotateHandle","select.pointingResizeHandle")&&1===c.length&&!this.readOnly&&!c.every(k=>k.hideResizeHandles)}get showCloneHandles(){const {selectedShapesArray:c}=this;return this.isInAny("select.idle","select.hoveringSelectionHandle","select.pointingShape","select.pointingSelectedShape")&&1===c.length&&Object.values(Eb).some(k=>k===this.selectedShapesArray[0].type)&&!this.readOnly}temporaryTransitionToMove(c){c.stopPropagation();c.preventDefault();this.transition("move",
{prevTool:this.selectedTool});this.selectedTool.transition("idleHold")}};vb(uh,"id","app");vb(uh,"initial","select");pe([Zg],uh.prototype,"serialized",1);pe([Sg],uh.prototype,"pages",2);pe([Zg],uh.prototype,"currentPageId",1);pe([Zg],uh.prototype,"currentPage",1);pe([Ic],uh.prototype,"addPages",1);pe([Ic],uh.prototype,"removePages",1);pe([Ic],uh.prototype,"createShapes",2);pe([Ic],uh.prototype,"updateShapes",2);pe([Ic],uh.prototype,"deleteShapes",2);pe([Sg],uh.prototype,"assets",2);pe([Ic],uh.prototype,
"addAssets",1);pe([Ic],uh.prototype,"removeAssets",1);pe([Ic],uh.prototype,"removeUnusedAssets",2);pe([Zg],uh.prototype,"selectedTool",1);pe([Sg],uh.prototype,"editingId",2);pe([Zg],uh.prototype,"editingShape",1);pe([Ic],uh.prototype,"setEditingShape",2);pe([Sg],uh.prototype,"hoveredId",2);pe([Zg],uh.prototype,"hoveredShape",1);pe([Zg],uh.prototype,"hoveredGroup",1);pe([Ic],uh.prototype,"setHoveredShape",2);pe([Sg],uh.prototype,"selectedIds",2);pe([Sg],uh.prototype,"selectedShapes",2);pe([Sg],uh.prototype,
"selectionRotation",2);pe([Zg],uh.prototype,"selectedShapesArray",1);pe([Zg],uh.prototype,"allSelectedShapes",1);pe([Zg],uh.prototype,"allSelectedShapesArray",1);pe([Ic],uh.prototype,"setSelectedShapes",2);pe([Ic],uh.prototype,"setSelectionRotation",1);pe([Sg],uh.prototype,"erasingIds",2);pe([Sg],uh.prototype,"erasingShapes",2);pe([Zg],uh.prototype,"erasingShapesArray",1);pe([Ic],uh.prototype,"setErasingShapes",2);pe([Sg],uh.prototype,"bindingIds",2);pe([Zg],uh.prototype,"bindingShapes",1);pe([Ic],
uh.prototype,"setBindingShapes",2);pe([Ic],uh.prototype,"createNewLineBinding",2);pe([Sg],uh.prototype,"brush",2);pe([Ic],uh.prototype,"setBrush",2);pe([Ic],uh.prototype,"setCamera",2);pe([Zg],uh.prototype,"currentGrid",1);pe([Zg],uh.prototype,"shapes",1);pe([Zg],uh.prototype,"shapesInViewport",1);pe([Zg],uh.prototype,"selectionDirectionHint",1);pe([Zg],uh.prototype,"selectionBounds",1);pe([Zg],uh.prototype,"showSelection",1);pe([Zg],uh.prototype,"showSelectionDetail",1);pe([Zg],uh.prototype,"showSelectionRotation",
1);pe([Zg],uh.prototype,"showContextBar",1);pe([Zg],uh.prototype,"showRotateHandles",1);pe([Zg],uh.prototype,"showResizeHandles",1);pe([Zg],uh.prototype,"showCloneHandles",1);var Kz=Function.prototype.toString,Yt=Object.create,Lz=Object.prototype.toString,Mz=function(){function c(){this._keys=[];this._values=[]}c.prototype.has=function(k){return!!~this._keys.indexOf(k)};c.prototype.get=function(k){return this._values[this._keys.indexOf(k)]};c.prototype.set=function(k,J){this._keys.push(k);this._values.push(J)};
return c}(),Nz="undefined"!==typeof WeakMap?le:de,Oz="g"===/test/g.flags?df:wf,Pz="undefined"!==typeof Symbol?gf:Bf,Qz=Object.defineProperty,Rz=Object.getOwnPropertyDescriptor,Lw=Object.getOwnPropertyNames,Zt=Object.getOwnPropertySymbols,Mw=Object.prototype,Nw=Mw.hasOwnProperty,Sz=Mw.propertyIsEnumerable,Ow="function"===typeof Zt,Tz=Ow?Wf:Lw,Uz=Array.isArray,$t=Object.assign,Vz=Object.getPrototypeOf,Pw={array:function(c,k){var J=new k.Constructor;k.cache.set(c,J);for(var da=0,qa=c.length;da<qa;++da)J[da]=
k.copier(c[da],k);return J},arrayBuffer:function(c,k){return c.slice(0)},blob:function(c,k){return c.slice(0,c.size,c.type)},dataView:function(c,k){return new k.Constructor(c.buffer.slice(0))},date:function(c,k){return new k.Constructor(c.getTime())},error:rh,map:Jg,object:Ow?Kg:Xf,regExp:function(c,k){k=new k.Constructor(c.source,Oz(c));k.lastIndex=c.lastIndex;return k},set:hi},Wz=$t({},Pw,{array:function(c,k){var J=new k.Constructor;k.cache.set(c,J);return Pg(c,J,k)},map:function(c,k){return Pg(c,
Jg(c,k),k)},object:function(c,k){var J=se(k.prototype);k.cache.set(c,J);return Pg(c,J,k)},set:function(c,k){return Pg(c,hi(c,k),k)}});Hi($t({},Wz,{}));var Xz=Hi({}),Yz=Uf(ya()),Zz=Uf(wa()),Bp=Xz,Ul=class{static insertTextFirefox(c,k){c.setRangeText(k,c.selectionStart||0,c.selectionEnd||0,"end");c.dispatchEvent(new InputEvent("input",{data:k,inputType:"insertText",isComposing:!1}))}static insert(c,k){const J=c.ownerDocument,da=J.activeElement;da!==c&&c.focus();J.execCommand("insertText",!1,k)||Ul.insertTextFirefox(c,
k);da===J.body?c.blur():da instanceof HTMLElement&&da!==c&&da.focus()}static set(c,k){c.select();Ul.insert(c,k)}static getSelection(c){const {selectionStart:k,selectionEnd:J}=c;return c.value.slice(k?k:void 0,J?J:void 0)}static wrapSelection(c,k,J){const {selectionStart:da,selectionEnd:qa}=c,Ca=Ul.getSelection(c);Ul.insert(c,k+Ca+(null!=J?J:k));c.selectionStart=(da||0)+k.length;c.selectionEnd=(qa||0)+k.length}static replace(c,k,J){let da=0;c.value.replace(k,(...qa)=>{const Ca=da+qa[qa.length-2],Ia=
qa[0].length;c.selectionStart=Ca;c.selectionEnd=Ca+Ia;qa="string"===typeof J?J:J(...qa);Ul.insert(c,qa);c.selectionStart=Ca;da+=qa.length-Ia;return qa})}static findLineEnd(c,k){const J=c.lastIndexOf("\n",k-1)+1;return"\t"!==c.charAt(J)?k:J+1}static indent(c){var k;const {selectionStart:J,selectionEnd:da,value:qa}=c;var Ca=qa.slice(J,da);if((Ca=null==(k=/\n/g.exec(Ca))?void 0:k.length)&&0<Ca){k=qa.lastIndexOf("\n",J-1)+1;var Ia=c.value.slice(k,da-1);Ca=Ia.replace(/^|\n/g,`$&${Ul.INDENT}`);Ia=Ca.length-
Ia.length;c.setSelectionRange(k,da-1);Ul.insert(c,Ca);c.setSelectionRange(J+1,da+Ia)}else Ul.insert(c,Ul.INDENT)}static unindent(c){const {selectionStart:k,selectionEnd:J,value:da}=c;var qa=da.lastIndexOf("\n",k-1)+1;const Ca=Ul.findLineEnd(da,J);var Ia=c.value.slice(qa,Ca);const bb=Ia.replace(/(^|\n)(\t| {1,2})/g,"$1");Ia=Ia.length-bb.length;c.setSelectionRange(qa,Ca);Ul.insert(c,bb);qa=(qa=/\t| {1,2}/.exec(da.slice(qa,k)))?qa[0].length:0;c.setSelectionRange(k-qa,Math.max(k-qa,J-Ia))}static normalizeText(c){return c.replace(Ul.fixNewLines,
"\n")}},uq=Ul;vb(uq,"fixNewLines",/\r?\n|\r/g);vb(uq,"INDENT","  ");var Ao;"undefined"!==typeof window&&(Ao=ig());var au=new Map,Qw=Rb()?"":"ctrl",$z=class extends uh{},Rw=Uf(ca(22)),aA=()=>{};/^((?!chrome|android).)*safari/i.test(navigator.userAgent);var Sw=Uf(ca(22)),bu={},xr=Uf(ca(22)),bA=c=>{for(c=c.parentElement;c&&c!==document.body;){const {overflowY:k}=window.getComputedStyle(c);if(c.scrollHeight>c.clientHeight&&("auto"===k||"scroll"===k||"overlay"===k))return c;c=c.parentElement}return document},
cu=Uf(ca(22)),du=new Map,cA={accent:"var(--lx-accent-09, hsl(var(--primary)))",brushFill:"var(--ls-scrollbar-background-color, rgba(0, 0, 0, .05))",brushStroke:"var(--ls-scrollbar-thumb-hover-color, rgba(0, 0, 0, .05))",selectStroke:"var(--color-selectedStroke)",selectFill:"var(--color-selectedFill)",binding:"var(--color-binding, rgba(65, 132, 244, 0.5))",background:"var(--ls-primary-background-color, hsl(var(--background)))",foreground:"var(--ls-primary-text-color, hsl(var(--foreground)))",grid:"var(--ls-quaternary-background-color, hsl(var(--secondary)))"},
dA=((c,...k)=>c.reduce((J,da,qa)=>J+da+(qa<k.length?k[qa]:""),""))`
  .tl-container {
    --tl-zoom: 1;
    --tl-scale: calc(1 / var(--tl-zoom));
    --tl-padding: calc(64px / var(--tl-zoom));;
    --tl-shadow-color: 0deg 0% 0%;
    --tl-binding-distance: ${4}px;
    --tl-shadow-elevation-low: 0px 0.4px 0.5px hsl(var(--tl-shadow-color) / 0.04),
      0px 0.6px 0.8px -0.7px hsl(var(--tl-shadow-color) / 0.06),
      0.1px 1.2px 1.5px -1.4px hsl(var(--tl-shadow-color) / 0.08);
    --tl-shadow-elevation-medium: 0px 0.4px 0.5px hsl(var(--tl-shadow-color) / 0.04),
      0.1px 1.3px 1.7px -0.5px hsl(var(--tl-shadow-color) / 0.06),
      0.1px 2.8px 3.6px -1px hsl(var(--tl-shadow-color) / 0.07),
      0.3px 6.1px 7.8px -1.4px hsl(var(--tl-shadow-color) / 0.09);
    --tl-shadow-elevation-high: 0px 0.4px 0.5px hsl(var(--tl-shadow-color) / 0.04),
      0.1px 2.3px 3px -0.2px hsl(var(--tl-shadow-color) / 0.05),
      0.2px 4.1px 5.3px -0.5px hsl(var(--tl-shadow-color) / 0.06),
      0.4px 6.6px 8.5px -0.7px hsl(var(--tl-shadow-color) / 0.07),
      0.6px 10.3px 13.2px -1px hsl(var(--tl-shadow-color) / 0.08),
      0.9px 16px 20.6px -1.2px hsl(var(--tl-shadow-color) / 0.09),
      1.3px 24.3px 31.2px -1.4px hsl(var(--tl-shadow-color) / 0.1);
    box-sizing: border-box;
    position: relative;
    top: 0px;
    left: 0px;
    width: 100%;
    height: 100%;
    max-width: 100%;
    max-height: 100%;
    box-sizing: border-box;
    padding: 0px;
    margin: 0px;
    outline: none;
    z-index: 100;
    user-select: none;
    touch-action: none;
    overscroll-behavior: none;
    background-color: var(--tl-background);
    cursor: inherit;
    box-sizing: border-box;
    color: var(--tl-foreground);
    -webkit-user-select: none;
    -webkit-user-drag: none;
  }

  .tl-overlay {
    background: none;
    fill: transparent;
    position: absolute;
    width: 100%;
    height: 100%;
    touch-action: none;
    pointer-events: none;
  }

  .tl-snap-line {
    stroke: var(--tl-accent);
    stroke-width: calc(1px * var(--tl-scale));
  }

  .tl-snap-point {
    stroke: var(--tl-accent);
    stroke-width: calc(1px * var(--tl-scale));
  }

  .tl-canvas {
    position: absolute;
    width: 100%;
    height: 100%;
    touch-action: none;
    pointer-events: all;
    overflow: clip;
    outline: none;
  }

  .tl-layer {
    position: absolute;
    top: 0px;
    left: 0px;
    height: 0px;
    width: 0px;
    contain: layout style size;
  }

  .tl-absolute {
    position: absolute;
    top: 0px;
    left: 0px;
    transform-origin: center center;
    contain: layout style size;
  }

  .tl-positioned {
    position: absolute;
    transform-origin: center center;
    pointer-events: none;
    display: flex;
    align-items: center;
    justify-content: center;
    contain: layout style size;
  }

  .tl-positioned-svg {
    width: 100%;
    height: 100%;
    overflow: hidden;
    contain: layout style size;
    pointer-events: none;
  }

  .tl-positioned-div {
    position: relative;
    width: 100%;
    height: 100%;
    padding: var(--tl-padding);
    contain: layout style size;
  }

  .tl-positioned-inner {
    position: relative;
    width: 100%;
    height: 100%;
  }

  .tl-counter-scaled {
    transform: scale(var(--tl-scale));
  }

  .tl-dashed {
    stroke-dasharray: calc(2px * var(--tl-scale)), calc(2px * var(--tl-scale));
  }

  .tl-transparent {
    fill: transparent;
    stroke: transparent;
  }

  .tl-corner-handle {
    stroke: var(--tl-selectStroke);
    fill: var(--tl-background);
    stroke-width: calc(1.5px * var(--tl-scale));
  }

  .tl-rotate-handle {
    stroke: var(--tl-selectStroke);
    fill: var(--tl-background);
    stroke-width: calc(1.5px * var(--tl-scale));
  }

  .tl-clone-handle {
    stroke: var(--tl-selectStroke);
    fill: var(--tl-background);
    stroke-width: calc(1.5px * var(--tl-scale));
  }

  .tl-clone-handle:hover {
    fill: var(--tl-selectStroke);
    cursor: pointer;
  }

  .tl-clone-handle:hover line {
    stroke: var(--tl-background);
  }

  .tl-user {
    left: -4px;
    top: -4px;
    height: 8px;
    width: 8px;
    border-radius: 100%;
    pointer-events: none;
  }

  .tl-indicator {
    fill: transparent;
    stroke-width: calc(1.5px * var(--tl-scale));
    pointer-events: none;
  }

  .tl-indicator-container {
    transform-origin: 0 0;
    fill: transparent;
    stroke-width: calc(1.5px * var(--tl-scale));
    pointer-events: none;
  }

  .tl-user-indicator-bounds {
    border-style: solid;
    border-width: calc(1px * var(--tl-scale));
  }

  .tl-selected {
    stroke: var(--tl-selectStroke);
  }

  .tl-hovered {
    stroke: var(--tl-selectStroke);
  }

  .tl-clone-target {
    pointer-events: all;
  }

  .tl-clone-target:hover .tl-clone-button {
    opacity: 1;
  }

  .tl-clone-button-target {
    cursor: pointer;
    pointer-events: all;
  }

  .tl-clone-button-target:hover .tl-clone-button {
    fill: var(--tl-selectStroke);
  }

  .tl-clone-button {
    opacity: 0;
    r: calc(8px * var(--tl-scale));
    stroke-width: calc(1.5px * var(--tl-scale));
    stroke: var(--tl-selectStroke);
    fill: var(--tl-background);
  }

  .tl-bounds {
    pointer-events: none;
    contain: layout style size;
  }

  .tl-bounds-bg {
    stroke: none;
    fill: var(--tl-selectFill);
    pointer-events: all;
    contain: layout style size;
  }

  .tl-bounds-fg {
    fill: transparent;
    stroke: var(--tl-selectStroke);
    stroke-width: calc(1.5px * var(--tl-scale));
  }

  .tl-brush {
    fill: var(--tl-brushFill);
    stroke: var(--tl-brushStroke);
    stroke-width: calc(1px * var(--tl-scale));
    pointer-events: none;
  }

  .tl-dot {
    fill: var(--tl-background);
    stroke: var(--tl-foreground);
    stroke-width: 2px;
  }

  .tl-handle {
    fill: var(--tl-background);
    stroke: var(--tl-selectStroke);
    stroke-width: 1.5px;
    pointer-events: none;
  }

  .tl-handle-bg {
    fill: transparent;
    stroke: none;
    r: calc(16px / max(1, var(--tl-zoom)));
    pointer-events: all;
    cursor: grab;
  }

  .tl-handle-bg:active {
    pointer-events: all;
    fill: none;
  }

  .tl-handle-bg:hover {
    cursor: grab;
    fill: var(--tl-selectFill);
  }

  .tl-binding-indicator {
    fill: transparent;
    stroke: var(--tl-binding);
  }

  .tl-centered {
    display: grid;
    place-content: center;
    place-items: center;
  }

  .tl-centered > * {
    grid-column: 1;
    grid-row: 1;
  }

  .tl-centered-g {
    transform: translate(var(--tl-padding), var(--tl-padding));
  }

  .tl-current-parent > *[data-shy='true'] {
    opacity: 1;
  }

  .tl-binding {
    fill: none;
    stroke: var(--tl-selectStroke);
    stroke-width: calc(2px * var(--tl-scale));
  }

  .tl-counter-scaled-positioned {
    position: absolute;
    top: 0;
    left: 0;
    pointer-events: none;
    padding: 0;
    contain: layout style size;
  }

  .tl-fade-in {
    opacity: 1;
    transition-timing-function: ease-in-out;
    transition-property: opacity;
    transition-duration: 0.12s;
    transition-delay: 0;
  }

  .tl-fade-out {
    opacity: 0;
    transition-timing-function: ease-out;
    transition-property: opacity;
    transition-duration: 0.12s;
    transition-delay: 0;
  }

  .tl-counter-scaled-positioned > .tl-positioned-div {
    user-select: none;
    padding: 64px;
  }

  .tl-context-bar > * {
    grid-column: 1;
    grid-row: 1;
  }

  .tl-bounds-detail {
    padding: 2px 3px;
    border-radius: 1px;
    white-space: nowrap;
    width: fit-content;
    text-align: center;
    font-size: 12px;
    font-weight: 500;
    background-color: var(--tl-selectStroke);
    color: var(--tl-background);
  }

  .tl-grid-canvas {
    position: absolute;
    touch-action: none;
    pointer-events: none;
    user-select: none;
  }

  .tl-grid {
    position: absolute;
    width: 100%;
    height: 100%;
    touch-action: none;
    pointer-events: none;
    user-select: none;
  }

  .tl-grid-dot {
    fill: var(--tl-grid);
  }

  .tl-html-canvas {
    position: absolute;
    top: 0px;
    left: 0px;
    width: 100%;
    height: 100%;
    zindex: 20000;
    pointer-events: none;
    border: 2px solid red;
  }

  .tl-direction-indicator {
    z-index: 100000;
    position: absolute;
    top: 0px;
    left: 0px;
    fill: var(--tl-selectStroke);
  }
`,Tw=Uf(ca(22)),Uw=Uf(ca(22)),eu={},Gj={toVector(c,k){void 0===c&&(c=k);return Array.isArray(c)?c:[c,c]},add(c,k){return[c[0]+k[0],c[1]+k[1]]},sub(c,k){return[c[0]-k[0],c[1]-k[1]]},addTo(c,k){c[0]+=k[0];c[1]+=k[1]},subTo(c,k){c[0]-=k[0];c[1]-=k[1]}},Vw={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}},eA=["enter","leave"],fA=["gotpointercapture","lostpointercapture"],
Ww=class{constructor(c,k,J){this.ctrl=c;this.args=k;this.key=J;this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(c){this.ctrl.state[this.key]=c}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const {state:c,
shared:k,ingKey:J,args:da}=this;k[J]=c._active=c.active=c._blocked=c._force=!1;c._step=[!1,!1];c.intentional=!1;c._movement=[0,0];c._distance=[0,0];c._direction=[0,0];c._delta=[0,0];c._bounds=[[-Infinity,Infinity],[-Infinity,Infinity]];c.args=da;c.axis=void 0;c.memo=void 0;c.elapsedTime=0;c.direction=[0,0];c.distance=[0,0];c.overflow=[0,0];c._movementBound=[!1,!1];c.velocity=[0,0];c.movement=[0,0];c.delta=[0,0];c.timeStamp=0}start(c){const k=this.state,J=this.config;k._active||(this.reset(),this.computeInitial(),
k._active=!0,k.target=c.target,k.currentTarget=c.currentTarget,k.lastOffset=J.from?Gg(J.from,k):k.offset,k.offset=k.lastOffset);k.startTime=k.timeStamp=c.timeStamp}computeValues(c){const k=this.state;k._values=c;k.values=this.config.transform(c)}computeInitial(){const c=this.state;c._initial=c._values;c.initial=c.values}compute(c){const {state:k,config:J,shared:da}=this;k.args=this.args;var qa=0;if(c){k.event=c;J.preventDefault&&c.cancelable&&k.event.preventDefault();k.type=c.type;da.touches=this.ctrl.pointerIds.size||
this.ctrl.touchIds.size;da.locked=!!document.pointerLockElement;qa=Object;var Ca=qa.assign,Ia={};"buttons"in c&&(Ia.buttons=c.buttons);if("shiftKey"in c){const {shiftKey:Gd,altKey:wd,metaKey:Ge,ctrlKey:Je}=c;Object.assign(Ia,{shiftKey:Gd,altKey:wd,metaKey:Ge,ctrlKey:Je})}Ca.call(qa,da,Ia);da.down=da.pressed=1===da.buttons%2||0<da.touches;qa=c.timeStamp-k.timeStamp;k.timeStamp=c.timeStamp;k.elapsedTime=k.timeStamp-k.startTime}k._active&&(Ca=k._delta.map(Math.abs),Gj.addTo(k._distance,Ca));this.axisIntent&&
this.axisIntent(c);const [bb,rb]=k._movement,[Pb,jc]=J.threshold,{_step:yc,values:Rc}=k;J.hasCustomTransform?(!1===yc[0]&&(yc[0]=Math.abs(bb)>=Pb&&Rc[0]),!1===yc[1]&&(yc[1]=Math.abs(rb)>=jc&&Rc[1])):(!1===yc[0]&&(yc[0]=Math.abs(bb)>=Pb&&Math.sign(bb)*Pb),!1===yc[1]&&(yc[1]=Math.abs(rb)>=jc&&Math.sign(rb)*jc));k.intentional=!1!==yc[0]||!1!==yc[1];if(k.intentional){Ca=[0,0];if(J.hasCustomTransform){const [Gd,wd]=Rc;Ca[0]=!1!==yc[0]?Gd-yc[0]:0;Ca[1]=!1!==yc[1]?wd-yc[1]:0}else Ca[0]=!1!==yc[0]?bb-yc[0]:
0,Ca[1]=!1!==yc[1]?rb-yc[1]:0;this.restrictToAxis&&!k._blocked&&this.restrictToAxis(Ca);Ia=k.offset;var jd=k._active&&!k._blocked||k.active;jd&&(k.first=k._active&&!k.active,k.last=!k._active&&k.active,k.active=da[this.ingKey]=k._active,c&&(k.first&&("bounds"in J&&(k._bounds=Gg(J.bounds,k)),this.setup&&this.setup()),k.movement=Ca,this.computeOffset()));var [fd,xd]=k.offset,[[Fd,Xc],[id,nd]]=k._bounds;k.overflow=[fd<Fd?-1:fd>Xc?1:0,xd<id?-1:xd>nd?1:0];k._movementBound[0]=k.overflow[0]?!1===k._movementBound[0]?
k._movement[0]:k._movementBound[0]:!1;k._movementBound[1]=k.overflow[1]?!1===k._movementBound[1]?k._movement[1]:k._movementBound[1]:!1;k.offset=Df(k._bounds,k.offset,k._active?J.rubberband||[0,0]:[0,0]);k.delta=Gj.sub(k.offset,Ia);this.computeMovement();jd&&(!k.last||32<qa)&&(k.delta=Gj.sub(k.offset,Ia),c=k.delta.map(Math.abs),Gj.addTo(k.distance,c),k.direction=k.delta.map(Math.sign),k._direction=k._delta.map(Math.sign),!k.first&&0<qa&&(k.velocity=[c[0]/qa,c[1]/qa]))}}emit(){const c=this.state;var k=
this.shared;const J=this.config;c._active||this.clean();if(!c._blocked&&c.intentional||c._force||J.triggerAllEvents)k=this.handler(vf(vf(vf({},k),c),{},{[this.aliasKey]:c.values})),void 0!==k&&(c.memo=k)}clean(){this.eventStore.clean();this.timeoutStore.clean()}},yr=class extends Ww{constructor(...c){super(...c);Yf(this,"aliasKey","xy")}reset(){super.reset();this.state.axis=void 0}init(){this.state.offset=[0,0];this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=Gj.add(this.state.lastOffset,
this.state.movement)}computeMovement(){this.state.movement=Gj.sub(this.state.offset,this.state.lastOffset)}axisIntent(c){const k=this.state,J=this.config;!k.axis&&c&&(c="object"===typeof J.axisThreshold?J.axisThreshold[Mg(c)]:J.axisThreshold,k.axis=Ji(k._movement,c));k._blocked=(J.lockDirection||!!J.axis)&&!k.axis||!!J.axis&&J.axis!==k.axis}restrictToAxis(c){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case "x":c[1]=0;break;case "y":c[0]=0}}},gA=c=>c,Xw={enabled(c=!0){return c},
eventOptions(c,k,J){return vf(vf({},J.shared.eventOptions),c)},preventDefault(c=!1){return c},triggerAllEvents(c=!1){return c},rubberband(c=0){switch(c){case !0:return[.15,.15];case !1:return[0,0];default:return Gj.toVector(c)}},from(c){if("function"===typeof c)return c;if(null!=c)return Gj.toVector(c)},transform(c,k,J){c=c||J.shared.transform;this.hasCustomTransform=!!c;return c||gA},threshold(c){return Gj.toVector(c,0)}},Cp=vf(vf({},Xw),{},{axis(c,k,{axis:J}){this.lockDirection="lock"===J;if(!this.lockDirection)return J},
axisThreshold(c=0){return c},bounds(c={}){if("function"===typeof c)return Ca=>Cp.bounds(c(Ca));if("current"in c)return()=>c.current;if("function"===typeof HTMLElement&&c instanceof HTMLElement)return c;const {left:k=-Infinity,right:J=Infinity,top:da=-Infinity,bottom:qa=Infinity}=c;return[[k,J],[da,qa]]}}),Yw={ArrowRight:(c=1)=>[10*c,0],ArrowLeft:(c=1)=>[-10*c,0],ArrowUp:(c=1)=>[0,-10*c],ArrowDown:(c=1)=>[0,10*c]},hA=class extends yr{constructor(...c){super(...c);Yf(this,"ingKey","dragging")}reset(){super.reset();
const c=this.state;c._pointerId=void 0;c._pointerActive=!1;c._keyboardActive=!1;c._preventScroll=!1;c._delayed=!1;c.swipe=[0,0];c.tap=!1;c.canceled=!1;c.cancel=this.cancel.bind(this)}setup(){const c=this.state;if(c._bounds instanceof HTMLElement){const k=c._bounds.getBoundingClientRect(),J=c.currentTarget.getBoundingClientRect();c._bounds=Cp.bounds({left:k.left-J.left+c.offset[0],right:k.right-J.right+c.offset[0],top:k.top-J.top+c.offset[1],bottom:k.bottom-J.bottom+c.offset[1]})}}cancel(){const c=
this.state;c.canceled||(c.canceled=!0,c._active=!1,setTimeout(()=>{this.compute();this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean();this.state._pointerActive=!1;this.state._keyboardActive=!1;super.clean()}pointerDown(c){const k=this.config,J=this.state;if(null==c.buttons||(Array.isArray(k.pointerButtons)?k.pointerButtons.includes(c.buttons):-1===k.pointerButtons||k.pointerButtons===c.buttons)){var da=this.ctrl.setEventIds(c);
k.pointerCapture&&c.target.setPointerCapture(c.pointerId);da&&1<da.size&&J._pointerActive||(this.start(c),this.setupPointer(c),J._pointerId=Fg(c),J._pointerActive=!0,this.computeValues(cg(c)),this.computeInitial(),k.preventScrollAxis&&"mouse"!==Mg(c)?(J._active=!1,this.setupScrollPrevention(c)):0<k.delay?(this.setupDelayTrigger(c),k.triggerAllEvents&&(this.compute(c),this.emit())):this.startPointerDrag(c))}}startPointerDrag(c){const k=this.state;k._active=!0;k._preventScroll=!0;k._delayed=!1;this.compute(c);
this.emit()}pointerMove(c){const k=this.state,J=this.config;if(k._pointerActive&&(k.type!==c.type||c.timeStamp!==k.timeStamp)){var da=Fg(c);if(void 0===k._pointerId||da===k._pointerId)da=cg(c),document.pointerLockElement===c.target?k._delta=[c.movementX,c.movementY]:(k._delta=Gj.sub(da,k._values),this.computeValues(da)),Gj.addTo(k._movement,k._delta),this.compute(c),k._delayed&&k.intentional?(this.timeoutStore.remove("dragDelay"),k.active=!1,this.startPointerDrag(c)):J.preventScrollAxis&&!k._preventScroll?
k.axis&&(k.axis===J.preventScrollAxis||"xy"===J.preventScrollAxis?(k._active=!1,this.clean()):(this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(c))):this.emit()}}pointerUp(c){this.ctrl.setEventIds(c);try{this.config.pointerCapture&&c.target.hasPointerCapture(c.pointerId)&&c.target.releasePointerCapture(c.pointerId)}catch(Ia){}const k=this.state,J=this.config;if(k._active&&k._pointerActive){var da=Fg(c);if(void 0===k._pointerId||da===k._pointerId){this.state._pointerActive=!1;this.setActive();
this.compute(c);var [qa,Ca]=k._distance;k.tap=qa<=J.tapsThreshold&&Ca<=J.tapsThreshold;if(k.tap&&J.filterTaps)k._force=!0;else{const [Ia,bb]=k.direction,[rb,Pb]=k.velocity,[jc,yc]=k.movement,[Rc,jd]=J.swipe.velocity,[fd,xd]=J.swipe.distance;k.elapsedTime<J.swipe.duration&&(Math.abs(rb)>Rc&&Math.abs(jc)>fd&&(k.swipe[0]=Ia),Math.abs(Pb)>jd&&Math.abs(yc)>xd&&(k.swipe[1]=bb))}this.emit()}}}pointerClick(c){!this.state.tap&&0<c.detail&&(c.preventDefault(),c.stopPropagation())}setupPointer(c){const k=this.config,
J=k.device;k.pointerLock&&c.currentTarget.requestPointerLock();k.pointerCapture||(this.eventStore.add(this.sharedConfig.window,J,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,J,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,J,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(c){this.state._preventScroll&&c.cancelable&&
c.preventDefault()}setupScrollPrevention(c){this.state._preventScroll=!1;"persist"in c&&"function"===typeof c.persist&&c.persist();const k=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",k);this.eventStore.add(this.sharedConfig.window,"touch","cancel",k);this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,c)}setupDelayTrigger(c){this.state._delayed=
!0;this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0];this.startPointerDrag(c)},this.config.delay)}keyDown(c){const k=Yw[c.key];if(k){const J=this.state,da=c.shiftKey?10:c.altKey?.1:1;this.start(c);J._delta=k(da);J._keyboardActive=!0;Gj.addTo(J._movement,J._delta);this.compute(c);this.emit()}}keyUp(c){c.key in Yw&&(this.state._keyboardActive=!1,this.setActive(),this.compute(c),this.emit())}bind(c){const k=this.config.device;c(k,"start",this.pointerDown.bind(this));this.config.pointerCapture&&
(c(k,"change",this.pointerMove.bind(this)),c(k,"end",this.pointerUp.bind(this)),c(k,"cancel",this.pointerUp.bind(this)),c("lostPointerCapture","",this.pointerUp.bind(this)));this.config.keys&&(c("key","down",this.keyDown.bind(this)),c("key","up",this.keyUp.bind(this)));this.config.filterTaps&&c("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}},Dp="undefined"!==typeof window&&window.document&&window.document.createElement;try{var Zw="constructor"in GestureEvent}catch(c){Zw=!1}var iA=
Zw,zr=Dp&&"ontouchstart"in window||Dp&&1<window.navigator.maxTouchPoints,$w=Dp&&"ontouchstart"in window||Dp&&1<window.navigator.maxTouchPoints,ax=Dp&&"onpointerdown"in window,jA=Dp&&"exitPointerLock"in window.document,bx={mouse:0,touch:0,pen:8},kA=vf(vf({},Cp),{},{device(c,k,{pointer:{touch:J=!1,lock:da=!1,mouse:qa=!1}={}}){this.pointerLock=da&&jA;return zr&&J?"touch":this.pointerLock?"mouse":ax&&!qa?"pointer":zr?"touch":"mouse"},preventScrollAxis(c,k,{preventScroll:J}){this.preventScrollDelay="number"===
typeof J?J:J||void 0===J&&c?250:void 0;if($w&&!1!==J)return c?c:void 0!==J?"y":void 0},pointerCapture(c,k,{pointer:{capture:J=!0,buttons:da=1,keys:qa=!0}={}}){this.pointerButtons=da;this.keys=qa;return!this.pointerLock&&"pointer"===this.device&&J},threshold(c,k,{filterTaps:J=!1,tapsThreshold:da=3,axis:qa}){c=Gj.toVector(c,J?da:qa?1:0);this.filterTaps=J;this.tapsThreshold=da;return c},swipe({velocity:c=.5,distance:k=50,duration:J=250}={}){return{velocity:this.transform(Gj.toVector(c)),distance:this.transform(Gj.toVector(k)),
duration:J}},delay(c=0){switch(c){case !0:return 180;case !1:return 0;default:return c}},axisThreshold(c){return c?vf(vf({},bx),c):bx}}),lA=class extends Ww{constructor(...c){super(...c);Yf(this,"ingKey","pinching");Yf(this,"aliasKey","da")}init(){this.state.offset=[1,0];this.state.lastOffset=[1,0];this.state._pointerEvents=new Map}reset(){super.reset();const c=this.state;c._touchIds=[];c.canceled=!1;c.cancel=this.cancel.bind(this);c.turns=0}computeOffset(){const {type:c,movement:k,lastOffset:J}=
this.state;this.state.offset="wheel"===c?Gj.add(k,J):[(1+k[0])*J[0],k[1]+J[1]]}computeMovement(){const {offset:c,lastOffset:k}=this.state;this.state.movement=[c[0]/k[0],c[1]-k[1]]}axisIntent(){const c=this.state,[k,J]=c._movement;if(!c.axis){const da=30*Math.abs(k)-Math.abs(J);0>da?c.axis="angle":0<da&&(c.axis="scale")}}restrictToAxis(c){this.config.lockDirection&&("scale"===this.state.axis?c[1]=0:"angle"===this.state.axis&&(c[0]=0))}cancel(){const c=this.state;c.canceled||setTimeout(()=>{c.canceled=
!0;c._active=!1;this.compute();this.emit()},0)}touchStart(c){this.ctrl.setEventIds(c);var k=this.state;const J=this.ctrl.touchIds;k._active&&k._touchIds.every(da=>J.has(da))||2>J.size||(this.start(c),k._touchIds=Array.from(J).slice(0,2),k=pf(c,k._touchIds),this.pinchStart(c,k))}pointerStart(c){if(null==c.buttons||1===c.buttons%2){this.ctrl.setEventIds(c);c.target.setPointerCapture(c.pointerId);var k=this.state,J=k._pointerEvents,da=this.ctrl.pointerIds;k._active&&Array.from(J.keys()).every(qa=>da.has(qa))||
(2>J.size&&J.set(c.pointerId,c),2>k._pointerEvents.size||(this.start(c),k=nf(...Array.from(J.values())),this.pinchStart(c,k)))}}pinchStart(c,k){this.state.origin=k.origin;this.computeValues([k.distance,k.angle]);this.computeInitial();this.compute(c);this.emit()}touchMove(c){if(this.state._active){var k=pf(c,this.state._touchIds);this.pinchMove(c,k)}}pointerMove(c){var k=this.state._pointerEvents;k.has(c.pointerId)&&k.set(c.pointerId,c);this.state._active&&(k=nf(...Array.from(k.values())),this.pinchMove(c,
k))}pinchMove(c,k){const J=this.state,da=k.angle-J._values[1];let qa=0;270<Math.abs(da)&&(qa+=Math.sign(da));this.computeValues([k.distance,k.angle-360*qa]);J.origin=k.origin;J.turns=qa;J._movement=[J._values[0]/J._initial[0]-1,J._values[1]-J._initial[1]];this.compute(c);this.emit()}touchEnd(c){this.ctrl.setEventIds(c);this.state._active&&this.state._touchIds.some(k=>!this.ctrl.touchIds.has(k))&&(this.state._active=!1,this.compute(c),this.emit())}pointerEnd(c){const k=this.state;this.ctrl.setEventIds(c);
try{c.target.releasePointerCapture(c.pointerId)}catch(J){}k._pointerEvents.has(c.pointerId)&&k._pointerEvents.delete(c.pointerId);k._active&&2>k._pointerEvents.size&&(k._active=!1,this.compute(c),this.emit())}gestureStart(c){c.cancelable&&c.preventDefault();const k=this.state;k._active||(this.start(c),this.computeValues([c.scale,c.rotation]),k.origin=[c.clientX,c.clientY],this.compute(c),this.emit())}gestureMove(c){c.cancelable&&c.preventDefault();if(this.state._active){var k=this.state;this.computeValues([c.scale,
c.rotation]);k.origin=[c.clientX,c.clientY];var J=k._movement;k._movement=[c.scale-1,c.rotation];k._delta=Gj.sub(k._movement,J);this.compute(c);this.emit()}}gestureEnd(c){this.state._active&&(this.state._active=!1,this.compute(c),this.emit())}wheel(c){const k=this.config.modifierKey;if(!k||c[k])this.state._active?this.wheelChange(c):this.wheelStart(c),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelStart(c){this.start(c);this.wheelChange(c)}wheelChange(c){"uv"in c||c.cancelable&&c.preventDefault();
const k=this.state;k._delta=[-ni(c)[1]/100*k.offset[0],0];Gj.addTo(k._movement,k._delta);Pj(k);this.state.origin=[c.clientX,c.clientY];this.compute(c);this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(c){const k=this.config.device;k&&(c(k,"start",this[k+"Start"].bind(this)),c(k,"change",this[k+"Move"].bind(this)),c(k,"end",this[k+"End"].bind(this)),c(k,"cancel",this[k+"End"].bind(this)));this.config.pinchOnWheel&&c("wheel","",this.wheel.bind(this),
{passive:!1})}},mA=vf(vf({},Xw),{},{device(c,k,{shared:J,pointer:{touch:da=!1}={}}){if(J.target&&!zr&&iA)return"gesture";if(zr&&da)return"touch";if($w){if(ax)return"pointer";if(zr)return"touch"}},bounds(c,k,{scaleBounds:J={},angleBounds:da={}}){const qa=Ia=>{Ia=Gg(J,Ia);Ia=Object.assign({},{min:-Infinity,max:Infinity},Ia||{});return[Ia.min,Ia.max]},Ca=Ia=>{Ia=Gg(da,Ia);Ia=Object.assign({},{min:-Infinity,max:Infinity},Ia||{});return[Ia.min,Ia.max]};return"function"!==typeof J&&"function"!==typeof da?
[qa(),Ca()]:Ia=>[qa(Ia),Ca(Ia)]},threshold(c,k,J){this.lockDirection="lock"===J.axis;return Gj.toVector(c,this.lockDirection?[.1,3]:0)},modifierKey(c){return void 0===c?"ctrlKey":c},pinchOnWheel(c=!0){return c}}),nA=class extends yr{constructor(...c){super(...c);Yf(this,"ingKey","moving")}move(c){this.config.mouseOnly&&"mouse"!==c.pointerType||(this.state._active?this.moveChange(c):this.moveStart(c),this.timeoutStore.add("moveEnd",this.moveEnd.bind(this)))}moveStart(c){this.start(c);this.computeValues(cg(c));
this.compute(c);this.computeInitial();this.emit()}moveChange(c){if(this.state._active){var k=cg(c),J=this.state;J._delta=Gj.sub(k,J._values);Gj.addTo(J._movement,J._delta);this.computeValues(k);this.compute(c);this.emit()}}moveEnd(c){this.state._active&&(this.state._active=!1,this.compute(c),this.emit())}bind(c){c("pointer","change",this.move.bind(this));c("pointer","leave",this.moveEnd.bind(this))}},oA=vf(vf({},Cp),{},{mouseOnly:(c=!0)=>c}),pA=class extends yr{constructor(...c){super(...c);Yf(this,
"ingKey","scrolling")}scroll(c){this.state._active||this.start(c);this.scrollChange(c);this.timeoutStore.add("scrollEnd",this.scrollEnd.bind(this))}scrollChange(c){c.cancelable&&c.preventDefault();const k=this.state;var J,da;const {scrollX:qa,scrollY:Ca,scrollLeft:Ia,scrollTop:bb}=c.currentTarget;var rb=[null!==(J=null!==qa&&void 0!==qa?qa:Ia)&&void 0!==J?J:0,null!==(da=null!==Ca&&void 0!==Ca?Ca:bb)&&void 0!==da?da:0];k._delta=Gj.sub(rb,k._values);Gj.addTo(k._movement,k._delta);this.computeValues(rb);
this.compute(c);this.emit()}scrollEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(c){c("scroll","",this.scroll.bind(this))}},qA=Cp,rA=class extends yr{constructor(...c){super(...c);Yf(this,"ingKey","wheeling")}wheel(c){this.state._active||this.start(c);this.wheelChange(c);this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(c){const k=this.state;k._delta=ni(c);Gj.addTo(k._movement,k._delta);Pj(k);this.compute(c);this.emit()}wheelEnd(){this.state._active&&
(this.state._active=!1,this.compute(),this.emit())}bind(c){c("wheel","",this.wheel.bind(this))}},sA=Cp,tA=class extends yr{constructor(...c){super(...c);Yf(this,"ingKey","hovering")}enter(c){this.config.mouseOnly&&"mouse"!==c.pointerType||(this.start(c),this.computeValues(cg(c)),this.compute(c),this.emit())}leave(c){if(!this.config.mouseOnly||"mouse"===c.pointerType){var k=this.state;if(k._active){k._active=!1;var J=cg(c);k._movement=k._delta=Gj.sub(J,k._values);this.computeValues(J);this.compute(c);
k.delta=k.movement;this.emit()}}}bind(c){c("pointer","enter",this.enter.bind(this));c("pointer","leave",this.leave.bind(this))}},uA=vf(vf({},Cp),{},{mouseOnly:(c=!0)=>c}),fu=new Map,gu=new Map,vA={key:"drag",engine:hA,resolver:kA},wA={key:"hover",engine:tA,resolver:uA},xA={key:"move",engine:nA,resolver:oA},yA={key:"pinch",engine:lA,resolver:mA},zA={key:"scroll",engine:pA,resolver:qA},AA={key:"wheel",engine:rA,resolver:sA},hu=Uf(ca(22)),BA={target(c){if(c)return()=>"current"in c?c.current:c},enabled(c=
!0){return c},window(c=Dp?window:void 0){return c},eventOptions({passive:c=!0,capture:k=!1}={}){return{passive:c,capture:k}},transform(c){return c}},CA=["target","eventOptions","window","enabled","transform"],cx=class{constructor(c,k){Yf(this,"_listeners",new Set);this._ctrl=c;this._gestureKey=k}add(c,k,J,da,qa){const Ca=this._listeners,Ia=Mh(k,J),bb=vf(vf({},this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{}),qa);c.addEventListener(Ia,da,bb);const rb=()=>{c.removeEventListener(Ia,
da,bb);Ca.delete(rb)};Ca.add(rb);return rb}clean(){this._listeners.forEach(c=>c());this._listeners.clear()}},DA=class{constructor(){Yf(this,"_timeouts",new Map)}add(c,k,J=140,...da){this.remove(c);this._timeouts.set(c,window.setTimeout(k,J,...da))}remove(c){(c=this._timeouts.get(c))&&window.clearTimeout(c)}clean(){this._timeouts.forEach(c=>void window.clearTimeout(c));this._timeouts.clear()}},EA=class{constructor(c){Yf(this,"gestures",new Set);Yf(this,"_targetEventStore",new cx(this));Yf(this,"gestureEventStores",
{});Yf(this,"gestureTimeoutStores",{});Yf(this,"handlers",{});Yf(this,"config",{});Yf(this,"pointerIds",new Set);Yf(this,"touchIds",new Set);Yf(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}});c.drag&&ri(this,"drag");c.wheel&&ri(this,"wheel");c.scroll&&ri(this,"scroll");c.move&&ri(this,"move");c.pinch&&ri(this,"pinch");c.hover&&ri(this,"hover")}setEventIds(c){if("touches"in c)return this.touchIds=new Set(Ye(c));if("pointerId"in c)return"pointerup"===c.type||"pointercancel"===c.type?
this.pointerIds.delete(c.pointerId):"pointerdown"===c.type&&this.pointerIds.add(c.pointerId),this.pointerIds}applyHandlers(c,k){this.handlers=c;this.nativeHandlers=k}applyConfig(c,k){this.config=Bi(c,k,this.config)}clean(){this._targetEventStore.clean();for(const c of this.gestures)this.gestureEventStores[c].clean(),this.gestureTimeoutStores[c].clean()}effect(){this.config.shared.target&&this.bind();return()=>this._targetEventStore.clean()}bind(...c){var k=this.config.shared;const J={};let da;if(k.target&&
(da=k.target(),!da))return;if(k.enabled){for(const qa of this.gestures){const Ca=this.config[qa],Ia=dx(J,Ca.eventOptions,!!da);Ca.enabled&&(new (fu.get(qa))(this,c,qa)).bind(Ia)}k=dx(J,k.eventOptions,!!da);for(const qa in this.nativeHandlers)k(qa,"",Ca=>this.nativeHandlers[qa](vf(vf({},this.state.shared),{},{event:Ca,args:c})),void 0,!0)}for(const qa in J)J[qa]=Eh(...J[qa]);if(!da)return J;for(const qa in J){const {device:Ca,capture:Ia,passive:bb}=Mf(qa);this._targetEventStore.add(da,Ca,"",J[qa],
{capture:Ia,passive:bb})}}},dx=(c,k,J)=>(da,qa,Ca,Ia={},bb=!1)=>{var rb,Pb;const jc=null!==(rb=Ia.capture)&&void 0!==rb?rb:k.capture;Ia=null!==(Pb=Ia.passive)&&void 0!==Pb?Pb:k.passive;da=bb?da:Dg(da,qa,jc);J&&Ia&&(da+="Passive");c[da]=c[da]||[];c[da].push(Ca)},FA=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/,ws=Uf(ca(22)),iu=Uf(ca(22)),ex=Uf(ca(22)),fx=Uf(ca(22)),GA=Uf(ca(22)),HA=Uf(ca(22)),IA=Uf(ca(22)),JA=Uf(ca(22)),KA={none:(c,k)=>"none",["default"]:(c,k)=>"default",pointer:(c,k)=>"pointer",crosshair:(c,
k)=>"crosshair",move:(c,k)=>"move",wait:(c,k)=>"wait",progress:(c,k)=>"progress",grab:(c,k)=>Yd('\x3cpath d\x3d"m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" fill\x3d"%23fff"/\x3e\x3cg stroke\x3d"%23000" stroke-linecap\x3d"round" stroke-width\x3d".75"\x3e\x3cpath d\x3d"m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" stroke-linejoin\x3d"round"/\x3e\x3cpath d\x3d"m20.5664 21.7344v-3.459"/\x3e\x3cpath d\x3d"m18.5508 21.7461-.016-3.473"/\x3e\x3cpath d\x3d"m16.5547 18.3047.021 3.426"/\x3e\x3c/g\x3e',
c,k),grabbing:(c,k)=>Yd("\x3cpath d\x3d'm13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042' fill\x3d'%23fff'/\x3e\x3cg stroke\x3d'%23000' stroke-width\x3d'.75'\x3e\x3cpath d\x3d'm13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042z' stroke-linejoin\x3d'round'/\x3e\x3cpath d\x3d'm20.5664 19.7344v-3.459' stroke-linecap\x3d'round'/\x3e\x3cpath d\x3d'm18.5508 19.7461-.016-3.473' stroke-linecap\x3d'round'/\x3e\x3cpath d\x3d'm16.5547 16.3047.021 3.426' stroke-linecap\x3d'round'/\x3e\x3c/g\x3e",
c,k),text:(c,k)=>Yd("\x3cpath d\x3d'm6.94 2v-1c-1.35866267-.08246172-2.66601117.53165299-3.47 1.63-.80398883-1.09834701-2.11133733-1.71246172-3.47-1.63v1c1.30781678-.16635468 2.55544738.59885876 3 1.84v5.1h-1v1h1v4.16c-.4476345 1.2386337-1.69302129 2.002471-3 1.84v1c1.35687108.0731933 2.6600216-.5389494 3.47-1.63.8099784 1.0910506 2.11312892 1.7031933 3.47 1.63v-1c-1.28590589.133063-2.49760499-.6252793-2.94-1.84v-4.18h1v-1h-1v-5.08c.43943906-1.21710975 1.65323743-1.97676587 2.94-1.84z' transform\x3d'translate(14 9)'/\x3e",
c,k),["resize-edge"]:(c,k)=>Yd("\x3cpath d\x3d'm9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill\x3d'%23fff'/\x3e\x3cpath d\x3d'm17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill\x3d'%23000'/\x3e",c,k),["resize-corner"]:(c,k)=>Yd("\x3cpath d\x3d'm19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill\x3d'%23fff'/\x3e\x3cpath d\x3d'm18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill\x3d'%23000'/\x3e",
c,k),["ew-resize"]:(c,k)=>Yd("\x3cpath d\x3d'm9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill\x3d'%23fff'/\x3e\x3cpath d\x3d'm17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill\x3d'%23000'/\x3e",c,k),["ns-resize"]:(c,k)=>Yd("\x3cpath d\x3d'm9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill\x3d'%23fff'/\x3e\x3cpath d\x3d'm17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill\x3d'%23000'/\x3e",
c+90,k),["nesw-resize"]:(c,k)=>Yd("\x3cpath d\x3d'm19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill\x3d'%23fff'/\x3e\x3cpath d\x3d'm18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill\x3d'%23000'/\x3e",c,k),["nwse-resize"]:(c,k)=>Yd("\x3cpath d\x3d'm19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill\x3d'%23fff'/\x3e\x3cpath d\x3d'm18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill\x3d'%23000'/\x3e",
c+90,k),rotate:(c,k)=>Yd('\x3cg\x3e\x3cpath d\x3d"M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill\x3d"black"/\x3e\x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill\x3d"white"/\x3e\x3c/g\x3e',
c+45,k),["nwse-rotate"]:(c,k)=>Yd('\x3cg\x3e\x3cpath d\x3d"M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill\x3d"black"/\x3e\x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill\x3d"white"/\x3e\x3c/g\x3e',
c,k),["nesw-rotate"]:(c,k)=>Yd('\x3cg\x3e\x3cpath d\x3d"M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill\x3d"black"/\x3e\x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill\x3d"white"/\x3e\x3c/g\x3e',
c+90,k),["senw-rotate"]:(c,k)=>Yd('\x3cg\x3e\x3cpath d\x3d"M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill\x3d"black"/\x3e\x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill\x3d"white"/\x3e\x3c/g\x3e',
c+180,k),["swne-rotate"]:(c,k)=>Yd('\x3cg\x3e\x3cpath d\x3d"M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill\x3d"black"/\x3e\x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill\x3d"white"/\x3e\x3c/g\x3e',
c+270,k)},LA=Uf(ca(22));Uf(ca(22));var gx=ca(22),hx=Uf(ca(22));if(!ca(22).useState)throw Error("mobx-react-lite requires React with Hooks support");if(!zc)throw Error("mobx-react-lite@3 requires mobx at least version 6 to be available");var MA=ca(23),Ar=Uf(ca(22)),ix="undefined"===typeof FinalizationRegistry?void 0:FinalizationRegistry,NA=1E4,OA=function(c){var k="function"===typeof Symbol&&Symbol.iterator,J=k&&c[k],da=0;if(J)return J.call(c);if(c&&"number"===typeof c.length)return{next:function(){c&&
da>=c.length&&(c=void 0);return{value:c&&c[da++],done:!c}}};throw new TypeError(k?"Object is not iterable.":"Symbol.iterator is not defined.");},jx=ix?ge(ix):$e(),PA=jx.addReactionToTrack,QA=jx.recordReactionAsCommitted,kx=function(c,k){var J="function"===typeof Symbol&&c[Symbol.iterator];if(!J)return c;c=J.call(c);var da,qa=[];try{for(;(void 0===k||0<k--)&&!(da=c.next()).done;)qa.push(da.value)}catch(Ia){var Ca={error:Ia}}finally{try{da&&!da.done&&(J=c["return"])&&J.call(c)}finally{if(Ca)throw Ca.error;
}}return qa},RA=function(){return function(){}}(),vq=ca(22),lx="function"===typeof Symbol&&Symbol.for,mx=lx?Symbol.for("react.forward_ref"):"function"===typeof vq.forwardRef&&(0,vq.forwardRef)(function(c){return null}).$$typeof,nx=lx?Symbol.for("react.memo"):"function"===typeof vq.memo&&(0,vq.memo)(function(c){return null}).$$typeof,SA={$$typeof:!0,render:!0,compare:!0,type:!0,displayName:!0};Pf.displayName="Observer";ca(22);ca(22);ca(22);(function(c){c||=Ee;ob({reactionScheduler:c})})(MA.unstable_batchedUpdates);
var TA=Uf(ca(22)),ju=ca(602),Vl=TA.forwardRef(function(c,k){var {children:J,opacity:da,centered:qa,className:Ca=""}=c,Ia=hj(c,["children","opacity","centered","className"]);return(0,ju.jsx)(Pf,{children:()=>(0,ju.jsx)("div",{ref:k,className:`tl-positioned-div ${Ca}`,style:da?{opacity:da}:void 0,draggable:!1,children:(0,ju.jsx)("div",gg(tf({className:`tl-positioned-inner ${qa?"tl-centered":""}`},Ia),{children:J}))})})}),UA=Uf(ca(22)),ku=ca(602),tm=UA.forwardRef(function(c,k){var {id:J,className:da=
"",style:qa,children:Ca}=c,Ia=hj(c,["id","className","style","children"]);return(0,ku.jsx)(Pf,{children:()=>(0,ku.jsx)("svg",{ref:k,style:qa,className:`tl-positioned-svg ${da}`,children:(0,ku.jsx)("g",gg(tf({id:J,className:"tl-centered-g"},Ia),{children:Ca}))})})}),Br=Uf(ca(22)),ox=Uf(ca(22)),xs=Uf(ca(22)),VA=ca(602),Bo=te(function(c){var {id:k,bounds:J,zIndex:da,rotation:qa=0,className:Ca="",children:Ia}=c;c=hj(c,"id bounds zIndex rotation className children".split(" "));const bb=xs.useRef(null);
xs.useLayoutEffect(()=>{bb.current.style.transform=`translate(
        calc(${J.minX}px - var(--tl-padding)),
        calc(${J.minY}px - var(--tl-padding)))
        rotate(${qa+(J.rotation||0)}rad)`},[J.minX,J.minY,qa,J.rotation]);xs.useLayoutEffect(()=>{const rb=bb.current;rb.style.width=`calc(${Math.floor(J.width)}px + (var(--tl-padding) * 2))`;rb.style.height=`calc(${Math.floor(J.height)}px + (var(--tl-padding) * 2))`},[J.width,J.height]);xs.useLayoutEffect(()=>{const rb=bb.current;void 0!==da&&(rb.style.zIndex=da.toString())},[da]);return(0,VA.jsx)("div",gg(tf({id:k,ref:bb,className:`tl-positioned ${Ca}`,"aria-label":"container"},c),{children:Ia}))}),
WA=Uf(ca(22)),px=ca(602),XA=te(function({shapes:c,hidden:k,bounds:J,rotation:da=0}){const {components:{ContextBar:qa},viewport:{bounds:Ca,camera:{point:[Ia,bb],zoom:rb}}}=md(),Pb=WA.useRef(null);var jc=Xe.getRotatedBounds(J,da);jc=Xe.multiplyBounds(jc,rb);Ib(Pb,J,da,10005);if(!qa)throw Error("Expected a ContextBar component.");const yc=Xe.translateBounds(jc,[Ia*rb,bb*rb]);return(0,px.jsx)("div",{ref:Pb,className:"tl-counter-scaled-positioned","aria-label":"context-bar-container","data-html2canvas-ignore":"true",
children:(0,px.jsx)(qa,{hidden:k,shapes:c,bounds:J,offsets:{left:yc.minX,right:Ca.width-yc.maxX,top:yc.minY,bottom:Ca.height-yc.maxY,width:yc.width,height:yc.height},scaledBounds:jc,rotation:da})})}),qx=Uf(ca(22)),YA=ca(602),rx=te(function({children:c}){const k=qx.useRef(null),{viewport:J}=md(),da=k.current,{zoom:qa,point:Ca}=J.camera;qx.useEffect(()=>{da&&(da.style.transform=`scale(${qa}) translate3d(${Ca[0]}px, ${Ca[1]}px, 0)`)},[qa,Ca,da]);return(0,YA.jsx)("div",{ref:k,className:"tl-absolute tl-layer",
children:c})}),ys=ca(602),sx=te(function({shape:c,isHovered:k=!1,isSelected:J=!1,isBinding:da=!1,isEditing:qa=!1,isLocked:Ca=!1,meta:Ia}){const {bounds:bb,props:{scale:rb,rotation:Pb=0},ReactIndicator:jc}=c;return(0,ys.jsx)(Bo,{"data-type":"Indicator","data-html2canvas-ignore":"true",bounds:bb,rotation:Pb,scale:rb,zIndex:qa?1E3:1E4,children:(0,ys.jsx)(tm,{children:(0,ys.jsx)("g",{className:`tl-indicator-container ${J?"tl-selected":"tl-hovered"} ${Ca?"tl-locked":""}`,children:(0,ys.jsx)(jc,{isEditing:qa,
isBinding:da,isHovered:k,isLocked:Ca,isSelected:J,isErasing:!1,meta:Ia})})})})}),tx=Uf(ca(22)),zs=ca(602),ZA=te(function({bounds:c,shape:k}){const {viewport:{camera:{zoom:J}},components:{QuickLinks:da}}=md();var qa=Le();const Ca=fh(k);if(!da)throw Error("Expected a QuickLinks component.");qa=50>c.height*J||!qa.selectedShapesArray.includes(k);return(0,zs.jsx)(Bo,{bounds:c,className:"tl-quick-links-container","data-html2canvas-ignore":"true",children:(0,zs.jsx)(Vl,{children:(0,zs.jsx)("span",gg(tf({style:{position:"absolute",
top:"100%",pointerEvents:"all",transformOrigin:"left top",paddingTop:"8px",transform:"scale(var(--tl-scale))",minWidth:"320px"}},Ca),{onPointerDown:Ia=>Ia.stopPropagation(),children:(0,zs.jsx)(da,{className:"tl-backlinks-count "+(qa?"tl-backlinks-count-rounded":""),id:k.id,shape:k})}))})})}),As=ca(602),$A=te(function({bounds:c,shape:k}){const {viewport:{camera:{zoom:J}},components:{BacklinksCount:da}}=md();var qa=Le();if(!da)throw Error("Expected a BacklinksCount component.");const Ca=Ia=>Ia.stopPropagation();
qa=50>c.height*J||!qa.selectedShapesArray.includes(k)||k.hideSelection;return(0,As.jsx)(Bo,{bounds:c,className:"tl-backlinks-count-container",children:(0,As.jsx)(Vl,{children:(0,As.jsx)("span",{style:{position:"absolute",left:"100%",pointerEvents:"all",transformOrigin:"left top",transform:"translateY(6px) scale(var(--tl-scale))"},onPointerDown:Ca,onWheelCapture:Ca,onKeyDown:Ca,title:"Shape Backlinks",children:(0,As.jsx)(da,{className:"tl-backlinks-count "+(qa?"tl-backlinks-count-rounded":""),id:k.id,
shape:k})})})})}),aB=Uf(ca(22)),ux=ca(602),bB=te(function({bounds:c,hidden:k,shapes:J,rotation:da=0,detail:qa="size"}){const {components:{SelectionDetail:Ca},viewport:{camera:{zoom:Ia}}}=md(),bb=aB.useRef(null),rb=Xe.multiplyBounds(c,Ia);Ib(bb,c,da,10003);if(!Ca)throw Error("Expected a SelectionDetail component.");return(0,ux.jsx)("div",{ref:bb,className:`tl-counter-scaled-positioned ${k?"tl-fade-out":""}`,"aria-label":"bounds-detail-container","data-html2canvas-ignore":"true",children:(0,ux.jsx)(Ca,
{shapes:J,bounds:c,scaledBounds:rb,zoom:Ia,rotation:da,detail:qa})})}),vx=ca(602),cB=te(function({shape:c,isHovered:k=!1,isSelected:J=!1,isBinding:da=!1,isErasing:qa=!1,isEditing:Ca=!1,onEditingEnd:Ia,asset:bb,meta:rb,zIndex:Pb}){const {bounds:jc,props:{rotation:yc,scale:Rc},ReactComponent:jd}=c,fd=Le(),xd=fh(c);var Fd=fd.getParentGroup(c);Fd=fd.selectedIds.has(null==Fd?void 0:Fd.id);return(0,vx.jsx)(Bo,{"data-shape-id":c.id,"data-html2canvas-ignore":!J&&!Fd&&0!==fd.selectedShapes.size||null,zIndex:Pb,
"data-type":"Shape",bounds:jc,rotation:yc,scale:Rc,children:(0,vx.jsx)(jd,{meta:rb,isEditing:Ca,isBinding:da,isHovered:k,isSelected:J,isErasing:qa,events:xd,asset:bb,onEditingEnd:Ia})})}),wq=ca(602),wx=[[-1,.15,64],[.05,.375,16],[.15,1,4],[.7,2.5,1]],dB=te(function({size:c}){const {viewport:{camera:{point:k,zoom:J}}}=md();return(0,wq.jsxs)("svg",{className:"tl-grid",version:"1.1",xmlns:"http://www.w3.org/2000/svg","data-html2canvas-ignore":"true",children:[(0,wq.jsx)("defs",{children:wx.map(([da,
qa,Ca],Ia)=>{Ca=Ca*c*J;var bb=k[0]*J,rb=k[1]*J;bb=0<bb?bb%Ca:Ca+bb%Ca;rb=0<rb?rb%Ca:Ca+rb%Ca;da=Ii(J,[da,qa],[0,1]);return(0,wq.jsx)("pattern",{id:`grid-${Ia}`,width:Ca,height:Ca,patternUnits:"userSpaceOnUse",children:!(2<da||.1>da)&&(0,wq.jsx)("circle",{className:"tl-grid-dot",cx:bb,cy:rb,r:1.5,opacity:Math.max(0,Math.min(da,1))})},`grid-pattern-${Ia}`)})}),wx.map((da,qa)=>(0,wq.jsx)("rect",{width:"100%",height:"100%",fill:`url(#grid-${qa})`},`grid-rect-${qa}`))]})}),xx=te(function({size:c}){return(0,wq.jsx)(dB,
{size:c})}),yx=ca(602),zx=te(function({bounds:c}){const k=Pd("background");return(0,yx.jsx)(tm,gg(tf({"data-html2canvas-ignore":"true"},k),{children:(0,yx.jsx)("rect",{className:"tl-bounds-bg",width:Math.max(1,c.width),height:Math.max(1,c.height),pointerEvents:"all",rx:8,ry:8})}))});ca(22);var Ax=ca(602),Bx=te(function({scaledBounds:c,shapes:k,detail:J="size",rotation:da=0}){var qa;const Ca=1===k.length?da:null!=(qa=c.rotation)?qa:0;return(0,Ax.jsx)(Vl,{centered:!0,children:(0,Ax.jsx)("div",{className:"tl-bounds-detail",
style:{transform:Ca<zh||Ca>3*zh?`rotate(${Ca}rad) translateY(${c.height/2+24}px)`:`rotate(${Math.PI+Ca}rad) translateY(${c.height/2+32}px)`,padding:"2px 3px",borderRadius:"1px"},children:1===k.length&&"line"===k[0].type?`${Rd.dist(k[0].props.handles.start.point,k[0].props.handles.end.point).toFixed()}`:"size"===J?`${c.width.toFixed()} \xD7 ${c.height.toFixed()}`:`\u2220${yi.radiansToDegrees(yi.clampRadians(da)).toFixed()}\xB0`})})}),lu=ca(602),eB={top_left_corner:"tl-cursor-nwse",top_right_corner:"tl-cursor-nesw",
bottom_right_corner:"tl-cursor-nwse",bottom_left_corner:"tl-cursor-nesw"},Bs=te(function({cx:c,cy:k,size:J,targetSize:da,corner:qa,isHidden:Ca}){const Ia=Pd(qa);return(0,lu.jsxs)("g",gg(tf({opacity:Ca?0:1},Ia),{children:[(0,lu.jsx)("rect",{className:"tl-transparent "+(Ca?"":eB[qa]),"aria-label":`${qa} target`,x:c-1.25*da,y:k-1.25*da,width:2.5*da,height:2.5*da,pointerEvents:Ca?"none":"all"}),(0,lu.jsx)("rect",{className:"tl-corner-handle","aria-label":`${qa} handle`,x:c-J/2,y:k-J/2,width:J,height:J,
pointerEvents:"none"})]}))}),Cs=ca(602),mu=te(function({cx:c,cy:k,size:J,direction:da,isHidden:qa}){const Ca=Le();return(0,Cs.jsxs)("g",{className:"tl-clone-handle",opacity:qa?0:1,children:[(0,Cs.jsx)("circle",{"aria-label":`${da} handle`,pointerEvents:"all",onPointerDown:Ia=>Ca.api.clone(da),cx:c,cy:k,r:J}),(0,Cs.jsx)("line",{x1:c-J/2,y1:k,x2:c+J/2,y2:k}),(0,Cs.jsx)("line",{x1:c,y1:k-J/2,x2:c,y2:k+J/2})]})}),fB=ca(602),gB={top_edge:"tl-cursor-ns",right_edge:"tl-cursor-ew",bottom_edge:"tl-cursor-ns",
left_edge:"tl-cursor-ew"},Ds=te(function({x:c,y:k,width:J,height:da,targetSize:qa,edge:Ca,disabled:Ia,isHidden:bb}){const rb=Pd(Ca);return(0,fB.jsx)("rect",tf({pointerEvents:bb||Ia?"none":"all",className:"tl-transparent tl-edge-handle "+(bb?"":gB[Ca]),"aria-label":`${Ca} target`,opacity:bb?0:1,x:c-qa,y:k-qa,width:Math.max(1,J+2*qa),height:Math.max(1,da+2*qa)},rb))}),nu=ca(602);te(function({cx:c,cy:k,size:J,targetSize:da,isHidden:qa}){const Ca=Pd("rotate");return(0,nu.jsxs)("g",gg(tf({opacity:qa?0:
1},Ca),{children:[(0,nu.jsx)("circle",{className:"tl-transparent ","aria-label":"rotate target",cx:c,cy:k,r:da,pointerEvents:qa?"none":"all"}),(0,nu.jsx)("circle",{className:"tl-rotate-handle","aria-label":"rotate handle",cx:c,cy:k,r:J/2,pointerEvents:"none"})]}))});ca(22);var Cx=ca(602),Es=te(function({cx:c,cy:k,targetSize:J,corner:da,isHidden:qa}){const Ca=Pd(da);return(0,Cx.jsx)("g",gg(tf({opacity:qa?0:1},Ca),{children:(0,Cx.jsx)("rect",{className:"tl-transparent","aria-label":`${da} target`,x:c-
2.5*J,y:k-2.5*J,width:3*J,height:3*J,pointerEvents:qa?"none":"all"})}))}),dk=ca(602),Dx=te(function({bounds:c,showResizeHandles:k,showRotateHandles:J,showCloneHandles:da,shapes:qa}){var Ca,Ia;const bb=Le();let {width:rb,height:Pb}=c;var jc=bb.viewport.camera.zoom;c=8/jc;const yc=6/jc;jc=30/jc;const Rc=2*c,jd=1===qa.length?qa[0].canResize:[!0,!0],fd=null!=(Ia=null==(Ca=bb.editingShape)?void 0:Ca.props.borderRadius)?Ia:0;return(0,dk.jsx)(dk.Fragment,{children:0<qa.length&&(0,dk.jsxs)(tm,{children:[!bb.editingShape&&
(0,dk.jsx)("rect",{className:"tl-bounds-fg",width:Math.max(rb,1),height:Math.max(Pb,1),rx:fd,ry:fd,pointerEvents:"none"}),(0,dk.jsx)(Ds,{x:2*yc,y:0,width:rb-4*yc,height:0,targetSize:yc,edge:"top_edge",disabled:!jd[1],isHidden:!k}),(0,dk.jsx)(Ds,{x:rb,y:2*yc,width:0,height:Pb-4*yc,targetSize:yc,edge:"right_edge",disabled:!jd[0],isHidden:!k}),(0,dk.jsx)(Ds,{x:2*yc,y:Pb,width:rb-4*yc,height:0,targetSize:yc,edge:"bottom_edge",disabled:!jd[1],isHidden:!k}),(0,dk.jsx)(Ds,{x:0,y:2*yc,width:0,height:Pb-4*
yc,targetSize:yc,edge:"left_edge",disabled:!jd[0],isHidden:!k}),(0,dk.jsx)(Es,{cx:0,cy:0,targetSize:yc,corner:"top_left_resize_corner",isHidden:!J}),(0,dk.jsx)(Es,{cx:rb+2*yc,cy:0,targetSize:yc,corner:"top_right_resize_corner",isHidden:!J}),(0,dk.jsx)(Es,{cx:rb+2*yc,cy:Pb+2*yc,targetSize:yc,corner:"bottom_right_resize_corner",isHidden:!J}),(0,dk.jsx)(Es,{cx:0,cy:Pb+2*yc,targetSize:yc,corner:"bottom_left_resize_corner",isHidden:!J}),(0,dk.jsx)(mu,{cx:-jc,cy:Pb/2,size:Rc,direction:"left",isHidden:!da}),
(0,dk.jsx)(mu,{cx:rb+jc,cy:Pb/2,size:Rc,direction:"right",isHidden:!da}),(0,dk.jsx)(mu,{cx:rb/2,cy:Pb+jc,size:Rc,direction:"down",isHidden:!da}),(null==jd?void 0:jd.every(xd=>xd))&&(0,dk.jsxs)(dk.Fragment,{children:[(0,dk.jsx)(Bs,{cx:0,cy:0,size:c,targetSize:yc,corner:"top_left_corner",isHidden:!k}),(0,dk.jsx)(Bs,{cx:rb,cy:0,size:c,targetSize:yc,corner:"top_right_corner",isHidden:!k}),(0,dk.jsx)(Bs,{cx:rb,cy:Pb,size:c,targetSize:yc,corner:"bottom_right_corner",isHidden:!k}),(0,dk.jsx)(Bs,{cx:0,cy:Pb,
size:c,targetSize:yc,corner:"bottom_left_corner",isHidden:!k})]})]})})}),ou=ca(602),Ex=te(function({bounds:c}){return(0,ou.jsx)(Bo,{bounds:c,zIndex:10001,children:(0,ou.jsx)(tm,{children:(0,ou.jsx)("rect",{className:"tl-brush",x:0,y:0,width:c.width,height:c.height})})})}),Fx=ca(602);te(function(){return(0,Fx.jsx)(Fx.Fragment,{})});var pu=ca(602),Gx=te(function({shape:c,handle:k,id:J}){c=Id(c,J);const [da,qa]=k.point;return(0,pu.jsxs)("g",gg(tf({className:"tl-handle","aria-label":"handle"},c),{transform:`translate(${da}, ${qa})`,
children:[(0,pu.jsx)("circle",{className:"tl-handle-bg",pointerEvents:"all"}),(0,pu.jsx)("circle",{className:"tl-counter-scaled tl-handle",pointerEvents:"none",r:4})]}))}),Hx=Uf(ca(22)),qu=ca(602),ru=te(function({direction:c}){const {viewport:{bounds:k}}=md(),J=Hx.useRef(null);Hx.useLayoutEffect(()=>{const da=J.current;if(da){var qa=[k.width/2,k.height/2],Ca=Xe.getRectangleSides([12,12],[k.width-24,k.height-24]);for(const [,[Ia,bb]]of Ca)Ca=u(qa,c,Ia,bb),Ca.didIntersect&&(Ca=Ca.points[0],da.style.transform=
`translate(${Ca[0]-6}px,${Ca[1]-6}px) rotate(${Rd.toAngle(c)}rad)`)}},[c,k]);return(0,qu.jsx)("div",{ref:J,className:"tl-direction-indicator","data-html2canvas-ignore":"true",children:(0,qu.jsx)("svg",{height:12,width:12,children:(0,qu.jsx)("polygon",{points:"0,0 12,6 0,12"})})})}),Hj=ca(602),hB=te(function({id:c,className:k,brush:J,shapes:da,assets:qa,bindingShapes:Ca,editingShape:Ia,hoveredShape:bb,hoveredGroup:rb,selectionBounds:Pb,selectedShapes:jc,erasingShapes:yc,selectionDirectionHint:Rc,cursor:jd=
"default",cursorRotation:fd=0,selectionRotation:xd=0,showSelection:Fd=!0,showHandles:Xc=!0,showSelectionRotation:id=!1,showResizeHandles:nd=!0,showRotateHandles:Gd=!0,showCloneHandles:wd=!0,showSelectionDetail:Ge=!0,showContextBar:Je=!0,showGrid:ag=!0,gridSize:af=8,onEditingEnd:Sf=aA,theme:Bh=qi,children:Tg}){var zg;const dh=Br.useRef(null),{viewport:uf,components:Af,meta:rf}=md(),Zf=Le(),hh=Br.useCallback(ih=>{Zf.inputs.updateContainerOffset([ih.minX,ih.minY])},[]);xe(Bh,c);yd(dh);fe(dh,uf,hh);dj(dh);
we();oe(dh,jd,fd);De(dh);Ng(dh);c=Qe();const Lh=(jd=1===(null==jc?void 0:jc.length)&&jc[0])&&"handles"in jd.props?null==jc?void 0:jc[0]:void 0,Oi=Br.useMemo(()=>new Set(jc||[]),[jc]),Vh=Br.useMemo(()=>new Set(yc||[]),[yc]);jd=1===(null==jc?void 0:jc.length)?jc[0]:void 0;rb=[...(new Set([rb,bb]))].filter(Fc);return(0,Hj.jsxs)("div",{ref:dh,className:`tl-container ${null!=k?k:""}`,children:[(0,Hj.jsxs)("div",gg(tf({tabIndex:-1,className:"tl-absolute tl-canvas"},c),{children:[ag&&Af.Grid&&(0,Hj.jsx)(Af.Grid,
{size:af}),(0,Hj.jsxs)(rx,{children:[Af.SelectionBackground&&jc&&Pb&&Fd&&(0,Hj.jsx)(Bo,{"data-type":"SelectionBackground",bounds:Pb,zIndex:2,"data-html2canvas-ignore":"true",children:(0,Hj.jsx)(Af.SelectionBackground,{shapes:jc,bounds:Pb,showResizeHandles:nd,showRotateHandles:Gd})}),da&&da.map((ih,oj)=>(0,Hj.jsx)(cB,{shape:ih,asset:qa&&ih.props.assetId?qa[ih.props.assetId]:void 0,isEditing:ih===Ia,isHovered:ih===bb,isBinding:null==Ca?void 0:Ca.includes(ih),isSelected:Oi.has(ih),isErasing:Vh.has(ih),
meta:rf,zIndex:1E3+oj,onEditingEnd:Sf},"shape_"+ih.id)),!Zf.isIn("select.pinching")&&(null==jc?void 0:jc.map(ih=>(0,Hj.jsx)(sx,{shape:ih,isEditing:ih===Ia,isHovered:!1,isBinding:!1,isSelected:!0,isLocked:ih.props.isLocked},"selected_indicator_"+ih.id))),rb.map(ih=>ih!==Ia&&(0,Hj.jsx)(sx,{shape:ih},"hovered_indicator_"+ih.id)),jd&&Af.BacklinksCount&&(0,Hj.jsx)($A,{hidden:!1,bounds:jd.bounds,shape:jd}),bb&&bb!==jd&&Af.QuickLinks&&(0,Hj.jsx)(ZA,{hidden:!1,bounds:bb.bounds,shape:bb}),J&&Af.Brush&&(0,Hj.jsx)(Af.Brush,
{bounds:J}),jc&&Pb&&(0,Hj.jsxs)(Hj.Fragment,{children:[Fd&&Af.SelectionForeground&&(0,Hj.jsx)(Bo,{"data-type":"SelectionForeground","data-html2canvas-ignore":"true",bounds:Pb,zIndex:Ia&&jc.includes(Ia)?1002:10002,children:(0,Hj.jsx)(Af.SelectionForeground,{shapes:jc.filter(ih=>!ih.props.isLocked),bounds:Pb,showResizeHandles:nd,showRotateHandles:Gd,showCloneHandles:wd})}),Xc&&Lh&&Af.Handle&&(0,Hj.jsx)(Bo,{"data-type":"onlySelectedShapeWithHandles","data-html2canvas-ignore":"true",bounds:Pb,zIndex:10003,
children:(0,Hj.jsx)(tm,{children:Object.entries(null!=(zg=Lh.props.handles)?zg:{}).map(([ih,oj])=>Br.createElement(Af.Handle,{key:`${oj.id}_handle_${oj.id}`,shape:Lh,handle:oj,id:ih}))})}),jc&&Af.SelectionDetail&&(0,Hj.jsx)(bB,{"data-html2canvas-ignore":"true",shapes:jc,bounds:Pb,detail:id?"rotation":"size",hidden:!Ge,rotation:xd},"detail"+jc.map(ih=>ih.id).join(""))]})]}),Rc&&Pb&&jc&&(0,Hj.jsx)(ru,{direction:Rc,bounds:Pb,shapes:jc}),(0,Hj.jsx)("div",{id:"tl-dev-tools-canvas-anchor","data-html2canvas-ignore":"true"})]})),
(0,Hj.jsx)(rx,{children:jc&&Pb&&(0,Hj.jsx)(Hj.Fragment,{children:jc&&Af.ContextBar&&(0,Hj.jsx)(XA,{shapes:jc.filter(ih=>!ih.props.isLocked),hidden:!Je,bounds:jd?jd.bounds:Pb,rotation:jd?jd.props.rotation:0},"context"+jc.map(ih=>ih.id).join(""))})}),Tg]})}),Ix=Uf(ca(22)),Jx=Uf(ca(22)),Kx=ca(602);te(function({children:c}){const k=Jx.useRef(null),{viewport:J}=md();Jx.useEffect(()=>ic(()=>{const da=k.current;if(da){var {zoom:qa,point:Ca}=J.camera;da.style.transform=`scale(${qa}) translateX(${Ca[0]}px) translateY(${Ca[1]}px)`}}),
[]);return(0,Kx.jsx)("svg",{className:"tl-absolute tl-overlay",pointerEvents:"none",children:(0,Kx.jsx)("g",{ref:k,pointerEvents:"none",children:c})})});var iB=ca(602),jB=te(function(c){const k=$c(c),J=Ae(c.id);qd(k,c);Sc(k,c);return(0,iB.jsx)(J.Provider,{value:k,children:c.children})}),kB=ca(602),lB=te(function({id:c="noid",viewport:k,inputs:J,callbacks:da=qi,meta:qa=qi,components:Ca=qi,children:Ia}){const [bb,rb]=Ix.useState(()=>{const {Brush:jc,ContextBar:yc,DirectionIndicator:Rc,Grid:jd,Handle:fd,
SelectionBackground:xd,SelectionDetail:Fd,SelectionForeground:Xc}=Ca,id=hj(Ca,"Brush ContextBar DirectionIndicator Grid Handle SelectionBackground SelectionDetail SelectionForeground".split(" "));return{id:c,viewport:k,inputs:J,callbacks:da,meta:qa,components:gg(tf({},id),{Brush:null===jc?void 0:Ex,ContextBar:yc,DirectionIndicator:null===Rc?void 0:ru,Grid:null===jd?void 0:xx,Handle:null===fd?void 0:Gx,SelectionBackground:null===xd?void 0:zx,SelectionDetail:null===Fd?void 0:Bx,SelectionForeground:null===
Xc?void 0:Dx})}});Ix.useLayoutEffect(()=>{const {Brush:jc,ContextBar:yc,DirectionIndicator:Rc,Grid:jd,Handle:fd,SelectionBackground:xd,SelectionDetail:Fd,SelectionForeground:Xc}=Ca,id=hj(Ca,"Brush ContextBar DirectionIndicator Grid Handle SelectionBackground SelectionDetail SelectionForeground".split(" "));return ic(()=>{rb({id:c,viewport:k,inputs:J,callbacks:da,meta:qa,components:gg(tf({},id),{Brush:null===jc?void 0:Ex,ContextBar:yc,DirectionIndicator:null===Rc?void 0:ru,Grid:null===jd?void 0:xx,
Handle:null===fd?void 0:Gx,SelectionBackground:null===xd?void 0:zx,SelectionDetail:null===Fd?void 0:Bx,SelectionForeground:null===Xc?void 0:Dx})})})},[]);const Pb=Yc(c);return(0,kB.jsx)(Pb.Provider,{value:bb,children:Ia})}),Lx=ca(602),mB=ca(602),nB=te(function(c){const k=Le();return(0,mB.jsx)(jh,tf({viewport:k.viewport,inputs:k.inputs,callbacks:k._events,brush:k.brush,editingShape:k.editingShape,hoveredShape:k.hoveredShape,hoveredGroup:k.hoveredGroup,bindingShapes:k.bindingShapes,selectionDirectionHint:k.selectionDirectionHint,
selectionBounds:k.selectionBounds,selectedShapes:k.selectedShapesArray,erasingShapes:k.erasingShapesArray,shapes:k.shapes,assets:k.assets,showGrid:k.settings.showGrid,penMode:k.settings.penMode,showSelection:k.showSelection,showSelectionRotation:k.showSelectionRotation,showResizeHandles:k.showResizeHandles,showRotateHandles:k.showRotateHandles,showCloneHandles:k.showCloneHandles,showSelectionDetail:k.showSelectionDetail,showContextBar:k.showContextBar,cursor:k.cursors.cursor,cursorRotation:k.cursors.rotation,
selectionRotation:k.selectionRotation,onEditingEnd:k.clearEditingState},c))});ca(602);var xq=Uf(ca(22)),Co=Uf(ca(22)),oB=ca(602),pB="add-link block-search block connector group internal-link link-to-block link-to-page link-to-whiteboard move-to-sidebar-right object-compact object-expanded open-as-page page-search page references-hide references-show select-cursor text ungroup whiteboard-element whiteboard".split(" "),mh=c=>{var {name:k,className:J}=c;c=hj(c,["name","className"]);const da=pB.includes(k)?
"tie tie-":"ti ti-";return(0,oB.jsx)("i",tf({className:[da+k,J].join(" ")},c))},Ep=ca(602),Cr=window.LSUI,Mx=ca(602),su=ca(602),qB=({style:c,icon:k,onClick:J})=>(0,su.jsx)("button",{"data-html2canvas-ignore":"true",style:c,className:"tl-circle-button",onPointerDown:J,children:(0,su.jsx)("div",{className:"tl-circle-button-icons-wrapper",children:(0,su.jsx)(mh,{name:k})})}),tu=ca(602),rB=window.LSUI,Si=Uf(ca(22)).default.createContext({}),sB=Uf(ca(22)),Nx=ca(602),yk=c=>{var {action:k,shortcut:J,opts:da}=
c;c=hj(c,["action","shortcut","opts"]);var {renderers:qa}=sB.useContext(Si);qa=null==qa?void 0:qa.KeyboardShortcut;return(0,Nx.jsx)("div",gg(tf({className:"tl-menu-right-slot"},c),{children:(0,Nx.jsx)(qa,{action:k,shortcut:J,opts:da})}))},Wl=ca(602),Do=window.LSUI,tB=te(function(){const c=Le(),k=J=>{J.preventDefault()};return(0,Wl.jsxs)(Do.DropdownMenu,{children:[(0,Wl.jsx)(Do.DropdownMenuTrigger,{className:"tl-button text-sm px-2 important",id:"tl-zoom",children:(100*c.viewport.camera.zoom).toFixed(0)+
"%"}),(0,Wl.jsxs)(Do.DropdownMenuContent,{onCloseAutoFocus:J=>J.preventDefault(),id:"zoomPopup",sideOffset:12,children:[(0,Wl.jsxs)(Do.DropdownMenuItem,{onSelect:k,onClick:c.api.zoomToFit,children:["Zoom to drawing",(0,Wl.jsx)(yk,{action:"whiteboard/zoom-to-fit"})]}),(0,Wl.jsxs)(Do.DropdownMenuItem,{onSelect:k,onClick:c.api.zoomToSelection,disabled:0===c.selectedShapesArray.length,children:["Zoom to fit selection",(0,Wl.jsx)(yk,{action:"whiteboard/zoom-to-selection"})]}),(0,Wl.jsxs)(Do.DropdownMenuItem,
{onSelect:k,onClick:c.api.zoomIn,children:["Zoom in",(0,Wl.jsx)(yk,{action:"whiteboard/zoom-in"})]}),(0,Wl.jsxs)(Do.DropdownMenuItem,{onSelect:k,onClick:c.api.zoomOut,children:["Zoom out",(0,Wl.jsx)(yk,{action:"whiteboard/zoom-out"})]}),(0,Wl.jsxs)(Do.DropdownMenuItem,{onSelect:k,onClick:c.api.resetZoom,children:["Reset zoom",(0,Wl.jsx)(yk,{action:"whiteboard/reset-zoom"})]})]})]})}),ek=ca(602),uB=window.LSUI,vB=te(function(){const c=Le(),{handlers:{t:k}}=Co.useContext(Si),J=Co.useCallback(()=>{c.api.undo()},
[c]),da=Co.useCallback(()=>{c.api.redo()},[c]),qa=Co.useCallback(()=>{c.api.zoomIn()},[c]),Ca=Co.useCallback(()=>{c.api.zoomOut()},[c]),Ia=Co.useCallback(()=>{c.api.toggleGrid()},[c]),bb=Co.useCallback(()=>{c.api.toggleSnapToGrid()},[c]),rb=Co.useCallback(()=>{c.api.togglePenMode()},[c]);return(0,ek.jsxs)("div",{className:"tl-action-bar","data-html2canvas-ignore":"true",children:[!c.readOnly&&(0,ek.jsxs)("div",{className:"tl-toolbar tl-history-bar mr-2 mb-2",children:[(0,ek.jsx)(ei,{tooltip:k("whiteboard/undo"),
onClick:J,children:(0,ek.jsx)(mh,{name:"arrow-back-up"})}),(0,ek.jsx)(ei,{tooltip:k("whiteboard/redo"),onClick:da,children:(0,ek.jsx)(mh,{name:"arrow-forward-up"})})]}),(0,ek.jsxs)("div",{className:"tl-toolbar tl-zoom-bar mr-2 mb-2",children:[(0,ek.jsx)(ei,{tooltip:k("whiteboard/zoom-in"),onClick:qa,id:"tl-zoom-in",children:(0,ek.jsx)(mh,{name:"plus"})}),(0,ek.jsx)(ei,{tooltip:k("whiteboard/zoom-out"),onClick:Ca,id:"tl-zoom-out",children:(0,ek.jsx)(mh,{name:"minus"})}),(0,ek.jsx)(uB.Separator,{orientation:"vertical"}),
(0,ek.jsx)(tB,{})]}),(0,ek.jsxs)("div",{className:"tl-toolbar tl-grid-bar mr-2 mb-2",children:[(0,ek.jsx)(Ig,{tooltip:k("whiteboard/toggle-grid"),className:"tl-button",pressed:c.settings.showGrid,id:"tl-show-grid",onPressedChange:Ia,children:(0,ek.jsx)(mh,{name:"grid-dots"})}),!c.readOnly&&(0,ek.jsx)(Ig,{tooltip:k("whiteboard/snap-to-grid"),className:"tl-button",pressed:c.settings.snapToGrid,id:"tl-snap-to-grid",onPressedChange:bb,children:(0,ek.jsx)(mh,{name:c.settings.snapToGrid?"magnet":"magnet-off"})})]}),
!c.readOnly&&(0,ek.jsx)("div",{className:"tl-toolbar tl-pen-mode-bar mb-2",children:(0,ek.jsx)(Ig,{tooltip:k("whiteboard/toggle-pen-mode"),className:"tl-button",pressed:c.settings.penMode,id:"tl-toggle-pen-mode",onPressedChange:rb,children:(0,ek.jsx)(mh,{name:c.settings.penMode?"pencil":"pencil-off"})})})]})}),Ox=Uf(ca(22)),wB=Uf(ca(23)),uu=ca(602),Fs=c=>`[${c.map(k=>{var J;return null!=(J=null==k?void 0:k.toFixed(2))?J:"-"}).join(", ")}]`,xB=te(()=>{var c;const {viewport:{bounds:k,camera:{point:J,
zoom:da}},inputs:qa}=md(),Ca=Ox.default.useRef();Ox.default.useEffect(()=>{const bb=document.getElementById("tl-statusbar-anchor");Ca.current=bb},[]);const Ia=[["Z",null!=(c=null==da?void 0:da.toFixed(2))?c:"null"],["MP",Fs(qa.currentPoint)],["MS",Fs(qa.currentScreenPoint)],["VP",Fs(J)],["VBR",Fs([k.maxX,k.maxY])]].map(bb=>bb.join("")).join("|");c=Ca.current?wB.default.createPortal((0,uu.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:Ia}),Ca.current):null;return(0,uu.jsx)(uu.Fragment,
{children:c})}),Dr=Uf(ca(22)),Gs=ca(602),rn=te(c=>{var {id:k,icon:J,tooltip:da,tooltipSide:qa="left",handleClick:Ca}=c;c=hj(c,["id","icon","tooltip","tooltipSide","handleClick"]);var Ia;const bb=Le(),rb=null==(Ia=[...bb.Tools,qq,rq])?void 0:Ia.find(Pb=>Pb.id===k);Ia=(Ia=null==rb?void 0:rb.shortcut)&&da?(0,Gs.jsxs)("div",{className:"flex",children:[da,(0,Gs.jsx)(yk,{action:Ia})]}):da;return(0,Gs.jsx)(ei,gg(tf({},c),{tooltipSide:qa,tooltip:Ia,"data-tool":k,"data-selected":k===bb.selectedTool.id,onClick:Ca,
children:"string"===typeof J?(0,Gs.jsx)(mh,{name:J}):J}))}),yB=Uf(ca(22)),Eo=ca(602),vu=window.LSUI,Px=te(function(c){var {popoverSide:k="left",setGeometry:J,activeGeometry:da,chevron:qa=!0}=c;c=hj(c,["popoverSide","setGeometry","activeGeometry","chevron"]);var {handlers:{t:Ca}}=yB.default.useContext(Si);const Ia=[{id:"box",icon:"square",tooltip:Ca("whiteboard/rectangle")},{id:"ellipse",icon:"circle",tooltip:Ca("whiteboard/circle")},{id:"polygon",icon:"triangle",tooltip:Ca("whiteboard/triangle")}];
Ca={id:"shapes",icon:"triangle-square-circle",tooltip:Ca("whiteboard/shape")};Ca=da?Ia.find(bb=>bb.id===da):Ca;return(0,Eo.jsxs)(vu.Popover,{children:[(0,Eo.jsx)(vu.PopoverTrigger,{asChild:!0,children:(0,Eo.jsxs)("div",gg(tf({},c),{className:"tl-geometry-tools-pane-anchor",children:[(0,Eo.jsx)(rn,gg(tf({},Ca),{tooltipSide:k})),qa&&(0,Eo.jsx)(mh,{"data-selected":da,className:"tl-popover-indicator",name:"chevron-down-left"})]}))}),(0,Eo.jsx)(vu.PopoverContent,{className:"p-0 w-auto",side:k,sideOffset:15,
collisionBoundary:document.querySelector(".logseq-tldraw"),children:(0,Eo.jsx)("div",{className:`tl-toolbar tl-geometry-toolbar ${["left","right"].includes(k)?"flex-col":"flex-row"}`,children:Ia.map(bb=>(0,Eo.jsx)(rn,{id:bb.id,icon:bb.icon,handleClick:J,tooltipSide:k},bb.id))})})]})}),Hs=ca(602),Is=window.LSUI,Qx=Uf(ca(22)),zk=ca(602),Js=window.LSUI,zB=Uf(ca(22)),wu=ca(22),AB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,
strokeLinecap:"round",strokeLinejoin:"round"},BB=((c,k)=>{const J=(0,wu.forwardRef)((da,qa)=>{var {color:Ca="currentColor",size:Ia=24,strokeWidth:bb=2,absoluteStrokeWidth:rb,children:Pb}=da;da=hj(da,["color","size","strokeWidth","absoluteStrokeWidth","children"]);return(0,wu.createElement)("svg",tf(gg(tf({ref:qa},AB),{width:Ia,height:Ia,stroke:Ca,strokeWidth:rb?24*Number(bb)/Number(Ia):bb,className:`lucide lucide-${c.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`}),da),[...k.map(([jc,yc])=>
(0,wu.createElement)(jc,yc)),...((Array.isArray(Pb)?Pb:[Pb])||[])])});J.displayName=`${c}`;return J})("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Un=ca(602),yq=window.LSUI,CB=Uf(ca(22)),DB=ca(602),ml=ca(602),Rx=window.LSUI,EB=te(function(){const c=Le(),{handlers:{t:k}}=Dr.useContext(Si),J=Dr.useCallback(Ia=>{c.api.setColor(Ia)},[]),da=Dr.useCallback(Ia=>{(Ia=Ia.currentTarget.dataset.tool)&&c.selectTool(Ia)},[]),[qa,Ca]=Dr.useState(()=>{var Ia;return null!=(Ia=Object.values(Eb).find(bb=>
bb===c.selectedTool.id))?Ia:Object.values(Eb)[0]});Dr.useEffect(()=>{Ca(Ia=>{var bb;return null!=(bb=Object.values(Eb).find(rb=>rb===c.selectedTool.id))?bb:Ia})},[c.selectedTool.id]);return(0,ml.jsx)("div",{className:"tl-primary-tools","data-html2canvas-ignore":"true",children:(0,ml.jsxs)("div",{className:"tl-toolbar tl-tools-floating-panel",children:[(0,ml.jsx)(rn,{handleClick:()=>c.selectTool("select"),tooltip:k("whiteboard/select"),id:"select",icon:"select-cursor"}),(0,ml.jsx)(rn,{handleClick:()=>
c.selectTool("move"),tooltip:k("whiteboard/pan"),id:"move",icon:c.isIn("move.panning")?"hand-grab":"hand-stop"}),(0,ml.jsx)(Rx.Separator,{orientation:"horizontal"}),(0,ml.jsx)(rn,{handleClick:()=>c.selectTool("logseq-portal"),tooltip:k("whiteboard/add-block-or-page"),id:"logseq-portal",icon:"circle-plus"}),(0,ml.jsx)(rn,{handleClick:()=>c.selectTool("pencil"),tooltip:k("whiteboard/draw"),id:"pencil",icon:"ballpen"}),(0,ml.jsx)(rn,{handleClick:()=>c.selectTool("highlighter"),tooltip:k("whiteboard/highlight"),
id:"highlighter",icon:"highlight"}),(0,ml.jsx)(rn,{handleClick:()=>c.selectTool("erase"),tooltip:k("whiteboard/eraser"),id:"erase",icon:"eraser"}),(0,ml.jsx)(rn,{handleClick:()=>c.selectTool("line"),tooltip:k("whiteboard/connector"),id:"line",icon:"connector"}),(0,ml.jsx)(rn,{handleClick:()=>c.selectTool("text"),tooltip:k("whiteboard/text"),id:"text",icon:"text"}),(0,ml.jsx)(Px,{activeGeometry:qa,setGeometry:da}),(0,ml.jsx)(Rx.Separator,{orientation:"horizontal",style:{margin:"0 -4px"}}),(0,ml.jsx)(Wi,
{popoverSide:"left",color:c.settings.color,setColor:J}),(0,ml.jsx)(Qg,{scaleLevel:c.settings.scaleLevel,popoverSide:"left",compact:!0})]})})}),xu=ca(602),FB=te(function(){const c=Le();return(0,xu.jsxs)("div",{className:"tl-statusbar","data-html2canvas-ignore":"true",children:[c.selectedTool.id," | ",c.selectedTool.currentState.id,(0,xu.jsx)("div",{style:{flex:1}}),(0,xu.jsx)("div",{id:"tl-statusbar-anchor",className:"flex gap-1"})]})}),zq=ca(602),GB=te(function(){const c=Le();return(0,zq.jsxs)(zq.Fragment,
{children:[ac()&&(0,zq.jsx)(FB,{}),ac()&&(0,zq.jsx)(xB,{}),!c.readOnly&&(0,zq.jsx)(EB,{}),(0,zq.jsx)(vB,{})]})}),Er=Uf(ca(22)),Ak=Uf(ca(22)),Sx=Uf(ca(22)),HB=Uf(ca(22)),Fo=ca(602),Tx=({id:c,showReferenceContent:k=!1})=>{var J;const {handlers:{isWhiteboardPage:da,redirectToPage:qa,sidebarAddBlock:Ca,queryBlockByUUID:Ia},renderers:{Breadcrumb:bb,PageName:rb}}=HB.default.useContext(Si);var Pb="";let jc=sg(c)?"B":"P",yc="";if(sg(c)){Pb=Ia(c);if(!Pb)return(0,Fo.jsx)("span",{className:"p-2",children:"Invalid reference. Did you remove it?"});
yc=Pb.content;Pb="whiteboard-shape"===(null==(J=Pb.properties)?void 0:J["ls-type"])?"link-to-whiteboard":"link-to-block"}else Pb=da(c)?"link-to-whiteboard":"link-to-page";J=yc&&23<yc.length?yc.slice(0,20)+"...":yc;return(0,Fo.jsxs)("button",{className:"inline-flex gap-1 items-center w-full",onPointerDown:Rc=>{Rc.stopPropagation();Rc.shiftKey?Ca(c,"B"===jc?"block":"page"):qa(c)},children:[(0,Fo.jsx)(mh,{name:Pb}),(0,Fo.jsx)("span",{className:"pointer-events-none block-link-reference-row",children:"P"===
jc?(0,Fo.jsx)(rb,{pageName:c}):(0,Fo.jsxs)(Fo.Fragment,{children:[(0,Fo.jsx)(bb,{levelLimit:1,blockId:c,endSeparator:k}),k&&J]})})]})},Kk=Uf(ca(22)),Bl=ca(22),IB=["children"],Ks="undefined"!==typeof document?Bl.useLayoutEffect:Bl.useEffect,yh=Uf(ca(22)),gi=ca(22),JB=ca(23),Fr,Bk,KB="undefined"!=typeof document?gi.useLayoutEffect:gi.useEffect;!function(c){c[c.DEBUG=0]="DEBUG";c[c.INFO=1]="INFO";c[c.WARN=2]="WARN";c[c.ERROR=3]="ERROR"}(Bk||={});var LB=((Fr={})[Bk.DEBUG]="debug",Fr[Bk.INFO]="log",Fr[Bk.WARN]=
"warn",Fr[Bk.ERROR]="error",Fr),Go=oh(function(){var c=fg(Bk.ERROR);return{log:fg(function(k,J,da){var qa;void 0===da&&(da=Bk.INFO);da>=(null!=(qa=("undefined"==typeof globalThis?window:globalThis).VIRTUOSO_LOG_LEVEL)?qa:c(4))&&console[LB[da]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",k,J)}),logLevel:c}},[],{singleton:!0}),Cl=oh(function(){var c=Yg(),k=Yg(),J=fg(0),da=Yg(),qa=fg(0),Ca=Yg(),Ia=Yg(),bb=fg(0),rb=fg(0),Pb=fg(0),jc=fg(0),yc=Yg(),Rc=Yg(),jd=fg(!1),
fd=fg(!1);return Xg(Cf(c,wg(function(xd){return xd.scrollTop})),k),Xg(Cf(c,wg(function(xd){return xd.scrollHeight})),Ia),Xg(k,qa),{scrollContainerState:c,scrollTop:k,viewportHeight:Ca,headerHeight:bb,fixedHeaderHeight:rb,fixedFooterHeight:Pb,footerHeight:jc,scrollHeight:Ia,smoothScrollTargetReached:da,react18ConcurrentRendering:fd,scrollTo:yc,scrollBy:Rc,statefulScrollTop:qa,deviation:J,scrollingInProgress:jd}},[],{singleton:!0}),Ni={lvl:0},yu=oh(function(){return{recalcInProgress:fg(!1)}},[],{singleton:!0}),
MB={offsetHeight:"height",offsetWidth:"width"},Vn=oh(function(c){var k=c[0].log,J=c[1].recalcInProgress;c=Yg();var da=Yg(),qa=Li(da,0),Ca=Yg(),Ia=Yg(),bb=fg(0),rb=fg([]),Pb=fg(void 0),jc=fg(void 0),yc=fg(function(id,nd){return Qb(id,MB[nd])}),Rc=fg(void 0),jd=fg(0),fd={offsetTree:[],sizeTree:Ni,groupOffsetTree:Ni,lastIndex:0,lastOffset:0,lastSize:0,groupIndices:[]},xd=Li(Cf(c,Hh(rb,k,jd),Fi(eh,fd),Ch()),fd);Xg(Cf(rb,xh(function(id){return 0<id.length}),Hh(xd,jd),wg(function(id){var nd=id[0],Gd=id[1],
wd=id[2];id=nd.reduce(function(Ge,Je,ag){return Bd(Ge,Je,Hg(Je,Gd.offsetTree,wd)||ag)},Ni);return Ga({},Gd,{groupIndices:nd,groupOffsetTree:id})})),xd);Xg(Cf(da,Hh(xd),xh(function(id){return id[0]<id[1].lastIndex}),wg(function(id){var nd=id[1];return[{startIndex:id[0],endIndex:nd.lastIndex,size:nd.lastSize}]})),c);Xg(Pb,jc);var Fd=Li(Cf(Pb,wg(function(id){return void 0===id})),!0);Xg(Cf(jc,xh(function(id){return void 0!==id&&xd(4).sizeTree===Ni}),wg(function(id){return[{startIndex:0,endIndex:0,size:id}]})),
c);fd=Ri(Cf(c,Hh(xd),Fi(function(id,nd){nd=nd[1];return{changed:nd!==id.sizes,sizes:nd}},{changed:!1,sizes:fd}),wg(function(id){return id.changed})));ti(Cf(bb,Fi(function(id,nd){return{diff:id.prev-nd,prev:nd}},{diff:0,prev:0}),wg(function(id){return id.diff})),function(id){0<id?(J(0,!0),Ca(0,id)):0>id&&Ia(0,id)});ti(Cf(bb,Hh(k)),function(id){0>id[0]&&(0,id[1])("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:bb},
Bk.ERROR)});k=Ri(Ca);Xg(Cf(Ca,Hh(xd),wg(function(id){var nd=id[0];id=id[1];if(0<id.groupIndices.length)throw Error("Virtuoso: prepending items does not work with groups");return ke(id.sizeTree).reduce(function(Gd,wd){var Ge=wd.k;wd=wd.v;return{ranges:[].concat(Gd.ranges,[{startIndex:Gd.prevIndex,endIndex:Ge+nd-1,size:Gd.prevSize}]),prevIndex:Ge+nd,prevSize:wd}},{ranges:[],prevIndex:0,prevSize:id.lastSize}).ranges})),c);var Xc=Ri(Cf(Ia,Hh(xd,jd),wg(function(id){return Hg(-id[0],id[1].offsetTree,id[2])})));
return Xg(Cf(Ia,Hh(xd,jd),wg(function(id){var nd=id[0],Gd=id[1];id=id[2];if(0<Gd.groupIndices.length)throw Error("Virtuoso: shifting items does not work with groups");var wd=ke(Gd.sizeTree).reduce(function(Ge,Je){return Bd(Ge,Math.max(0,Je.k+nd),Je.v)},Ni);return Ga({},Gd,{sizeTree:wd},oi(Gd.offsetTree,0,wd,id))})),xd),{data:Rc,totalCount:da,sizeRanges:c,groupIndices:rb,defaultItemSize:jc,fixedItemSize:Pb,unshiftWith:Ca,shiftWith:Ia,shiftWithOffset:Xc,beforeUnshiftWith:k,firstItemIndex:bb,gap:jd,
sizes:xd,listRefresh:fd,statefulTotalCount:qa,trackItemSizes:Fd,itemSize:yc}},ii(Go,yu),{singleton:!0}),NB="undefined"!=typeof document&&"scrollBehavior"in document.documentElement.style,Gr=oh(function(c){function k(){Fd&&(Fd(),Fd=null);id&&(id(),id=null);Xc&&(clearTimeout(Xc),Xc=null);bb(0,!1)}var J=c[0],da=J.sizes,qa=J.totalCount,Ca=J.listRefresh;J=J.gap;var Ia=c[1],bb=Ia.scrollingInProgress,rb=Ia.viewportHeight,Pb=Ia.scrollTo,jc=Ia.smoothScrollTargetReached,yc=Ia.headerHeight,Rc=Ia.footerHeight,
jd=Ia.fixedHeaderHeight;Ia=Ia.fixedFooterHeight;c=c[2].log;var fd=Yg(),xd=fg(0),Fd=null,Xc=null,id=null;return Xg(Cf(fd,Hh(da,rb,qa,xd,yc,Rc,c),Hh(J,jd,Ia),wg(function(nd){var Gd=nd[0],wd=Gd[0],Ge=Gd[1],Je=Gd[2],ag=Gd[3],af=Gd[4],Sf=Gd[5],Bh=Gd[6],Tg=Gd[7],zg=nd[1];Gd=nd[2];nd=nd[3];var dh=Kl(wd),uf=dh.align,Af=dh.behavior,rf=dh.offset;--ag;dh=Zh(dh,Ge,ag);Sf=Hg(dh,Ge.offsetTree,zg)+Sf;"end"===uf?(Sf+=Gd+ud(Ge.sizeTree,dh)[1]-Je+nd,dh===ag&&(Sf+=Bh)):"center"===uf?Sf+=(Gd+ud(Ge.sizeTree,dh)[1]-Je+
nd)/2:Sf-=af;rf&&(Sf+=rf);var Zf=function(Lh){k();Lh?(Tg("retrying to scroll to",{location:wd},Bk.DEBUG),fd(0,wd)):Tg("list did not change, scroll successful",{},Bk.DEBUG)};if(k(),"smooth"===Af){var hh=!1;id=ti(Ca,function(Lh){hh=hh||Lh});Fd=tk(jc,function(){Zf(hh)})}else Fd=tk(Cf(Ca,function(Lh){var Oi=setTimeout(function(){Lh(!1)},150);return function(Vh){Vh&&(Lh(!0),clearTimeout(Oi))}}),Zf);Xc=setTimeout(function(){k()},1200);bb(0,!0);return Tg("scrolling from index to",{index:dh,top:Sf,behavior:Af},
Bk.DEBUG),{top:Sf,behavior:Af}})),Pb),{scrollToIndex:fd,topListHeight:xd}},ii(Vn,Cl,Go),{singleton:!0}),OB={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollTop:0,viewportHeight:0,scrollHeight:0}},Hr=oh(function(c){var k=c[0],J=k.scrollContainerState;c=k.scrollTop;var da=k.viewportHeight,qa=k.headerHeight,Ca=k.footerHeight,Ia=k.scrollBy;k=fg(!1);var bb=fg(!0),rb=Yg(),Pb=Yg(),jc=fg(4),yc=fg(0),Rc=Li(Cf(xl(Cf(Qh(c),Tj(1),cj(!0)),Cf(Qh(c),Tj(1),cj(!1),cl(100))),Ch()),
!1),jd=Li(Cf(xl(Cf(Ia,cj(!0)),Cf(Ia,cj(!1),cl(200))),Ch()),!1);Xg(Cf(Gi(Qh(c),Qh(yc)),wg(function(fd){return fd[0]<=fd[1]}),Ch()),bb);Xg(Cf(bb,Lj(50)),Pb);da=Ri(Cf(Gi(J,Qh(da),Qh(qa),Qh(Ca),Qh(jc)),Fi(function(fd,xd){var Fd,Xc,id=xd[0],nd=id.scrollTop;id=id.scrollHeight;var Gd=xd[1],wd={viewportHeight:Gd,scrollTop:nd,scrollHeight:id};return nd+Gd-id>-xd[4]?(nd>fd.state.scrollTop?(Fd="SCROLLED_DOWN",Xc=fd.state.scrollTop-nd):(Fd="SIZE_DECREASED",Xc=fd.state.scrollTop-nd||fd.scrollTopDelta),{atBottom:!0,
state:wd,atBottomBecause:Fd,scrollTopDelta:Xc}):{atBottom:!1,notAtBottomBecause:wd.scrollHeight>fd.state.scrollHeight?"SIZE_INCREASED":Gd<fd.state.viewportHeight?"VIEWPORT_HEIGHT_DECREASING":nd<fd.state.scrollTop?"SCROLLING_UPWARDS":"NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",state:wd}},OB),Ch(function(fd,xd){return fd&&fd.atBottom===xd.atBottom})));qa=Li(Cf(J,Fi(function(fd,xd){var Fd=xd.scrollTop,Xc=xd.scrollHeight;xd=xd.viewportHeight;return 1.01>Math.abs(fd.scrollHeight-Xc)?{scrollTop:Fd,scrollHeight:Xc,
jump:0,changed:!1}:fd.scrollTop!==Fd&&1>Xc-(Fd+xd)?{scrollHeight:Xc,scrollTop:Fd,jump:fd.scrollTop-Fd,changed:!0}:{scrollHeight:Xc,scrollTop:Fd,jump:0,changed:!0}},{scrollHeight:0,jump:0,scrollTop:0,changed:!1}),xh(function(fd){return fd.changed}),wg(function(fd){return fd.jump})),0);Xg(Cf(da,wg(function(fd){return fd.atBottom})),k);Xg(Cf(k,Lj(50)),rb);Ca=fg("down");Xg(Cf(J,wg(function(fd){return fd.scrollTop}),Ch(),Fi(function(fd,xd){return jd(4)?{direction:fd.direction,prevScrollTop:xd}:{direction:xd<
fd.prevScrollTop?"up":"down",prevScrollTop:xd}},{direction:"down",prevScrollTop:0}),wg(function(fd){return fd.direction})),Ca);Xg(Cf(J,Lj(50),cj("none")),Ca);J=fg(0);return Xg(Cf(Rc,xh(function(fd){return!fd}),cj(0)),J),Xg(Cf(c,Lj(100),Hh(Rc),xh(function(fd){return!!fd[1]}),Fi(function(fd,xd){return[fd[1],xd[0]]},[0,0]),wg(function(fd){return fd[1]-fd[0]})),J),{isScrolling:Rc,isAtTop:bb,isAtBottom:k,atBottomState:da,atTopStateChange:Pb,atBottomStateChange:rb,scrollDirection:Ca,atBottomThreshold:jc,
atTopThreshold:yc,scrollVelocity:J,lastJumpDueToItemResize:qa}},ii(Cl)),Fp=oh(function(c){var k=c[0].log;c=fg(!1);var J=Ri(Cf(c,xh(function(da){return da}),Ch()));return ti(c,function(da){da&&k(4)("props updated",{},Bk.DEBUG)}),{propsReady:c,didMount:J}},ii(Go),{singleton:!0}),zu=oh(function(c){var k=c[0],J=k.sizes,da=k.listRefresh;k=k.defaultItemSize;var qa=c[1].scrollTop,Ca=c[2].scrollToIndex;c=c[3].didMount;var Ia=fg(!0),bb=fg(0);return Xg(Cf(c,Hh(bb),xh(function(rb){return!!rb[1]}),cj(!1)),Ia),
ti(Cf(Gi(da,c),Hh(Ia,J,k),xh(function(rb){var Pb=rb[1],jc=rb[3];return rb[0][1]&&(rb[2].sizeTree!==Ni||void 0!==jc)&&!Pb}),Hh(bb)),function(rb){var Pb=rb[1];setTimeout(function(){tk(qa,function(){Ia(0,!0)});Ca(0,Pb)})}),{scrolledToInitialItem:Ia,initialTopMostItemIndex:bb}},ii(Vn,Cl,Gr,Fp),{singleton:!0}),PB=oh(function(c){function k(xd){rb(0,{index:"LAST",align:"end",behavior:xd})}function J(xd){var Fd=tk(bb,function(Xc){!xd||Xc.atBottom||"SIZE_INCREASED"!==Xc.notAtBottomBecause||fd||(yc(4)("scrolling to bottom due to increased size",
{},Bk.DEBUG),k("auto"))});setTimeout(Fd,100)}var da=c[0],qa=da.totalCount,Ca=da.listRefresh,Ia=c[1];da=Ia.isAtBottom;var bb=Ia.atBottomState,rb=c[2].scrollToIndex;Ia=c[3].scrolledToInitialItem;var Pb=c[4],jc=Pb.propsReady;Pb=Pb.didMount;var yc=c[5].log;c=c[6].scrollingInProgress;var Rc=fg(!1),jd=Yg(),fd=null;return ti(Cf(Gi(Cf(Qh(qa),Tj(1)),Pb),Hh(Qh(Rc),da,Ia,c),wg(function(xd){var Fd=xd[0],Xc=Fd[0];Fd=Fd[1]&&xd[3];var id="auto";Fd&&(id=xd[1],xd=xd[2]||xd[4],id="function"==typeof id?Ok(id(xd)):xd&&
Ok(id),Fd=Fd&&!!id);return{totalCount:Xc,shouldFollow:Fd,followOutputBehavior:id}}),xh(function(xd){return xd.shouldFollow})),function(xd){var Fd=xd.totalCount,Xc=xd.followOutputBehavior;fd&&(fd(),fd=null);fd=tk(Ca,function(){yc(4)("following output to ",{totalCount:Fd},Bk.DEBUG);k(Xc);fd=null})}),ti(Cf(Gi(Qh(Rc),qa,jc),xh(function(xd){return xd[0]&&xd[2]}),Fi(function(xd,Fd){Fd=Fd[1];return{refreshed:xd.value===Fd,value:Fd}},{refreshed:!1,value:0}),xh(function(xd){return xd.refreshed}),Hh(Rc,qa)),
function(xd){J(!1!==xd[1])}),ti(jd,function(){J(!1!==Rc(4))}),ti(Gi(Qh(Rc),bb),function(xd){var Fd=xd[1];xd[0]&&!Fd.atBottom&&"VIEWPORT_HEIGHT_DECREASING"===Fd.notAtBottomBecause&&k("auto")}),{followOutput:Rc,autoscrollToBottom:jd}},ii(Vn,Hr,Gr,zu,Fp,Go,Cl)),Ux=oh(function(c){var k=c[0],J=k.totalCount,da=k.groupIndices;k=k.sizes;var qa=c[1];c=qa.scrollTop;qa=qa.headerHeight;var Ca=Yg(),Ia=Yg(),bb=Ri(Cf(Ca,wg(Zm)));return Xg(Cf(bb,wg(function(rb){return rb.totalCount})),J),Xg(Cf(bb,wg(function(rb){return rb.groupIndices})),
da),Xg(Cf(Gi(c,k,qa),xh(function(rb){return rb[1].groupOffsetTree!==Ni}),wg(function(rb){return ud(rb[1].groupOffsetTree,Math.max(rb[0]-rb[2],0),"v")[0]}),Ch(),wg(function(rb){return[rb]})),Ia),{groupCounts:Ca,topItemsIndexes:Ia}},ii(Vn,Cl)),Au=oh(function(c){var k=c[0];c=k.scrollTop;var J=k.viewportHeight,da=k.deviation,qa=k.headerHeight,Ca=k.fixedHeaderHeight;k=Yg();var Ia=fg(0),bb=fg(0),rb=fg(0);c=Li(Cf(Gi(Qh(c),Qh(J),Qh(qa),Qh(k,ak),Qh(rb),Qh(Ia),Qh(Ca),Qh(da),Qh(bb)),wg(function(Pb){var jc=Pb[0],
yc=Pb[1],Rc=Pb[2],jd=Pb[3],fd=jd[0];jd=jd[1];var xd=Pb[4],Fd=Pb[6],Xc=Pb[7],id=Pb[8],nd=jc-Xc;Pb=Pb[5]+Fd;var Gd=Math.max(Rc-nd,0),wd="none",Ge="number"==typeof id?id:id.top||0;id="number"==typeof id?id:id.bottom||0;return fd-=Xc,jd+=Rc+Fd,fd+(Rc+Fd)>jc+Pb-Ge&&(wd="up"),jd-Xc<jc-Gd+yc+id&&(wd="down"),"none"!==wd?[Math.max(nd-Rc-Bn(xd,"top",wd)-Ge,0),nd-Gd-Fd+yc+Bn(xd,"bottom",wd)+id]:null}),xh(function(Pb){return null!=Pb}),Ch(ak)),[0,0]);return{listBoundary:k,overscan:rb,topListHeight:Ia,increaseViewportBy:bb,
visibleRange:c}},ii(Cl),{singleton:!0}),Vx={items:[],topItems:[],offsetTop:0,offsetBottom:0,top:0,bottom:0,topListHeight:0,totalCount:0,firstItemIndex:0},Aq=oh(function(c){var k=c[0],J=k.sizes,da=k.totalCount,qa=k.data,Ca=k.firstItemIndex,Ia=k.gap,bb=c[1],rb=c[2],Pb=rb.visibleRange;k=rb.listBoundary;rb=rb.topListHeight;var jc=c[3],yc=jc.scrolledToInitialItem,Rc=jc.initialTopMostItemIndex;jc=c[4].topListHeight;var jd=c[5],fd=c[6].didMount,xd=c[7].recalcInProgress;c=fg([]);var Fd=Yg();Xg(bb.topItemsIndexes,
c);J=Li(Cf(Gi(fd,xd,Qh(Pb,ak),Qh(da),Qh(J),Qh(Rc),yc,Qh(c),Qh(Ca),Qh(Ia),qa),xh(function(Xc){return Xc[0]&&!Xc[1]}),wg(function(Xc){var id=Xc[2],nd=id[0],Gd=id[1];id=Xc[3];var wd=Xc[5],Ge=Xc[6],Je=Xc[7],ag=Xc[8],af=Xc[9],Sf=Xc[10];Xc=Xc[4];var Bh=Xc.sizeTree,Tg=Xc.offsetTree;if(0===id||0===nd&&0===Gd)return Ga({},Vx,{totalCount:id});if(Bh===Ni)return Ll(function(Vh,ih,oj){return ih.groupOffsetTree!==Ni?(Vh=uj(Vh,ih),[{index:ud(ih.groupOffsetTree,Vh)[0],size:0,offset:0},{index:Vh,size:0,offset:0,data:oj&&
oj[0]}]):[{index:Vh,size:0,offset:0,data:oj&&oj[0]}]}("number"==typeof wd?wd:"LAST"===wd.index?id-1:wd.index,Xc,Sf),[],id,af,Xc,ag);wd=[];if(0<Je.length){var zg,dh=Je[0],uf=Je[Je.length-1],Af=0;for(Bh=Mb(bg(Bh,dh,uf));!(zg=Bh()).done;){var rf=zg.value;zg=rf.value;var Zf=Math.min(rf.end,uf);for(rf=Math.max(rf.start,dh);rf<=Zf;rf++)wd.push({index:rf,size:zg,offset:Af,data:Sf&&Sf[rf]}),Af+=zg}}if(!Ge)return Ll([],wd,id,af,Xc,ag);var hh=0<Je.length?Je[Je.length-1]+1:0,Lh=function(Vh,ih,oj,Jj){return void 0===
Jj&&(Jj=0),0<Jj&&(ih=Math.max(ih,Vh[Rg(Vh,Jj,Lf)].offset)),og(($l=oj,lf=Rg(qk=Vh,ih,Zn=Rh),rg=Rg(qk,$l,Zn,lf),qk.slice(lf,rg+1)),Sh);var qk,$l,Zn,lf,rg}(Tg,nd,Gd,hh);if(0===Lh.length)return null;var Oi=id-1;return Ll(lk([],function(Vh){for(var ih,oj=Mb(Lh);!(ih=oj()).done;){var Jj=ih.value,qk=Jj.value;ih=qk.offset;var $l=Jj.start,Zn=qk.size;qk.offset<nd&&(qk=($l+=Math.floor((nd-qk.offset+af)/(Zn+af)))-Jj.start,ih+=qk*Zn+qk*af);$l<hh&&(ih+=(hh-$l)*Zn,$l=hh);for(Jj=Math.min(Jj.end,Oi);$l<=Jj&&!(ih>=
Gd);$l++)Vh.push({index:$l,size:Zn,offset:ih,data:Sf&&Sf[$l]}),ih+=Zn+af}}),wd,id,af,Xc,ag)}),xh(function(Xc){return null!==Xc}),Ch()),Vx);return Xg(Cf(qa,xh(function(Xc){return void 0!==Xc}),wg(function(Xc){return Xc.length})),da),Xg(Cf(J,wg(function(Xc){return Xc.topListHeight})),jc),Xg(jc,rb),Xg(Cf(J,wg(function(Xc){return[Xc.top,Xc.bottom]})),k),Xg(Cf(J,wg(function(Xc){return Xc.items})),Fd),Ga({listState:J,topItemsIndexes:c,endReached:Ri(Cf(J,xh(function(Xc){return 0<Xc.items.length}),Hh(da,
qa),xh(function(Xc){var id=Xc[0].items;return id[id.length-1].originalIndex===Xc[1]-1}),wg(function(Xc){return[Xc[1]-1,Xc[2]]}),Ch(ak),wg(function(Xc){return Xc[0]}))),startReached:Ri(Cf(J,Lj(200),xh(function(Xc){var id=Xc.items;return 0<id.length&&id[0].originalIndex===Xc.topItems.length}),wg(function(Xc){return Xc.items[0].index}),Ch())),rangeChanged:Ri(Cf(J,xh(function(Xc){return 0<Xc.items.length}),wg(function(Xc){Xc=Xc.items;for(var id=0,nd=Xc.length-1;"group"===Xc[id].type&&id<nd;)id++;for(;"group"===
Xc[nd].type&&nd>id;)nd--;return{startIndex:Xc[id].index,endIndex:Xc[nd].index}}),Ch(pj))),itemsRendered:Fd},jd)},ii(Vn,Ux,Au,zu,Gr,Hr,Fp,yu),{singleton:!0}),QB=oh(function(c){var k=c[0],J=k.sizes,da=k.firstItemIndex,qa=k.data;k=k.gap;var Ca=c[1].listState;c=c[2].didMount;var Ia=fg(0);return Xg(Cf(c,Hh(Ia),xh(function(bb){return 0!==bb[1]}),Hh(J,da,k,qa),wg(function(bb){var rb=bb[0][1],Pb=bb[1],jc=bb[2],yc=bb[3];bb=bb[4];var Rc=void 0===bb?[]:bb;bb=0;if(0<Pb.groupIndices.length)for(var jd,fd=Mb(Pb.groupIndices);!((jd=
fd()).done||jd.value-bb>=rb);)bb++;rb+=bb;return Ll(Array.from({length:rb}).map(function(xd,Fd){return{index:Fd,size:0,offset:0,data:Rc[Fd]}}),[],rb,yc,Pb,jc)})),Ca),{initialItemCount:Ia}},ii(Vn,Aq,Fp),{singleton:!0}),Wx=oh(function(c){c=c[0].scrollVelocity;var k=fg(!1),J=Yg(),da=fg(!1);return Xg(Cf(c,Hh(da,k,J),xh(function(qa){return!!qa[1]}),wg(function(qa){var Ca=qa[0],Ia=qa[1],bb=qa[2];qa=qa[3];var rb=Ia.enter;if(bb){if((0,Ia.exit)(Ca,qa))return!1}else if(rb(Ca,qa))return!0;return bb}),Ch()),
k),ti(Cf(Gi(k,c,J),Hh(da)),function(qa){var Ca=qa[0];qa=qa[1];return Ca[0]&&qa&&qa.change&&qa.change(Ca[1],Ca[2])}),{isSeeking:k,scrollSeekConfiguration:da,scrollVelocity:c,scrollSeekRangeChanged:J}},ii(Hr),{singleton:!0}),RB=oh(function(c){c=c[0].topItemsIndexes;var k=fg(0);return Xg(Cf(k,xh(function(J){return 0<J}),wg(function(J){return Array.from({length:J}).map(function(da,qa){return qa})})),c),{topItemCount:k}},ii(Aq)),Bu=oh(function(c){var k=c[0],J=k.footerHeight,da=k.headerHeight,qa=k.fixedHeaderHeight;
k=k.fixedFooterHeight;var Ca=c[1].listState;c=Yg();J=Li(Cf(Gi(J,k,da,qa,Ca),wg(function(Ia){var bb=Ia[4];return Ia[0]+Ia[1]+Ia[2]+Ia[3]+bb.offsetBottom+bb.bottom})),0);return Xg(Qh(J),c),{totalListHeight:J,totalListHeightChanged:c}},ii(Cl,Aq),{singleton:!0}),SB=ol(function(){return/iP(ad|hone|od).+Version\/[\d.]+.*Safari/i.test(navigator.userAgent)}),TB=oh(function(c){function k(Fd){0<Fd?(da(0,{top:-Fd,behavior:"auto"}),Ca(0,0)):(Ca(0,0),da(0,{top:-Fd,behavior:"auto"}))}var J=c[0],da=J.scrollBy,qa=
J.scrollTop,Ca=J.deviation,Ia=J.scrollingInProgress,bb=c[1];J=bb.isScrolling;var rb=bb.isAtBottom,Pb=bb.scrollDirection,jc=c[3],yc=jc.beforeUnshiftWith,Rc=jc.shiftWithOffset,jd=jc.sizes;jc=jc.gap;var fd=c[4].log,xd=c[5].recalcInProgress;c=Ri(Cf(c[2].listState,Hh(bb.lastJumpDueToItemResize),Fi(function(Fd,Xc){var id=Fd[1],nd=Xc[0],Gd=nd.items,wd=nd.totalCount;nd=nd.bottom+nd.offsetBottom;var Ge=0;return Fd[2]===wd&&0<id.length&&0<Gd.length&&(0===Gd[0].originalIndex&&0===id[0].originalIndex||0!=(Ge=
nd-Fd[3])&&(Ge+=Xc[1])),[Ge,Gd,wd,nd]},[0,[],0,0]),xh(function(Fd){return 0!==Fd[0]}),Hh(qa,Pb,Ia,rb,fd),xh(function(Fd){return!Fd[3]&&0!==Fd[1]&&"up"===Fd[2]}),wg(function(Fd){var Xc=Fd[0][0];return(0,Fd[5])("Upward scrolling compensation",{amount:Xc},Bk.DEBUG),Xc})));return ti(Cf(c,Hh(Ca,J)),function(Fd){var Xc=Fd[0],id=Fd[1];Fd[2]&&SB()?Ca(0,id-Xc):k(-Xc)}),ti(Cf(Gi(Li(J,!1),Ca,xd),xh(function(Fd){return!Fd[0]&&!Fd[2]&&0!==Fd[1]}),wg(function(Fd){return Fd[1]}),Lj(1)),k),Xg(Cf(Rc,wg(function(Fd){return{top:-Fd}})),
da),ti(Cf(yc,Hh(jd,jc),wg(function(Fd){var Xc=Fd[0];return Xc*Fd[1].lastSize+Xc*Fd[2]})),function(Fd){Ca(0,Fd);requestAnimationFrame(function(){jl(da,{top:Fd});requestAnimationFrame(function(){Ca(0,0);xd(0,!1)})})}),{deviation:Ca}},ii(Cl,Hr,Aq,Vn,Go,yu)),UB=oh(function(c){var k=c[0].totalListHeight,J=c[1].didMount,da=c[2].scrollTo;c=fg(0);return ti(Cf(J,Hh(c),xh(function(qa){return 0!==qa[1]}),wg(function(qa){return{top:qa[1]}})),function(qa){tk(Cf(k,xh(function(Ca){return 0!==Ca})),function(){setTimeout(function(){da(0,
qa)})})}),{initialScrollTop:c}},ii(Bu,Fp,Cl),{singleton:!0}),VB=oh(function(c){var k=c[0].viewportHeight;c=c[1].totalListHeight;var J=fg(!1);return{alignToBottom:J,paddingTopAddition:Li(Cf(Gi(J,k,c),xh(function(da){return da[0]}),wg(function(da){return Math.max(0,da[1]-da[2])}),Ch()),0)}},ii(Cl,Bu),{singleton:!0}),Xx=oh(function(c){var k=c[0];c=k.scrollTo;k=k.scrollContainerState;var J=Yg(),da=Yg(),qa=Yg(),Ca=fg(!1),Ia=fg(void 0);return Xg(Cf(Gi(J,da),wg(function(bb){var rb=bb[0];return{scrollTop:Math.max(0,
rb.scrollTop-bb[1].offsetTop),scrollHeight:rb.scrollHeight,viewportHeight:rb.viewportHeight}})),k),Xg(Cf(c,Hh(da),wg(function(bb){var rb=bb[0];return Ga({},rb,{top:rb.top+bb[1].offsetTop})})),qa),{useWindowScroll:Ca,customScrollParent:Ia,windowScrollContainerState:J,windowViewportRect:da,windowScrollTo:qa}},ii(Cl)),WB=["done","behavior","align"],XB=oh(function(c){var k=c[0],J=k.sizes,da=k.totalCount;k=k.gap;var qa=c[1],Ca=qa.scrollTop,Ia=qa.viewportHeight,bb=qa.headerHeight,rb=qa.fixedHeaderHeight,
Pb=qa.fixedFooterHeight,jc=qa.scrollingInProgress;c=c[2].scrollToIndex;qa=Yg();return Xg(Cf(qa,Hh(J,Ia,da,bb,rb,Pb,Ca),Hh(k),wg(function(yc){var Rc=yc[0],jd=Rc[0],fd=Rc[1],xd=Rc[2],Fd=Rc[3],Xc=Rc[4],id=Rc[5],nd=Rc[6];Rc=Rc[7];var Gd=yc[1];yc=jd.done;var wd=jd.behavior,Ge=jd.align,Je=sc(jd,WB),ag=null;jd=Zh(jd,fd,Fd-1);Xc=Hg(jd,fd.offsetTree,Gd)+Xc+id;return Xc<Rc+id?ag=Ga({},Je,{behavior:wd,align:null!=Ge?Ge:"start"}):Xc+ud(fd.sizeTree,jd)[1]>Rc+xd-nd&&(ag=Ga({},Je,{behavior:wd,align:null!=Ge?Ge:
"end"})),ag?yc&&tk(Cf(jc,Tj(1),xh(function(af){return!1===af})),yc):yc&&yc(),ag}),xh(function(yc){return null!==yc})),c),{scrollIntoView:qa}},ii(Vn,Cl,Gr,Aq,Go),{singleton:!0}),YB=["listState","topItemsIndexes"],ZB=oh(function(c){return Ga({},c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8])},ii(Au,QB,Fp,Wx,Bu,UB,VB,Xx,XB)),Yx=oh(function(c){var k=c[0],J=k.totalCount,da=k.sizeRanges,qa=k.fixedItemSize,Ca=k.defaultItemSize,Ia=k.trackItemSizes,bb=k.itemSize,rb=k.data,Pb=k.firstItemIndex,jc=k.groupIndices,
yc=k.statefulTotalCount;k=k.gap;var Rc=c[1],jd=Rc.initialTopMostItemIndex;Rc=Rc.scrolledToInitialItem;var fd=c[2],xd=c[3],Fd=c[4],Xc=Fd.listState,id=Fd.topItemsIndexes;Fd=sc(Fd,YB);var nd=c[5].scrollToIndex,Gd=c[7].topItemCount,wd=c[8].groupCounts,Ge=c[9];c=c[10];return Xg(Fd.rangeChanged,Ge.scrollSeekRangeChanged),Xg(Cf(Ge.windowViewportRect,wg(function(Je){return Je.visibleHeight})),fd.viewportHeight),Ga({totalCount:J,data:rb,firstItemIndex:Pb,sizeRanges:da,initialTopMostItemIndex:jd,scrolledToInitialItem:Rc,
topItemsIndexes:id,topItemCount:Gd,groupCounts:wd,fixedItemHeight:qa,defaultItemHeight:Ca,gap:k},xd,{statefulTotalCount:yc,listState:Xc,scrollToIndex:nd,trackItemSizes:Ia,itemSize:bb,groupIndices:jc},Fd,Ge,fd,c)},ii(Vn,zu,Cl,PB,Aq,Gr,TB,RB,Ux,ZB,Go)),Zx=ol(function(){if("undefined"==typeof document)return"sticky";var c=document.createElement("div");return c.style.position="-webkit-sticky","-webkit-sticky"===c.style.position?"-webkit-sticky":"sticky"}),Ls=yh.createContext(void 0),$x=yh.createContext(void 0),
$B=["placeholder"],aC=["style","children"],bC=["style","children"],cC=oh(function(){var c=fg(function(rb){return"Item "+rb}),k=fg(null),J=fg(function(rb){return"Group "+rb}),da=fg({}),qa=fg(gk),Ca=fg("div"),Ia=fg(fi),bb=function(rb,Pb){return void 0===Pb&&(Pb=null),Li(Cf(da,wg(function(jc){return jc[rb]}),Ch()),Pb)};return{context:k,itemContent:c,groupContent:J,components:da,computeItemKey:qa,headerFooterTag:Ca,scrollerRef:Ia,FooterComponent:bb("Footer"),HeaderComponent:bb("Header"),TopItemListComponent:bb("TopItemList"),
ListComponent:bb("List","div"),ItemComponent:bb("Item","div"),GroupComponent:bb("Group","div"),ScrollerComponent:bb("Scroller","div"),EmptyPlaceholder:bb("EmptyPlaceholder"),ScrollSeekPlaceholder:bb("ScrollSeekPlaceholder")}}),dC=oh(function(c){function k(qa,Ca,Ia){Xg(Cf(qa,Hh(da.components),wg(function(bb){var rb,Pb=bb[0];bb=bb[1];return console.warn("react-virtuoso: "+Ia+" property is deprecated. Pass components."+Ca+" instead."),Ga({},bb,((rb={})[Ca]=Pb,rb))})),da.components)}var J=c[0],da=c[1];
c={item:$m(da.itemContent,"Rename the %citem%c prop to %citemContent."),group:$m(da.groupContent,"Rename the %cgroup%c prop to %cgroupContent."),topItems:$m(J.topItemCount,"Rename the %ctopItems%c prop to %ctopItemCount."),itemHeight:$m(J.fixedItemHeight,"Rename the %citemHeight%c prop to %cfixedItemHeight."),scrollingStateChange:$m(J.isScrolling,"Rename the %cscrollingStateChange%c prop to %cisScrolling."),adjustForPrependedItems:Yg(),maxHeightCacheSize:Yg(),footer:Yg(),header:Yg(),HeaderContainer:Yg(),
FooterContainer:Yg(),ItemContainer:Yg(),ScrollContainer:Yg(),GroupContainer:Yg(),ListContainer:Yg(),emptyComponent:Yg(),scrollSeek:Yg()};return ti(c.adjustForPrependedItems,function(){console.warn("react-virtuoso: adjustForPrependedItems is no longer supported. Use the firstItemIndex property instead - https://virtuoso.dev/prepend-items.","color: red;","color: inherit;","color: blue;")}),ti(c.maxHeightCacheSize,function(){console.warn("react-virtuoso: maxHeightCacheSize is no longer necessary. Setting it has no effect - remove it from your code.")}),
ti(c.HeaderContainer,function(){console.warn("react-virtuoso: HeaderContainer is deprecated. Use headerFooterTag if you want to change the wrapper of the header component and pass components.Header to change its contents.")}),ti(c.FooterContainer,function(){console.warn("react-virtuoso: FooterContainer is deprecated. Use headerFooterTag if you want to change the wrapper of the footer component and pass components.Footer to change its contents.")}),ti(c.scrollSeek,function(qa){var Ca=qa.placeholder;
qa=sc(qa,$B);console.warn("react-virtuoso: scrollSeek property is deprecated. Pass scrollSeekConfiguration and specify the placeholder in components.ScrollSeekPlaceholder instead.");Ca=Ga({},(0,da.components)(4),{ScrollSeekPlaceholder:Ca});(0,da.components)(0,Ca);(0,J.scrollSeekConfiguration)(0,qa)}),k(c.footer,"Footer","footer"),k(c.header,"Header","header"),k(c.ItemContainer,"Item","ItemContainer"),k(c.ListContainer,"List","ListContainer"),k(c.ScrollContainer,"Scroller","ScrollContainer"),k(c.emptyComponent,
"EmptyPlaceholder","emptyComponent"),k(c.GroupContainer,"Group","GroupContainer"),Ga({},J,da,c)},ii(Yx,cC)),eC=function(c){return yh.createElement("div",{style:{height:c.height}})},fC={position:Zx(),zIndex:1,overflowAnchor:"none"},gC={overflowAnchor:"none"},ay=yh.memo(function(c){c=c.showTopList;c=void 0!==c&&c;var k=Zi("listState"),J=um("sizeRanges"),da=Zi("useWindowScroll"),qa=Zi("customScrollParent"),Ca=um("windowScrollContainerState"),Ia=um("scrollContainerState");da=qa||da?Ca:Ia;var bb=Zi("itemContent"),
rb=Zi("context"),Pb=Zi("groupContent");Ca=Zi("trackItemSizes");Ia=Zi("itemSize");var jc=Zi("log"),yc=um("gap");J=Sb(J,Ia,Ca,c?fi:da,jc,yc,qa).callbackRef;qa=yh.useState(0);var Rc=qa[0],jd=qa[1];Cu("deviation",function(Gd){Rc!==Gd&&jd(Gd)});qa=Zi("EmptyPlaceholder");var fd=Zi("ScrollSeekPlaceholder")||eC;da=Zi("ListComponent");var xd=Zi("ItemComponent"),Fd=Zi("GroupComponent"),Xc=Zi("computeItemKey"),id=Zi("isSeeking"),nd=0<Zi("groupIndices").length;Ca=Zi("paddingTopAddition");Ca=c?{}:{boxSizing:"border-box",
paddingTop:k.offsetTop+Ca,paddingBottom:k.offsetBottom,marginTop:Rc};return!c&&0===k.totalCount&&qa?(0,gi.createElement)(qa,Ki(qa,rb)):(0,gi.createElement)(da,Ga({},Ki(da,rb),{ref:J,style:Ca,"data-test-id":c?"virtuoso-top-item-list":"virtuoso-item-list"}),(c?k.topItems:k.items).map(function(Gd){var wd=Gd.originalIndex,Ge=Xc(wd+k.firstItemIndex,Gd.data,rb);return id?(0,gi.createElement)(fd,Ga({},Ki(fd,rb),{key:Ge,index:Gd.index,height:Gd.size,type:Gd.type||"item"},"group"===Gd.type?{}:{groupIndex:Gd.groupIndex})):
"group"===Gd.type?(0,gi.createElement)(Fd,Ga({},Ki(Fd,rb),{key:Ge,"data-index":wd,"data-known-size":Gd.size,"data-item-index":Gd.index,style:fC}),Pb(Gd.index)):(0,gi.createElement)(xd,Ga({},Ki(xd,rb),{key:Ge,"data-index":wd,"data-known-size":Gd.size,"data-item-index":Gd.index,"data-item-group-index":Gd.groupIndex,style:gC}),nd?bb(Gd.index,Gd.groupIndex,Gd.data,rb):bb(Gd.index,Gd.data,rb))}))}),hC={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},Bq=
{width:"100%",height:"100%",position:"absolute",top:0},iC={width:"100%",position:Zx(),top:0},jC=yh.memo(function(){var c=Zi("HeaderComponent"),k=um("headerHeight"),J=Zi("headerFooterTag"),da=fc(function(Ca){return k(Qb(Ca,"height"))}),qa=Zi("context");return c?(0,gi.createElement)(J,{ref:da},(0,gi.createElement)(c,Ki(c,qa))):null}),kC=yh.memo(function(){var c=Zi("FooterComponent"),k=um("footerHeight"),J=Zi("headerFooterTag"),da=fc(function(Ca){return k(Qb(Ca,"height"))}),qa=Zi("context");return c?
(0,gi.createElement)(J,{ref:da},(0,gi.createElement)(c,Ki(c,qa))):null}),lC=function(c){c=c.children;var k=(0,gi.useContext)(Ls),J=um("viewportHeight"),da=um("fixedItemHeight"),qa=fc(kk(J,function(Ca){return Qb(Ca,"height")}));return yh.useEffect(function(){k&&(J(k.viewportHeight),da(k.itemHeight))},[k,J,da]),yh.createElement("div",{style:Bq,ref:qa,"data-viewport-type":"element"},c)},mC=function(c){c=c.children;var k=(0,gi.useContext)(Ls),J=um("windowViewportRect"),da=um("fixedItemHeight"),qa=Zi("customScrollParent");
qa=Pi(J,qa);return yh.useEffect(function(){k&&(da(k.itemHeight),J({offsetTop:0,visibleHeight:k.viewportHeight,visibleWidth:100}))},[k,J,da]),yh.createElement("div",{ref:qa,style:Bq,"data-viewport-type":"window"},c)},nC=function(c){c=c.children;var k=Zi("TopItemListComponent"),J=Zi("headerHeight");J=Ga({},iC,{marginTop:J+"px"});var da=Zi("context");return(0,gi.createElement)(k||"div",{style:J,context:da},c)},Ms=mc(dC,{required:{},optional:{context:"context",followOutput:"followOutput",firstItemIndex:"firstItemIndex",
itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",topItemCount:"topItemCount",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",groupCounts:"groupCounts",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",
headerFooterTag:"headerFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",react18ConcurrentRendering:"react18ConcurrentRendering",item:"item",group:"group",topItems:"topItems",itemHeight:"itemHeight",scrollingStateChange:"scrollingStateChange",maxHeightCacheSize:"maxHeightCacheSize",footer:"footer",header:"header",
ItemContainer:"ItemContainer",ScrollContainer:"ScrollContainer",ListContainer:"ListContainer",GroupContainer:"GroupContainer",emptyComponent:"emptyComponent",HeaderContainer:"HeaderContainer",FooterContainer:"FooterContainer",scrollSeek:"scrollSeek"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",adjustForPrependedItems:"adjustForPrependedItems",autoscrollToBottom:"autoscrollToBottom"},events:{isScrolling:"isScrolling",endReached:"endReached",
startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},yh.memo(function(c){var k=Zi("useWindowScroll"),J=0<Zi("topItemsIndexes").length,da=Zi("customScrollParent"),qa=da||k?mC:lC;return yh.createElement(da||k?qC:pC,Ga({},c),yh.createElement(qa,null,yh.createElement(jC,null),yh.createElement(ay,null),yh.createElement(kC,
null)),J&&yh.createElement(nC,null,yh.createElement(ay,{showTopList:!0})))})),oC=Ms.Component,um=Ms.usePublisher,Zi=Ms.useEmitterValue,Cu=Ms.useEmitter,pC=kl({usePublisher:um,useEmitterValue:Zi,useEmitter:Cu}),qC=Ol({usePublisher:um,useEmitterValue:Zi,useEmitter:Cu}),by={items:[],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},rC={items:[{index:0}],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},cy=Math.round,dy=Math.ceil,Ns=Math.floor,Du=Math.min,Cq=Math.max,
sC=oh(function(c){var k=c[0],J=k.overscan,da=k.visibleRange,qa=k.listBoundary,Ca=c[1];k=Ca.scrollTop;var Ia=Ca.viewportHeight,bb=Ca.scrollBy,rb=Ca.scrollTo,Pb=Ca.smoothScrollTargetReached,jc=Ca.scrollContainerState,yc=Ca.footerHeight;Ca=Ca.headerHeight;var Rc=c[2],jd=c[3],fd=c[4],xd=fd.propsReady,Fd=fd.didMount,Xc=c[5];fd=Xc.windowViewportRect;var id=Xc.windowScrollTo,nd=Xc.useWindowScroll,Gd=Xc.customScrollParent;Xc=Xc.windowScrollContainerState;c=c[6];var wd=fg(0),Ge=fg(0),Je=fg(by),ag=fg({height:0,
width:0}),af=fg({height:0,width:0}),Sf=Yg(),Bh=Yg(),Tg=fg(0),zg=fg(void 0),dh=fg({row:0,column:0});Xg(Cf(Gi(Fd,Ge,zg),xh(function(uf){return 0!==uf[1]}),wg(function(uf){return{items:mm(0,uf[1]-1,uf[2]),top:0,bottom:0,offsetBottom:0,offsetTop:0,itemHeight:0,itemWidth:0}})),Je);Xg(Cf(Gi(Qh(wd),da,Qh(dh,tl),Qh(af,function(uf,Af){return uf&&uf.width===Af.width&&uf.height===Af.height}),zg),Hh(ag),wg(function(uf){var Af=uf[0],rf=Af[0],Zf=Af[1],hh=Zf[0],Lh=Zf[1],Oi=Af[2],Vh=Af[3],ih=Af[4],oj=uf[1];uf=Oi.row;
var Jj=Oi.column;Af=Vh.height;Zf=Vh.width;var qk=oj.width;if(0===rf||0===qk)return by;if(0===Zf)return Ga({},rC,{items:mm(0,0,ih)});Jj=Cq(1,Ns((qk+Jj)/(Zf+Jj)));hh=Jj*Ns((hh+uf)/(Af+uf));Lh=Jj*dy((Lh+uf)/(Af+uf))-1;Lh=Du(rf-1,Cq(Lh,Jj-1));hh=mm(Du(Lh,Cq(0,hh)),Lh,ih);Vh=wi(oj,Oi,Vh,hh);Oi=Vh.top;Vh=Vh.bottom;rf=dy(rf/Jj);return{items:hh,offsetTop:Oi,offsetBottom:rf*Af+(rf-1)*uf-Vh,top:Oi,bottom:Vh,itemHeight:Af,itemWidth:Zf}})),Je);Xg(Cf(zg,xh(function(uf){return void 0!==uf}),wg(function(uf){return uf.length})),
wd);Xg(Cf(ag,wg(function(uf){return uf.height})),Ia);Xg(Cf(Gi(ag,af,Je,dh),wg(function(uf){uf=wi(uf[0],uf[3],uf[1],uf[2].items);return[uf.top,uf.bottom]}),Ch(ak)),qa);da=Ri(Cf(Qh(Je),xh(function(uf){return 0<uf.items.length}),Hh(wd),xh(function(uf){var Af=uf[0].items;return Af[Af.length-1].index===uf[1]-1}),wg(function(uf){return uf[1]-1}),Ch()));qa=Ri(Cf(Qh(Je),xh(function(uf){uf=uf.items;return 0<uf.length&&0===uf[0].index}),cj(0),Ch()));Ia=Ri(Cf(Qh(Je),xh(function(uf){return 0<uf.items.length}),
wg(function(uf){uf=uf.items;return{startIndex:uf[0].index,endIndex:uf[uf.length-1].index}}),Ch(pj)));Xg(Ia,jd.scrollSeekRangeChanged);Xg(Cf(Sf,Hh(ag,af,wd,dh),wg(function(uf){var Af=uf[1],rf=uf[2],Zf=uf[3],hh=uf[4],Lh=Kl(uf[0]);uf=Lh.align;var Oi=Lh.behavior,Vh=Lh.offset;Lh=Lh.index;"LAST"===Lh&&(Lh=Zf-1);Zf=Fm(Af,hh,rf,Cq(0,Lh,Du(Zf-1,Lh)));return"end"===uf?Zf=cy(Zf-Af.height+rf.height):"center"===uf&&(Zf=cy(Zf-Af.height/2+rf.height/2)),Vh&&(Zf+=Vh),{top:Zf,behavior:Oi}})),rb);Fd=Li(Cf(Je,wg(function(uf){return uf.offsetBottom+
uf.bottom})),0);return Xg(Cf(fd,wg(function(uf){return{width:uf.visibleWidth,height:uf.visibleHeight}})),ag),Ga({data:zg,totalCount:wd,viewportDimensions:ag,itemDimensions:af,scrollTop:k,scrollHeight:Bh,overscan:J,scrollBy:bb,scrollTo:rb,scrollToIndex:Sf,smoothScrollTargetReached:Pb,windowViewportRect:fd,windowScrollTo:id,useWindowScroll:nd,customScrollParent:Gd,windowScrollContainerState:Xc,deviation:Tg,scrollContainerState:jc,footerHeight:yc,headerHeight:Ca,initialItemCount:Ge,gap:dh},jd,{gridState:Je,
totalListHeight:Fd},Rc,{startReached:qa,endReached:da,rangeChanged:Ia,propsReady:xd},c)},ii(Au,Cl,Hr,Wx,Fp,Xx,Go)),tC=["placeholder"],uC=oh(function(){var c=fg(function(Pb){return"Item "+Pb}),k=fg({}),J=fg(null),da=fg("virtuoso-grid-item"),qa=fg("virtuoso-grid-list"),Ca=fg(gk),Ia=fg("div"),bb=fg(fi),rb=function(Pb,jc){return void 0===jc&&(jc=null),Li(Cf(k,wg(function(yc){return yc[Pb]}),Ch()),jc)};return{context:J,itemContent:c,components:k,computeItemKey:Ca,itemClassName:da,listClassName:qa,headerFooterTag:Ia,
scrollerRef:bb,FooterComponent:rb("Footer"),HeaderComponent:rb("Header"),ListComponent:rb("List","div"),ItemComponent:rb("Item","div"),ScrollerComponent:rb("Scroller","div"),ScrollSeekPlaceholder:rb("ScrollSeekPlaceholder","div")}}),vC=oh(function(c){function k(qa,Ca,Ia){Xg(Cf(qa,Hh(da.components),wg(function(bb){var rb,Pb=bb[0];bb=bb[1];return console.warn("react-virtuoso: "+Ia+" property is deprecated. Pass components."+Ca+" instead."),Ga({},bb,((rb={})[Ca]=Pb,rb))})),da.components)}var J=c[0],
da=c[1];c={item:$m(da.itemContent,"Rename the %citem%c prop to %citemContent."),ItemContainer:Yg(),ScrollContainer:Yg(),ListContainer:Yg(),emptyComponent:Yg(),scrollSeek:Yg()};return ti(c.scrollSeek,function(qa){var Ca=qa.placeholder;qa=sc(qa,tC);console.warn("react-virtuoso: scrollSeek property is deprecated. Pass scrollSeekConfiguration and specify the placeholder in components.ScrollSeekPlaceholder instead.");Ca=Ga({},(0,da.components)(4),{ScrollSeekPlaceholder:Ca});(0,da.components)(0,Ca);(0,J.scrollSeekConfiguration)(0,
qa)}),k(c.ItemContainer,"Item","ItemContainer"),k(c.ListContainer,"List","ListContainer"),k(c.ScrollContainer,"Scroller","ScrollContainer"),Ga({},J,da,c)},ii(sC,uC)),wC=yh.memo(function(){var c=Xj("gridState"),k=Xj("listClassName"),J=Xj("itemClassName"),da=Xj("itemContent"),qa=Xj("computeItemKey"),Ca=Xj("isSeeking"),Ia=Pm("scrollHeight"),bb=Xj("ItemComponent"),rb=Xj("ListComponent"),Pb=Xj("ScrollSeekPlaceholder"),jc=Xj("context"),yc=Pm("itemDimensions"),Rc=Pm("gap"),jd=Xj("log"),fd=fc(function(xd){Ia(xd.parentElement.parentElement.scrollHeight);
var Fd=xd.firstChild;Fd&&yc(Fd.getBoundingClientRect());Rc({row:rl("row-gap",getComputedStyle(xd).rowGap,jd),column:rl("column-gap",getComputedStyle(xd).columnGap,jd)})});return(0,gi.createElement)(rb,Ga({ref:fd,className:k},Ki(rb,jc),{style:{paddingTop:c.offsetTop,paddingBottom:c.offsetBottom}}),c.items.map(function(xd){var Fd=qa(xd.index,xd.data,jc);return Ca?(0,gi.createElement)(Pb,Ga({key:Fd},Ki(Pb,jc),{index:xd.index,height:c.itemHeight,width:c.itemWidth})):(0,gi.createElement)(bb,Ga({},Ki(bb,
jc),{className:J,"data-index":xd.index,key:Fd}),da(xd.index,xd.data,jc))}))}),xC=yh.memo(function(){var c=Xj("HeaderComponent"),k=Pm("headerHeight"),J=Xj("headerFooterTag"),da=fc(function(Ca){return k(Qb(Ca,"height"))}),qa=Xj("context");return c?(0,gi.createElement)(J,{ref:da},(0,gi.createElement)(c,Ki(c,qa))):null}),yC=yh.memo(function(){var c=Xj("FooterComponent"),k=Pm("footerHeight"),J=Xj("headerFooterTag"),da=fc(function(Ca){return k(Qb(Ca,"height"))}),qa=Xj("context");return c?(0,gi.createElement)(J,
{ref:da},(0,gi.createElement)(c,Ki(c,qa))):null}),zC=function(c){c=c.children;var k=(0,gi.useContext)($x),J=Pm("itemDimensions"),da=Pm("viewportDimensions"),qa=fc(function(Ca){da(Ca.getBoundingClientRect())});return yh.useEffect(function(){k&&(da({height:k.viewportHeight,width:k.viewportWidth}),J({height:k.itemHeight,width:k.itemWidth}))},[k,da,J]),yh.createElement("div",{style:Bq,ref:qa},c)},AC=function(c){c=c.children;var k=(0,gi.useContext)($x),J=Pm("windowViewportRect"),da=Pm("itemDimensions"),
qa=Xj("customScrollParent");qa=Pi(J,qa);return yh.useEffect(function(){k&&(da({height:k.itemHeight,width:k.itemWidth}),J({offsetTop:0,visibleHeight:k.viewportHeight,visibleWidth:k.viewportWidth}))},[k,J,da]),yh.createElement("div",{ref:qa,style:Bq},c)},Eu=mc(vC,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",
headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",item:"item",ItemContainer:"ItemContainer",ScrollContainer:"ScrollContainer",ListContainer:"ListContainer",scrollSeek:"scrollSeek"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",
atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange"}},yh.memo(function(c){c=Ga({},c);var k=Xj("useWindowScroll"),J=Xj("customScrollParent"),da=J||k?AC:zC;return yh.createElement(J||k?CC:BC,Ga({},c),yh.createElement(da,null,yh.createElement(xC,null),yh.createElement(wC,null),yh.createElement(yC,null)))})),Pm=Eu.usePublisher,Xj=Eu.useEmitterValue,ey=Eu.useEmitter,BC=kl({usePublisher:Pm,useEmitterValue:Xj,useEmitter:ey}),CC=Ol({usePublisher:Pm,useEmitterValue:Xj,useEmitter:ey}),
DC=oh(function(){var c=fg(function(rb){return yh.createElement("td",null,"Item $",rb)}),k=fg(null),J=fg(null),da=fg(null),qa=fg({}),Ca=fg(gk),Ia=fg(fi),bb=function(rb,Pb){return void 0===Pb&&(Pb=null),Li(Cf(qa,wg(function(jc){return jc[rb]}),Ch()),Pb)};return{context:k,itemContent:c,fixedHeaderContent:J,fixedFooterContent:da,components:qa,computeItemKey:Ca,scrollerRef:Ia,TableComponent:bb("Table","table"),TableHeadComponent:bb("TableHead","thead"),TableFooterComponent:bb("TableFoot","tfoot"),TableBodyComponent:bb("TableBody",
"tbody"),TableRowComponent:bb("TableRow","tr"),ScrollerComponent:bb("Scroller","div"),EmptyPlaceholder:bb("EmptyPlaceholder"),ScrollSeekPlaceholder:bb("ScrollSeekPlaceholder"),FillerRow:bb("FillerRow")}}),EC=oh(function(c){return Ga({},c[0],c[1])},ii(Yx,DC)),FC=function(c){return yh.createElement("tr",null,yh.createElement("td",{style:{height:c.height}}))},GC=function(c){return yh.createElement("tr",null,yh.createElement("td",{style:{height:c.height,padding:0,border:0}}))},HC=yh.memo(function(){var c=
ij("listState"),k=Qm("sizeRanges"),J=ij("useWindowScroll"),da=ij("customScrollParent"),qa=Qm("windowScrollContainerState"),Ca=Qm("scrollContainerState");J=da||J?qa:Ca;var Ia=ij("itemContent");qa=ij("trackItemSizes");da=Sb(k,ij("itemSize"),qa,J,ij("log"),void 0,da);k=da.callbackRef;var bb=da.ref;da=yh.useState(0);var rb=da[0],Pb=da[1];Gu("deviation",function(Xc){rb!==Xc&&(bb.current.style.marginTop=Xc+"px",Pb(Xc))});qa=ij("EmptyPlaceholder");var jc=ij("ScrollSeekPlaceholder")||FC;J=ij("FillerRow")||
GC;da=ij("TableBodyComponent");var yc=ij("TableRowComponent"),Rc=ij("computeItemKey"),jd=ij("isSeeking");Ca=ij("paddingTopAddition");var fd=ij("firstItemIndex"),xd=ij("statefulTotalCount"),Fd=ij("context");if(0===xd&&qa)return(0,gi.createElement)(qa,Ki(qa,Fd));qa=c.offsetTop+Ca+rb;Ca=c.offsetBottom;qa=0<qa?yh.createElement(J,{height:qa,key:"padding-top"}):null;J=0<Ca?yh.createElement(J,{height:Ca,key:"padding-bottom"}):null;c=c.items.map(function(Xc){var id=Xc.originalIndex,nd=Rc(id+fd,Xc.data,Fd);
return jd?(0,gi.createElement)(jc,Ga({},Ki(jc,Fd),{key:nd,index:Xc.index,height:Xc.size,type:Xc.type||"item"})):(0,gi.createElement)(yc,Ga({},Ki(yc,Fd),{key:nd,"data-index":id,"data-known-size":Xc.size,"data-item-index":Xc.index,style:{overflowAnchor:"none"}}),Ia(Xc.index,Xc.data,Fd))});return(0,gi.createElement)(da,Ga({ref:k,"data-test-id":"virtuoso-item-list"},Ki(da,Fd)),[qa].concat(c,[J]))}),IC=function(c){c=c.children;var k=(0,gi.useContext)(Ls),J=Qm("viewportHeight"),da=Qm("fixedItemHeight"),
qa=fc(kk(J,function(Ca){return Qb(Ca,"height")}));return yh.useEffect(function(){k&&(J(k.viewportHeight),da(k.itemHeight))},[k,J,da]),yh.createElement("div",{style:Bq,ref:qa,"data-viewport-type":"element"},c)},JC=function(c){c=c.children;var k=(0,gi.useContext)(Ls),J=Qm("windowViewportRect"),da=Qm("fixedItemHeight"),qa=ij("customScrollParent");qa=Pi(J,qa);return yh.useEffect(function(){k&&(da(k.itemHeight),J({offsetTop:0,visibleHeight:k.viewportHeight,visibleWidth:100}))},[k,J,da]),yh.createElement("div",
{ref:qa,style:Bq,"data-viewport-type":"window"},c)},Fu=mc(EC,{required:{},optional:{context:"context",followOutput:"followOutput",firstItemIndex:"firstItemIndex",itemContent:"itemContent",fixedHeaderContent:"fixedHeaderContent",fixedFooterContent:"fixedFooterContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",topItemCount:"topItemCount",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",groupCounts:"groupCounts",atBottomThreshold:"atBottomThreshold",
atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",react18ConcurrentRendering:"react18ConcurrentRendering"},methods:{scrollToIndex:"scrollToIndex",
scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},yh.memo(function(c){var k=ij("useWindowScroll"),J=ij("customScrollParent"),da=Qm("fixedHeaderHeight"),qa=Qm("fixedFooterHeight"),
Ca=ij("fixedHeaderContent"),Ia=ij("fixedFooterContent"),bb=ij("context");da=fc(kk(da,function(yc){return Qb(yc,"height")}));var rb=fc(kk(qa,function(yc){return Qb(yc,"height")}));qa=J||k?LC:KC;k=J||k?JC:IC;J=ij("TableComponent");var Pb=ij("TableHeadComponent"),jc=ij("TableFooterComponent");Ca=Ca?yh.createElement(Pb,Ga({key:"TableHead",style:{zIndex:1,position:"sticky",top:0},ref:da},Ki(Pb,bb)),Ca()):null;Ia=Ia?yh.createElement(jc,Ga({key:"TableFoot",style:{zIndex:1,position:"sticky",bottom:0},ref:rb},
Ki(jc,bb)),Ia()):null;return yh.createElement(qa,Ga({},c),yh.createElement(k,null,yh.createElement(J,Ga({style:{borderSpacing:0}},Ki(J,bb)),[Ca,yh.createElement(HC,{key:"TableBody"}),Ia])))})),Qm=Fu.usePublisher,ij=Fu.useEmitterValue,Gu=Fu.useEmitter,KC=kl({usePublisher:Qm,useEmitterValue:ij,useEmitter:Gu}),LC=Ol({usePublisher:Qm,useEmitterValue:ij,useEmitter:Gu}),fy=Uf(ca(22)),sn=function(c){function k(J){J=c.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+
J+" for more information.")||this;if(void 0===J)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return J}op(k,c);return k}(bn(Error)),gy={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",
crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",
firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",
lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",
midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",
salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},MC=/^#[a-fA-F0-9]{6}$/,NC=/^#[a-fA-F0-9]{8}$/,OC=/^#[a-fA-F0-9]{3}$/,PC=/^#[a-fA-F0-9]{4}$/,
Hu=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,QC=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,RC=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,SC=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,Iu=function(c){return 7===c.length&&c[1]===c[2]&&
c[3]===c[4]&&c[5]===c[6]?"#"+c[1]+c[3]+c[5]:c},TC=sl(In,In.length,[]),hy=ca(602),Rm=Uf(ca(22)),Xl=class{static insertTextFirefox(c,k){c.setRangeText(k,c.selectionStart||0,c.selectionEnd||0,"end");c.dispatchEvent(new InputEvent("input",{data:k,inputType:"insertText",isComposing:!1}))}static insert(c,k){const J=c.ownerDocument,da=J.activeElement;da!==c&&c.focus();J.execCommand("insertText",!1,k)||Xl.insertTextFirefox(c,k);da===J.body?c.blur():da instanceof HTMLElement&&da!==c&&da.focus()}static set(c,
k){c.select();Xl.insert(c,k)}static getSelection(c){const {selectionStart:k,selectionEnd:J}=c;return c.value.slice(k?k:void 0,J?J:void 0)}static wrapSelection(c,k,J){const {selectionStart:da,selectionEnd:qa}=c,Ca=Xl.getSelection(c);Xl.insert(c,k+Ca+(null!=J?J:k));c.selectionStart=(da||0)+k.length;c.selectionEnd=(qa||0)+k.length}static replace(c,k,J){let da=0;c.value.replace(k,(...qa)=>{const Ca=da+qa[qa.length-2],Ia=qa[0].length;c.selectionStart=Ca;c.selectionEnd=Ca+Ia;qa="string"===typeof J?J:J(...qa);
Xl.insert(c,qa);c.selectionStart=Ca;da+=qa.length-Ia;return qa})}static findLineEnd(c,k){const J=c.lastIndexOf("\n",k-1)+1;return"\t"!==c.charAt(J)?k:J+1}static indent(c){var k;const {selectionStart:J,selectionEnd:da,value:qa}=c;var Ca=qa.slice(J,da);if((Ca=null==(k=/\n/g.exec(Ca))?void 0:k.length)&&0<Ca){k=qa.lastIndexOf("\n",J-1)+1;var Ia=c.value.slice(k,da-1);Ca=Ia.replace(/^|\n/g,"$\x26  ");Ia=Ca.length-Ia.length;c.setSelectionRange(k,da-1);Xl.insert(c,Ca);c.setSelectionRange(J+1,da+Ia)}else Xl.insert(c,
"  ")}static unindent(c){const {selectionStart:k,selectionEnd:J,value:da}=c;var qa=da.lastIndexOf("\n",k-1)+1;const Ca=Xl.findLineEnd(da,J);var Ia=c.value.slice(qa,Ca);const bb=Ia.replace(/(^|\n)(\t| {1,2})/g,"$1");Ia=Ia.length-bb.length;c.setSelectionRange(qa,Ca);Xl.insert(c,bb);qa=(qa=/\t| {1,2}/.exec(da.slice(qa,k)))?qa[0].length:0;c.setSelectionRange(k-qa,Math.max(k-qa,J-Ia))}},Ju=ca(602),Os=c=>c.stopPropagation(),Ps=Rm.memo(function({font:c,text:k,color:J,fontStyle:da,fontSize:qa,fontWeight:Ca,
offsetX:Ia=0,offsetY:bb=0,scale:rb=1,isEditing:Pb=!1,pointerEvents:jc=!1,onBlur:yc,onChange:Rc}){const jd=Rm.useRef(null),fd=Rm.useRef(!1),xd=Rm.useCallback(wd=>{Rc(uq.normalizeText(wd.currentTarget.value))},[Rc]),Fd=Rm.useCallback(wd=>{if("Escape"!==wd.key)if("Tab"===wd.key&&0===k.length)wd.preventDefault();else{if("Meta"!==wd.key&&!wd.metaKey)wd.stopPropagation();else if("z"===wd.key&&wd.metaKey){document.execCommand(wd.shiftKey?"redo":"undo",!1);wd.stopPropagation();wd.preventDefault();return}"Tab"===
wd.key&&(wd.preventDefault(),wd.shiftKey?Xl.unindent(wd.currentTarget):Xl.indent(wd.currentTarget),null==Rc?void 0:Rc(uq.normalizeText(wd.currentTarget.value)))}},[Rc]),Xc=Rm.useCallback(wd=>{Pb&&(wd.currentTarget.setSelectionRange(0,0),null==yc?void 0:yc())},[yc]),id=Rm.useCallback(wd=>{Pb&&fd.current&&document.activeElement===wd.currentTarget&&wd.currentTarget.select()},[Pb]),nd=Rm.useCallback(wd=>{Pb&&wd.stopPropagation()},[Pb]);Rm.useEffect(()=>{Pb&&requestAnimationFrame(()=>{fd.current=!0;const wd=
jd.current;wd&&(wd.focus(),wd.select())})},[Pb,yc]);const Gd=Rm.useRef(null);Rm.useLayoutEffect(()=>{const wd=Gd.current;if(wd){var Ge=xg(k||"Enter text",{fontFamily:"var(--ls-font-family)",fontSize:qa,lineHeight:1,fontWeight:Ca},4);wd.style.transform=`scale(${rb}, ${rb}) translate(${Ia}px, ${bb}px)`;wd.style.width=Ge[0]+1+"px";wd.style.height=Ge[1]+1+"px"}},[k,Ca,qa,bb,Ia,rb]);return(0,Ju.jsx)("div",{className:"tl-text-label-wrapper",children:(0,Ju.jsxs)("div",{className:"tl-text-label-inner-wrapper",
ref:Gd,style:{font:c,fontStyle:da,fontSize:qa,fontWeight:Ca,color:J,pointerEvents:jc?"all":"none",userSelect:Pb?"text":"none"},children:[Pb?(0,Ju.jsx)("textarea",{ref:jd,style:{font:c,color:J,fontStyle:da,fontSize:qa,fontWeight:Ca},className:"tl-text-label-textarea",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:!0,placeholder:"Enter text",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:k,color:J,onFocus:id,
onChange:xd,onKeyDown:Fd,onBlur:Xc,onPointerDown:nd,onContextMenu:Os,onCopy:Os,onPaste:Os,onCut:Os}):k,""]})})}),Ho=ca(602),iy={xs:10,sm:16,md:20,lg:32,xl:48,xxl:60},Dq=class extends $k{constructor(){super(...arguments);vb(this,"canEdit",!0);vb(this,"ReactComponent",te(({events:c,isErasing:k,isBinding:J,isSelected:da,isEditing:qa,onEditingEnd:Ca})=>{const {props:{size:[Ia,bb],stroke:rb,fill:Pb,noFill:jc,strokeWidth:yc,strokeType:Rc,borderRadius:jd,opacity:fd,label:xd,italic:Fd,fontWeight:Xc,fontSize:id}}=
this;var nd=xd||qa?xg(xd,{fontFamily:"var(--ls-font-family)",fontSize:id,lineHeight:1,fontWeight:Xc},4):[0,0];const Gd=Rd.mul(this.props.size,.5);nd=Math.max(.5,Math.min(1,Ia/nd[0],bb/nd[1]));const wd=this.getBounds(),Ge=fy.useMemo(()=>Rd.sub(Gd,Rd.toFixed([wd.width/2,wd.height/2])),[wd,nd,Gd]),Je=fy.useCallback(ag=>{var af;null==(af=this.update)?void 0:af.call(this,{label:ag})},[xd]);return(0,Ho.jsxs)("div",gg(tf({},c),{style:{width:"100%",height:"100%",overflow:"hidden"},className:"tl-box-container",
children:[(0,Ho.jsx)(Ps,{font:"20px / 1 var(--ls-font-family)",text:xd,color:sf(rb,"text"),offsetX:Ge[0],offsetY:Ge[1],fontSize:id,scale:nd,isEditing:qa,onChange:Je,onBlur:Ca,fontStyle:Fd?"italic":"normal",fontWeight:Xc,pointerEvents:!!xd}),(0,Ho.jsxs)(tm,{opacity:k?.2:fd,children:[J&&(0,Ho.jsx)(Hn,{mode:"svg",strokeWidth:yc,size:[Ia,bb]}),(0,Ho.jsx)("rect",{className:da||!jc?"tl-hitarea-fill":"tl-hitarea-stroke",x:yc/2,y:yc/2,rx:jd,ry:jd,width:Math.max(.01,Ia-yc),height:Math.max(.01,bb-yc),pointerEvents:"all"}),
(0,Ho.jsx)("rect",{x:yc/2,y:yc/2,rx:jd,ry:jd,width:Math.max(.01,Ia-yc),height:Math.max(.01,bb-yc),strokeWidth:yc,stroke:sf(rb,"stroke"),strokeDasharray:"dashed"===Rc?"8 2":void 0,fill:jc?"none":sf(Pb,"background")})]})]}))}));vb(this,"setScaleLevel",c=>z(this,null,function*(){this.update({scaleLevel:c,fontSize:iy[null!=c?c:"md"],strokeWidth:iy[null!=c?c:"md"]/10});this.onResetBounds()}));vb(this,"ReactIndicator",te(()=>{const {props:{size:[c,k],borderRadius:J,isLocked:da}}=this;return(0,Ho.jsx)("g",
{children:(0,Ho.jsx)("rect",{width:c,height:k,rx:J,ry:J,fill:"transparent",strokeDasharray:da?"8 2":void 0})})}));vb(this,"validateProps",c=>{void 0!==c.size&&(c.size[0]=Math.max(c.size[0],1),c.size[1]=Math.max(c.size[1],1));void 0!==c.borderRadius&&(c.borderRadius=Math.max(0,c.borderRadius));return fl(this,c)})}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}};vb(Dq,"id","box");vb(Dq,"defaultProps",{id:"box",parentId:"page",type:"box",point:[0,0],size:[100,100],borderRadius:2,
stroke:"",fill:"",noFill:!1,fontWeight:400,fontSize:20,italic:!1,strokeType:"line",strokeWidth:2,opacity:1,label:""});pe([Zg],Dq.prototype,"scaleLevel",1);pe([Ic],Dq.prototype,"setScaleLevel",2);var jy=Uf(ca(22)),tn=ca(602),ky={xs:10,sm:16,md:20,lg:32,xl:48,xxl:60},Eq=class extends Rt{constructor(){super(...arguments);vb(this,"canEdit",!0);vb(this,"ReactComponent",te(({isSelected:c,isErasing:k,events:J,isEditing:da,onEditingEnd:qa})=>{const {size:[Ca,Ia],stroke:bb,fill:rb,noFill:Pb,strokeWidth:jc,
strokeType:yc,opacity:Rc,label:jd,italic:fd,fontWeight:xd,fontSize:Fd}=this.props;var Xc=jd||da?xg(jd,{fontFamily:"var(--ls-font-family)",fontSize:Fd,lineHeight:1,fontWeight:xd},4):[0,0];const id=Rd.mul(this.props.size,.5);Xc=Math.max(.5,Math.min(1,Ca/Xc[0],Ia/Xc[1]));const nd=this.getBounds(),Gd=jy.useMemo(()=>Rd.sub(id,Rd.toFixed([nd.width/2,nd.height/2])),[nd,Xc,id]),wd=jy.useCallback(Ge=>{var Je;null==(Je=this.update)?void 0:Je.call(this,{label:Ge})},[jd]);return(0,tn.jsxs)("div",gg(tf({},J),
{style:{width:"100%",height:"100%",overflow:"hidden"},className:"tl-ellipse-container",children:[(0,tn.jsx)(Ps,{font:"18px / 1 var(--ls-font-family)",text:jd,color:sf(bb,"text"),offsetX:Gd[0],offsetY:Gd[1],scale:Xc,isEditing:da,onChange:wd,onBlur:qa,fontStyle:fd?"italic":"normal",fontSize:Fd,fontWeight:xd,pointerEvents:!!jd}),(0,tn.jsxs)(tm,gg(tf({},J),{opacity:k?.2:Rc,children:[(0,tn.jsx)("ellipse",{className:c||!Pb?"tl-hitarea-fill":"tl-hitarea-stroke",cx:Ca/2,cy:Ia/2,rx:Math.max(.01,(Ca-jc)/2),
ry:Math.max(.01,(Ia-jc)/2)}),(0,tn.jsx)("ellipse",{cx:Ca/2,cy:Ia/2,rx:Math.max(.01,(Ca-jc)/2),ry:Math.max(.01,(Ia-jc)/2),strokeWidth:jc,stroke:sf(bb,"stroke"),strokeDasharray:"dashed"===yc?"8 2":void 0,fill:Pb?"none":sf(rb,"background")})]}))]}))}));vb(this,"setScaleLevel",c=>z(this,null,function*(){this.update({scaleLevel:c,fontSize:ky[null!=c?c:"md"],strokeWidth:ky[null!=c?c:"md"]/10});this.onResetBounds()}));vb(this,"ReactIndicator",te(()=>{const {size:[c,k],isLocked:J}=this.props;return(0,tn.jsx)("g",
{children:(0,tn.jsx)("ellipse",{cx:c/2,cy:k/2,rx:c/2,ry:k/2,strokeWidth:2,fill:"transparent",strokeDasharray:J?"8 2":"undefined"})})}));vb(this,"validateProps",c=>{void 0!==c.size&&(c.size[0]=Math.max(c.size[0],1),c.size[1]=Math.max(c.size[1],1));return fl(this,c)})}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}getShapeSVGJsx(c){const {size:[k,J],stroke:da,fill:qa,noFill:Ca,strokeWidth:Ia,strokeType:bb,opacity:rb}=this.props;return(0,tn.jsxs)("g",{opacity:rb,children:[(0,tn.jsx)("ellipse",
{className:Ca?"tl-hitarea-stroke":"tl-hitarea-fill",cx:k/2,cy:J/2,rx:Math.max(.01,(k-Ia)/2),ry:Math.max(.01,(J-Ia)/2)}),(0,tn.jsx)("ellipse",{cx:k/2,cy:J/2,rx:Math.max(.01,(k-Ia)/2),ry:Math.max(.01,(J-Ia)/2),strokeWidth:Ia,stroke:sf(da,"stroke"),strokeDasharray:"dashed"===bb?"8 2":void 0,fill:Ca?"none":sf(qa,"background")})]})}};vb(Eq,"id","ellipse");vb(Eq,"defaultProps",{id:"ellipse",parentId:"page",type:"ellipse",point:[0,0],size:[100,100],stroke:"",fill:"",noFill:!1,fontWeight:400,fontSize:20,
italic:!1,strokeType:"line",strokeWidth:2,opacity:1,label:""});pe([Zg],Eq.prototype,"scaleLevel",1);pe([Ic],Eq.prototype,"setScaleLevel",2);var Ir=ca(602),Ku=class extends ss{constructor(){super(...arguments);vb(this,"ReactComponent",te(({events:c})=>{const k=this.getBounds(),J=Le(),da=J.selectedShapesArray.some(Ca=>J.shapesInGroups([this]).includes(Ca)),qa=this.ReactIndicator;return(0,Ir.jsxs)(tm,gg(tf({},c),{className:"tl-group-container",children:[(0,Ir.jsx)("rect",{className:"tl-hitarea-fill",
x:1,y:1,width:Math.max(.01,k.width-2),height:Math.max(.01,k.height-2),pointerEvents:"all"}),da&&(0,Ir.jsx)("g",{stroke:"var(--color-selectedFill)",children:(0,Ir.jsx)(qa,{})})]}))}));vb(this,"ReactIndicator",te(()=>{const c=this.getBounds();return(0,Ir.jsx)("rect",{strokeDasharray:"8 2",x:-8,y:-8,rx:4,ry:4,width:c.width+16,height:c.height+16,fill:"transparent"})}))}};vb(Ku,"id","group");vb(Ku,"defaultProps",{id:"group",type:"group",parentId:"page",point:[0,0],size:[0,0],children:[]});var Qs=ca(602),
UC={xs:1,sm:1.6,md:2,lg:3.2,xl:4.8,xxl:6},Gp=class extends nq{constructor(c={}){super(c);vb(this,"ReactComponent",te(({events:k,isErasing:J})=>{const {pointsPath:da,props:{stroke:qa,strokeWidth:Ca,opacity:Ia}}=this;return(0,Qs.jsx)(tm,gg(tf({},k),{opacity:J?.2:1,children:(0,Qs.jsx)("path",{d:da,strokeWidth:16*Ca,stroke:sf(qa,"stroke"),fill:"none",pointerEvents:"all",strokeLinejoin:"round",strokeLinecap:"round",opacity:Ia})}))}));vb(this,"setScaleLevel",k=>z(this,null,function*(){this.update({scaleLevel:k,
strokeWidth:UC[null!=k?k:"md"]});this.onResetBounds()}));vb(this,"ReactIndicator",te(()=>{const {pointsPath:k,props:J}=this;return(0,Qs.jsx)("path",{d:k,fill:"none",strokeDasharray:J.isLocked?"8 2":"undefined"})}));vb(this,"validateProps",k=>{k=fl(this,k);void 0!==k.strokeWidth&&(k.strokeWidth=Math.max(k.strokeWidth,1));return k});zc(this)}get pointsPath(){const {points:c}=this.props;return vk.getCurvedPathForPoints(c)}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}getShapeSVGJsx(){const {pointsPath:c,
props:{stroke:k,strokeWidth:J,opacity:da}}=this;return(0,Qs.jsx)("path",{d:c,strokeWidth:16*J,stroke:sf(k,"stroke"),fill:"none",pointerEvents:"all",strokeLinejoin:"round",strokeLinecap:"round",opacity:da})}};vb(Gp,"id","highlighter");vb(Gp,"defaultProps",{id:"highlighter",parentId:"page",type:"highlighter",point:[0,0],points:[],isComplete:!1,stroke:"",fill:"",noFill:!0,strokeType:"line",strokeWidth:2,opacity:.5});pe([Zg],Gp.prototype,"pointsPath",1);pe([Zg],Gp.prototype,"scaleLevel",1);pe([Ic],Gp.prototype,
"setScaleLevel",2);var Lu=Uf(ca(22)),Rs=ca(602),Mu={xs:.5,sm:.8,md:1,lg:1.5,xl:2,xxl:3},Io=class extends $k{constructor(){super(...arguments);vb(this,"canChangeAspectRatio",!0);vb(this,"canFlip",!1);vb(this,"canEdit",!0);vb(this,"htmlAnchorRef",Lu.createRef());vb(this,"setScaleLevel",c=>z(this,null,function*(){var k;const J=Rd.mul(this.props.size,Mu[null!=c?c:"md"]/Mu[null!=(k=this.props.scaleLevel)?k:"md"]);this.update({scaleLevel:c});yield Ac();this.update({size:J})}));vb(this,"onResetBounds",c=>
{var k;if(this.htmlAnchorRef.current){const J=this.htmlAnchorRef.current.getBoundingClientRect(),[da,qa]=Rd.div([J.width,J.height],null!=(k=null==c?void 0:c.zoom)?k:1);this.update({size:[Math.max(Math.min(da||400,1400),10),Math.max(Math.min(qa||400,1400),10)]})}return this});vb(this,"ReactComponent",te(({events:c,isErasing:k,isEditing:J})=>{const {props:{html:da,scaleLevel:qa}}=this,Ca=an(),Ia=Le(),bb=Ia.selectedIds.has(this.id),rb=Ca||bb&&!J||"select"!==Ia.selectedTool.id,Pb=Lu.useCallback(yc=>{rb||
yc.stopPropagation()},[rb]),jc=Mu[null!=qa?qa:"md"];Lu.useEffect(()=>{0===this.props.size[1]&&(this.onResetBounds({zoom:Ia.viewport.camera.zoom}),Ia.persist(!0))},[]);return(0,Rs.jsx)(Vl,gg(tf({style:{overflow:"hidden",pointerEvents:"all",opacity:k?.2:1}},c),{children:(0,Rs.jsx)("div",{onWheelCapture:Pb,onPointerDown:Pb,onPointerUp:Pb,className:"tl-html-container",style:{pointerEvents:Ca||!J&&!bb?"none":"all",overflow:J?"auto":"hidden",width:`calc(100% / ${jc})`,height:`calc(100% / ${jc})`,transform:`scale(${jc})`},
children:(0,Rs.jsx)("div",{ref:this.htmlAnchorRef,className:"tl-html-anchor",dangerouslySetInnerHTML:{__html:da.trim()}})})}))}));vb(this,"ReactIndicator",te(()=>{const {props:{size:[c,k],isLocked:J}}=this;return(0,Rs.jsx)("rect",{width:c,height:k,fill:"transparent",strokeDasharray:J?"8 2":"undefined"})}));vb(this,"validateProps",c=>{void 0!==c.size&&(c.size[0]=Math.max(c.size[0],1),c.size[1]=Math.max(c.size[1],1));return fl(this,c)})}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?
c:"md"}};vb(Io,"id","html");vb(Io,"defaultProps",{id:"html",type:"html",parentId:"page",point:[0,0],size:[600,0],html:""});pe([Zg],Io.prototype,"scaleLevel",1);pe([Ic],Io.prototype,"setScaleLevel",2);var ly=Uf(ca(22)),Jr=ca(602),Hp=class extends $k{constructor(){super(...arguments);vb(this,"frameRef",ly.createRef());vb(this,"canEdit",!0);vb(this,"onIFrameSourceChange",c=>{this.update({url:c})});vb(this,"reload",()=>{var c,k;this.frameRef.current&&(this.frameRef.current.src=null==(k=null==(c=this.frameRef)?
void 0:c.current)?void 0:k.src)});vb(this,"ReactComponent",te(({events:c,isErasing:k,isEditing:J})=>{ly.useRef(null);const da=Le();return(0,Jr.jsx)(Vl,gg(tf({style:{overflow:"hidden",pointerEvents:"all",opacity:k?.2:1}},c),{children:(0,Jr.jsx)("div",{className:"tl-iframe-container",style:{pointerEvents:J||da.readOnly?"all":"none",userSelect:"none"},children:this.props.url&&(0,Jr.jsx)("div",{style:{overflow:"hidden",position:"relative",height:"100%"},children:(0,Jr.jsx)("iframe",{ref:this.frameRef,
className:"absolute inset-0 w-full h-full m-0",width:"100%",height:"100%",src:`${this.props.url}`,frameBorder:"0",sandbox:"allow-scripts allow-same-origin allow-presentation"})})})}))}));vb(this,"ReactIndicator",te(()=>{const {props:{size:[c,k],isLocked:J}}=this;return(0,Jr.jsx)("rect",{width:c,height:k,fill:"transparent",rx:8,ry:8,strokeDasharray:J?"8 2":"undefined"})}))}};vb(Hp,"id","iframe");vb(Hp,"defaultProps",{id:"iframe",type:"iframe",parentId:"page",point:[0,0],size:[853,480],url:""});pe([Ic],
Hp.prototype,"onIFrameSourceChange",2);pe([Ic],Hp.prototype,"reload",2);var VC=Uf(ca(22)),Fq=ca(602),Ss=class extends St{constructor(){super(...arguments);vb(this,"ReactComponent",te(({events:c,isErasing:k,isBinding:J,asset:da})=>{const {props:{opacity:qa,objectFit:Ca,clipping:Ia,size:[bb,rb]}}=this,[Pb,jc,yc,Rc]=Array.isArray(Ia)?Ia:[Ia,Ia,Ia,Ia],{handlers:jd}=VC.useContext(Si);return(0,Fq.jsxs)(Vl,gg(tf({},c),{opacity:k?.2:qa,children:[J&&(0,Fq.jsx)(Hn,{mode:"html",strokeWidth:4,size:[bb,rb]}),
(0,Fq.jsx)("div",{"data-asset-loaded":!!da,className:"tl-image-shape-container",children:da?(0,Fq.jsx)("img",{src:jd?jd.makeAssetUrl(da.src):da.src,draggable:!1,style:{position:"relative",top:-Pb,left:-Rc,width:bb+(Rc-jc),height:rb+(Pb-yc),objectFit:Ca}}):"Asset is missing"})]}))}));vb(this,"ReactIndicator",te(()=>{const {props:{size:[c,k],isLocked:J}}=this;return(0,Fq.jsx)("rect",{width:c,height:k,fill:"transparent",strokeDasharray:J?"8 2":"undefined"})}))}getShapeSVGJsx({assets:c}){var k,J;const da=
this.getBounds(),{assetId:qa,clipping:Ca}=this.props;if(c=c.find(Ia=>Ia.id===qa)){Array.isArray(Ca);const Ia=null==(J=null==(k=window.logseq)?void 0:k.api)?void 0:J.make_asset_url;return(0,Fq.jsx)("image",{width:da.width,height:da.height,href:Ia?Ia(c.src):c.src})}return super.getShapeSVGJsx({})}};vb(Ss,"id","image");vb(Ss,"defaultProps",{id:"image1",parentId:"page",type:"image",point:[0,0],size:[100,100],opacity:1,assetId:"",clipping:0,objectFit:"fill",isAspectRatioLocked:!0});var Nu=Uf(ca(22)),WC=
Uf(ca(22)),Ou=ca(602),Gq=ca(602),my={xs:10,sm:16,md:20,lg:32,xl:48,xxl:60},XC=WC.memo(function({style:c,start:k,end:J,decorationStart:da,decorationEnd:qa,scaleLevel:Ca}){const Ia=Rd.dist(k,J);if(2>Ia)return null;const {strokeWidth:bb}=c,rb=1+bb*my[null!=Ca?Ca:"md"]/10,Pb="M"+Rd.toFixed(k)+"L"+Rd.toFixed(J);Ca=Math.min(Ia/3,bb*my[null!=Ca?Ca:"md"]);da=da?el(k,J,Ca):null;qa=qa?el(J,k,Ca):null;return(0,Gq.jsxs)(Gq.Fragment,{children:[(0,Gq.jsx)("path",{className:"tl-stroke-hitarea",d:Pb}),(0,Gq.jsx)("path",
{d:Pb,strokeWidth:rb,stroke:c.stroke,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"dashed"===c.strokeType?"8 4":void 0,pointerEvents:"stroke"}),da&&(0,Gq.jsx)(pl,{left:da.left,middle:k,right:da.right,stroke:c.stroke,strokeWidth:rb}),qa&&(0,Gq.jsx)(pl,{left:qa.left,middle:J,right:qa.right,stroke:c.stroke,strokeWidth:rb})]})}),Ts=ca(602),Dl=ca(602),YC={xs:10,sm:16,md:20,lg:32,xl:48,xxl:60},Hq=class extends vr{constructor(){super(...arguments);vb(this,"hideSelection",!0);vb(this,"canEdit",
!0);vb(this,"ReactComponent",te(({events:c,isErasing:k,isEditing:J,onEditingEnd:da})=>{const {stroke:qa,handles:{start:Ca,end:Ia},opacity:bb,label:rb,italic:Pb,fontWeight:jc,fontSize:yc,id:Rc}=this.props,jd=rb||J?xg(rb||"Enter text",{fontFamily:"var(--ls-font-family)",fontSize:yc,lineHeight:1,fontWeight:jc},6):[0,0],fd=Rd.med(Ca.point,Ia.point);var xd=Rd.dist(Ca.point,Ia.point);xd=Math.max(.5,Math.min(1,Math.max(xd/(jd[1]+128),xd/(jd[0]+128))));const Fd=this.getBounds(),Xc=Nu.useMemo(()=>Rd.sub(fd,
Rd.toFixed([Fd.width/2,Fd.height/2])),[Fd,xd,fd]),id=Nu.useCallback(nd=>{var Gd;null==(Gd=this.update)?void 0:Gd.call(this,{label:nd})},[rb]);return(0,Dl.jsxs)("div",gg(tf({},c),{style:{width:"100%",height:"100%",overflow:"hidden"},className:"tl-line-container",children:[(0,Dl.jsx)(Ps,{font:"20px / 1 var(--ls-font-family)",text:rb,fontSize:yc,color:sf(qa,"text"),offsetX:Xc[0],offsetY:Xc[1],scale:xd,isEditing:J,onChange:id,onBlur:da,fontStyle:Pb?"italic":"normal",fontWeight:jc,pointerEvents:!!rb}),
(0,Dl.jsxs)(tm,{opacity:k?.2:bb,id:Rc+"_svg",children:[(0,Dl.jsx)(hl,{id:Rc,bounds:Fd,labelSize:jd,offset:Xc,scale:xd}),(0,Dl.jsx)("g",{pointerEvents:"none",mask:rb||J?`url(#${Rc}_clip)`:"",children:this.getShapeSVGJsx({preview:!1})})]})]}))}));vb(this,"setScaleLevel",c=>z(this,null,function*(){this.update({scaleLevel:c,fontSize:YC[null!=c?c:"md"]});this.onResetBounds()}));vb(this,"ReactIndicator",te(({isEditing:c})=>{const {id:k,decorations:J,label:da,strokeWidth:qa,fontSize:Ca,fontWeight:Ia,handles:{start:bb,
end:rb},isLocked:Pb}=this.props,jc=this.getBounds(),yc=da||c?xg(da,{fontFamily:"var(--ls-font-family)",fontSize:Ca,lineHeight:1,fontWeight:Ia},6):[0,0],Rc=Rd.med(bb.point,rb.point);var jd=Rd.dist(bb.point,rb.point);jd=Math.max(.5,Math.min(1,Math.max(jd/(yc[1]+128),jd/(yc[0]+128))));const fd=Nu.useMemo(()=>Rd.sub(Rc,Rd.toFixed([jc.width/2,jc.height/2])),[jc,jd,Rc]);return(0,Dl.jsxs)("g",{children:[(0,Dl.jsx)("path",{mask:da?`url(#${k}_clip)`:"",d:po({strokeWidth:qa},bb.point,rb.point,null==J?void 0:
J.start,null==J?void 0:J.end),strokeDasharray:Pb?"8 2":"undefined"}),da&&!c&&(0,Dl.jsx)("rect",{x:jc.width/2-yc[0]/2*jd+fd[0],y:jc.height/2-yc[1]/2*jd+fd[1],width:yc[0]*jd,height:yc[1]*jd,rx:4*jd,ry:4*jd,fill:"transparent"})]})}));vb(this,"validateProps",c=>fl(this,c))}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}getShapeSVGJsx({preview:c}){const {stroke:k,fill:J,strokeWidth:da,strokeType:qa,decorations:Ca,label:Ia,scaleLevel:bb,handles:{start:rb,end:Pb}}=this.props,jc=Rd.med(rb.point,
Pb.point);return(0,Dl.jsxs)(Dl.Fragment,{children:[(0,Dl.jsx)(XC,{style:{stroke:sf(k,"text"),fill:J,strokeWidth:da,strokeType:qa},scaleLevel:bb,start:rb.point,end:Pb.point,decorationStart:null==Ca?void 0:Ca.start,decorationEnd:null==Ca?void 0:Ca.end}),c&&(0,Dl.jsx)(Dl.Fragment,{children:(0,Dl.jsx)("text",{style:{transformOrigin:"top left"},fontFamily:"Inter",fontSize:20,transform:`translate(${jc[0]}, ${jc[1]})`,textAnchor:"middle",fill:sf(k,"text"),stroke:sf(k,"text"),children:Ia})})]})}};vb(Hq,"id",
"line");vb(Hq,"defaultProps",{id:"line",parentId:"page",type:"line",point:[0,0],handles:{start:{id:"start",canBind:!0,point:[0,0]},end:{id:"end",canBind:!0,point:[1,1]}},stroke:"",fill:"",noFill:!0,fontWeight:400,fontSize:20,italic:!1,strokeType:"line",strokeWidth:1,opacity:1,decorations:{end:"arrow"},label:""});pe([Zg],Hq.prototype,"scaleLevel",1);pe([Ic],Hq.prototype,"setScaleLevel",2);var El=Uf(ca(22)),Ij=ca(602),Kr={xs:.5,sm:.8,md:1,lg:1.5,xl:2,xxl:3},ZC=te(({type:c,fill:k,opacity:J,children:da})=>
{const qa="var(--ls-secondary-background-color)"!==k?sf(k,"background"):"var(--ls-tertiary-background-color)";k=k&&"var(--ls-secondary-background-color)"!==k?qf(k)?`var(--ls-highlight-color-${k})`:k:"var(--ls-secondary-background-color)";return(0,Ij.jsxs)("div",{className:`tl-logseq-portal-header tl-logseq-portal-header-${"P"===c?"page":"block"}`,children:[(0,Ij.jsx)("div",{className:"absolute inset-0 tl-logseq-portal-header-bg",style:{opacity:J,background:"P"===c?qa:`linear-gradient(0deg, ${k}, ${qa})`}}),
(0,Ij.jsx)("div",{className:"relative",children:da})]})}),Yj=class extends $k{constructor(c={}){var k;super(c);vb(this,"hideRotateHandle",!0);vb(this,"canChangeAspectRatio",!0);vb(this,"canFlip",!0);vb(this,"canEdit",!0);vb(this,"persist",null);vb(this,"initialHeightCalculated",!0);vb(this,"getInnerHeight",null);vb(this,"setCollapsed",J=>z(this,null,function*(){var da;if("B"===this.props.blockType){if(this.update({compact:J}),this.canResize[1]=!J,!J)this.onResetBounds()}else{const qa=this.props.size[1];
this.canResize[1]=!J;this.update({isAutoResizing:!J,collapsed:J,size:[this.props.size[0],J?this.getHeaderHeight():this.props.collapsedHeight],collapsedHeight:J?qa:this.props.collapsedHeight})}null==(da=this.persist)?void 0:da.call(this)}));vb(this,"setScaleLevel",J=>z(this,null,function*(){var da;const qa=Rd.mul(this.props.size,Kr[null!=J?J:"md"]/Kr[null!=(da=this.props.scaleLevel)?da:"md"]);this.update({scaleLevel:J});yield Ac();this.update({size:qa})}));vb(this,"onResetBounds",J=>{J=this.getAutoResizeHeight();
null!==J&&1<Math.abs(J-this.props.size[1])&&(this.update({size:[this.props.size[0],J]}),this.initialHeightCalculated=!0);return this});vb(this,"onResize",(J,da)=>{var qa;const {bounds:Ca,rotation:Ia,scale:[bb,rb]}=da;J=[...this.scale];0>bb&&(J[0]*=-1);0>rb&&(J[1]*=-1);da=Ca.height;this.props.isAutoResizing&&(da=null!=(qa=this.getAutoResizeHeight())?qa:da);return this.update({point:[Ca.minX,Ca.minY],size:[Math.max(1,Ca.width),Math.max(1,da)],scale:J,rotation:Ia})});vb(this,"PortalComponent",te(({})=>
{const {props:{pageId:J,fill:da,opacity:qa}}=this,{renderers:Ca}=El.useContext(Si),Ia=Le(),bb=El.useRef(null),[,rb]=this.useComponentSize(bb,this.props.compact?".tl-logseq-cp-container \x3e .single-block":".tl-logseq-cp-container \x3e .page");if(null==Ca||!Ca.Page)return null;const {Page:Pb,Block:jc}=Ca,[yc,Rc]=El.useState(!1);El.useEffect(()=>{var jd,fd;if(this.props.isAutoResizing){const xd=(null!=(fd=null==(jd=this.getInnerHeight)?void 0:jd.call(this))?fd:rb)+this.getHeaderHeight();rb&&1<Math.abs(xd-
this.props.size[1])&&(this.update({size:[this.props.size[0],xd]}),yc&&Ia.persist(!0))}},[rb,this.props.isAutoResizing]);El.useEffect(()=>{this.initialHeightCalculated||setTimeout(()=>{this.onResetBounds();Ia.persist(!0)})},[this.initialHeightCalculated]);El.useEffect(()=>{setTimeout(function(){Rc(!0)})},[]);return(0,Ij.jsxs)(Ij.Fragment,{children:[(0,Ij.jsx)("div",{className:"absolute inset-0 tl-logseq-cp-container-bg",style:{textRendering:.5>Ia.viewport.camera.zoom?"optimizeSpeed":"auto",background:da&&
"var(--ls-secondary-background-color)"!==da?qf(da)?`var(--ls-highlight-color-${da})`:da:"var(--ls-secondary-background-color)",opacity:qa}}),(0,Ij.jsx)("div",{ref:bb,className:"relative tl-logseq-cp-container",style:{overflow:this.props.isAutoResizing?"visible":"auto"},children:(yc||!this.initialHeightCalculated)&&("B"===this.props.blockType&&this.props.compact?(0,Ij.jsx)(jc,{blockId:J}):(0,Ij.jsx)(Pb,{pageName:J}))})]})}));vb(this,"ReactComponent",te(J=>{var da;const {events:qa,isErasing:Ca,isEditing:Ia,
isBinding:bb}=J,{props:{opacity:rb,pageId:Pb,fill:jc,scaleLevel:yc,strokeWidth:Rc,size:jd}}=this,fd=Le(),{renderers:xd,handlers:Fd}=El.useContext(Si);this.persist=()=>fd.persist();const Xc=an(),id=fd.selectedIds.has(this.id)&&1===fd.selectedIds.size,nd=fd.isIn("logseq-portal.creating")&&!Pb,Gd=(Xc||id&&!Ia||"select"!==fd.selectedTool.id)&&!nd,wd=El.useCallback(uf=>{Gd||uf.stopPropagation()},[Gd]),Ge=1===fd.selectedShapesArray.length&&fd.selectedShapesArray.some(uf=>"logseq-portal"===uf.type&&uf.props.id!==
this.props.id&&Pb&&uf.props.pageId===Pb),Je=Kr[null!=yc?yc:"md"];El.useEffect(()=>this.props.collapsed&&Ia?(this.update({size:[this.props.size[0],this.props.collapsedHeight]}),()=>{this.update({size:[this.props.size[0],this.getHeaderHeight()]})}):()=>{},[Ia,this.props.collapsed]);El.useEffect(()=>{if(nd){const uf=[fd.viewport.bounds.width,fd.viewport.bounds.height],Af=fd.viewport.getScreenPoint([this.bounds.minX,this.bounds.minY]);(Af[0]>uf[0]-400||Af[1]>uf[1]-240||1.5<fd.viewport.camera.zoom||.5>
fd.viewport.camera.zoom)&&fd.viewport.zoomToBounds(gg(tf({},this.bounds),{minY:this.bounds.maxY+25}))}},[fd.viewport.bounds.height.toFixed(2)]);const ag=El.useCallback(uf=>{this.initialHeightCalculated=!1;const Af=sg(uf)?"B":"P";this.update({pageId:uf,size:[400,320],blockType:Af,compact:"B"===Af});fd.selectTool("select");fd.history.resume();fd.history.persist()},[]),af=this.PortalComponent;var Sf=El.useMemo(()=>{var uf;if(Pb&&"B"===this.props.blockType)return null==(uf=null==Fd?void 0:Fd.queryBlockByUUID(Pb))?
void 0:uf.content},[null==Fd?void 0:Fd.queryBlockByUUID,Pb]);Sf="B"===this.props.blockType&&"string"!==typeof Sf;const Bh=(!this.props.collapsed||Ia)&&!Sf;if(null==xd||!xd.Page)return null;const {Breadcrumb:Tg,PageName:zg}=xd,dh={width:`calc(100% / ${Je})`,height:`calc(100% / ${Je})`,opacity:Ca?.2:1};1!==Je&&(dh.transform=`scale(${Je})`);return(0,Ij.jsxs)(Vl,gg(tf({style:{pointerEvents:"all"}},qa),{children:[bb&&(0,Ij.jsx)(Hn,{mode:"html",strokeWidth:Rc,size:jd}),(0,Ij.jsx)("div",{"data-inner-events":!Gd,
onWheelCapture:wd,onPointerDown:wd,onPointerUp:wd,style:{width:"100%",height:"100%",pointerEvents:Xc||!Ia&&!id?"none":"all"},children:nd?(0,Ij.jsx)(wy,{onChange:ag,onAddBlock:uf=>{setTimeout(()=>{var Af,rf,Zf;fd.api.editShape(this);null==(Zf=null==(rf=null==(Af=window.logseq)?void 0:Af.api)?void 0:rf.edit_block)?void 0:Zf.call(rf,uf)})},placeholder:"Create or search your graph..."}):(0,Ij.jsxs)("div",{className:"tl-logseq-portal-container","data-collapsed":this.collapsed,"data-page-id":Pb,"data-portal-selected":Ge,
"data-editing":Ia,style:dh,children:[!this.props.compact&&!Sf&&(0,Ij.jsx)(ZC,{type:null!=(da=this.props.blockType)?da:"P",fill:jc,opacity:rb,children:"P"===this.props.blockType?(0,Ij.jsx)(zg,{pageName:Pb}):(0,Ij.jsx)(Tg,{blockId:Pb})}),Sf&&(0,Ij.jsx)("div",{className:"tl-target-not-found",children:"Target not found"}),Bh&&(0,Ij.jsx)(af,tf({},J))]})})]}))}));vb(this,"ReactIndicator",te(()=>{const J=this.getBounds();return(0,Ij.jsx)("rect",{width:J.width,height:J.height,fill:"transparent",rx:8,ry:8,
strokeDasharray:this.props.isLocked?"8 2":"undefined"})}));vb(this,"validateProps",J=>{var da;if(void 0!==J.size){const qa=Kr[null!=(da=this.props.scaleLevel)?da:"md"];J.size[0]=Math.max(J.size[0],60*qa);J.size[1]=Math.max(J.size[1],40*qa)}return fl(this,J)});zc(this);c.collapsed&&Object.assign(this.canResize,[!0,!1]);0===(null==(k=c.size)?void 0:k[1])&&(this.initialHeightCalculated=!1)}static isPageOrBlock(c){return c?/^\(\(.*\)\)$/.test(c)&&40===c.length?"B":"P":!1}get collapsed(){return"B"===this.props.blockType?
this.props.compact:this.props.collapsed}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}useComponentSize(c,k=""){const [J,da]=El.useState([0,0]),qa=Le();El.useEffect(()=>{setTimeout(()=>{if(null==c?0:c.current){const Ca=k?c.current.querySelector(k):c.current;if(Ca){const Ia=()=>{const {width:rb,height:Pb}=Ca.getBoundingClientRect(),jc=Rd.div([rb,Pb],qa.viewport.camera.zoom);da(jc);return jc};Ia();this.getInnerHeight=()=>Ia()[1];const bb=new ResizeObserver(()=>{Ia()});bb.observe(Ca);
return()=>{bb.disconnect()}}}return()=>{}},10)},[c,k]);return J}getHeaderHeight(){var c;const k=Kr[null!=(c=this.props.scaleLevel)?c:"md"];return this.props.compact?0:40*k}getAutoResizeHeight(){return this.getInnerHeight?this.getHeaderHeight()+this.getInnerHeight():null}getShapeSVGJsx({}){var c,k,J;const da=this.getBounds();return(0,Ij.jsxs)(Ij.Fragment,{children:[(0,Ij.jsx)("rect",{fill:this.props.fill&&"var(--ls-secondary-background-color)"!==this.props.fill?qf(this.props.fill)?`var(--ls-highlight-color-${this.props.fill})`:
this.props.fill:"var(--ls-secondary-background-color)",stroke:sf(this.props.fill,"background"),strokeWidth:null!=(c=this.props.strokeWidth)?c:2,fillOpacity:null!=(k=this.props.opacity)?k:.2,width:da.width,rx:8,ry:8,height:da.height}),!this.props.compact&&(0,Ij.jsx)("rect",{fill:this.props.fill&&"var(--ls-secondary-background-color)"!==this.props.fill?sf(this.props.fill,"background"):"var(--ls-tertiary-background-color)",fillOpacity:null!=(J=this.props.opacity)?J:.2,x:1,y:1,width:da.width-2,height:38,
rx:8,ry:8}),(0,Ij.jsx)("text",{style:{transformOrigin:"top left"},transform:`translate(${da.width/2}, ${10+da.height/2})`,textAnchor:"middle",fontFamily:"var(--ls-font-family)",fontSize:"32",fill:"var(--ls-secondary-text-color)",stroke:"var(--ls-secondary-text-color)",children:"P"===this.props.blockType?this.props.pageId:""})]})}};vb(Yj,"id","logseq-portal");vb(Yj,"defaultSearchQuery","");vb(Yj,"defaultSearchFilter",null);vb(Yj,"defaultProps",{id:"logseq-portal",type:"logseq-portal",parentId:"page",
point:[0,0],size:[400,50],collapsedHeight:0,stroke:"",fill:"",noFill:!1,borderRadius:8,strokeWidth:2,strokeType:"line",opacity:1,pageId:"",collapsed:!1,compact:!1,scaleLevel:"md",isAutoResizing:!0});pe([Zg],Yj.prototype,"collapsed",1);pe([Ic],Yj.prototype,"setCollapsed",2);pe([Zg],Yj.prototype,"scaleLevel",1);pe([Ic],Yj.prototype,"setScaleLevel",2);var {min:Iq,PI:$C}=Math,Lr=$C+1E-4,Pu=ca(602),aD={xs:1,sm:1.6,md:2,lg:3.2,xl:4.8,xxl:6},bD={easing:c=>Math.sin(c*Math.PI/2),simulatePressure:!0},cD={easing:c=>
c*c,simulatePressure:!1},Ip=class extends nq{constructor(c={}){super(c);vb(this,"ReactComponent",te(({events:k,isErasing:J})=>{const {props:{opacity:da}}=this;return(0,Pu.jsx)(tm,gg(tf({},k),{opacity:J?.2:da,children:this.getShapeSVGJsx()}))}));vb(this,"setScaleLevel",k=>z(this,null,function*(){this.update({scaleLevel:k,strokeWidth:aD[null!=k?k:"md"]});this.onResetBounds()}));vb(this,"ReactIndicator",te(()=>{const {pointsPath:k}=this;return(0,Pu.jsx)("path",{d:k,strokeDasharray:this.props.isLocked?
"8 2":"undefined"})}));vb(this,"validateProps",k=>{k=fl(this,k);void 0!==k.strokeWidth&&(k.strokeWidth=Math.max(k.strokeWidth,1));return k});zc(this)}get pointsPath(){var c=this.props;if(2>c.points.length)var k="";else k=gg(tf({size:1+1.5*c.strokeWidth,thinning:.65,streamline:.65,smoothing:.65},.5===c.points[1][2]?bD:cD),{last:c.isComplete}),c=Lm(c.points,k),k=vk.getSvgPathFromStroke(mn(c,k));return k}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}getShapeSVGJsx(){const {pointsPath:c,
props:{stroke:k,strokeWidth:J,strokeType:da}}=this;return(0,Pu.jsx)("path",{pointerEvents:"all",d:c,strokeWidth:J/2,strokeLinejoin:"round",strokeLinecap:"round",stroke:sf(k,"text"),fill:sf(k,"text"),strokeDasharray:"dashed"===da?"12 4":void 0})}};vb(Ip,"id","pencil");vb(Ip,"defaultProps",{id:"pencil",parentId:"page",type:"pencil",point:[0,0],points:[],isComplete:!1,stroke:"",fill:"",noFill:!0,strokeType:"line",strokeWidth:2,opacity:1});pe([Zg],Ip.prototype,"pointsPath",1);pe([Zg],Ip.prototype,"scaleLevel",
1);pe([Ic],Ip.prototype,"setScaleLevel",2);var ny=Uf(ca(22)),Sm=ca(602),oy={xs:10,sm:16,md:20,lg:32,xl:48,xxl:60},Jq=class extends xo{constructor(){super(...arguments);vb(this,"canEdit",!0);vb(this,"ReactComponent",te(({events:c,isErasing:k,isSelected:J,isEditing:da,onEditingEnd:qa})=>{const {offset:[Ca,Ia],props:{stroke:bb,fill:rb,noFill:Pb,strokeWidth:jc,opacity:yc,strokeType:Rc,label:jd,italic:fd,fontWeight:xd,fontSize:Fd}}=this,Xc=this.getVertices(jc/2).join();var id=jd||da?xg(jd,{fontFamily:"var(--ls-font-family)",
fontSize:Fd,lineHeight:1,fontWeight:xd},4):[0,0];const nd=[this.props.size[0]/2,2*this.props.size[1]/3];id=Math.max(.5,Math.min(1,this.props.size[0]/(2*id[0]),this.props.size[1]/(2*id[1])));const Gd=this.getBounds(),wd=ny.useMemo(()=>Rd.sub(nd,Rd.toFixed([Gd.width/2,Gd.height/2])),[Gd,id,nd]),Ge=ny.useCallback(Je=>{var ag;null==(ag=this.update)?void 0:ag.call(this,{label:Je})},[jd]);return(0,Sm.jsxs)("div",gg(tf({},c),{style:{width:"100%",height:"100%",overflow:"hidden"},children:[(0,Sm.jsx)(Ps,{font:"20px / 1 var(--ls-font-family)",
text:jd,fontSize:Fd,color:sf(bb,"text"),offsetX:wd[0],offsetY:wd[1]/id,scale:id,isEditing:da,onChange:Ge,onBlur:qa,fontStyle:fd?"italic":"normal",fontWeight:xd,pointerEvents:!!jd}),(0,Sm.jsx)(tm,{opacity:k?.2:yc,children:(0,Sm.jsxs)("g",{transform:`translate(${Ca}, ${Ia})`,children:[(0,Sm.jsx)("polygon",{className:J||!Pb?"tl-hitarea-fill":"tl-hitarea-stroke",points:Xc}),(0,Sm.jsx)("polygon",{points:Xc,stroke:sf(bb,"stroke"),fill:Pb?"none":sf(rb,"background"),strokeWidth:jc,rx:2,ry:2,strokeLinejoin:"round",
strokeDasharray:"dashed"===Rc?"8 2":void 0})]})})]}))}));vb(this,"setScaleLevel",c=>z(this,null,function*(){this.update({scaleLevel:c,fontSize:oy[null!=c?c:"md"],strokeWidth:oy[null!=c?c:"md"]/10});this.onResetBounds()}));vb(this,"ReactIndicator",te(()=>{const {offset:[c,k],props:{strokeWidth:J,isLocked:da}}=this;return(0,Sm.jsx)("g",{children:(0,Sm.jsx)("polygon",{transform:`translate(${c}, ${k})`,points:this.getVertices(J/2).join(),strokeDasharray:da?"8 2":"undefined"})})}));vb(this,"validateProps",
c=>{void 0!==c.sides&&(c.sides=Math.max(c.sides,3));return fl(this,c)})}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}getShapeSVGJsx(c){const {offset:[k,J],props:{stroke:da,fill:qa,noFill:Ca,strokeWidth:Ia,opacity:bb,strokeType:rb}}=this;c=this.getVertices(Ia/2).join();return(0,Sm.jsxs)("g",{transform:`translate(${k}, ${J})`,opacity:bb,children:[(0,Sm.jsx)("polygon",{className:Ca?"tl-hitarea-stroke":"tl-hitarea-fill",points:c}),(0,Sm.jsx)("polygon",{points:c,stroke:sf(da,"stroke"),
fill:Ca?"none":sf(qa,"background"),strokeWidth:Ia,rx:2,ry:2,strokeLinejoin:"round",strokeDasharray:"dashed"===rb?"8 2":void 0})]})}};vb(Jq,"id","polygon");vb(Jq,"defaultProps",{id:"polygon",parentId:"page",type:"polygon",point:[0,0],size:[100,100],sides:3,ratio:1,isFlippedY:!1,stroke:"",fill:"",fontWeight:400,fontSize:20,italic:!1,noFill:!1,strokeType:"line",strokeWidth:2,opacity:1,label:""});pe([Zg],Jq.prototype,"scaleLevel",1);pe([Ic],Jq.prototype,"setScaleLevel",2);var un=Uf(ca(22)),Jo=ca(602),
dD={xs:10,sm:16,md:20,lg:32,xl:48,xxl:60},Kq=class extends Tt{constructor(){super(...arguments);vb(this,"ReactComponent",te(({events:c,isErasing:k,isEditing:J,onEditingEnd:da})=>{const {props:{opacity:qa,fontFamily:Ca,fontSize:Ia,fontWeight:bb,italic:rb,lineHeight:Pb,text:jc,stroke:yc,padding:Rc}}=this,jd=un.useRef(null),fd=un.useRef(!1),xd=un.useRef(null),Fd=un.useCallback(wd=>{const {isSizeLocked:Ge}=this.props;wd=uq.normalizeText(wd.currentTarget.value);Ge?this.update({text:wd,size:this.getAutoSizedBoundingBox({text:wd})}):
this.update({text:wd})},[]),Xc=un.useCallback(wd=>{if("Escape"!==wd.key)if("Tab"===wd.key&&0===jc.length)wd.preventDefault();else{if("Meta"!==wd.key&&!wd.metaKey)wd.stopPropagation();else if("z"===wd.key&&wd.metaKey){wd.shiftKey?document.execCommand("redo",!1):document.execCommand("undo",!1);wd.stopPropagation();wd.preventDefault();return}"Tab"===wd.key&&(wd.preventDefault(),wd.shiftKey?Xl.unindent(wd.currentTarget):Xl.indent(wd.currentTarget),this.update({text:uq.normalizeText(wd.currentTarget.value)}))}},
[]),id=un.useCallback(wd=>{J&&(null==da?void 0:da())},[da]),nd=un.useCallback(wd=>{J&&fd.current&&document.activeElement===wd.currentTarget&&wd.currentTarget.select()},[J]),Gd=un.useCallback(wd=>{J&&wd.stopPropagation()},[J]);un.useEffect(()=>{J&&requestAnimationFrame(()=>{fd.current=!0;const wd=jd.current;wd&&(wd.focus(),wd.select())})},[J,da]);un.useLayoutEffect(()=>{if(0===this.props.size[0]||0===this.props.size[1])this.onResetBounds()},[]);return(0,Jo.jsx)(Vl,gg(tf({},c),{opacity:k?.2:qa,children:(0,Jo.jsx)("div",
{ref:xd,className:"tl-text-shape-wrapper","data-hastext":!!jc,"data-isediting":J,style:{fontFamily:Ca,fontStyle:rb?"italic":"normal",fontSize:Ia,fontWeight:bb,padding:Rc,lineHeight:Pb,color:sf(yc,"text")},children:J?(0,Jo.jsx)("textarea",{ref:jd,className:"tl-text-shape-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:jc,onFocus:nd,onChange:Fd,onKeyDown:Xc,
onBlur:id,onPointerDown:Gd}):(0,Jo.jsxs)(Jo.Fragment,{children:[jc,""]})})}))}));vb(this,"setScaleLevel",c=>z(this,null,function*(){this.update({scaleLevel:c,fontSize:dD[null!=c?c:"md"]});this.onResetBounds()}));vb(this,"ReactIndicator",te(({isEditing:c})=>{const {props:{borderRadius:k,isLocked:J},bounds:da}=this;return c?null:(0,Jo.jsx)("rect",{width:da.width,height:da.height,rx:k,ry:k,fill:"transparent",strokeDasharray:J?"8 2":"undefined"})}));vb(this,"validateProps",c=>fl(this,c));vb(this,"getBounds",
()=>{const [c,k]=this.props.point,[J,da]=this.props.size;return{minX:c,minY:k,maxX:c+J,maxY:k+da,width:J,height:da}});vb(this,"onResizeStart",({isSingle:c})=>{var k;if(!c)return this;this.scale=[...(null!=(k=this.props.scale)?k:[1,1])];return this.update({isSizeLocked:!1})});vb(this,"onResetBounds",()=>{this.update({size:this.getAutoSizedBoundingBox(),isSizeLocked:!0});return this})}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}getAutoSizedBoundingBox(c={}){const {text:k=this.props.text,
fontFamily:J=this.props.fontFamily,fontSize:da=this.props.fontSize,fontWeight:qa=this.props.fontWeight,lineHeight:Ca=this.props.lineHeight,padding:Ia=this.props.padding}=c,[bb,rb]=xg(k,{fontFamily:J,fontSize:da,lineHeight:Ca,fontWeight:qa},Ia);return[bb,rb]}getShapeSVGJsx(){var c=window.navigator.userAgent.toLowerCase();if(c.includes("webkit")&&!c.includes("chrome"))return super.getShapeSVGJsx(null);const {props:{text:k,stroke:J,fontSize:da,fontFamily:qa}}=this;c=this.getBounds();return(0,Jo.jsx)("foreignObject",
{width:c.width,height:c.height,children:(0,Jo.jsx)("div",{style:{color:sf(J,"text"),fontSize:da,fontFamily:qa,display:"contents"},children:k})})}};vb(Kq,"id","text");vb(Kq,"defaultProps",{id:"box",parentId:"page",type:"text",point:[0,0],size:[0,0],isSizeLocked:!0,text:"",lineHeight:1.2,fontSize:20,fontWeight:400,italic:!1,padding:4,fontFamily:"var(--ls-font-family)",borderRadius:0,stroke:"",fill:"",noFill:!0,strokeType:"line",strokeWidth:2,opacity:1});pe([Zg],Kq.prototype,"scaleLevel",1);pe([Ic],
Kq.prototype,"setScaleLevel",2);var py=Uf(ca(22)),Us=ca(602),Vs=class extends $k{constructor(){super(...arguments);vb(this,"canFlip",!1);vb(this,"canEdit",!0);vb(this,"canChangeAspectRatio",!1);vb(this,"ReactComponent",te(({events:c,isErasing:k,asset:J,isEditing:da})=>{const {props:{opacity:qa}}=this,Ca=an();var Ia=Le();const bb=Ia.selectedIds.has(this.id),rb=Ca||bb&&!da||"select"!==Ia.selectedTool.id;Ia=py.useCallback(jc=>{rb||jc.stopPropagation()},[rb]);const {handlers:Pb}=py.useContext(Si);return(0,Us.jsx)(Vl,
gg(tf({style:{overflow:"hidden",pointerEvents:"all",opacity:k?.2:qa}},c),{children:(0,Us.jsx)("div",{onWheelCapture:Ia,onPointerDown:Ia,onPointerUp:Ia,className:"tl-video-container",style:{pointerEvents:Ca||!da&&!bb?"none":"all",overflow:da?"auto":"hidden"},children:J&&(0,Us.jsx)("video",{controls:!0,src:Pb?Pb.makeAssetUrl(J.src):J.src})})}))}));vb(this,"ReactIndicator",te(()=>{const {props:{size:[c,k],isLocked:J}}=this;return(0,Us.jsx)("rect",{width:c,height:k,fill:"transparent",strokeDasharray:J?
"8 2":"undefined"})}))}};vb(Vs,"id","video");vb(Vs,"defaultProps",{id:"video1",parentId:"page",type:"video",point:[0,0],size:[100,100],opacity:1,assetId:"",clipping:0,isAspectRatioLocked:!0});var Lk=ca(602),qy=/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/,ry=class extends $k{constructor(){super(...arguments);vb(this,"aspectRatio",480/853);vb(this,"canChangeAspectRatio",!1);vb(this,"canFlip",!1);vb(this,"canEdit",!0);vb(this,
"onYoutubeLinkChange",c=>{this.update({url:c,size:ry.defaultProps.size})});vb(this,"ReactComponent",te(({events:c,isErasing:k,isEditing:J})=>{const da=Le();return(0,Lk.jsx)(Vl,gg(tf({style:{overflow:"hidden",pointerEvents:"all",opacity:k?.2:1}},c),{children:(0,Lk.jsx)("div",{className:"rounded-lg w-full h-full relative overflow-hidden shadow-xl tl-youtube-container",style:{pointerEvents:J||da.readOnly?"all":"none",userSelect:"none",background:`url('https://img.youtube.com/vi/${this.embedId}/mqdefault.jpg') no-repeat center/cover`},
children:this.embedId?(0,Lk.jsx)("div",{style:{overflow:"hidden",position:"relative",height:"100%"},children:(0,Lk.jsx)("iframe",{className:"absolute inset-0 w-full h-full m-0",width:"853",height:"480",src:`https://www.youtube.com/embed/${this.embedId}`,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,title:"Embedded youtube"})}):(0,Lk.jsx)("div",{className:"w-full h-full flex items-center justify-center p-4",style:{backgroundColor:"var(--ls-primary-background-color)"},
children:(0,Lk.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 502 210.649",height:"210.65",width:"128",children:(0,Lk.jsxs)("g",{children:[(0,Lk.jsx)("path",{d:"M498.333 45.7s-2.91-20.443-11.846-29.447C475.157 4.44 462.452 4.38 456.627 3.687c-41.7-3-104.25-3-104.25-3h-.13s-62.555 0-104.255 3c-5.826.693-18.523.753-29.86 12.566-8.933 9.004-11.84 29.447-11.84 29.447s-2.983 24.003-2.983 48.009v22.507c0 24.006 2.983 48.013 2.983 48.013s2.907 20.44 11.84 29.446c11.337 11.817 26.23 11.44 32.86 12.677 23.84 2.28 101.315 2.983 101.315 2.983s62.62-.094 104.32-3.093c5.824-.694 18.527-.75 29.857-12.567 8.936-9.006 11.846-29.446 11.846-29.446s2.98-24.007 2.98-48.013V93.709c0-24.006-2.98-48.01-2.98-48.01",
fill:"#cd201f"}),(0,Lk.jsx)("g",{children:(0,Lk.jsx)("path",{d:"M187.934 169.537h-18.96V158.56c-7.19 8.24-13.284 12.4-19.927 12.4-5.826 0-9.876-2.747-11.9-7.717-1.23-3.02-2.103-7.736-2.103-14.663V68.744h18.957v81.833c.443 2.796 1.636 3.823 4.043 3.823 3.63 0 6.913-3.153 10.93-8.817V68.744h18.96v100.793zM102.109 139.597c.996 9.98-2.1 14.93-7.987 14.93s-8.98-4.95-7.98-14.93v-39.92c-1-9.98 2.093-14.657 7.98-14.657 5.89 0 8.993 4.677 7.996 14.657l-.01 39.92zm18.96-37.923c0-10.77-2.164-18.86-5.987-23.95-5.054-6.897-12.973-9.72-20.96-9.72-9.033 0-15.913 2.823-20.957 9.72-3.886 5.09-5.97 13.266-5.97 24.036l-.016 35.84c0 10.71 1.853 18.11 5.736 23.153 5.047 6.873 13.227 10.513 21.207 10.513 7.986 0 16.306-3.64 21.36-10.513 3.823-5.043 5.586-12.443 5.586-23.153v-35.926zM46.223 114.647v54.889h-19.96v-54.89S5.582 47.358 1.314 34.815H22.27L36.277 87.38l13.936-52.566H71.17l-24.947 79.833z"})}),
(0,Lk.jsxs)("g",{fill:"#fff",children:[(0,Lk.jsx)("path",{d:"M440.413 96.647c0-9.33 2.557-11.874 8.59-11.874 5.99 0 8.374 2.777 8.374 11.997v10.893l-16.964.02V96.647zm35.96 25.986l-.003-20.4c0-10.656-2.1-18.456-5.88-23.5-5.06-6.823-12.253-10.436-21.317-10.436-9.226 0-16.42 3.613-21.643 10.436-3.84 5.044-6.076 13.28-6.076 23.943v34.927c0 10.596 2.46 18.013 6.296 23.003 5.227 6.813 12.42 10.216 21.87 10.216 9.44 0 16.853-3.566 21.85-10.81 2.2-3.196 3.616-6.82 4.226-10.823.164-1.81.64-5.933.64-11.753v-2.827h-18.96c0 7.247.037 11.557-.133 12.54-1.033 4.834-3.623 7.25-8.07 7.25-6.203 0-8.826-4.636-8.76-13.843v-17.923h35.96zM390.513 140.597c0 9.98-2.353 13.806-7.563 13.806-2.973 0-6.4-1.53-9.423-4.553l.02-60.523c3.02-2.98 6.43-4.55 9.403-4.55 5.21 0 7.563 2.93 7.563 12.91v42.91zm2.104-72.453c-6.647 0-13.253 4.087-19.09 11.27l.02-43.603h-17.963V169.54h17.963l.027-10.05c6.036 7.47 12.62 11.333 19.043 11.333 7.193 0 12.45-3.85 14.863-11.267 1.203-4.226 1.993-10.733 1.993-19.956V99.684c0-9.447-1.21-15.907-2.416-19.917-2.41-7.466-7.247-11.623-14.44-11.623M340.618 169.537h-18.956V158.56c-7.193 8.24-13.283 12.4-19.926 12.4-5.827 0-9.877-2.747-11.9-7.717-1.234-3.02-2.107-7.736-2.107-14.663V69.744h18.96v80.833c.443 2.796 1.633 3.823 4.043 3.823 3.63 0 6.913-3.153 10.93-8.817V69.744h18.957v99.793z"}),
(0,Lk.jsx)("path",{d:"M268.763 169.537h-19.956V54.77h-20.956V35.835l62.869-.024v18.96h-21.957v114.766z"})]})]})})})})}))}));vb(this,"ReactIndicator",te(()=>{const {props:{size:[c,k],isLocked:J}}=this;return(0,Lk.jsx)("rect",{width:c,height:k,fill:"transparent",rx:8,ry:8,strokeDasharray:J?"8 2":"undefined"})}));vb(this,"validateProps",c=>{void 0!==c.size&&(c.size[0]=Math.max(c.size[0],1),c.size[1]=Math.max(c.size[0]*this.aspectRatio,1));return fl(this,c)})}get embedId(){var c,k;const J=this.props.url,
da=J.match(qy);return null!=(k=null!=(c=null==da?void 0:da[1])?c:J)?k:""}getShapeSVGJsx(){const c=this.getBounds(),k=this.embedId;return k?(0,Lk.jsxs)("g",{children:[(0,Lk.jsx)("image",{width:c.width,height:c.height,href:`https://img.youtube.com/vi/${k}/mqdefault.jpg`,className:"grayscale-[50%]"}),(0,Lk.jsx)("svg",{x:c.width/4,y:c.height/4,width:c.width/2,height:c.height/2,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,Lk.jsx)("path",{d:"M4.76447 3.12199C5.63151 3.04859 6.56082 3 7.5 3C8.43918 3 9.36849 3.04859 10.2355 3.12199C11.2796 3.21037 11.9553 3.27008 12.472 3.39203C12.9425 3.50304 13.2048 3.64976 13.4306 3.88086C13.4553 3.90618 13.4902 3.94414 13.5133 3.97092C13.7126 4.20149 13.8435 4.4887 13.918 5.03283C13.9978 5.6156 14 6.37644 14 7.52493C14 8.66026 13.9978 9.41019 13.9181 9.98538C13.8439 10.5206 13.7137 10.8061 13.5125 11.0387C13.4896 11.0651 13.4541 11.1038 13.4296 11.1287C13.2009 11.3625 12.9406 11.5076 12.4818 11.6164C11.9752 11.7365 11.3143 11.7942 10.2878 11.8797C9.41948 11.9521 8.47566 12 7.5 12C6.52434 12 5.58052 11.9521 4.7122 11.8797C3.68572 11.7942 3.02477 11.7365 2.51816 11.6164C2.05936 11.5076 1.7991 11.3625 1.57037 11.1287C1.54593 11.1038 1.51035 11.0651 1.48748 11.0387C1.28628 10.8061 1.15612 10.5206 1.08193 9.98538C1.00221 9.41019 1 8.66026 1 7.52493C1 6.37644 1.00216 5.6156 1.082 5.03283C1.15654 4.4887 1.28744 4.20149 1.48666 3.97092C1.5098 3.94414 1.54468 3.90618 1.56942 3.88086C1.7952 3.64976 2.05752 3.50304 2.52796 3.39203C3.04473 3.27008 3.7204 3.21037 4.76447 3.12199ZM0 7.52493C0 5.28296 0 4.16198 0.729985 3.31713C0.766457 3.27491 0.815139 3.22194 0.854123 3.18204C1.63439 2.38339 2.64963 2.29744 4.68012 2.12555C5.56923 2.05028 6.52724 2 7.5 2C8.47276 2 9.43077 2.05028 10.3199 2.12555C12.3504 2.29744 13.3656 2.38339 14.1459 3.18204C14.1849 3.22194 14.2335 3.27491 14.27 3.31713C15 4.16198 15 5.28296 15 7.52493C15 9.74012 15 10.8477 14.2688 11.6929C14.2326 11.7348 14.1832 11.7885 14.1444 11.8281C13.3629 12.6269 12.3655 12.71 10.3709 12.8763C9.47971 12.9505 8.50782 13 7.5 13C6.49218 13 5.52028 12.9505 4.62915 12.8763C2.63446 12.71 1.63712 12.6269 0.855558 11.8281C0.816844 11.7885 0.767442 11.7348 0.731221 11.6929C0 10.8477 0 9.74012 0 7.52493ZM5.25 5.38264C5.25 5.20225 5.43522 5.08124 5.60041 5.15369L10.428 7.27105C10.6274 7.35853 10.6274 7.64147 10.428 7.72895L5.60041 9.84631C5.43522 9.91876 5.25 9.79775 5.25 9.61736V5.38264Z",
fill:"#D10014",fillRule:"evenodd",clipRule:"evenodd"})})]}):super.getShapeSVGJsx({})}},Jp=ry;vb(Jp,"id","youtube");vb(Jp,"defaultProps",{id:"youtube",type:"youtube",parentId:"page",point:[0,0],size:[853,480],url:""});pe([Zg],Jp.prototype,"embedId",1);pe([Ic],Jp.prototype,"onYoutubeLinkChange",2);var Lq=Uf(ca(22)),Wn=ca(602),sy=/https?:\/\/twitter.com\/[0-9a-zA-Z_]{1,20}\/status\/([0-9]*)/,ty=class extends $k{constructor(){super(...arguments);vb(this,"canFlip",!1);vb(this,"canEdit",!0);vb(this,"initialHeightCalculated",
!0);vb(this,"getInnerHeight",null);vb(this,"onTwitterLinkChange",c=>{this.update({url:c,size:ty.defaultProps.size})});vb(this,"ReactComponent",te(({events:c,isErasing:k,isEditing:J})=>{const {renderers:{Tweet:da}}=Lq.useContext(Si),qa=Le(),Ca=Lq.useRef(null),[,Ia]=this.useComponentSize(Ca);Lq.useEffect(()=>{var bb,rb;const Pb=null!=(rb=null==(bb=this.getInnerHeight)?void 0:bb.call(this))?rb:Ia;Ia&&1<Math.abs(Pb-this.props.size[1])&&(this.update({size:[this.props.size[0],Pb]}),qa.persist(!0))},[Ia]);
Lq.useEffect(()=>{this.initialHeightCalculated||setTimeout(()=>{this.onResetBounds();qa.persist(!0)})},[this.initialHeightCalculated]);return(0,Wn.jsx)(Vl,gg(tf({style:{overflow:"hidden",pointerEvents:"all",opacity:k?.2:1}},c),{children:(0,Wn.jsx)("div",{className:"rounded-xl w-full h-full relative shadow-xl tl-tweet-container",style:{pointerEvents:J||qa.readOnly?"all":"none",userSelect:"none"},children:this.embedId?(0,Wn.jsx)("div",{ref:Ca,children:(0,Wn.jsx)(da,{tweetId:this.embedId})}):null})}))}));
vb(this,"ReactIndicator",te(()=>{const {props:{size:[c,k],isLocked:J}}=this;return(0,Wn.jsx)("rect",{width:c,height:k,fill:"transparent",rx:8,ry:8,strokeDasharray:J?"8 2":"undefined"})}));vb(this,"onResetBounds",c=>{c=this.getAutoResizeHeight();null!==c&&1<Math.abs(c-this.props.size[1])&&(this.update({size:[this.props.size[0],c]}),this.initialHeightCalculated=!0);return this});vb(this,"onResize",(c,k)=>{var J;const {bounds:da,rotation:qa,scale:[Ca,Ia]}=k;c=[...this.scale];0>Ca&&(c[0]*=-1);0>Ia&&(c[1]*=
-1);k=null!=(J=this.getAutoResizeHeight())?J:da.height;return this.update({point:[da.minX,da.minY],size:[Math.max(1,da.width),Math.max(1,k)],scale:c,rotation:qa})});vb(this,"validateProps",c=>{void 0!==c.size&&(c.size[0]=Math.min(Math.max(c.size[0],300),550),c.size[1]=Math.max(c.size[1],1));return fl(this,c)})}get embedId(){var c,k;const J=this.props.url,da=J.match(sy);return null!=(k=null!=(c=null==da?void 0:da[1])?c:J)?k:""}useComponentSize(c,k=""){const [J,da]=Lq.useState([0,0]),qa=Le();Lq.useEffect(()=>
{if(null==c?0:c.current){const Ca=k?c.current.querySelector(k):c.current;if(Ca){const Ia=()=>{const {width:rb,height:Pb}=Ca.getBoundingClientRect(),jc=Rd.div([rb,Pb],qa.viewport.camera.zoom);da(jc);return jc};Ia();this.getInnerHeight=()=>Ia()[1];const bb=new ResizeObserver(()=>{Ia()});bb.observe(Ca);return()=>{bb.disconnect()}}}return()=>{}},[c,k]);return J}getAutoResizeHeight(){return this.getInnerHeight?this.getInnerHeight():null}getShapeSVGJsx(){const c=this.getBounds();return this.embedId?(0,Wn.jsxs)("g",
{children:[(0,Wn.jsx)("rect",{width:c.width,height:c.height,fill:"#15202b",rx:8,ry:8}),(0,Wn.jsx)("svg",{x:c.width/4,y:c.height/4,width:c.width/2,height:c.height/2,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,Wn.jsx)("path",{d:"m13.464 4.4401c0.0091 0.13224 0.0091 0.26447 0.0091 0.39793 0 4.0664-3.0957 8.7562-8.7562 8.7562v-0.0024c-1.6721 0.0024-3.3095-0.47658-4.7172-1.3797 0.24314 0.02925 0.48751 0.04387 0.73248 0.04448 1.3857 0.0013 2.7319-0.46374 3.8221-1.3199-1.3169-0.024981-2.4717-0.8836-2.8751-2.1371 0.4613 0.08897 0.93662 0.070688 1.3894-0.053016-1.4357-0.29007-2.4686-1.5515-2.4686-3.0165v-0.039001c0.42779 0.23827 0.90676 0.37051 1.3967 0.38513-1.3522-0.90372-1.769-2.7026-0.95247-4.1091 1.5625 1.9226 3.8678 3.0914 6.3425 3.2151-0.24802-1.0689 0.090798-2.1889 0.89031-2.9403 1.2395-1.1651 3.1889-1.1054 4.3541 0.13346 0.68921-0.13589 1.3498-0.38879 1.9543-0.74711-0.22974 0.71237-0.71054 1.3175-1.3528 1.702 0.60999-0.071907 1.206-0.23522 1.7672-0.48446-0.41316 0.61913-0.93358 1.1584-1.5356 1.5942z",
fill:"#1d9bf0",fillRule:"evenodd",clipRule:"evenodd"})})]}):super.getShapeSVGJsx({})}},Mq=ty;vb(Mq,"id","tweet");vb(Mq,"defaultProps",{id:"tweet",type:"tweet",parentId:"page",point:[0,0],size:[331,290],url:""});pe([Zg],Mq.prototype,"embedId",1);pe([Ic],Mq.prototype,"onTwitterLinkChange",2);var Qu=Uf(ca(22)),Ru=ca(602),Mr=class extends $k{constructor(){super(...arguments);vb(this,"frameRef",Qu.createRef());vb(this,"canChangeAspectRatio",!0);vb(this,"canFlip",!0);vb(this,"canEdit",!0);vb(this,"ReactComponent",
te(({events:c,asset:k,isErasing:J,isEditing:da})=>{Qu.useRef(null);const {handlers:qa}=Qu.useContext(Si);Le();const Ca=an();return(0,Ru.jsx)(Vl,gg(tf({style:{overflow:"hidden",pointerEvents:"all",opacity:J?.2:1}},c),{children:k?(0,Ru.jsx)("embed",{src:qa?qa.inflateAsset(k.src).url:k.src,className:"relative tl-pdf-container",onWheelCapture:stop,onPointerDown:stop,onPointerUp:stop,style:{width:"100%",height:"100%",pointerEvents:!Ca&&da?"all":"none"}}):null}))}));vb(this,"ReactIndicator",te(()=>{const {props:{size:[c,
k],isLocked:J}}=this;return(0,Ru.jsx)("rect",{width:c,height:k,fill:"transparent",rx:8,ry:8,strokeDasharray:J?"8 2":"undefined"})}))}};vb(Mr,"id","pdf");vb(Mr,"defaultProps",{id:"pdf",type:"pdf",parentId:"page",point:[0,0],size:[595,842],assetId:""});ca(602);var uy=[Dq,Eq,Gp,Ss,Vs,Hq,Ip,Jq,Kq,Jp,Mq,Hp,Io,Mr,Yj,Ku],Su=class extends Tn{constructor(){super(...arguments);vb(this,"Shape",Dq)}};vb(Su,"id","box");vb(Su,"shortcut","whiteboard/rectangle");var Tu=class extends Tn{constructor(){super(...arguments);
vb(this,"Shape",Eq)}};vb(Tu,"id","ellipse");vb(Tu,"shortcut","whiteboard/ellipse");var Yl=class extends ts{};vb(Yl,"id","erase");vb(Yl,"shortcut","whiteboard/eraser");var Uu=class extends wr{constructor(){super(...arguments);vb(this,"Shape",Gp);vb(this,"simplify",!0);vb(this,"simplifyTolerance",.618)}};vb(Uu,"id","highlighter");vb(Uu,"shortcut","whiteboard/highlighter");var Vu=class extends us{constructor(){super(...arguments);vb(this,"Shape",Hq)}};vb(Vu,"id","line");vb(Vu,"shortcut","whiteboard/connector");
var Wu=class extends wr{constructor(){super(...arguments);vb(this,"Shape",Ip);vb(this,"simplify",!1)}};vb(Wu,"id","pencil");vb(Wu,"shortcut","whiteboard/pencil");var Xu=class extends Tn{constructor(){super(...arguments);vb(this,"Shape",Jq)}};vb(Xu,"id","polygon");var Ek=class extends vs{constructor(){super(...arguments);vb(this,"Shape",Kq)}};vb(Ek,"id","text");vb(Ek,"shortcut","whiteboard/text");var Fl=class extends Tn{constructor(){super(...arguments);vb(this,"Shape",Jp)}};vb(Fl,"id","youtube");
var hs=class extends zi{constructor(){super(...arguments);vb(this,"creatingShape");vb(this,"offset",[0,0]);vb(this,"onEnter",()=>{this.app.history.pause();Tb(()=>{var c=Rd.sub(this.app.inputs.originPoint,this.offset);this.app.settings.snapToGrid&&(c=Rd.snap(c,8));this.creatingShape=c=new Yj({id:Ff(),parentId:this.app.currentPage.id,point:c,size:Yj.defaultProps.size,fill:this.app.settings.color,stroke:this.app.settings.color});this.app.currentPage.addShapes(c);this.app.setEditingShape(c);this.app.setSelectedShapes([c])})});
vb(this,"onPointerDown",c=>{switch(c.type){case "shape":if(c.shape===this.creatingShape)break;this.app.selectTool("select");break;case "canvas":c.order||this.app.selectTool("select")}});vb(this,"onExit",()=>{var c;this.creatingShape&&(this.app.history.resume(),(null==(c=this.creatingShape)?0:c.props.pageId)?this.app.setSelectedShapes([this.creatingShape.id]):(this.app.deleteShapes([this.creatingShape.id]),this.app.setEditingShape()),this.creatingShape=void 0)})}};vb(hs,"id","creating");var Sv=class extends zi{constructor(){super(...arguments);
vb(this,"cursor","crosshair");vb(this,"onPointerDown",c=>{this.tool.transition("creating")})}};vb(Sv,"id","idle");var mr=class extends yo{constructor(){super(...arguments);vb(this,"Shape",Yj);vb(this,"onPinch",c=>{this.app.viewport.pinchZoom(c.point,c.delta,c.delta[2])})}};vb(mr,"id","logseq-portal");vb(mr,"shortcut","whiteboard/portal");vb(mr,"states",[Sv,hs]);vb(mr,"initial","idle");var Bt=class extends Tn{constructor(){super(...arguments);vb(this,"Shape",Io)}};vb(Bt,"id","youtube");var Tv=class extends Tn{constructor(){super(...arguments);
vb(this,"Shape",Hp)}};vb(Tv,"id","iframe");var Tp=Uf(ca(605)),ul=ca(602),eD=new Map(uy.map(c=>[c.id,c])),Ws=class{constructor(c){vb(this,"shapes");vb(this,"pageId");vb(this,"assets");c&&this.load(c)}load(c){var k;const J=null==(k=null==c?void 0:c.pages)?void 0:k[0];this.pageId=null==J?void 0:J.id;this.assets=c.assets;this.shapes=null==J?void 0:J.shapes.map(da=>{var qa=da.type;if(!qa)throw Error("No shape type provided.");const Ca=eD.get(qa);if(!Ca)throw Error(`Could not find shape class for ${qa}`);
return new Ca(da)}).filter(da=>"group"!==da.type)}generatePreviewJsx(c,k){var J,da;const qa=[...(null!=(J=this.shapes)?J:[]).map(Pb=>Pb.getRotatedBounds())];(J=null==c?void 0:c.currentView)&&qa.push(J);let Ca=Xe.getCommonBounds(qa);if(!Ca)return null;Ca=Xe.expandBounds(Ca,16);Ca=k?Xe.ensureRatio(Ca,k):Ca;const Ia=Pb=>[(Pb[0]-Ca.minX).toFixed(2),(Pb[1]-Ca.minY).toFixed(2)],[bb,rb]=J?Ia([J.minX,J.minY]):[0,0];return Ca&&(0,ul.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg","data-common-bound-x":Ca.minX.toFixed(2),
"data-common-bound-y":Ca.minY.toFixed(2),"data-common-bound-width":Ca.width.toFixed(2),"data-common-bound-height":Ca.height.toFixed(2),viewBox:[0,0,Ca.width,Ca.height].join(" "),children:[(0,ul.jsx)("defs",{children:J&&(0,ul.jsxs)(ul.Fragment,{children:[(0,ul.jsx)("rect",{id:this.pageId+"-camera-rect",transform:`translate(${bb}, ${rb})`,width:J.width,height:J.height}),(0,ul.jsxs)("mask",{id:this.pageId+"-camera-mask",children:[(0,ul.jsx)("rect",{width:Ca.width,height:Ca.height,fill:"white"}),(0,ul.jsx)("use",
{href:`#${this.pageId}-camera-rect`,fill:"black"})]})]})}),(0,ul.jsx)("g",{id:this.pageId+"-preview-shapes",children:null==(da=this.shapes)?void 0:da.map(Pb=>{var jc,yc;const {bounds:Rc,props:{rotation:jd}}=Pb,[fd,xd]=Ia([Rc.minX,Rc.minY]),Fd=+(180*((null!=jd?jd:0)+(null!=(jc=Rc.rotation)?jc:0))/Math.PI).toFixed(2),[Xc,id]=[(Rc.width/2).toFixed(2),(Rc.height/2).toFixed(2)];return(0,ul.jsx)("g",{transform:[`translate(${fd}, ${xd})`,`rotate(${Fd}, ${Xc}, ${id})`].join(" "),children:Pb.getShapeSVGJsx({assets:null!=
(yc=this.assets)?yc:[]})},Pb.id)})}),(0,ul.jsx)("rect",{mask:J?`url(#${this.pageId}-camera-mask)`:"",width:Ca.width,height:Ca.height,fill:"transparent"}),J&&(0,ul.jsx)("use",{id:"minimap-camera-rect","data-x":bb,"data-y":rb,"data-width":J.width,"data-height":J.height,href:`#${this.pageId}-camera-rect`,fill:"transparent",stroke:"red",strokeWidth:4/c.camera.zoom})]})}exportAsSVG(c){return(c=this.generatePreviewJsx(void 0,c))?Tp.default.renderToString(c):""}},vy=Uf(ca(22)),Nr=ca(602),Or=vy.forwardRef((c,
k)=>{var {value:J,className:da}=c;c=hj(c,["autoResize","value","className"]);return(0,Nr.jsx)("div",{className:"tl-input"+(da?" "+da:""),children:(0,Nr.jsxs)("div",{className:"tl-input-sizer",children:[(0,Nr.jsx)("div",{className:"tl-input-hidden",children:J}),(0,Nr.jsx)("input",tf({ref:k,value:J,className:"tl-text-input",type:"text"},c))]})})}),bi=ca(602),Im=({type:c,active:k})=>(0,bi.jsx)("span",{className:"tl-type-tag","data-active":k,children:(0,bi.jsx)("i",{className:`tie tie-${({B:"block",P:"page",
WP:"whiteboard",BA:"new-block",PA:"new-page",WA:"new-whiteboard",BS:"block-search",PS:"page-search"})[c]}`})}),Ct=(c,k)=>(0,bi.jsx)("span",{children:c.split(new RegExp(`(${k.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$\x26")})`,"gi")).map((J,da)=>1===da%2?(0,bi.jsx)("mark",{className:"tl-highlighted",children:J}):J).map((J,da)=>(0,bi.jsx)(Kk.default.Fragment,{children:J},da))}),Uv=(c,k)=>{const {handlers:J}=Kk.default.useContext(Si),[da,qa]=Kk.default.useState(null),Ca=Me(c,200);Kk.default.useEffect(()=>
{let Ia=!1;if(0<Ca.length){const bb={"pages?":!0,"blocks?":!0,"files?":!1};"B"===k?bb["pages?"]=!1:"P"===k&&(bb["blocks?"]=!1);J.search(Ca,bb).then(rb=>{Ia||qa(rb)})}else qa(null);return()=>{Ia=!0}},[Ca,null==J?void 0:J.search]);return da},wy=te(({className:c,style:k,placeholder:J,onChange:da,onBlur:qa,onAddBlock:Ca})=>{const [Ia,bb]=Kk.default.useState(Yj.defaultSearchQuery),[rb,Pb]=Kk.default.useState(Yj.defaultSearchFilter),jc=Kk.default.useRef(null),{handlers:yc,renderers:Rc}=Kk.default.useContext(Si),
jd=yc.t,fd=Kk.default.useCallback(af=>{var Sf;setTimeout(()=>da(af));null==(Sf=jc.current)?void 0:Sf.blur();af&&(Yj.defaultSearchQuery="",Yj.defaultSearchFilter=null)},[]),xd=Kk.default.useCallback(af=>z(void 0,null,function*(){const Sf=yield null==yc?void 0:yc.addNewBlock(af);Sf&&(fd(Sf),null==Ca?void 0:Ca(Sf));return Sf}),[Ca]),Fd=Kk.default.useRef(null),[Xc,id]=Kk.default.useState(0),nd=Uv(Ia,rb),[Gd,wd]=Kk.default.useState("circle-plus"),[Ge,Je]=Kk.default.useState(!1);Kk.default.useEffect(()=>
{setTimeout(()=>{var af;null==(af=jc.current)?void 0:af.focus()})},[rb]);Kk.default.useEffect(()=>{Yj.defaultSearchQuery=Ia;Yj.defaultSearchFilter=rb},[Ia,rb]);const ag=Kk.default.useMemo(()=>{var af;const Sf=[],Bh=null==Rc?void 0:Rc.Breadcrumb;if(!Bh||!yc)return[];Ca&&Sf.push({actionIcon:"circle-plus",onChosen:()=>!!xd(Ia),element:(0,bi.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,bi.jsx)(Im,{active:!0,type:"BA"}),0<Ia.length?(0,bi.jsxs)(bi.Fragment,{children:[(0,bi.jsx)("strong",
{children:jd("whiteboard/new-block")}),Ia]}):(0,bi.jsx)("strong",{children:jd("whiteboard/new-block-no-colon")})]})});(null==(af=null==nd?void 0:nd.pages)?0:af.some(Tg=>Tg.toLowerCase()===Ia.toLowerCase()))||!Ia||Sf.push({actionIcon:"circle-plus",onChosen:()=>{fd(Ia);return!0},element:(0,bi.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,bi.jsx)(Im,{active:!0,type:"PA"}),(0,bi.jsx)("strong",{children:jd("whiteboard/new-page")}),Ia]})},{actionIcon:"circle-plus",onChosen:()=>z(void 0,
null,function*(){yield null==yc?void 0:yc.addNewWhiteboard(Ia);fd(Ia);return!0}),element:(0,bi.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,bi.jsx)(Im,{active:!0,type:"WA"}),(0,bi.jsx)("strong",{children:jd("whiteboard/new-whiteboard")}),Ia]})});0===Ia.length&&null===rb&&Sf.push({actionIcon:"search",onChosen:()=>{Pb("B");return!0},element:(0,bi.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,bi.jsx)(Im,{type:"BS"}),jd("whiteboard/search-only-blocks")]})},{actionIcon:"search",
onChosen:()=>{Pb("P");return!0},element:(0,bi.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,bi.jsx)(Im,{type:"PS"}),jd("whiteboard/search-only-pages")]})});rb&&"P"!==rb||!nd||!nd.pages||Sf.push(...nd.pages.map(Tg=>({actionIcon:"search",onChosen:()=>{fd(Tg);return!0},element:(0,bi.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,bi.jsx)(Im,{type:yc.isWhiteboardPage(Tg)?"WP":"P"}),Ct(Tg,Ia)]})})));rb&&"B"!==rb||!nd||!nd.blocks||Sf.push(...nd.blocks.filter(Tg=>Tg.content&&
Tg.uuid).map(({content:Tg,uuid:zg})=>{const dh=yc.queryBlockByUUID(zg);return{actionIcon:"search",onChosen:()=>{var uf,Af,rf;return dh?(fd(zg),null==(rf=null==(Af=null==(uf=window.logseq)?void 0:uf.api)?void 0:Af.set_blocks_id)?void 0:rf.call(Af,[zg]),!0):!1},element:dh?(0,bi.jsxs)(bi.Fragment,{children:[(0,bi.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,bi.jsx)(Im,{type:"B"}),(0,bi.jsx)("div",{className:"tl-quick-search-option-breadcrumb",children:(0,bi.jsx)(Bh,{blockId:zg})})]}),
(0,bi.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,bi.jsx)("div",{className:"tl-quick-search-option-placeholder"}),Ct(Tg,Ia)]})]}):(0,bi.jsx)("div",{className:"tl-quick-search-option-row",children:jd("whiteboard/cache-outdated")})}}));return Sf},[Ia,rb,nd,null==Rc?void 0:Rc.Breadcrumb,yc]);Kk.default.useEffect(()=>{const af=Sf=>{var Bh,Tg;let zg=Xc;"ArrowDown"===Sf.key?zg=Math.min(ag.length-1,Xc+1):"ArrowUp"===Sf.key?zg=Math.max(0,Xc-1):"Enter"===Sf.key?(null==(Bh=ag[Xc])?void 0:
Bh.onChosen(),Sf.stopPropagation(),Sf.preventDefault()):"Backspace"===Sf.key&&0===Ia.length?Pb(null):"Escape"===Sf.key&&fd("");zg!==Xc&&(Bh=ag[zg],id(zg),wd(Bh.actionIcon),Sf.stopPropagation(),Sf.preventDefault(),(Sf=null==(Tg=Fd.current)?void 0:Tg.querySelector(".tl-quick-search-option:nth-child("+(zg+1)+")"))&&(null==Sf?void 0:Sf.scrollIntoViewIfNeeded(!1)))};document.addEventListener("keydown",af,!0);return()=>{document.removeEventListener("keydown",af,!0)}},[ag,Xc,Ia]);return(0,bi.jsxs)("div",
{className:"tl-quick-search "+(null!=c?c:""),style:k,children:[(0,bi.jsx)(qB,{icon:Gd,onClick:()=>{var af;null==(af=ag[Xc])?void 0:af.onChosen()}}),(0,bi.jsxs)("div",{className:"tl-quick-search-input-container",children:[rb&&(0,bi.jsxs)("div",{className:"tl-quick-search-input-filter",children:[(0,bi.jsx)(Im,{type:rb}),"B"===rb?"Search blocks":"Search pages",(0,bi.jsx)("div",{className:"tl-quick-search-input-filter-remove",onClick:()=>Pb(null),children:(0,bi.jsx)(mh,{name:"x"})})]}),(0,bi.jsx)(Or,
{ref:jc,type:"text",value:Ia,className:"tl-quick-search-input",placeholder:null!=J?J:"Create or search your graph...",onChange:af=>bb(af.target.value),onKeyDown:af=>{"Enter"===af.key&&fd(Ia);af.stopPropagation()},onFocus:()=>{Je(!0)},onBlur:()=>{Je(!1);null==qa?void 0:qa()}})]}),0<ag.length&&(0,bi.jsx)("div",{onWheelCapture:af=>af.stopPropagation(),className:"tl-quick-search-options",ref:Fd,style:{visibility:Ge?"visible":"hidden",pointerEvents:Ge?"all":"none"},children:(0,bi.jsx)(oC,{style:{height:40*
Math.min(Math.max(1,ag.length),12)},totalCount:ag.length,itemContent:af=>{const {actionIcon:Sf,onChosen:Bh,element:Tg}=ag[af];return(0,bi.jsx)("div",{"data-focused":af===Xc,className:"tl-quick-search-option",tabIndex:0,onMouseEnter:()=>{wd(Sf);id(af)},onPointerDownCapture:zg=>{Bh()&&(zg.stopPropagation(),zg.preventDefault())},children:Tg},af)}})})]})}),yj=ca(602),fD=te(function(c){var {pageId:k,portalType:J,refs:da,side:qa,onRefsChange:Ca}=c;c=hj(c,"pageId portalType shapeType refs side onRefsChange".split(" "));
const {handlers:{t:Ia}}=Sx.default.useContext(Si),bb=da.length+(k?1:0),rb=0===da.length,Pb=yc=>{yc&&!da.includes(yc)&&rb&&Ca([...da,yc])},jc=!(!k||!J);return(0,yj.jsx)(Rk,gg(tf({},c),{side:qa,align:"start",alignOffset:-6,label:(0,yj.jsx)(Uh,{content:Ia("whiteboard/link"),sideOffset:14,children:(0,yj.jsxs)("div",{className:"flex gap-1 relative items-center justify-center px-1",children:[(0,yj.jsx)(mh,{name:0<bb?"link":"add-link"}),0<bb&&(0,yj.jsx)("div",{className:"tl-shape-links-count",children:bb})]})}),
children:(0,yj.jsxs)("div",{className:"color-level rounded-lg","data-show-reference-panel":jc,children:[jc&&(0,yj.jsxs)("div",{className:"tl-shape-links-reference-panel",children:[(0,yj.jsxs)("div",{className:"text-base inline-flex gap-1 items-center",children:[(0,yj.jsx)(mh,{className:"opacity-50",name:"internal-link"}),Ia("whiteboard/references")]}),(0,yj.jsx)(Jk,{type:J,id:k})]}),(0,yj.jsxs)("div",{className:"tl-shape-links-panel color-level",children:[(0,yj.jsxs)("div",{className:"text-base inline-flex gap-1 items-center",
children:[(0,yj.jsx)(mh,{className:"opacity-50",name:"add-link"}),Ia("whiteboard/link-to-any-page-or-block")]}),rb&&(0,yj.jsx)(wy,{style:{width:"calc(100% - 46px)",marginLeft:"46px"},placeholder:Ia("whiteboard/start-typing-to-search"),onChange:Pb}),0<da.length&&(0,yj.jsx)("div",{className:"flex flex-col items-stretch gap-2",children:da.map((yc,Rc)=>(0,yj.jsx)(Jk,{id:yc,type:sg(yc)?"B":"P",onRemove:()=>{Ca(da.filter((jd,fd)=>Rc!==fd))},showContent:!0},yc))})]})]})}))}),Xn=ca(602),Nq=window.LSUI,gh=
ca(602),vm="EditPdf LogseqPortalViewMode Geometry AutoResizing Swatch NoFill StrokeType ScaleLevel TextStyle YoutubeLink TwitterLink IFrameSource ArrowMode Links".split(" "),Zj=["YoutubeLink","TwitterLink","IFrameSource","Links","EditPdf"],fk=new Map,pk={"logseq-portal":["Swatch","LogseqPortalViewMode","ScaleLevel","AutoResizing","Links"],youtube:["YoutubeLink","Links"],tweet:["TwitterLink","Links"],iframe:["IFrameSource","Links"],box:"Geometry TextStyle Swatch ScaleLevel NoFill StrokeType Links".split(" "),
ellipse:"Geometry TextStyle Swatch ScaleLevel NoFill StrokeType Links".split(" "),polygon:"Geometry TextStyle Swatch ScaleLevel NoFill StrokeType Links".split(" "),line:["TextStyle","Swatch","ScaleLevel","ArrowMode","Links"],pencil:["Swatch","Links","ScaleLevel"],highlighter:["Swatch","Links","ScaleLevel"],text:["TextStyle","Swatch","ScaleLevel","AutoResizing","Links"],html:["ScaleLevel","AutoResizing","Links"],image:["Links"],video:["Links"],pdf:["EditPdf","Links"]},Zl=Object.entries(pk).filter(([,
c])=>c.includes("NoFill")&&c.includes("Swatch")).map(([c])=>c),Ti=te(()=>{const c=Le(),{handlers:{t:k}}=Ak.default.useContext(Si),J=Wk("AutoResizing"),da=J.every(qa=>qa.props.isAutoResizing);return(0,gh.jsx)(Ig,{tooltip:k("whiteboard/auto-resize"),toggle:J.every(qa=>"logseq-portal"===qa.props.type),className:"tl-button",pressed:da,onPressedChange:qa=>{J.forEach(Ca=>{if("logseq-portal"===Ca.props.type)Ca.update({isAutoResizing:qa});else Ca.onResetBounds({zoom:c.viewport.camera.zoom})});c.persist()},
children:(0,gh.jsx)(mh,{name:"dimensions"})})}),xy=te(()=>{const c=Le();var {handlers:{t:k}}=Ak.default.useContext(Si);const J=Wk("LogseqPortalViewMode"),da=J.every(qa=>qa.collapsed);if(!da&&!J.every(qa=>!qa.collapsed))return null;k=(0,gh.jsxs)("div",{className:"flex",children:[da?k("whiteboard/expand"):k("whiteboard/collapse"),(0,gh.jsx)(yk,{action:da?"editor/expand-block-children":"editor/collapse-block-children"})]});return(0,gh.jsx)(Ig,{tooltip:k,toggle:J.every(qa=>"logseq-portal"===qa.props.type),
className:"tl-button",pressed:da,onPressedChange:()=>c.api.setCollapsed(!da),children:(0,gh.jsx)(mh,{name:da?"object-expanded":"object-compact"})})}),Xs=te(()=>{const {handlers:{isMobile:c}}=Ak.default.useContext(Si);var k=Wk("ScaleLevel");k=1<(new Set(k.map(J=>J.scaleLevel))).size?"":k[0].scaleLevel;return(0,gh.jsx)(Qg,{scaleLevel:k,compact:c()})}),Ys=te(()=>{const c=Le(),{handlers:{t:k}}=Ak.default.useContext(Si),J=Wk("IFrameSource")[0],da=Ak.default.useCallback(Ca=>{J.onIFrameSourceChange(Ca.target.value.trim().toLowerCase());
c.persist()},[]),qa=Ak.default.useCallback(()=>{J.reload()},[]);return(0,gh.jsxs)("span",{className:"flex gap-3",children:[(0,gh.jsx)(ei,{tooltip:k("whiteboard/reload"),type:"button",onClick:qa,children:(0,gh.jsx)(mh,{name:"refresh"})}),(0,gh.jsx)(Or,{title:k("whiteboard/website-url"),className:"tl-iframe-src",value:`${J.props.url}`,onChange:da}),(0,gh.jsx)(ei,{tooltip:k("whiteboard/open-website-url"),type:"button",onClick:()=>window.open(J.props.url),children:(0,gh.jsx)(mh,{name:"external-link"})})]})}),
Yu=te(()=>{const c=Le(),{handlers:{t:k}}=Ak.default.useContext(Si),J=Wk("YoutubeLink")[0],da=Ak.default.useCallback(qa=>{J.onYoutubeLinkChange(qa.target.value);c.persist()},[]);return(0,gh.jsxs)("span",{className:"flex gap-3",children:[(0,gh.jsx)(Or,{title:k("whiteboard/youtube-url"),className:"tl-youtube-link",value:`${J.props.url}`,onChange:da}),(0,gh.jsx)(ei,{tooltip:k("whiteboard/open-youtube-url"),type:"button",onClick:()=>{var qa,Ca,Ia;return null==(Ia=null==(Ca=null==(qa=window.logseq)?void 0:
qa.api)?void 0:Ca.open_external_link)?void 0:Ia.call(Ca,J.props.url)},children:(0,gh.jsx)(mh,{name:"external-link"})})]})}),yy=te(()=>{const c=Le(),{handlers:{t:k}}=Ak.default.useContext(Si),J=Wk("TwitterLink")[0],da=Ak.default.useCallback(qa=>{J.onTwitterLinkChange(qa.target.value);c.persist()},[]);return(0,gh.jsxs)("span",{className:"flex gap-3",children:[(0,gh.jsx)(Or,{title:k("whiteboard/twitter-url"),className:"tl-twitter-link",value:`${J.props.url}`,onChange:da}),(0,gh.jsx)(ei,{tooltip:k("whiteboard/open-twitter-url"),
type:"button",onClick:()=>{var qa,Ca,Ia;return null==(Ia=null==(Ca=null==(qa=window.logseq)?void 0:qa.api)?void 0:Ca.open_external_link)?void 0:Ia.call(Ca,J.props.url)},children:(0,gh.jsx)(mh,{name:"external-link"})})]})}),Zu=te(()=>{const c=Le(),{handlers:{t:k,setCurrentPdf:J}}=Ak.default.useContext(Si),da=c.selectedShapesArray[0];return(0,gh.jsx)(ei,{tooltip:k("whiteboard/edit-pdf"),type:"button",onClick:()=>J(c.assets[da.props.assetId].src),children:(0,gh.jsx)(mh,{name:"edit"})})}),Ui=te(()=>{const c=
Le(),{handlers:{t:k}}=Ak.default.useContext(Si);var J=Wk("NoFill");const da=Ak.default.useCallback(qa=>{c.selectedShapesArray.forEach(Ca=>Ca.update({noFill:qa}));c.persist()},[]);J=J.every(qa=>qa.props.noFill);return(0,gh.jsx)(Ig,{tooltip:k("whiteboard/fill"),className:"tl-button",pressed:J,onPressedChange:da,children:(0,gh.jsx)(mh,{name:J?"droplet-off":"droplet"})})}),$u=te(()=>{const c=Le(),k=Wk("Swatch"),J=Ak.default.useCallback(qa=>{c.selectedShapesArray.forEach(Ca=>{Ca.update({fill:qa,stroke:qa})});
c.persist()},[]),da=Ak.default.useCallback(qa=>{c.selectedShapesArray.forEach(Ca=>{Ca.update({opacity:qa})});c.persist()},[]);return(0,gh.jsx)(Wi,{popoverSide:"top",color:k[0].props.noFill?k[0].props.stroke:k[0].props.fill,opacity:k[0].props.opacity,setOpacity:da,setColor:J})}),av=te(()=>{const c=Le(),k=Ak.default.useCallback(J=>{c.api.convertShapes(J.currentTarget.dataset.tool)},[]);return(0,gh.jsx)(Px,{popoverSide:"top",chevron:!1,setGeometry:k})}),bv=te(()=>{const c=Le(),{handlers:{t:k}}=Ak.default.useContext(Si),
J=Wk("StrokeType"),da=J.every(qa=>"dashed"===qa.props.strokeType)?"dashed":J.every(qa=>"line"===qa.props.strokeType)?"line":"mixed";return(0,gh.jsx)(Mi,{title:k("whiteboard/stroke-type"),options:[{value:"line",icon:"circle",tooltip:"Solid"},{value:"dashed",icon:"circle-dashed",tooltip:"Dashed"}],value:da,onValueChange:qa=>{J.forEach(Ca=>{Ca.update({strokeType:qa})});c.persist()}})}),Oq=te(()=>{const c=Le(),{handlers:{t:k}}=Ak.default.useContext(Si),J=Wk("ArrowMode");var da=J.every(Ca=>{var Ia;return"arrow"===
(null==(Ia=Ca.props.decorations)?void 0:Ia.start)});const qa=J.every(Ca=>{var Ia;return"arrow"===(null==(Ia=Ca.props.decorations)?void 0:Ia.end)});da=[da?"start":null,qa?"end":null].filter(Fc);return(0,gh.jsx)(Mn,{title:k("whiteboard/arrow-head"),options:[{value:"start",icon:"arrow-narrow-left"},{value:"end",icon:"arrow-narrow-right"}],value:da,onValueChange:Ca=>{J.forEach(Ia=>{var bb=Ia.update;var rb={start:Ca.includes("start")?"arrow":null,end:Ca.includes("end")?"arrow":null};bb.call(Ia,{decorations:rb})});
c.persist()}})}),zy=te(()=>{const c=Le(),{handlers:{t:k}}=Ak.default.useContext(Si),J=Wk("TextStyle"),da=J.every(Ca=>500<Ca.props.fontWeight),qa=J.every(Ca=>Ca.props.italic);return(0,gh.jsxs)("span",{className:"flex gap-1",children:[(0,gh.jsx)(Ig,{tooltip:k("whiteboard/bold"),className:"tl-button",pressed:da,onPressedChange:Ca=>{J.forEach(Ia=>{Ia.update({fontWeight:Ca?700:400});Ia.onResetBounds()});c.persist()},children:(0,gh.jsx)(mh,{name:"bold"})}),(0,gh.jsx)(Ig,{tooltip:k("whiteboard/italic"),
className:"tl-button",pressed:qa,onPressedChange:Ca=>{J.forEach(Ia=>{Ia.update({italic:Ca});Ia.onResetBounds()});c.persist()},children:(0,gh.jsx)(mh,{name:"italic"})})]})}),Kp=te(()=>{var c;const k=Le(),J=k.selectedShapesArray[0];return(0,gh.jsx)(fD,{onRefsChange:da=>{J.update({refs:da});k.persist()},refs:null!=(c=J.props.refs)?c:[],shapeType:J.props.type,side:"right",pageId:"logseq-portal"===J.props.type?J.props.pageId:void 0,portalType:"logseq-portal"===J.props.type?J.props.blockType:void 0})});
fk.set("Geometry",av);fk.set("AutoResizing",Ti);fk.set("LogseqPortalViewMode",xy);fk.set("ScaleLevel",Xs);fk.set("YoutubeLink",Yu);fk.set("TwitterLink",yy);fk.set("IFrameSource",Ys);fk.set("NoFill",Ui);fk.set("Swatch",$u);fk.set("StrokeType",bv);fk.set("ArrowMode",Oq);fk.set("TextStyle",zy);fk.set("Links",Kp);fk.set("EditPdf",Zu);var Ay=c=>{var k;return(null!=(k=pk[c])?k:[]).filter(Fc)},Zs=c=>{const k=c.map(da=>da.props.type),J=new Set(0<c.length?Ay(k[0]):[]);for(let da=1;da<k.length&&0<J.size;da++){const qa=
Ay(k[da]);J.forEach(Ca=>{qa.includes(Ca)||J.delete(Ca)})}1<c.length&&Zj.forEach(da=>{J.has(da)&&J.delete(da)});return Array.from(J).sort((da,qa)=>vm.indexOf(da)-vm.indexOf(qa)).map(da=>fk.get(da))},Ko=ca(602),cv=window.LSUI,Pr=te(({shapes:c,offsets:k,hidden:J})=>{const da=Le(),qa=Er.useRef(null),Ca=Er.useRef(null);Er.useLayoutEffect(()=>{setTimeout(()=>{const bb=Ca.current;if(bb){var {offsetWidth:rb,offsetHeight:Pb}=bb;qa.current=[rb,Pb]}})});Er.useLayoutEffect(()=>{var bb;const rb=Ca.current;if(rb){var Pb=
null!=(bb=qa.current)?bb:[0,0];bb=0;if(116>k.top){var jc=k.height/2+40;140>k.bottom&&(jc+=k.bottom-140)}else jc=-(k.height/2+40);16>k.left+k.width/2-Pb[0]/2?bb+=-(k.left+k.width/2-Pb[0]/2-16):16>k.right+k.width/2-Pb[0]/2&&(bb+=k.right+k.width/2-Pb[0]/2-16);var [yc,Rc]=[bb,jc];rb.style.transform=`translateX(${yc}px) translateY(${Rc}px)`}},[k]);if(!da)return null;const Ia=Zs(c);return(0,Ko.jsx)(Vl,{centered:!0,children:0<Ia.length&&(0,Ko.jsx)("div",{ref:Ca,className:"tl-toolbar tl-context-bar",style:{visibility:J?
"hidden":"visible",pointerEvents:J?"none":"all"},children:Ia.map((bb,rb)=>(0,Ko.jsxs)(Er.Fragment,{children:[(0,Ko.jsx)(bb,{}),rb<Ia.length-1&&(0,Ko.jsx)(cv.Separator,{orientation:"vertical"})]},rb))})})}),Qr=Uf(ca(22)),Kf=ca(602),Vi=window.LSUI,By=te(function({children:c,collisionRef:k}){var J,da,qa,Ca,Ia,bb,rb,Pb,jc,yc,Rc,jd,fd,xd,Fd,Xc,id;const nd=Le(),{handlers:Gd}=Qr.useContext(Si),wd=Gd.t,Ge=Qr.useRef(null),Je=af=>{af();nd.transition("select")},ag=Qr.useMemo(()=>ac(),[]);return(0,Kf.jsxs)(Vi.ContextMenu,
{onOpenChange:af=>{af&&!nd.isIn("select.contextMenu")?nd.transition("select").selectedTool.transition("contextMenu"):!af&&nd.isIn("select.contextMenu")&&nd.selectedTool.transition("idle")},children:[(0,Kf.jsx)(Vi.ContextMenuTrigger,{disabled:nd.editingShape&&0!==Object.keys(nd.editingShape).length,children:c}),(0,Kf.jsx)(Vi.ContextMenuContent,{className:"tl-menu tl-context-menu",ref:Ge,onEscapeKeyDown:()=>nd.transition("select"),collisionBoundary:k.current,asChild:!0,tabIndex:-1,children:(0,Kf.jsxs)("div",
{children:[1<(null==(J=nd.selectedShapes)?void 0:J.size)&&!nd.readOnly&&(null==(da=nd.selectedShapesArray)?void 0:da.some(af=>!af.props.isLocked))&&(0,Kf.jsxs)(Kf.Fragment,{children:[(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-button-row-wrap",children:[(0,Kf.jsxs)("div",{className:"tl-menu-button-row pb-0",children:[(0,Kf.jsx)(ei,{tooltip:wd("whiteboard/align-left"),onClick:()=>Je(()=>nd.align("left")),children:(0,Kf.jsx)(mh,{name:"layout-align-left"})}),(0,Kf.jsx)(ei,{tooltip:wd("whiteboard/align-center-horizontally"),
onClick:()=>Je(()=>nd.align("centerHorizontal")),children:(0,Kf.jsx)(mh,{name:"layout-align-center"})}),(0,Kf.jsx)(ei,{tooltip:wd("whiteboard/align-right"),onClick:()=>Je(()=>nd.align("right")),children:(0,Kf.jsx)(mh,{name:"layout-align-right"})}),(0,Kf.jsx)(Vi.Separator,{className:"tl-toolbar-separator",orientation:"vertical"}),(0,Kf.jsx)(ei,{tooltip:wd("whiteboard/distribute-horizontally"),onClick:()=>Je(()=>nd.distribute("horizontal")),children:(0,Kf.jsx)(mh,{name:"layout-distribute-vertical"})})]}),
(0,Kf.jsxs)("div",{className:"tl-menu-button-row pt-0",children:[(0,Kf.jsx)(ei,{tooltip:wd("whiteboard/align-top"),onClick:()=>Je(()=>nd.align("top")),children:(0,Kf.jsx)(mh,{name:"layout-align-top"})}),(0,Kf.jsx)(ei,{tooltip:wd("whiteboard/align-center-vertically"),onClick:()=>Je(()=>nd.align("centerVertical")),children:(0,Kf.jsx)(mh,{name:"layout-align-middle"})}),(0,Kf.jsx)(ei,{tooltip:wd("whiteboard/align-bottom"),onClick:()=>Je(()=>nd.align("bottom")),children:(0,Kf.jsx)(mh,{name:"layout-align-bottom"})}),
(0,Kf.jsx)(Vi.Separator,{className:"tl-toolbar-separator",orientation:"vertical"}),(0,Kf.jsx)(ei,{tooltip:wd("whiteboard/distribute-vertically"),onClick:()=>Je(()=>nd.distribute("vertical")),children:(0,Kf.jsx)(mh,{name:"layout-distribute-horizontal"})})]})]}),(0,Kf.jsx)(Vi.ContextMenuSeparator,{className:"menu-separator"}),(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Je(nd.packIntoRectangle),children:[(0,Kf.jsx)(mh,{className:"tl-menu-icon",name:"layout-grid"}),wd("whiteboard/pack-into-rectangle")]}),
(0,Kf.jsx)(Vi.ContextMenuSeparator,{className:"menu-separator"})]}),0<(null==(qa=nd.selectedShapes)?void 0:qa.size)&&(0,Kf.jsxs)(Kf.Fragment,{children:[(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Je(nd.api.zoomToSelection),children:[(0,Kf.jsx)(mh,{className:"tl-menu-icon",name:"circle-dotted"}),wd("whiteboard/zoom-to-fit"),(0,Kf.jsx)(yk,{action:"whiteboard/zoom-to-fit"})]}),(0,Kf.jsx)(Vi.ContextMenuSeparator,{className:"menu-separator"})]}),(nd.selectedShapesArray.some(af=>
"group"===af.type||nd.getParentGroup(af))||1<nd.selectedShapesArray.length)&&(null==(Ca=nd.selectedShapesArray)?void 0:Ca.some(af=>!af.props.isLocked))&&!nd.readOnly&&(0,Kf.jsxs)(Kf.Fragment,{children:[nd.selectedShapesArray.some(af=>"group"===af.type||nd.getParentGroup(af))&&(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Je(nd.api.unGroup),children:[(0,Kf.jsx)(mh,{className:"tl-menu-icon",name:"ungroup"}),wd("whiteboard/ungroup"),(0,Kf.jsx)(yk,{action:"whiteboard/ungroup"})]}),
1<nd.selectedShapesArray.length&&(null==(Ia=nd.selectedShapesArray)?void 0:Ia.some(af=>!af.props.isLocked))&&(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Je(nd.api.doGroup),children:[(0,Kf.jsx)(mh,{className:"tl-menu-icon",name:"group"}),wd("whiteboard/group"),(0,Kf.jsx)(yk,{action:"whiteboard/group"})]}),(0,Kf.jsx)(Vi.ContextMenuSeparator,{className:"menu-separator"})]}),0<(null==(bb=nd.selectedShapes)?void 0:bb.size)&&(null==(rb=nd.selectedShapesArray)?void 0:rb.some(af=>
!af.props.isLocked))&&(0,Kf.jsxs)(Kf.Fragment,{children:[!nd.readOnly&&(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Je(nd.cut),children:[(0,Kf.jsx)(mh,{className:"tl-menu-icon",name:"cut"}),wd("whiteboard/cut")]}),(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Je(nd.copy),children:[(0,Kf.jsx)(mh,{className:"tl-menu-icon",name:"copy"}),wd("whiteboard/copy"),(0,Kf.jsx)(yk,{action:"editor/copy"})]})]}),!nd.readOnly&&(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-item",
onClick:()=>Je(nd.paste),children:[(0,Kf.jsx)(mh,{className:"tl-menu-icon",name:"clipboard"}),wd("whiteboard/paste"),(0,Kf.jsx)(yk,{shortcut:`${Qw}+v`})]}),1===(null==(Pb=nd.selectedShapes)?void 0:Pb.size)&&!nd.readOnly&&(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Je(()=>nd.paste(void 0,!0)),children:[(0,Kf.jsx)(mh,{className:"tl-menu-icon",name:"circle-dotted"}),wd("whiteboard/paste-as-link"),(0,Kf.jsx)(yk,{shortcut:`${Qw}+\u21E7+v`})]}),0<(null==(jc=nd.selectedShapes)?void 0:
jc.size)&&(0,Kf.jsxs)(Kf.Fragment,{children:[(0,Kf.jsx)(Vi.ContextMenuSeparator,{className:"menu-separator"}),(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Je(()=>{var af,Sf;return Gd.exportToImage(nd.currentPageId,{x:nd.selectionBounds.minX+nd.viewport.camera.point[0]-8,y:nd.selectionBounds.minY+nd.viewport.camera.point[1]-8,width:(null==(af=nd.selectionBounds)?void 0:af.width)+16,height:(null==(Sf=nd.selectionBounds)?void 0:Sf.height)+16,zoom:nd.viewport.camera.zoom})}),children:[(0,Kf.jsx)(mh,
{className:"tl-menu-icon",name:"file-export"}),wd("whiteboard/export"),(0,Kf.jsx)("div",{className:"tl-menu-right-slot",children:(0,Kf.jsx)("span",{className:"keyboard-shortcut"})})]})]}),(0,Kf.jsx)(Vi.ContextMenuSeparator,{className:"menu-separator"}),(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Je(nd.api.selectAll),children:[(0,Kf.jsx)(mh,{className:"tl-menu-icon",name:"circle-dotted"}),wd("whiteboard/select-all"),(0,Kf.jsx)(yk,{action:"editor/select-parent"})]}),1<(null==
(yc=nd.selectedShapes)?void 0:yc.size)&&(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Je(nd.api.deselectAll),children:[(0,Kf.jsx)(mh,{className:"tl-menu-icon",name:"circle-dotted"}),wd("whiteboard/deselect-all")]}),!nd.readOnly&&0<(null==(Rc=nd.selectedShapes)?void 0:Rc.size)&&(null==(jd=nd.selectedShapesArray)?void 0:jd.some(af=>!af.props.isLocked))&&(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Je(()=>nd.setLocked(!0)),children:[(0,Kf.jsx)(mh,{className:"tl-menu-icon",
name:"lock"}),wd("whiteboard/lock"),(0,Kf.jsx)(yk,{action:"whiteboard/lock"})]}),!nd.readOnly&&0<(null==(fd=nd.selectedShapes)?void 0:fd.size)&&(null==(xd=nd.selectedShapesArray)?void 0:xd.some(af=>af.props.isLocked))&&(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Je(()=>nd.setLocked(!1)),children:[(0,Kf.jsx)(mh,{className:"tl-menu-icon",name:"lock-open"}),wd("whiteboard/unlock"),(0,Kf.jsx)(yk,{action:"whiteboard/unlock"})]}),0<(null==(Fd=nd.selectedShapes)?void 0:Fd.size)&&
!nd.readOnly&&(null==(Xc=nd.selectedShapesArray)?void 0:Xc.some(af=>!af.props.isLocked))&&(0,Kf.jsxs)(Kf.Fragment,{children:[(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Je(nd.api.deleteShapes),children:[(0,Kf.jsx)(mh,{className:"tl-menu-icon",name:"backspace"}),wd("whiteboard/delete"),(0,Kf.jsx)(yk,{action:"editor/delete"})]}),1<(null==(id=nd.selectedShapes)?void 0:id.size)&&!nd.readOnly&&(0,Kf.jsxs)(Kf.Fragment,{children:[(0,Kf.jsx)(Vi.ContextMenuSeparator,{className:"menu-separator"}),
(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Je(nd.flipHorizontal),children:[(0,Kf.jsx)(mh,{className:"tl-menu-icon",name:"flip-horizontal"}),wd("whiteboard/flip-horizontally")]}),(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Je(nd.flipVertical),children:[(0,Kf.jsx)(mh,{className:"tl-menu-icon",name:"flip-vertical"}),wd("whiteboard/flip-vertically")]})]}),!nd.readOnly&&(0,Kf.jsxs)(Kf.Fragment,{children:[(0,Kf.jsx)(Vi.ContextMenuSeparator,{className:"menu-separator"}),
(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Je(nd.bringToFront),children:[(0,Kf.jsx)(mh,{className:"tl-menu-icon",name:"circle-dotted"}),wd("whiteboard/move-to-front"),(0,Kf.jsx)(yk,{action:"whiteboard/bring-to-front"})]}),(0,Kf.jsxs)(Vi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Je(nd.sendToBack),children:[(0,Kf.jsx)(mh,{className:"tl-menu-icon",name:"circle-dotted"}),wd("whiteboard/move-to-back"),(0,Kf.jsx)(yk,{action:"whiteboard/send-to-back"})]})]}),ag&&(0,Kf.jsx)(Vi.ContextMenuItem,
{className:"tl-menu-item",onClick:()=>{1===nd.selectedShapesArray.length?console.log(Db(nd.selectedShapesArray[0].serialized)):console.log(nd.selectedShapesArray.map(af=>Db(af.serialized)))},children:wd("whiteboard/dev-print-shape-props")})]})]})})]})}),Cy=Uf(ca(22)),Lo=ca(602),Rr=te(({shape:c})=>{const k=Le(),{handlers:J}=Cy.default.useContext(Si),da=J.t,qa=Cy.default.useMemo(()=>{var Ca;const Ia=[...(null!=(Ca=c.props.refs)?Ca:[])].map(bb=>[bb,!0]);"logseq-portal"===c.props.type&&c.props.pageId&&
Ia.unshift([c.props.pageId,!1]);return Ia.filter(bb=>bb[0].toLowerCase()!==k.currentPage.name&&J.getBlockPageName(bb[0])!==k.currentPage.name)},[c.props.id,c.props.type,c.props.parentId,c.props.refs]);return 0===qa.length?null:(0,Lo.jsx)("div",{className:"tl-quick-links",title:da("whiteboard/shape-quick-links"),children:qa.map(([Ca,Ia])=>(0,Lo.jsx)("div",{className:"tl-quick-links-row",children:(0,Lo.jsx)(Tx,{id:Ca,showReferenceContent:Ia})},Ca))})}),$s=Uf(ca(22)),Sr=Uf(ca(22)),Dy={image:[".png",
".svg",".jpg",".jpeg",".gif"],video:[".mp4",".webm",".ogg"],pdf:[".pdf"]},at=(c,k,J)=>z(void 0,[c,k,J],function*(da,{point:qa,shiftKey:Ca,dataTransfer:Ia,fromDrop:bb},rb){function Pb(rf,Zf){return z(this,null,function*(){const hh=Object.values(da.assets).find(Lh=>Lh.src===rf);return hh?hh:{id:Ff(),type:Zf,src:rf,size:yield Ai(rb.makeAssetUrl(rf),Zf)}})}function jc(rf){return z(this,null,function*(){const Zf=rf.filter(hh=>"unknown"!==Xk(hh.name)).map(hh=>z(this,null,function*(){try{const Lh=yield rb.saveAsset(hh);
return yield Pb(Lh,Xk(hh.name))}catch(Lh){console.error(Lh)}return null}));return(yield Promise.all(Zf)).filter(Fc)})}function yc(rf){return[gg(tf({},Io.defaultProps),{html:rf,point:[qa[0],qa[1]]})]}function Rc(rf){return z(this,null,function*(){return Yk(fd,xd,id,Xc,nd,Fd,ag)(rf)})}function jd(){return z(this,null,function*(){const rf=yield navigator.clipboard.read(),Zf=Yk(nd,Fd,ag);return(yield Promise.all(rf.map(hh=>Zf(hh)))).flat().filter(Fc)})}function fd(rf){return z(this,null,function*(){var Zf=
rf.getData("file");if(!Zf)return null;const hh=yield Pb(Zf,"pdf");da.addAssets([hh]);Zf=gg(tf({},Mr.defaultProps),{id:Ff(),assetId:hh.id,url:Zf,opacity:1});hh.size&&Object.assign(Zf,{point:[qa[0]-hh.size[0]/4+16,qa[1]-hh.size[1]/4+16],size:Rd.div(hh.size,2)});return[Zf]})}function xd(rf){return z(this,null,function*(){var Zf=Array.from(rf.files);return 0<Zf.length?(Bh=Zf=yield jc(Zf),Zf.map((hh,Lh)=>{switch(hh.type){case "video":var Oi=Vs.defaultProps;break;case "image":Oi=Ss.defaultProps;break;case "pdf":Oi=
Mr.defaultProps;break;default:return null}Oi=gg(tf({},Oi),{id:Ff(),assetId:hh.id,opacity:1});hh.size&&Object.assign(Oi,{point:[qa[0]-hh.size[0]/4+16*Lh,qa[1]-hh.size[1]/4+16*Lh],size:Rd.div(hh.size,2)});return Oi})):null})}function Fd(rf){return z(this,null,function*(){if(rf.types.includes("text/plain")&&(Ca||bb))return null;const Zf=yield qo(rf,"text/html");return Zf?Yk(Gd,yc)(Zf):null})}function Xc(rf){return z(this,null,function*(){var Zf,hh,Lh,Oi,Vh,ih,oj=rf.getData("block-uuid");if(oj){oj=oj.trim();
const Jj=null==(Lh=null==(hh=null==(Zf=window.logseq)?void 0:Zf.api)?void 0:hh.get_selected_blocks)?void 0:Lh.call(hh);Zf=Jj&&1<(null==Jj?void 0:Jj.length)?Jj.map(qk=>qk.uuid):[oj];null==(ih=null==(Vh=null==(Oi=window.logseq)?void 0:Oi.api)?void 0:Vh.set_blocks_id)?void 0:ih.call(Vh,Zf);Oi=Zf.map(qk=>Je(`((${qk}))`));return(yield Promise.all(Oi)).flat().filter(Fc).map((qk,$l)=>gg(tf({},qk),{point:[qa[0]+(Yj.defaultProps.size[0]+16)*$l,qa[1]]}))}return null})}function id(rf){return z(this,null,function*(){var Zf=
rf.getData("page-name");return Zf?(Zf=Zf.trim(),Je(`[[${Zf}]]`)):null})}function nd(rf){return z(this,null,function*(){var Zf=yield qo(rf,"text/plain");return Zf?(Zf=Zf.trim(),Yk(wd,Ge)(Zf)):null})}function Gd(rf){if(rf=da.api.getClonedShapesFromTldrString(decodeURIComponent(rf),qa)){const {shapes:Zf,assets:hh,bindings:Lh}=rf;Tg.push(...hh);zg.push(...Lh);return Zf}return null}function wd(rf){return z(this,null,function*(){try{const hh=new URL(rf);var Zf=hh.host&&["http:","https:"].includes(hh.protocol)}catch(hh){Zf=
!1}return Zf&&!Ca?qy.test(rf)?[gg(tf({},Jp.defaultProps),{url:rf,point:[qa[0],qa[1]]})]:sy.test(rf)?[gg(tf({},Mq.defaultProps),{url:rf,point:[qa[0],qa[1]]})]:[gg(tf({},Hp.defaultProps),{url:rf,point:[qa[0],qa[1]]})]:null})}function Ge(rf){return rf.startsWith("\x3ciframe")?[gg(tf({},Io.defaultProps),{html:rf,point:[qa[0],qa[1]]})]:null}function Je(rf){return z(this,null,function*(){if(/^\(\(.*\)\)$/.test(rf)&&40===rf.length){var Zf=rf.slice(2,-2);if(sg(Zf))return[gg(tf({},Yj.defaultProps),{point:[qa[0],
qa[1]],size:[400,0],pageId:Zf,fill:da.settings.color,stroke:da.settings.color,scaleLevel:da.settings.scaleLevel,blockType:"B"})]}else if(/^\[\[.*\]\]$/.test(rf))return Zf=rf.slice(2,-2),[gg(tf({},Yj.defaultProps),{point:[qa[0],qa[1]],size:[400,0],pageId:Zf,fill:da.settings.color,stroke:da.settings.color,scaleLevel:da.settings.scaleLevel,blockType:"P"})];return null})}function ag(rf){return z(this,null,function*(){var Zf=yield qo(rf,"text/plain");return Zf&&(Zf=Zf.trim(),Zf=yield null==rb?void 0:rb.addNewBlock(Zf))?
[gg(tf({},Yj.defaultProps),{size:[400,0],point:[qa[0],qa[1]],pageId:Zf,fill:da.settings.color,stroke:da.settings.color,scaleLevel:da.settings.scaleLevel,blockType:"B",compact:!0})]:null})}var af,Sf;let Bh=[],Tg=[];const zg=[];da.cursors.setCursor("progress");let dh=[];try{Ia?dh.push(...(null!=(af=yield Rc(Ia))?af:[])):dh.push(...(null!=(Sf=yield jd())?Sf:[]))}catch(rf){console.error(rf)}const uf=dh.map(rf=>gg(tf({},rf),{parentId:da.currentPageId,isLocked:!1,id:sg(rf.id)?rf.id:Ff()})),Af=null==Ia?
void 0:Ia.types.every(rf=>"Files"===rf);da.wrapUpdate(()=>{var rf=[...Bh,...Tg];0<rf.length&&da.createAssets(rf);0<uf.length&&da.createShapes(uf);da.currentPage.updateBindings(Object.fromEntries(zg.map(Zf=>[Zf.id,Zf])));if(1===da.selectedShapesArray.length&&1===uf.length&&bb){rf=da.selectedShapesArray[0];const Zf=da.getShapeById(uf[0].id);da.createNewLineBinding(rf,Zf)}da.setSelectedShapes(uf.map(Zf=>Zf.id));da.selectedTool.transition("idle");da.cursors.setCursor("default");(bb||Af)&&da.packIntoRectangle()})}),
Ey=Uf(ca(22)),dv=Uf(ca(22)),Yn=ca(602),Fy=[Su,Tu,Xu,Yl,Uu,Vu,Wu,Ek,Fl,Tv,Bt,mr],gD=c=>{const {renderers:k}=xq.useContext(Si);return(0,Yn.jsx)(k.BacklinksCount,gg(tf({},c),{options:{"portal?":!1}}))},Tr=()=>{const c=xq.useRef(null),k=Le(),J=xq.useMemo(()=>({ContextBar:Pr,BacklinksCount:gD,QuickLinks:Rr}),[]);return(0,Yn.jsx)(By,{collisionRef:c,children:(0,Yn.jsx)("div",{ref:c,className:"logseq-tldraw logseq-tldraw-wrapper","data-tlapp":k.uuid,children:(0,Yn.jsx)(nB,{components:J,children:(0,Yn.jsx)(GB,
{})})})})},Lp=c=>{var {onPersist:k,readOnly:J,model:da}=c;c=hj(c,["onPersist","readOnly","model"]);const qa=Rl(),Ca=Ej(),Ia=up(),bb=J?null:zl(),rb=xq.useCallback((Pb,jc)=>{null==k?void 0:k(Pb,jc)},[da]);return(0,Yn.jsx)(jB,gg(tf({Shapes:uy,Tools:Fy,onDrop:qa,onPaste:Ca,onCopy:Ia,readOnly:J,onCanvasDBClick:bb,onPersist:rb,model:da},c),{children:(0,Yn.jsx)(Tr,{})}))},Gy=function(c){var {renderers:k,handlers:J}=c;c=hj(c,["renderers","handlers"]);const da={renderers:xq.useMemo(()=>Object.fromEntries(Object.entries(k).map(([qa,
Ca])=>[qa,xq.memo(Ca)])),[]),handlers:J};return(0,Yn.jsx)(Si.Provider,{value:da,children:(0,Yn.jsx)(Lp,tf({},c))})}};
'use strict';var ZMd=function(a,b){var c=$APP.bI(a)?$APP.Qv.C($APP.uI.C(new $APP.O(null,2,5,$APP.Q,[$APP.Pv,"logseq.tldraw.shape"],null))):$APP.cx;a=$APP.uI.C(new $APP.O(null,2,5,$APP.Q,[$APP.Pv,$APP.Oo.C?$APP.Oo.C(b):$APP.Oo.call(null,b)],null));return $APP.wk.A(function(d){var e=$APP.rf(d);d=$APP.H.A(e,$APP.Qv);e=$APP.H.A(e,$APP.yw);e=$APP.H.A(e,c);return $APP.n(e)?new $APP.m(null,2,[$APP.Dk,$APP.t.C(d),$APP.v_c,$APP.v_c.C(e)],null):null},$APP.qw.C(a))},$Md=function(a){return $APP.Mo.G(a,$APP.G([$APP.No,
!0]))},aNd=function(a,b,c,d,e){var f=$APP.Oo.C?$APP.Oo.C(b):$APP.Oo.call(null,b);c=$APP.of([$APP.DK($APP.dx),$APP.EUa,$APP.DK($APP.fx),new $APP.m(null,6,[$APP.Dk,$APP.pa(c,"id"),$APP.Un,$APP.pa(c,"name"),$APP.sB,$Md($APP.pa(c,"bindings")),$APP.v_c,$APP.pa(c,"nonce"),$APP.B5b,$Md(d),$APP.u5b,e],null)]);d=$APP.To.I?$APP.To.I():$APP.To.call(null);a=$APP.Nv.C(a);a=$APP.n(a)?a:$APP.To.I?$APP.To.I():$APP.To.call(null);return new $APP.m(null,6,[$APP.Rv,b,$APP.Pv,f,$APP.fw,"whiteboard",$APP.yw,c,$APP.Mv,
d,$APP.Nv,a],null)},bNd=function(a,b,c,d,e,f){a=$Md(a.getCleanUpAssets());var g=b.shapes,h=$APP.rh.A(function(z){return $APP.pa(z,"id")},g),k=$APP.Xg(h,$APP.mj.C(g.length));g=$APP.Ug($APP.rh.A(function(z){z=$APP.rf(z);z=$APP.H.A(z,$APP.Dk);return $APP.T.F($Md(b.getShapeById(z).serialized),$APP.Fs,$APP.H.A(k,z))},$APP.es.A(c,d)));d=$APP.Ug($APP.rh.A($APP.Dk,d));var p=$APP.Ug($APP.rh.A($APP.Dk,c)),q=$APP.Ug($APP.wl.A($APP.Fj,$APP.es.A(p,d)));c=$APP.Ug($APP.Wf.A(function(z){z=$APP.Dk.C(z);return q.C?
q.C(z):q.call(null,z)},g));var r=$APP.wl.A($APP.Fj,$APP.es.A(d,p)),u=$APP.nG();d=$APP.y(r)?$APP.wl.A($APP.jb,$APP.lj.A(function(z){return $APP.CK(z,$APP.cx)},function(){var z=new $APP.O(null,1,5,$APP.Q,[$APP.Yt],null),D=$APP.lj.A(function(F){return new $APP.O(null,2,5,$APP.Q,[$APP.Qv,$APP.Uh(F)],null)},r);return $APP.nI?$APP.nI(u,z,D):$APP.Gmb.call(null,u,z,D)}())):null;p=$APP.lj.A(function(z){return new $APP.O(null,2,5,$APP.Q,[$APP.bNa,new $APP.O(null,2,5,$APP.Q,[$APP.Qv,$APP.Uh(z)],null)],null)},
r);g=$APP.wl.A(function(z){var D=$APP.B,F=D.A,J=$APP.v_c.C;var M=new $APP.O(null,2,5,$APP.Q,[$APP.Qv,$APP.Qv.C(z)],null);M=$APP.uI.C?$APP.uI.C(M):$APP.uI.call(null,M);return F.call(D,J.call($APP.v_c,$APP.CK(M,$APP.cx)),$APP.v_c.C($APP.CK(z,$APP.cx)))},$APP.rh.A(function(z){var D=$APP.nG(),F=$APP.hI?$APP.hI(D):$APP.jI.call(null,D);return $APP.KMa(D,F,z,e)},g));var x=$APP.RI(e);a=aNd(x,e,b,a,h);return $APP.y(g)||$APP.y(p)||$APP.Lg.A($APP.yw.C(a),$APP.yw.C(x))?new $APP.m(null,6,[$APP.gTc,a,$APP.r7c,
$APP.rh.A($APP.Ov,g),$APP.vA,p,$APP.fbd,d,$APP.jDc,c,$APP.BRa,new $APP.m(null,2,[$APP.QWa,!0,$APP.QRa,f],null)],null):null},cNd=function(a,b,c){var d=$APP.Dc($APP.A(b.pages)),e=d.shapes,f=$APP.RI(a);f=$APP.CK(f,$APP.fx);f=$APP.u5b.C(f);var g=$APP.Xg(f,$APP.mj.C($APP.vc(f)));e=$APP.Ug($APP.Xl.A(function(r,u){var x=u.id;return new $APP.m(null,2,[$APP.Dk,x,$APP.v_c,$APP.B.A(r,$APP.H.A(g,x))?u.nonce:Date.now()],null)},e));var h=$APP.nG();f=function(){var r=$APP.wt.A($APP.v($APP.Mvd),new $APP.O(null,2,
5,$APP.Q,[h,a],null));return $APP.n(r)?r:$APP.Ug($APP.rh.A(function(u){return $APP.Wr.F(u,$APP.Dk,$APP.t)},ZMd(h,a)))}();b=bNd(b,d,e,f,a,c);d=$APP.rf(b);f=$APP.H.A(d,$APP.gTc);b=$APP.H.A(d,$APP.jDc);var k=$APP.H.A(d,$APP.fbd),p=$APP.H.A(d,$APP.r7c),q=$APP.H.A(d,$APP.vA);c=$APP.H.A(d,$APP.BRa);if($APP.y(d)){d=$APP.kk.G(q,new $APP.O(null,1,5,$APP.Q,[f],null),$APP.G([p]));b=$APP.n($APP.Df(function(r){return $APP.B.A("group",$APP.yl.C(r))},b))?$APP.T.F(c,$APP.LHc,$APP.eF):$APP.n(function(){var r=$APP.sf(k);
return $APP.n(r)?$APP.Af(function(u){return $APP.B.A("group",$APP.yl.C(u))},k):r}())?$APP.T.F(c,$APP.LHc,$APP.oUc):$APP.n($APP.Df(function(r){return $APP.B.A("line",$APP.yl.C(r))&&$APP.B.A("arrow ",$APP.Km.C($APP.eSc.C(r)))},b))?$APP.T.F(c,$APP.LHc,$APP.Q3c):c;$APP.Ih.K($APP.Mvd,$APP.Vr,new $APP.O(null,2,5,$APP.Q,[h,a],null),e);if($APP.Xd(new $APP.Ng(null,new $APP.m(null,1,[$APP.Q3c,null],null),null),$APP.LHc.C(b)))return $APP.pG($APP.Gid,new $APP.m(null,2,[$APP.ot,d,$APP.BRa,b],null));e=$APP.Gid.C($APP.v($APP.lG));
c=$APP.kk.A($APP.ot.C(e),d);e=$APP.Ln.G($APP.G([b,$APP.BRa.C(e)]));$APP.pG($APP.Gid,$APP.pf);return $APP.qI?$APP.qI(h,c,e):$APP.rI.call(null,h,c,e)}return null},dNd=function(a){return $APP.el(null,function(){return $APP.el(function(){var b=$APP.n(a)?$APP.vi(a):a;return $APP.n(b)?b:$APP.lu?$APP.lu():$APP.mu.call(null)}(),function(b){return $APP.el($APP.n(a)?a:$APP.t.C(b),function(c){return $APP.el(function(){var d=$APP.of([$APP.DK($APP.dx),$APP.EUa,$APP.DK($APP.fx),new $APP.m(null,6,[$APP.Dk,$APP.t.C(b),
$APP.Un,c,$APP.dx,$APP.EUa,$APP.sB,$APP.pf,$APP.v_c,1,$APP.B5b,$APP.$f],null)]);d=new $APP.O(null,1,5,$APP.Q,[$APP.Cg([$APP.Qv,$APP.yw,$APP.rw,$APP.Mv,$APP.Nv,$APP.Px,$APP.fw,$APP.Pv,$APP.Rv],[b,d,!1,$APP.To.I?$APP.To.I():$APP.To.call(null),$APP.To.I?$APP.To.I():$APP.To.call(null),$APP.cs,"whiteboard",$APP.Oo.C?$APP.Oo.C(c):$APP.Oo.call(null,c),c])],null);return $APP.oI?$APP.oI(d):$APP.rI.call(null,d)}(),function(){return $APP.Xk(c)})})})})},eNd=function(a,b){return $APP.el(null,function(){return $APP.el($APP.nG(),
function(c){return $APP.el($APP.vw.I?$APP.vw.I():$APP.vw.call(null),function(d){return $APP.el($APP.RI(a),function(e){return $APP.el($APP.Ov(new $APP.m(null,5,[$APP.Qv,d,$APP.Sv,$APP.n(b)?b:"",$APP.Px,$APP.cs,$APP.iw,new $APP.m(null,2,[$APP.Pv,$APP.Oo.C?$APP.Oo.C(a):$APP.Oo.call(null,a),$APP.Rv,a],null),$APP.kw,$APP.rt.C(e)],null)),function(f){return $APP.el(function(){var g=new $APP.O(null,1,5,$APP.Q,[f],null),h=new $APP.m(null,1,[$APP.QWa,!0],null);return $APP.qI?$APP.qI(c,g,h):$APP.rI.call(null,
c,g,h)}(),function(){return $APP.Xk(d)})})})})})})},fNd=function(){return $APP.el(null,function(){return $APP.el(fetch("./whiteboard/onboarding.edn"),function(a){return $APP.el(a.text(),function(b){return $APP.el($APP.eE($APP.pf,b),function(c){return $APP.Xk(c)})})})})},gNd=function(a){var b=$APP.Nob();return($APP.ad(b)||$APP.B.A(1,$APP.vc(b))&&$APP.B.A(a,$APP.Pv.C($APP.A(b))))&&$APP.nb($APP.wt.A($APP.v($APP.lG),new $APP.O(null,1,5,$APP.Q,[$APP.$kb],null)))},hNd=function(a){var b=$APP.BH();$APP.n(b)&&
$APP.Gf.A(b.api.updateShapes,$APP.Fi(a))},iNd=function(a){var b=$APP.BH();$APP.n(b)&&(b=$APP.Dc($APP.A(b.pages)),$APP.n(b)&&(a=new $APP.O(null,2,5,$APP.Q,[$APP.Pv,a],null),a=$APP.uI.C?$APP.uI.C(a):$APP.uI.call(null,a),$APP.n(a)&&(a=$APP.CK(a,$APP.fx),a=$APP.u5b.C(a),$APP.y(a)&&b.updateShapesIndex($APP.Fi(a)))))},jNd=function(a){return null!=a?$APP.fl($APP.el(null,function(){return $APP.el(fNd(),function(b){var c=$APP.rf(b);b=$APP.H.A(c,$APP.ow);c=$APP.H.A(c,$APP.qy);var d=$APP.A(b);b=$APP.v5b(d,c);
d=$APP.CK(d,$APP.fx);c=$APP.B5b.C(d);d=$APP.sB.C(d);a.cloneShapesIntoCurrentPage($APP.Ei(new $APP.m(null,3,[$APP.E5b,b,$APP.B5b,c,$APP.sB,d],null)));b=$APP.blb();return $APP.Xk(b)})}),function(b){return console.warn("Failed to populate onboarding whiteboard",b)}):null},kNd=function(a){a.cleanup($APP.rh.A(function(b){return b.id},a.shapes))},nNd=function(a,b){b=$APP.Mo.G(b,$APP.G([new $APP.m(null,1,[$APP.No,!0],null)]));b=$APP.rf(b);var c=$APP.H.A(b,lNd),d=$APP.H.A(b,$APP.AK),e=$APP.H.A(b,mNd),f=$APP.nG();
return $APP.el(null,function(){return $APP.el($APP.n(d)?$APP.JKb(f,a,new $APP.m(null,1,[$APP.Ft,100],null)):null,function(g){return $APP.el($APP.rh.A(function(h){return $APP.Wr.F(h,$APP.Qv,$APP.t)},g),function(h){return $APP.el($APP.n(c)?$APP.KKb(a):null,function(k){return $APP.el($APP.n(e)?$APP.LKb(a,100):null,function(p){return $APP.Xk($APP.Ei(new $APP.m(null,3,[$APP.ow,k,$APP.qy,h,$APP.eA,p],null)))})})})})})},oNd=function(a){return $APP.dl($APP.kXb($APP.nG(),new $APP.O(null,1,5,$APP.Q,[$APP.Mo.C(a)],
null)),function(b){var c=(c=$APP.y(b))?$APP.A(b):c;return $APP.n(c)?(b=$APP.C.F(c,0,null),$APP.C.F(c,1,null),c=$APP.C.F(c,2,null),$APP.nXb($APP.n(c)?c:b)):null})},pNd=function(){return $APP.I_b(null)},qNd=function(){return $APP.J_b(null)},HNd=function(a){return $APP.Cg([rNd,sNd,tNd,uNd,vNd,wNd,xNd,yNd,$APP.tC,zNd,ANd,BNd,CNd,$APP.Vz,DNd,ENd,FNd,GNd],[function(b){if($APP.n($APP.Ro.C?$APP.Ro.C(b):$APP.Ro.call(null,b)))var c=$APP.Pv.C($APP.Rnb($APP.nG(),$APP.vi(b)));else c=$APP.Pv.C,b=new $APP.O(null,
2,5,$APP.Q,[$APP.Pv,$APP.Oo.C?$APP.Oo.C(b):$APP.Oo.call(null,b)],null),b=$APP.uI.C?$APP.uI.C(b):$APP.uI.call(null,b),c=c.call($APP.Pv,b);return c},function(b){return $APP.Ei($APP.Pic(b))},function(b){return $APP.SI(b,!1)},function(b){return $APP.klb($APP.n(b)?$APP.Pic(b):null)},function(b){return dNd(b)},$APP.SF,function(b){return $APP.oWb(b,new $APP.m(null,1,[$APP.wP,!1],null))},$APP.WI,nNd,oNd,$APP.mXb,function(b,c){return $APP.bfb(b,$APP.G([$APP.Hz,c]))},function(b){return $APP.el(null,function(){return $APP.el(eNd(a,
b),function(c){return $APP.Xk($APP.t.C(c))})})},function(b){return $APP.TK.G($APP.G([$APP.sh.C(b)]))},function(b,c){return $APP.wH(function(){return(0,$APP.ifc)(b,$APP.Ln.G($APP.G([$APP.Mo.G(c,$APP.G([$APP.No,!0])),new $APP.m(null,1,[$APP.Ay,!0],null)])))})},function(b,c){return $APP.eH($APP.nG(),$APP.rt.C($APP.RI(b)),$APP.sh.C(c))},function(b){var c=$APP.n($APP.Ro.C?$APP.Ro.C(b):$APP.Ro.call(null,b))?$APP.Pv.C($APP.Rnb($APP.nG(),$APP.vi(b))):null;c=$APP.n(c)?c:b;var d=$APP.PI(c),e=$APP.WI(c);return $APP.n(d)?
$APP.n(e)?$APP.OLb(c,new $APP.m(null,1,[$APP.BN,b],null)):$APP.AN($APP.SI(b,!1)):null},function(b){return $APP.Ei($APP.snb(b))}])},JNd=function(a,b,c){return $APP.fl($APP.el(null,function(){return $APP.el($APP.v(INd),function(){return $APP.el($APP.el(null,function(){return $APP.el($APP.pG(new $APP.O(null,2,5,$APP.Q,[$APP.O$c,$APP.nG()],null),$APP.To.I?$APP.To.I():$APP.To.call(null)),function(){return $APP.Xk(cNd(a,b,c.replace))})}),function(d){return $APP.Xk($APP.Kf(INd,d))})})}),function(d){console.error(d);
return $APP.zD.C(new $APP.O(null,2,5,$APP.Q,[$APP.ZB,["Save whiteboard failed, error:",$APP.t.C(d.cause)].join("")],null))})},GNd=new $APP.K(null,"queryBlockByUUID","queryBlockByUUID",2091812895),DNd=new $APP.K(null,"exportToImage","exportToImage",-154356643),CNd=new $APP.K(null,"addNewBlock","addNewBlock",1426762680),KNd=new $APP.K(null,"KeyboardShortcut","KeyboardShortcut",1250004264),mNd=new $APP.K(null,"files?","files?",-1267491104),rNd=new $APP.K(null,"getBlockPageName","getBlockPageName",-1656908032),
LNd=new $APP.K(null,"renderers","renderers",-1460292282),MNd=new $APP.K(null,"model","model",331153215),tNd=new $APP.K(null,"getRedirectPageName","getRedirectPageName",-1858136925),wNd=new $APP.K(null,"isMobile","isMobile",-2043133877),uNd=new $APP.K(null,"setCurrentPdf","setCurrentPdf",-63289336),NNd=new $APP.K(null,"onMount","onMount",-876858467),xNd=new $APP.K(null,"insertFirstPageBlock","insertFirstPageBlock",-1676658548),ANd=new $APP.K(null,"makeAssetUrl","makeAssetUrl",217779988),ONd=new $APP.K(null,
"onPersist","onPersist",-1848738852),PNd=new $APP.K(null,"Breadcrumb","Breadcrumb",-1351298906),BNd=new $APP.K(null,"copyToClipboard","copyToClipboard",1092115063),FNd=new $APP.K(null,"redirectToPage","redirectToPage",87147838),vNd=new $APP.K(null,"addNewWhiteboard","addNewWhiteboard",554297706),zNd=new $APP.K(null,"saveAsset","saveAsset",-668047853),QNd=new $APP.K(null,"BacklinksCount","BacklinksCount",364670631),RNd=new $APP.K(null,"Block","Block",-1959785792),ENd=new $APP.K(null,"sidebarAddBlock",
"sidebarAddBlock",-1204903203),SNd=new $APP.K(null,"Page","Page",-1267059506),lNd=new $APP.K(null,"pages?","pages?",-2065014049),TNd=new $APP.K(null,"PageName","PageName",-164991013),UNd=new $APP.K(null,"Tweet","Tweet",-452258680),yNd=new $APP.K(null,"isWhiteboardPage","isWhiteboardPage",-134150579),VNd=new $APP.K(null,"BlockReference","BlockReference",-120254741),sNd=new $APP.K(null,"inflateAsset","inflateAsset",-1449040639);$APP.Z4a("tldraw");var WNd=$APP.jl(606);var XNd,YNd,INd,ZNd,$Nd;$APP.jDd={};XNd=$APP.hG($APP.pa(WNd,"App"));$APP.mDd=$APP.pa(WNd,"generateJSXFromModel");
YNd=new $APP.m(null,8,[SNd,$APP.DE($APP.HE,function(a){return(0,$APP.Rzc)(new $APP.m(null,2,[$APP.$z,$APP.SI($APP.pa(a,"pageName"),!1),$APP.Ay,!0],null))},null,"frontend.extensions.tldraw/page-cp"),RNd,$APP.DE($APP.HE,function(a){a=$APP.Uh($APP.pa(a,"blockId"));var b=$APP.lkb($APP.Wzc);a=b.C?b.C(a):b.call(null,a);return $APP.uE(a)},null,"frontend.extensions.tldraw/block-cp"),PNd,$APP.DE($APP.HE,function(a){return(0,$APP.eU)(new $APP.m(null,1,[$APP.gX,!0],null),$APP.nG(),$APP.Uh($APP.pa(a,"blockId")),
new $APP.m(null,2,[$APP.wFc,$APP.pa(a,"endSeparator"),$APP.uBc,$APP.pa(a,"levelLimit",3)],null))},null,"frontend.extensions.tldraw/breadcrumb"),UNd,$APP.DE($APP.HE,function(a){return(0,$APP.smc)($APP.pa(a,"tweetId"))},null,"frontend.extensions.tldraw/tweet"),TNd,$APP.DE($APP.HE,function(a){return(0,$APP.QS)(new $APP.m(null,1,[$APP.gX,!0],null),new $APP.m(null,1,[$APP.Pv,$APP.pa(a,"pageName")],null))},null,"frontend.extensions.tldraw/page-name-link"),QNd,function(a){return $APP.Gf.A($APP.pDd,$APP.rh.A(function(b){return $APP.Mo.G($APP.pa(a,
b),$APP.G([new $APP.m(null,1,[$APP.No,!0],null)]))},new $APP.O(null,3,5,$APP.Q,["id","className","options"],null)))},VNd,$APP.DE($APP.HE,function(a){return(0,$APP.Flc)($APP.pf,$APP.pa(a,"blockId"),null)},null,"frontend.extensions.tldraw/block-reference"),KNd,$APP.DE($APP.HE,function(a){return $APP.uE(function(){var b=$APP.Di(a);if($APP.n(b)){var c=$APP.rf(b);b=$APP.H.A(c,$APP.IC);var d=$APP.H.A(c,$APP.CQ);c=$APP.H.A(c,$APP.oy);b="string"===typeof b?$APP.RQ($APP.sh.C(b)):d;var e=$APP.Ln.G($APP.G([new $APP.m(null,
1,[$APP.k4,!1],null),c]));return"string"===typeof b?$APP.r8b(b,$APP.G([e])):$APP.qn.A(" | ",$APP.rh.A(function(f){return $APP.r8b(f,$APP.G([e]))},b))}return null}())},null,"frontend.extensions.tldraw/keyboard-shortcut")],null);INd=$APP.Gh.C(null);
ZNd=$APP.DE($APP.HE,function(a,b,c,d,e){return $APP.Y("div",{style:{overscrollBehavior:"none"},onBlur:function(f){f=$APP.pa(f,"target").tagName;var g=new $APP.Ng(null,new $APP.m(null,2,["INPUT",null,"TEXTAREA",null],null),null);f=g.C?g.C(f):g.call(null,f);return $APP.n(f)?$APP.hH():null},onWheel:$APP.CF,className:"draw tldraw whiteboard relative w-full h-full"},[$APP.n($APP.n(c)?$APP.nb(d):c)?$APP.Y("div",{style:{zIndex:200},className:"absolute inset-0 flex items-center justify-center"},[$APP.uE($APP.VQ("Loading onboarding whiteboard ..."))]):
null,$APP.uE(function(){var f=new $APP.m(null,6,[LNd,YNd,$APP.OLa,HNd(a),NNd,e,$APP.T8c,!0,ONd,function(g,h){return JNd(a,g,h)},MNd,b],null);return XNd.C?XNd.C(f):XNd.call(null,f)}())])},new $APP.O(null,2,5,$APP.Q,[$APP.GE,new $APP.m(null,1,[$APP.fbb,function(a,b){var c=$APP.A($APP.FE.C(a)),d=$APP.C.A($APP.FE.C(a),1),e=$APP.C.A($APP.FE.C(b),1),f=function(){var g=function(){var h=$APP.pa(d,"pages");h=null==h?null:$APP.A(h);return null==h?null:$APP.pa(h,"shapes")}();return $APP.Xg($APP.rh.A(function(h){return $APP.pa(h,
"id")},g),g)}();a=function(){var g=$APP.pa(e,"pages");g=null==g?null:$APP.A(g);return null==g?null:$APP.pa(g,"shapes")}();a=$APP.Wf.A(function(g){var h=$APP.H.A(f,$APP.pa(g,"id"));return $APP.n(h)?$APP.Lg.A($APP.pa(g,"type"),$APP.pa(h,"type")):null},a);$APP.y(a)&&hNd(a);iNd(c);return b}],null)],null),"frontend.extensions.tldraw/tldraw-inner");
$Nd=$APP.DE($APP.HE,function(a,b,c,d){function e(h){if($APP.n(h)){h.appUndo=pNd;h.appRedo=qNd;var k=$APP.pa(h,"api");return $APP.n(k)?$APP.dl(f?jNd(k):null,function(){kNd(h.currentPage);$APP.llb(h,b);return d.C?d.C(h):d.call(null,h)}):null}return null}if($APP.n($APP.XH(a)))return null;var f=gNd(a),g=$APP.F5b(a);return $APP.n(g)?ZNd(a,g,f,c,e):null},new $APP.O(null,2,5,$APP.Q,[$APP.v8,new $APP.m(null,1,[$APP.yE,function(a){var b=$APP.A($APP.FE.C(a));$APP.zKb($APP.nG(),b);return a}],null)],null),"frontend.extensions.tldraw/tldraw-app-inner");
$APP.kDd=$APP.DE($APP.HE,function(a,b){var c=$APP.NE(null),d=$APP.C.F(c,0,null);c=$APP.C.F(c,1,null);$APP.OE(function(){$APP.n($APP.n(d)?b:d)&&$APP.llb(d,b);return function(){return $APP.gc}},new $APP.O(null,2,5,$APP.Q,[b,d],null));return $Nd(a,b,d,c)},null,"frontend.extensions.tldraw/tldraw-app");$APP.Xy.ii();
}).call(this);